var che=Object.defineProperty;var uhe=(n,e,t)=>e in n?che(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var We=(n,e,t)=>(uhe(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function xj(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}function DC(n){if(Bn(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=ho(r)?fhe(r):DC(r);if(i)for(const s in i)e[s]=i[s]}return e}else{if(ho(n))return n;if(ws(n))return n}}const hhe=/;(?![^(]*\))/g,dhe=/:([^]+)/,phe=/\/\*.*?\*\//gs;function fhe(n){const e={};return n.replace(phe,"").split(hhe).forEach(t=>{if(t){const r=t.split(dhe);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function QO(n){let e="";if(ho(n))e=n;else if(Bn(n))for(let t=0;t<n.length;t++){const r=QO(n[t]);r&&(e+=r+" ")}else if(ws(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function mhe(n){if(!n)return null;let{class:e,style:t}=n;return e&&!ho(e)&&(n.class=QO(e)),t&&(n.style=DC(t)),n}const vhe="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ghe=xj(vhe);function ree(n){return!!n||n===""}const Ni={},Py=[],rh=()=>{},_he=()=>!1,yhe=/^on[^a-z]/,$O=n=>yhe.test(n),bj=n=>n.startsWith("onUpdate:"),Ia=Object.assign,wj=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},xhe=Object.prototype.hasOwnProperty,yr=(n,e)=>xhe.call(n,e),Bn=Array.isArray,hM=n=>eL(n)==="[object Map]",bhe=n=>eL(n)==="[object Set]",jn=n=>typeof n=="function",ho=n=>typeof n=="string",Sj=n=>typeof n=="symbol",ws=n=>n!==null&&typeof n=="object",iee=n=>ws(n)&&jn(n.then)&&jn(n.catch),whe=Object.prototype.toString,eL=n=>whe.call(n),She=n=>eL(n).slice(8,-1),Mhe=n=>eL(n)==="[object Object]",Mj=n=>ho(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,p3=xj(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),tL=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},Che=/-(\w)/g,td=tL(n=>n.replace(Che,(e,t)=>t?t.toUpperCase():"")),Ehe=/\B([A-Z])/g,Wx=tL(n=>n.replace(Ehe,"-$1").toLowerCase()),nL=tL(n=>n.charAt(0).toUpperCase()+n.slice(1)),IB=tL(n=>n?`on${nL(n)}`:""),VM=(n,e)=>!Object.is(n,e),NB=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},MR=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},see=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let J7;const Ahe=()=>J7||(J7=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Sh;class Phe{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Sh,!e&&Sh&&(this.index=(Sh.scopes||(Sh.scopes=[])).push(this)-1)}run(e){if(this.active){const t=Sh;try{return Sh=this,e()}finally{Sh=t}}}on(){Sh=this}off(){Sh=this.parent}stop(e){if(this.active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this.active=!1}}}function The(n,e=Sh){e&&e.active&&e.effects.push(n)}const Cj=n=>{const e=new Set(n);return e.w=0,e.n=0,e},oee=n=>(n.w&Cm)>0,aee=n=>(n.n&Cm)>0,Rhe=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=Cm},Ohe=n=>{const{deps:e}=n;if(e.length){let t=0;for(let r=0;r<e.length;r++){const i=e[r];oee(i)&&!aee(i)?i.delete(n):e[t++]=i,i.w&=~Cm,i.n&=~Cm}e.length=t}},n6=new WeakMap;let ZS=0,Cm=1;const r6=30;let Qu;const n0=Symbol(""),i6=Symbol("");class Ej{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,The(this,r)}run(){if(!this.active)return this.fn();let e=Qu,t=mm;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Qu,Qu=this,mm=!0,Cm=1<<++ZS,ZS<=r6?Rhe(this):Q7(this),this.fn()}finally{ZS<=r6&&Ohe(this),Cm=1<<--ZS,Qu=this.parent,mm=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Qu===this?this.deferStop=!0:this.active&&(Q7(this),this.onStop&&this.onStop(),this.active=!1)}}function Q7(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let mm=!0;const lee=[];function Gx(){lee.push(mm),mm=!1}function Xx(){const n=lee.pop();mm=n===void 0?!0:n}function Ac(n,e,t){if(mm&&Qu){let r=n6.get(n);r||n6.set(n,r=new Map);let i=r.get(t);i||r.set(t,i=Cj()),cee(i)}}function cee(n,e){let t=!1;ZS<=r6?aee(n)||(n.n|=Cm,t=!oee(n)):t=!n.has(Qu),t&&(n.add(Qu),Qu.deps.push(n))}function Hp(n,e,t,r,i,s){const o=n6.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&Bn(n)){const c=see(r);o.forEach((u,d)=>{(d==="length"||d>=c)&&a.push(u)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":Bn(n)?Mj(t)&&a.push(o.get("length")):(a.push(o.get(n0)),hM(n)&&a.push(o.get(i6)));break;case"delete":Bn(n)||(a.push(o.get(n0)),hM(n)&&a.push(o.get(i6)));break;case"set":hM(n)&&a.push(o.get(n0));break}if(a.length===1)a[0]&&s6(a[0]);else{const c=[];for(const u of a)u&&c.push(...u);s6(Cj(c))}}function s6(n,e){const t=Bn(n)?n:[...n];for(const r of t)r.computed&&$7(r);for(const r of t)r.computed||$7(r)}function $7(n,e){(n!==Qu||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const Lhe=xj("__proto__,__v_isRef,__isVue"),uee=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Sj)),Dhe=Aj(),Ihe=Aj(!1,!0),Nhe=Aj(!0),eW=khe();function khe(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=Vn(this);for(let s=0,o=this.length;s<o;s++)Ac(r,"get",s+"");const i=r[e](...t);return i===-1||i===!1?r[e](...t.map(Vn)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){Gx();const r=Vn(this)[e].apply(this,t);return Xx(),r}}),n}function Aj(n=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!n;if(i==="__v_isReadonly")return n;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(n?e?Qhe:mee:e?fee:pee).get(r))return r;const o=Bn(r);if(!n&&o&&yr(eW,i))return Reflect.get(eW,i,s);const a=Reflect.get(r,i,s);return(Sj(i)?uee.has(i):Lhe(i))||(n||Ac(r,"get",i),e)?a:La(a)?o&&Mj(i)?a:a.value:ws(a)?n?vee(a):iL(a):a}}const zhe=hee(),Bhe=hee(!0);function hee(n=!1){return function(t,r,i,s){let o=t[r];if(Qy(o)&&La(o)&&!La(i))return!1;if(!n&&(!CR(i)&&!Qy(i)&&(o=Vn(o),i=Vn(i)),!Bn(t)&&La(o)&&!La(i)))return o.value=i,!0;const a=Bn(t)&&Mj(r)?Number(r)<t.length:yr(t,r),c=Reflect.set(t,r,i,s);return t===Vn(s)&&(a?VM(i,o)&&Hp(t,"set",r,i):Hp(t,"add",r,i)),c}}function Vhe(n,e){const t=yr(n,e);n[e];const r=Reflect.deleteProperty(n,e);return r&&t&&Hp(n,"delete",e,void 0),r}function Fhe(n,e){const t=Reflect.has(n,e);return(!Sj(e)||!uee.has(e))&&Ac(n,"has",e),t}function Uhe(n){return Ac(n,"iterate",Bn(n)?"length":n0),Reflect.ownKeys(n)}const dee={get:Dhe,set:zhe,deleteProperty:Vhe,has:Fhe,ownKeys:Uhe},jhe={get:Nhe,set(n,e){return!0},deleteProperty(n,e){return!0}},Hhe=Ia({},dee,{get:Ihe,set:Bhe}),Pj=n=>n,rL=n=>Reflect.getPrototypeOf(n);function mA(n,e,t=!1,r=!1){n=n.__v_raw;const i=Vn(n),s=Vn(e);t||(e!==s&&Ac(i,"get",e),Ac(i,"get",s));const{has:o}=rL(i),a=r?Pj:t?Oj:FM;if(o.call(i,e))return a(n.get(e));if(o.call(i,s))return a(n.get(s));n!==i&&n.get(e)}function vA(n,e=!1){const t=this.__v_raw,r=Vn(t),i=Vn(n);return e||(n!==i&&Ac(r,"has",n),Ac(r,"has",i)),n===i?t.has(n):t.has(n)||t.has(i)}function gA(n,e=!1){return n=n.__v_raw,!e&&Ac(Vn(n),"iterate",n0),Reflect.get(n,"size",n)}function tW(n){n=Vn(n);const e=Vn(this);return rL(e).has.call(e,n)||(e.add(n),Hp(e,"add",n,n)),this}function nW(n,e){e=Vn(e);const t=Vn(this),{has:r,get:i}=rL(t);let s=r.call(t,n);s||(n=Vn(n),s=r.call(t,n));const o=i.call(t,n);return t.set(n,e),s?VM(e,o)&&Hp(t,"set",n,e):Hp(t,"add",n,e),this}function rW(n){const e=Vn(this),{has:t,get:r}=rL(e);let i=t.call(e,n);i||(n=Vn(n),i=t.call(e,n)),r&&r.call(e,n);const s=e.delete(n);return i&&Hp(e,"delete",n,void 0),s}function iW(){const n=Vn(this),e=n.size!==0,t=n.clear();return e&&Hp(n,"clear",void 0,void 0),t}function _A(n,e){return function(r,i){const s=this,o=s.__v_raw,a=Vn(o),c=e?Pj:n?Oj:FM;return!n&&Ac(a,"iterate",n0),o.forEach((u,d)=>r.call(i,c(u),c(d),s))}}function yA(n,e,t){return function(...r){const i=this.__v_raw,s=Vn(i),o=hM(s),a=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,u=i[n](...r),d=t?Pj:e?Oj:FM;return!e&&Ac(s,"iterate",c?i6:n0),{next(){const{value:p,done:f}=u.next();return f?{value:p,done:f}:{value:a?[d(p[0]),d(p[1])]:d(p),done:f}},[Symbol.iterator](){return this}}}}function Af(n){return function(...e){return n==="delete"?!1:this}}function Whe(){const n={get(s){return mA(this,s)},get size(){return gA(this)},has:vA,add:tW,set:nW,delete:rW,clear:iW,forEach:_A(!1,!1)},e={get(s){return mA(this,s,!1,!0)},get size(){return gA(this)},has:vA,add:tW,set:nW,delete:rW,clear:iW,forEach:_A(!1,!0)},t={get(s){return mA(this,s,!0)},get size(){return gA(this,!0)},has(s){return vA.call(this,s,!0)},add:Af("add"),set:Af("set"),delete:Af("delete"),clear:Af("clear"),forEach:_A(!0,!1)},r={get(s){return mA(this,s,!0,!0)},get size(){return gA(this,!0)},has(s){return vA.call(this,s,!0)},add:Af("add"),set:Af("set"),delete:Af("delete"),clear:Af("clear"),forEach:_A(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=yA(s,!1,!1),t[s]=yA(s,!0,!1),e[s]=yA(s,!1,!0),r[s]=yA(s,!0,!0)}),[n,t,e,r]}const[Ghe,Xhe,qhe,Yhe]=Whe();function Tj(n,e){const t=e?n?Yhe:qhe:n?Xhe:Ghe;return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(yr(t,i)&&i in r?t:r,i,s)}const Zhe={get:Tj(!1,!1)},Khe={get:Tj(!1,!0)},Jhe={get:Tj(!0,!1)},pee=new WeakMap,fee=new WeakMap,mee=new WeakMap,Qhe=new WeakMap;function $he(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ede(n){return n.__v_skip||!Object.isExtensible(n)?0:$he(She(n))}function iL(n){return Qy(n)?n:Rj(n,!1,dee,Zhe,pee)}function tde(n){return Rj(n,!1,Hhe,Khe,fee)}function vee(n){return Rj(n,!0,jhe,Jhe,mee)}function Rj(n,e,t,r,i){if(!ws(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=ede(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function Ty(n){return Qy(n)?Ty(n.__v_raw):!!(n&&n.__v_isReactive)}function Qy(n){return!!(n&&n.__v_isReadonly)}function CR(n){return!!(n&&n.__v_isShallow)}function gee(n){return Ty(n)||Qy(n)}function Vn(n){const e=n&&n.__v_raw;return e?Vn(e):n}function _ee(n){return MR(n,"__v_skip",!0),n}const FM=n=>ws(n)?iL(n):n,Oj=n=>ws(n)?vee(n):n;function yee(n){mm&&Qu&&(n=Vn(n),cee(n.dep||(n.dep=Cj())))}function xee(n,e){n=Vn(n),n.dep&&s6(n.dep)}function La(n){return!!(n&&n.__v_isRef===!0)}function qx(n){return nde(n,!1)}function nde(n,e){return La(n)?n:new rde(n,e)}class rde{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Vn(e),this._value=t?e:FM(e)}get value(){return yee(this),this._value}set value(e){const t=this.__v_isShallow||CR(e)||Qy(e);e=t?e:Vn(e),VM(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:FM(e),xee(this))}}function Mh(n){return La(n)?n.value:n}const ide={get:(n,e,t)=>Mh(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return La(i)&&!La(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function bee(n){return Ty(n)?n:new Proxy(n,ide)}var wee;class sde{constructor(e,t,r,i){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[wee]=!1,this._dirty=!0,this.effect=new Ej(e,()=>{this._dirty||(this._dirty=!0,xee(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=Vn(this);return yee(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}wee="__v_isReadonly";function ode(n,e,t=!1){let r,i;const s=jn(n);return s?(r=n,i=rh):(r=n.get,i=n.set),new sde(r,i,s||!i,t)}function vm(n,e,t,r){let i;try{i=r?n(...r):n()}catch(s){sL(s,e,t)}return i}function nu(n,e,t,r){if(jn(n)){const s=vm(n,e,t,r);return s&&iee(s)&&s.catch(o=>{sL(o,e,t)}),s}const i=[];for(let s=0;s<n.length;s++)i.push(nu(n[s],e,t,r));return i}function sL(n,e,t,r=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=t;for(;s;){const u=s.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](n,o,a)===!1)return}s=s.parent}const c=e.appContext.config.errorHandler;if(c){vm(c,null,10,[n,o,a]);return}}ade(n,t,i,r)}function ade(n,e,t,r=!0){console.error(n)}let UM=!1,o6=!1;const Pa=[];let Ih=0;const Ry=[];let Sp=null,jg=0;const See=Promise.resolve();let Lj=null;function lde(n){const e=Lj||See;return n?e.then(this?n.bind(this):n):e}function cde(n){let e=Ih+1,t=Pa.length;for(;e<t;){const r=e+t>>>1;jM(Pa[r])<n?e=r+1:t=r}return e}function Dj(n){(!Pa.length||!Pa.includes(n,UM&&n.allowRecurse?Ih+1:Ih))&&(n.id==null?Pa.push(n):Pa.splice(cde(n.id),0,n),Mee())}function Mee(){!UM&&!o6&&(o6=!0,Lj=See.then(Eee))}function ude(n){const e=Pa.indexOf(n);e>Ih&&Pa.splice(e,1)}function hde(n){Bn(n)?Ry.push(...n):(!Sp||!Sp.includes(n,n.allowRecurse?jg+1:jg))&&Ry.push(n),Mee()}function sW(n,e=UM?Ih+1:0){for(;e<Pa.length;e++){const t=Pa[e];t&&t.pre&&(Pa.splice(e,1),e--,t())}}function Cee(n){if(Ry.length){const e=[...new Set(Ry)];if(Ry.length=0,Sp){Sp.push(...e);return}for(Sp=e,Sp.sort((t,r)=>jM(t)-jM(r)),jg=0;jg<Sp.length;jg++)Sp[jg]();Sp=null,jg=0}}const jM=n=>n.id==null?1/0:n.id,dde=(n,e)=>{const t=jM(n)-jM(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function Eee(n){o6=!1,UM=!0,Pa.sort(dde);const e=rh;try{for(Ih=0;Ih<Pa.length;Ih++){const t=Pa[Ih];t&&t.active!==!1&&vm(t,null,14)}}finally{Ih=0,Pa.length=0,Cee(),UM=!1,Lj=null,(Pa.length||Ry.length)&&Eee()}}function pde(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Ni;let i=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:p,trim:f}=r[d]||Ni;f&&(i=t.map(v=>ho(v)?v.trim():v)),p&&(i=t.map(see))}let a,c=r[a=IB(e)]||r[a=IB(td(e))];!c&&s&&(c=r[a=IB(Wx(e))]),c&&nu(c,n,6,i);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,nu(u,n,6,i)}}function Aee(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},a=!1;if(!jn(n)){const c=u=>{const d=Aee(u,e,!0);d&&(a=!0,Ia(o,d))};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}return!s&&!a?(ws(n)&&r.set(n,null),null):(Bn(s)?s.forEach(c=>o[c]=null):Ia(o,s),ws(n)&&r.set(n,o),o)}function oL(n,e){return!n||!$O(e)?!1:(e=e.slice(2).replace(/Once$/,""),yr(n,e[0].toLowerCase()+e.slice(1))||yr(n,Wx(e))||yr(n,e))}let Da=null,Pee=null;function ER(n){const e=Da;return Da=n,Pee=n&&n.type.__scopeId||null,e}function KS(n,e=Da,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&mW(-1);const s=ER(e);let o;try{o=n(...i)}finally{ER(s),r._d&&mW(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function kB(n){const{type:e,vnode:t,proxy:r,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:c,emit:u,render:d,renderCache:p,data:f,setupState:v,ctx:x,inheritAttrs:y}=n;let _,S;const C=ER(n);try{if(t.shapeFlag&4){const P=i||r;_=Ph(d.call(P,P,p,s,v,f,x)),S=c}else{const P=e;_=Ph(P.length>1?P(s,{attrs:c,slots:a,emit:u}):P(s,null)),S=e.props?c:fde(c)}}catch(P){fM.length=0,sL(P,n,1),_=sa(Xh)}let A=_;if(S&&y!==!1){const P=Object.keys(S),{shapeFlag:D}=A;P.length&&D&7&&(o&&P.some(bj)&&(S=mde(S,o)),A=Em(A,S))}return t.dirs&&(A=Em(A),A.dirs=A.dirs?A.dirs.concat(t.dirs):t.dirs),t.transition&&(A.transition=t.transition),_=A,ER(C),_}const fde=n=>{let e;for(const t in n)(t==="class"||t==="style"||$O(t))&&((e||(e={}))[t]=n[t]);return e},mde=(n,e)=>{const t={};for(const r in n)(!bj(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function vde(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:a,patchFlag:c}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&c>=0){if(c&1024)return!0;if(c&16)return r?oW(r,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let p=0;p<d.length;p++){const f=d[p];if(o[f]!==r[f]&&!oL(u,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?oW(r,o,u):!0:!!o;return!1}function oW(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!oL(t,s))return!0}return!1}function gde({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const _de=n=>n.__isSuspense;function yde(n,e){e&&e.pendingBranch?Bn(n)?e.effects.push(...n):e.effects.push(n):hde(n)}function aL(n,e){if(Ao){let t=Ao.provides;const r=Ao.parent&&Ao.parent.provides;r===t&&(t=Ao.provides=Object.create(r)),t[n]=e}}function r0(n,e,t=!1){const r=Ao||Da;if(r){const i=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&n in i)return i[n];if(arguments.length>1)return t&&jn(e)?e.call(r.proxy):e}}function Wp(n,e){return Ij(n,null,e)}const xA={};function zB(n,e,t){return Ij(n,e,t)}function Ij(n,e,{immediate:t,deep:r,flush:i,onTrack:s,onTrigger:o}=Ni){const a=Ao;let c,u=!1,d=!1;if(La(n)?(c=()=>n.value,u=CR(n)):Ty(n)?(c=()=>n,r=!0):Bn(n)?(d=!0,u=n.some(A=>Ty(A)||CR(A)),c=()=>n.map(A=>{if(La(A))return A.value;if(Ty(A))return vy(A);if(jn(A))return vm(A,a,2)})):jn(n)?e?c=()=>vm(n,a,2):c=()=>{if(!(a&&a.isUnmounted))return p&&p(),nu(n,a,3,[f])}:c=rh,e&&r){const A=c;c=()=>vy(A())}let p,f=A=>{p=S.onStop=()=>{vm(A,a,4)}},v;if(WM)if(f=rh,e?t&&nu(e,a,3,[c(),d?[]:void 0,f]):c(),i==="sync"){const A=vpe();v=A.__watcherHandles||(A.__watcherHandles=[])}else return rh;let x=d?new Array(n.length).fill(xA):xA;const y=()=>{if(!!S.active)if(e){const A=S.run();(r||u||(d?A.some((P,D)=>VM(P,x[D])):VM(A,x)))&&(p&&p(),nu(e,a,3,[A,x===xA?void 0:d&&x[0]===xA?[]:x,f]),x=A)}else S.run()};y.allowRecurse=!!e;let _;i==="sync"?_=y:i==="post"?_=()=>El(y,a&&a.suspense):(y.pre=!0,a&&(y.id=a.uid),_=()=>Dj(y));const S=new Ej(c,_);e?t?y():x=S.run():i==="post"?El(S.run.bind(S),a&&a.suspense):S.run();const C=()=>{S.stop(),a&&a.scope&&wj(a.scope.effects,S)};return v&&v.push(C),C}function xde(n,e,t){const r=this.proxy,i=ho(n)?n.includes(".")?Tee(r,n):()=>r[n]:n.bind(r,r);let s;jn(e)?s=e:(s=e.handler,t=e);const o=Ao;$y(this);const a=Ij(i,s.bind(r),t);return o?$y(o):i0(),a}function Tee(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}function vy(n,e){if(!ws(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),La(n))vy(n.value,e);else if(Bn(n))for(let t=0;t<n.length;t++)vy(n[t],e);else if(bhe(n)||hM(n))n.forEach(t=>{vy(t,e)});else if(Mhe(n))for(const t in n)vy(n[t],e);return n}function bde(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Dee(()=>{n.isMounted=!0}),Iee(()=>{n.isUnmounting=!0}),n}const Zc=[Function,Array],wde={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Zc,onEnter:Zc,onAfterEnter:Zc,onEnterCancelled:Zc,onBeforeLeave:Zc,onLeave:Zc,onAfterLeave:Zc,onLeaveCancelled:Zc,onBeforeAppear:Zc,onAppear:Zc,onAfterAppear:Zc,onAppearCancelled:Zc},setup(n,{slots:e}){const t=lpe(),r=bde();let i;return()=>{const s=e.default&&Oee(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const y of s)if(y.type!==Xh){o=y;break}}const a=Vn(n),{mode:c}=a;if(r.isLeaving)return BB(o);const u=aW(o);if(!u)return BB(o);const d=a6(u,a,r,t);l6(u,d);const p=t.subTree,f=p&&aW(p);let v=!1;const{getTransitionKey:x}=u.type;if(x){const y=x();i===void 0?i=y:y!==i&&(i=y,v=!0)}if(f&&f.type!==Xh&&(!Hg(u,f)||v)){const y=a6(f,a,r,t);if(l6(f,y),c==="out-in")return r.isLeaving=!0,y.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&t.update()},BB(o);c==="in-out"&&u.type!==Xh&&(y.delayLeave=(_,S,C)=>{const A=Ree(r,f);A[String(f.key)]=f,_._leaveCb=()=>{S(),_._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=C})}return o}}},Sde=wde;function Ree(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function a6(n,e,t,r){const{appear:i,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:p,onLeave:f,onAfterLeave:v,onLeaveCancelled:x,onBeforeAppear:y,onAppear:_,onAfterAppear:S,onAppearCancelled:C}=e,A=String(n.key),P=Ree(t,n),D=(T,k)=>{T&&nu(T,r,9,k)},N=(T,k)=>{const U=k[1];D(T,k),Bn(T)?T.every(ee=>ee.length<=1)&&U():T.length<=1&&U()},j={mode:s,persisted:o,beforeEnter(T){let k=a;if(!t.isMounted)if(i)k=y||a;else return;T._leaveCb&&T._leaveCb(!0);const U=P[A];U&&Hg(n,U)&&U.el._leaveCb&&U.el._leaveCb(),D(k,[T])},enter(T){let k=c,U=u,ee=d;if(!t.isMounted)if(i)k=_||c,U=S||u,ee=C||d;else return;let xe=!1;const ce=T._enterCb=te=>{xe||(xe=!0,te?D(ee,[T]):D(U,[T]),j.delayedLeave&&j.delayedLeave(),T._enterCb=void 0)};k?N(k,[T,ce]):ce()},leave(T,k){const U=String(n.key);if(T._enterCb&&T._enterCb(!0),t.isUnmounting)return k();D(p,[T]);let ee=!1;const xe=T._leaveCb=ce=>{ee||(ee=!0,k(),ce?D(x,[T]):D(v,[T]),T._leaveCb=void 0,P[U]===n&&delete P[U])};P[U]=n,f?N(f,[T,xe]):xe()},clone(T){return a6(T,e,t,r)}};return j}function BB(n){if(lL(n))return n=Em(n),n.children=null,n}function aW(n){return lL(n)?n.children?n.children[0]:void 0:n}function l6(n,e){n.shapeFlag&6&&n.component?l6(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Oee(n,e=!1,t){let r=[],i=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Al?(o.patchFlag&128&&i++,r=r.concat(Oee(o.children,e,a))):(e||o.type!==Xh)&&r.push(a!=null?Em(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function Um(n){return jn(n)?{setup:n,name:n.name}:n}const dM=n=>!!n.type.__asyncLoader,lL=n=>n.type.__isKeepAlive;function Mde(n,e){Lee(n,"a",e)}function Cde(n,e){Lee(n,"da",e)}function Lee(n,e,t=Ao){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(cL(e,r,t),t){let i=t.parent;for(;i&&i.parent;)lL(i.parent.vnode)&&Ede(r,e,t,i),i=i.parent}}function Ede(n,e,t,r){const i=cL(e,n,r,!0);Nj(()=>{wj(r[e],i)},t)}function cL(n,e,t=Ao,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;Gx(),$y(t);const a=nu(e,t,n,o);return i0(),Xx(),a});return r?i.unshift(s):i.push(s),s}}const Kp=n=>(e,t=Ao)=>(!WM||n==="sp")&&cL(n,(...r)=>e(...r),t),Ade=Kp("bm"),Dee=Kp("m"),Pde=Kp("bu"),Tde=Kp("u"),Iee=Kp("bum"),Nj=Kp("um"),Rde=Kp("sp"),Ode=Kp("rtg"),Lde=Kp("rtc");function Dde(n,e=Ao){cL("ec",n,e)}function dg(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let c=a.dir[r];c&&(Gx(),nu(c,t,8,[n.el,a,n,e]),Xx())}}const Nee="components";function Ide(n,e){return kde(Nee,n,!0,e)||n}const Nde=Symbol();function kde(n,e,t=!0,r=!1){const i=Da||Ao;if(i){const s=i.type;if(n===Nee){const a=ppe(s,!1);if(a&&(a===e||a===td(e)||a===nL(td(e))))return s}const o=lW(i[n]||s[n],e)||lW(i.appContext[n],e);return!o&&r?s:o}}function lW(n,e){return n&&(n[e]||n[td(e)]||n[nL(td(e))])}function zde(n,e,t,r){let i;const s=t&&t[r];if(Bn(n)||ho(n)){i=new Array(n.length);for(let o=0,a=n.length;o<a;o++)i[o]=e(n[o],o,void 0,s&&s[o])}else if(typeof n=="number"){i=new Array(n);for(let o=0;o<n;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(ws(n))if(n[Symbol.iterator])i=Array.from(n,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(n);i=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const u=o[a];i[a]=e(n[u],u,a,s&&s[a])}}else i=[];return t&&(t[r]=i),i}function IC(n,e,t={},r,i){if(Da.isCE||Da.parent&&dM(Da.parent)&&Da.parent.isCE)return e!=="default"&&(t.name=e),sa("slot",t,r&&r());let s=n[e];s&&s._c&&(s._d=!1),mM();const o=s&&kee(s(t)),a=f6(Al,{key:t.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&n._===1?64:-2);return!i&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function kee(n){return n.some(e=>qee(e)?!(e.type===Xh||e.type===Al&&!kee(e.children)):!0)?n:null}const c6=n=>n?Kee(n)?Vj(n)||n.proxy:c6(n.parent):null,pM=Ia(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>c6(n.parent),$root:n=>c6(n.root),$emit:n=>n.emit,$options:n=>kj(n),$forceUpdate:n=>n.f||(n.f=()=>Dj(n.update)),$nextTick:n=>n.n||(n.n=lde.bind(n.proxy)),$watch:n=>xde.bind(n)}),VB=(n,e)=>n!==Ni&&!n.__isScriptSetup&&yr(n,e),Bde={get({_:n},e){const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:c}=n;let u;if(e[0]!=="$"){const v=o[e];if(v!==void 0)switch(v){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(VB(r,e))return o[e]=1,r[e];if(i!==Ni&&yr(i,e))return o[e]=2,i[e];if((u=n.propsOptions[0])&&yr(u,e))return o[e]=3,s[e];if(t!==Ni&&yr(t,e))return o[e]=4,t[e];u6&&(o[e]=0)}}const d=pM[e];let p,f;if(d)return e==="$attrs"&&Ac(n,"get",e),d(n);if((p=a.__cssModules)&&(p=p[e]))return p;if(t!==Ni&&yr(t,e))return o[e]=4,t[e];if(f=c.config.globalProperties,yr(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return VB(i,e)?(i[e]=t,!0):r!==Ni&&yr(r,e)?(r[e]=t,!0):yr(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!t[o]||n!==Ni&&yr(n,o)||VB(e,o)||(a=s[0])&&yr(a,o)||yr(r,o)||yr(pM,o)||yr(i.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:yr(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};let u6=!0;function Vde(n){const e=kj(n),t=n.proxy,r=n.ctx;u6=!1,e.beforeCreate&&cW(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:a,provide:c,inject:u,created:d,beforeMount:p,mounted:f,beforeUpdate:v,updated:x,activated:y,deactivated:_,beforeDestroy:S,beforeUnmount:C,destroyed:A,unmounted:P,render:D,renderTracked:N,renderTriggered:j,errorCaptured:T,serverPrefetch:k,expose:U,inheritAttrs:ee,components:xe,directives:ce,filters:te}=e;if(u&&Fde(u,r,null,n.appContext.config.unwrapInjectedRef),o)for(const Se in o){const pe=o[Se];jn(pe)&&(r[Se]=pe.bind(t))}if(i){const Se=i.call(t,t);ws(Se)&&(n.data=iL(Se))}if(u6=!0,s)for(const Se in s){const pe=s[Se],se=jn(pe)?pe.bind(t,t):jn(pe.get)?pe.get.bind(t,t):rh,ae=!jn(pe)&&jn(pe.set)?pe.set.bind(t):rh,Le=Fj({get:se,set:ae});Object.defineProperty(r,Se,{enumerable:!0,configurable:!0,get:()=>Le.value,set:Re=>Le.value=Re})}if(a)for(const Se in a)zee(a[Se],r,t,Se);if(c){const Se=jn(c)?c.call(t):c;Reflect.ownKeys(Se).forEach(pe=>{aL(pe,Se[pe])})}d&&cW(d,n,"c");function ge(Se,pe){Bn(pe)?pe.forEach(se=>Se(se.bind(t))):pe&&Se(pe.bind(t))}if(ge(Ade,p),ge(Dee,f),ge(Pde,v),ge(Tde,x),ge(Mde,y),ge(Cde,_),ge(Dde,T),ge(Lde,N),ge(Ode,j),ge(Iee,C),ge(Nj,P),ge(Rde,k),Bn(U))if(U.length){const Se=n.exposed||(n.exposed={});U.forEach(pe=>{Object.defineProperty(Se,pe,{get:()=>t[pe],set:se=>t[pe]=se})})}else n.exposed||(n.exposed={});D&&n.render===rh&&(n.render=D),ee!=null&&(n.inheritAttrs=ee),xe&&(n.components=xe),ce&&(n.directives=ce)}function Fde(n,e,t=rh,r=!1){Bn(n)&&(n=h6(n));for(const i in n){const s=n[i];let o;ws(s)?"default"in s?o=r0(s.from||i,s.default,!0):o=r0(s.from||i):o=r0(s),La(o)&&r?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function cW(n,e,t){nu(Bn(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function zee(n,e,t,r){const i=r.includes(".")?Tee(t,r):()=>t[r];if(ho(n)){const s=e[n];jn(s)&&zB(i,s)}else if(jn(n))zB(i,n.bind(t));else if(ws(n))if(Bn(n))n.forEach(s=>zee(s,e,t,r));else{const s=jn(n.handler)?n.handler.bind(t):e[n.handler];jn(s)&&zB(i,s,n)}}function kj(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let c;return a?c=a:!i.length&&!t&&!r?c=e:(c={},i.length&&i.forEach(u=>AR(c,u,o,!0)),AR(c,e,o)),ws(e)&&s.set(e,c),c}function AR(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&AR(n,s,t,!0),i&&i.forEach(o=>AR(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=Ude[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const Ude={data:uW,props:kg,emits:kg,methods:kg,computed:kg,beforeCreate:sl,created:sl,beforeMount:sl,mounted:sl,beforeUpdate:sl,updated:sl,beforeDestroy:sl,beforeUnmount:sl,destroyed:sl,unmounted:sl,activated:sl,deactivated:sl,errorCaptured:sl,serverPrefetch:sl,components:kg,directives:kg,watch:Hde,provide:uW,inject:jde};function uW(n,e){return e?n?function(){return Ia(jn(n)?n.call(this,this):n,jn(e)?e.call(this,this):e)}:e:n}function jde(n,e){return kg(h6(n),h6(e))}function h6(n){if(Bn(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function sl(n,e){return n?[...new Set([].concat(n,e))]:e}function kg(n,e){return n?Ia(Ia(Object.create(null),n),e):e}function Hde(n,e){if(!n)return e;if(!e)return n;const t=Ia(Object.create(null),n);for(const r in e)t[r]=sl(n[r],e[r]);return t}function Wde(n,e,t,r=!1){const i={},s={};MR(s,hL,1),n.propsDefaults=Object.create(null),Bee(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:tde(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function Gde(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,a=Vn(i),[c]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const d=n.vnode.dynamicProps;for(let p=0;p<d.length;p++){let f=d[p];if(oL(n.emitsOptions,f))continue;const v=e[f];if(c)if(yr(s,f))v!==s[f]&&(s[f]=v,u=!0);else{const x=td(f);i[x]=d6(c,a,x,v,n,!1)}else v!==s[f]&&(s[f]=v,u=!0)}}}else{Bee(n,e,i,s)&&(u=!0);let d;for(const p in a)(!e||!yr(e,p)&&((d=Wx(p))===p||!yr(e,d)))&&(c?t&&(t[p]!==void 0||t[d]!==void 0)&&(i[p]=d6(c,a,p,void 0,n,!0)):delete i[p]);if(s!==a)for(const p in s)(!e||!yr(e,p)&&!0)&&(delete s[p],u=!0)}u&&Hp(n,"set","$attrs")}function Bee(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,a;if(e)for(let c in e){if(p3(c))continue;const u=e[c];let d;i&&yr(i,d=td(c))?!s||!s.includes(d)?t[d]=u:(a||(a={}))[d]=u:oL(n.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(s){const c=Vn(t),u=a||Ni;for(let d=0;d<s.length;d++){const p=s[d];t[p]=d6(i,c,p,u[p],n,!yr(u,p))}}return o}function d6(n,e,t,r,i,s){const o=n[t];if(o!=null){const a=yr(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&jn(c)){const{propsDefaults:u}=i;t in u?r=u[t]:($y(i),r=u[t]=c.call(null,e),i0())}else r=c}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===Wx(t))&&(r=!0))}return r}function Vee(n,e,t=!1){const r=e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},a=[];let c=!1;if(!jn(n)){const d=p=>{c=!0;const[f,v]=Vee(p,e,!0);Ia(o,f),v&&a.push(...v)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!s&&!c)return ws(n)&&r.set(n,Py),Py;if(Bn(s))for(let d=0;d<s.length;d++){const p=td(s[d]);hW(p)&&(o[p]=Ni)}else if(s)for(const d in s){const p=td(d);if(hW(p)){const f=s[d],v=o[p]=Bn(f)||jn(f)?{type:f}:Object.assign({},f);if(v){const x=fW(Boolean,v.type),y=fW(String,v.type);v[0]=x>-1,v[1]=y<0||x<y,(x>-1||yr(v,"default"))&&a.push(p)}}}const u=[o,a];return ws(n)&&r.set(n,u),u}function hW(n){return n[0]!=="$"}function dW(n){const e=n&&n.toString().match(/^\s*function (\w+)/);return e?e[1]:n===null?"null":""}function pW(n,e){return dW(n)===dW(e)}function fW(n,e){return Bn(e)?e.findIndex(t=>pW(t,n)):jn(e)&&pW(e,n)?0:-1}const Fee=n=>n[0]==="_"||n==="$stable",zj=n=>Bn(n)?n.map(Ph):[Ph(n)],Xde=(n,e,t)=>{if(e._n)return e;const r=KS((...i)=>zj(e(...i)),t);return r._c=!1,r},Uee=(n,e,t)=>{const r=n._ctx;for(const i in n){if(Fee(i))continue;const s=n[i];if(jn(s))e[i]=Xde(i,s,r);else if(s!=null){const o=zj(s);e[i]=()=>o}}},jee=(n,e)=>{const t=zj(e);n.slots.default=()=>t},qde=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=Vn(e),MR(e,"_",t)):Uee(e,n.slots={})}else n.slots={},e&&jee(n,e);MR(n.slots,hL,1)},Yde=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=Ni;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(Ia(i,e),!t&&a===1&&delete i._):(s=!e.$stable,Uee(e,i)),o=e}else e&&(jee(n,e),o={default:1});if(s)for(const a in i)!Fee(a)&&!(a in o)&&delete i[a]};function Hee(){return{app:null,config:{isNativeTag:_he,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Zde=0;function Kde(n,e){return function(r,i=null){jn(r)||(r=Object.assign({},r)),i!=null&&!ws(i)&&(i=null);const s=Hee(),o=new Set;let a=!1;const c=s.app={_uid:Zde++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:gpe,get config(){return s.config},set config(u){},use(u,...d){return o.has(u)||(u&&jn(u.install)?(o.add(u),u.install(c,...d)):jn(u)&&(o.add(u),u(c,...d))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,d){return d?(s.components[u]=d,c):s.components[u]},directive(u,d){return d?(s.directives[u]=d,c):s.directives[u]},mount(u,d,p){if(!a){const f=sa(r,i);return f.appContext=s,d&&e?e(f,u):n(f,u,p),a=!0,c._container=u,u.__vue_app__=c,Vj(f.component)||f.component.proxy}},unmount(){a&&(n(null,c._container),delete c._container.__vue_app__)},provide(u,d){return s.provides[u]=d,c}};return c}}function p6(n,e,t,r,i=!1){if(Bn(n)){n.forEach((f,v)=>p6(f,e&&(Bn(e)?e[v]:e),t,r,i));return}if(dM(r)&&!i)return;const s=r.shapeFlag&4?Vj(r.component)||r.component.proxy:r.el,o=i?null:s,{i:a,r:c}=n,u=e&&e.r,d=a.refs===Ni?a.refs={}:a.refs,p=a.setupState;if(u!=null&&u!==c&&(ho(u)?(d[u]=null,yr(p,u)&&(p[u]=null)):La(u)&&(u.value=null)),jn(c))vm(c,a,12,[o,d]);else{const f=ho(c),v=La(c);if(f||v){const x=()=>{if(n.f){const y=f?yr(p,c)?p[c]:d[c]:c.value;i?Bn(y)&&wj(y,s):Bn(y)?y.includes(s)||y.push(s):f?(d[c]=[s],yr(p,c)&&(p[c]=d[c])):(c.value=[s],n.k&&(d[n.k]=c.value))}else f?(d[c]=o,yr(p,c)&&(p[c]=o)):v&&(c.value=o,n.k&&(d[n.k]=o))};o?(x.id=-1,El(x,t)):x()}}}const El=yde;function Jde(n){return Qde(n)}function Qde(n,e){const t=Ahe();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:c,setText:u,setElementText:d,parentNode:p,nextSibling:f,setScopeId:v=rh,insertStaticContent:x}=n,y=(Y,K,ve,Ae=null,De=null,je=null,Xe=!1,He=null,ne=!!K.dynamicChildren)=>{if(Y===K)return;Y&&!Hg(Y,K)&&(Ae=Mt(Y),Re(Y,De,je,!0),Y=null),K.patchFlag===-2&&(ne=!1,K.dynamicChildren=null);const{type:W,ref:O,shapeFlag:E}=K;switch(W){case uL:_(Y,K,ve,Ae);break;case Xh:S(Y,K,ve,Ae);break;case FB:Y==null&&C(K,ve,Ae,Xe);break;case Al:xe(Y,K,ve,Ae,De,je,Xe,He,ne);break;default:E&1?D(Y,K,ve,Ae,De,je,Xe,He,ne):E&6?ce(Y,K,ve,Ae,De,je,Xe,He,ne):(E&64||E&128)&&W.process(Y,K,ve,Ae,De,je,Xe,He,ne,it)}O!=null&&De&&p6(O,Y&&Y.ref,je,K||Y,!K)},_=(Y,K,ve,Ae)=>{if(Y==null)r(K.el=a(K.children),ve,Ae);else{const De=K.el=Y.el;K.children!==Y.children&&u(De,K.children)}},S=(Y,K,ve,Ae)=>{Y==null?r(K.el=c(K.children||""),ve,Ae):K.el=Y.el},C=(Y,K,ve,Ae)=>{[Y.el,Y.anchor]=x(Y.children,K,ve,Ae,Y.el,Y.anchor)},A=({el:Y,anchor:K},ve,Ae)=>{let De;for(;Y&&Y!==K;)De=f(Y),r(Y,ve,Ae),Y=De;r(K,ve,Ae)},P=({el:Y,anchor:K})=>{let ve;for(;Y&&Y!==K;)ve=f(Y),i(Y),Y=ve;i(K)},D=(Y,K,ve,Ae,De,je,Xe,He,ne)=>{Xe=Xe||K.type==="svg",Y==null?N(K,ve,Ae,De,je,Xe,He,ne):k(Y,K,De,je,Xe,He,ne)},N=(Y,K,ve,Ae,De,je,Xe,He)=>{let ne,W;const{type:O,props:E,shapeFlag:F,transition:z,dirs:Z}=Y;if(ne=Y.el=o(Y.type,je,E&&E.is,E),F&8?d(ne,Y.children):F&16&&T(Y.children,ne,null,Ae,De,je&&O!=="foreignObject",Xe,He),Z&&dg(Y,null,Ae,"created"),E){for(const be in E)be!=="value"&&!p3(be)&&s(ne,be,null,E[be],je,Y.children,Ae,De,we);"value"in E&&s(ne,"value",null,E.value),(W=E.onVnodeBeforeMount)&&bh(W,Ae,Y)}j(ne,Y,Y.scopeId,Xe,Ae),Z&&dg(Y,null,Ae,"beforeMount");const de=(!De||De&&!De.pendingBranch)&&z&&!z.persisted;de&&z.beforeEnter(ne),r(ne,K,ve),((W=E&&E.onVnodeMounted)||de||Z)&&El(()=>{W&&bh(W,Ae,Y),de&&z.enter(ne),Z&&dg(Y,null,Ae,"mounted")},De)},j=(Y,K,ve,Ae,De)=>{if(ve&&v(Y,ve),Ae)for(let je=0;je<Ae.length;je++)v(Y,Ae[je]);if(De){let je=De.subTree;if(K===je){const Xe=De.vnode;j(Y,Xe,Xe.scopeId,Xe.slotScopeIds,De.parent)}}},T=(Y,K,ve,Ae,De,je,Xe,He,ne=0)=>{for(let W=ne;W<Y.length;W++){const O=Y[W]=He?rm(Y[W]):Ph(Y[W]);y(null,O,K,ve,Ae,De,je,Xe,He)}},k=(Y,K,ve,Ae,De,je,Xe)=>{const He=K.el=Y.el;let{patchFlag:ne,dynamicChildren:W,dirs:O}=K;ne|=Y.patchFlag&16;const E=Y.props||Ni,F=K.props||Ni;let z;ve&&pg(ve,!1),(z=F.onVnodeBeforeUpdate)&&bh(z,ve,K,Y),O&&dg(K,Y,ve,"beforeUpdate"),ve&&pg(ve,!0);const Z=De&&K.type!=="foreignObject";if(W?U(Y.dynamicChildren,W,He,ve,Ae,Z,je):Xe||pe(Y,K,He,null,ve,Ae,Z,je,!1),ne>0){if(ne&16)ee(He,K,E,F,ve,Ae,De);else if(ne&2&&E.class!==F.class&&s(He,"class",null,F.class,De),ne&4&&s(He,"style",E.style,F.style,De),ne&8){const de=K.dynamicProps;for(let be=0;be<de.length;be++){const oe=de[be],ze=E[oe],ke=F[oe];(ke!==ze||oe==="value")&&s(He,oe,ze,ke,De,Y.children,ve,Ae,we)}}ne&1&&Y.children!==K.children&&d(He,K.children)}else!Xe&&W==null&&ee(He,K,E,F,ve,Ae,De);((z=F.onVnodeUpdated)||O)&&El(()=>{z&&bh(z,ve,K,Y),O&&dg(K,Y,ve,"updated")},Ae)},U=(Y,K,ve,Ae,De,je,Xe)=>{for(let He=0;He<K.length;He++){const ne=Y[He],W=K[He],O=ne.el&&(ne.type===Al||!Hg(ne,W)||ne.shapeFlag&70)?p(ne.el):ve;y(ne,W,O,null,Ae,De,je,Xe,!0)}},ee=(Y,K,ve,Ae,De,je,Xe)=>{if(ve!==Ae){if(ve!==Ni)for(const He in ve)!p3(He)&&!(He in Ae)&&s(Y,He,ve[He],null,Xe,K.children,De,je,we);for(const He in Ae){if(p3(He))continue;const ne=Ae[He],W=ve[He];ne!==W&&He!=="value"&&s(Y,He,W,ne,Xe,K.children,De,je,we)}"value"in Ae&&s(Y,"value",ve.value,Ae.value)}},xe=(Y,K,ve,Ae,De,je,Xe,He,ne)=>{const W=K.el=Y?Y.el:a(""),O=K.anchor=Y?Y.anchor:a("");let{patchFlag:E,dynamicChildren:F,slotScopeIds:z}=K;z&&(He=He?He.concat(z):z),Y==null?(r(W,ve,Ae),r(O,ve,Ae),T(K.children,ve,O,De,je,Xe,He,ne)):E>0&&E&64&&F&&Y.dynamicChildren?(U(Y.dynamicChildren,F,ve,De,je,Xe,He),(K.key!=null||De&&K===De.subTree)&&Wee(Y,K,!0)):pe(Y,K,ve,O,De,je,Xe,He,ne)},ce=(Y,K,ve,Ae,De,je,Xe,He,ne)=>{K.slotScopeIds=He,Y==null?K.shapeFlag&512?De.ctx.activate(K,ve,Ae,Xe,ne):te(K,ve,Ae,De,je,Xe,ne):fe(Y,K,ne)},te=(Y,K,ve,Ae,De,je,Xe)=>{const He=Y.component=ape(Y,Ae,De);if(lL(Y)&&(He.ctx.renderer=it),cpe(He),He.asyncDep){if(De&&De.registerDep(He,ge),!Y.el){const ne=He.subTree=sa(Xh);S(null,ne,K,ve)}return}ge(He,Y,K,ve,De,je,Xe)},fe=(Y,K,ve)=>{const Ae=K.component=Y.component;if(vde(Y,K,ve))if(Ae.asyncDep&&!Ae.asyncResolved){Se(Ae,K,ve);return}else Ae.next=K,ude(Ae.update),Ae.update();else K.el=Y.el,Ae.vnode=K},ge=(Y,K,ve,Ae,De,je,Xe)=>{const He=()=>{if(Y.isMounted){let{next:O,bu:E,u:F,parent:z,vnode:Z}=Y,de=O,be;pg(Y,!1),O?(O.el=Z.el,Se(Y,O,Xe)):O=Z,E&&NB(E),(be=O.props&&O.props.onVnodeBeforeUpdate)&&bh(be,z,O,Z),pg(Y,!0);const oe=kB(Y),ze=Y.subTree;Y.subTree=oe,y(ze,oe,p(ze.el),Mt(ze),Y,De,je),O.el=oe.el,de===null&&gde(Y,oe.el),F&&El(F,De),(be=O.props&&O.props.onVnodeUpdated)&&El(()=>bh(be,z,O,Z),De)}else{let O;const{el:E,props:F}=K,{bm:z,m:Z,parent:de}=Y,be=dM(K);if(pg(Y,!1),z&&NB(z),!be&&(O=F&&F.onVnodeBeforeMount)&&bh(O,de,K),pg(Y,!0),E&&Qe){const oe=()=>{Y.subTree=kB(Y),Qe(E,Y.subTree,Y,De,null)};be?K.type.__asyncLoader().then(()=>!Y.isUnmounted&&oe()):oe()}else{const oe=Y.subTree=kB(Y);y(null,oe,ve,Ae,Y,De,je),K.el=oe.el}if(Z&&El(Z,De),!be&&(O=F&&F.onVnodeMounted)){const oe=K;El(()=>bh(O,de,oe),De)}(K.shapeFlag&256||de&&dM(de.vnode)&&de.vnode.shapeFlag&256)&&Y.a&&El(Y.a,De),Y.isMounted=!0,K=ve=Ae=null}},ne=Y.effect=new Ej(He,()=>Dj(W),Y.scope),W=Y.update=()=>ne.run();W.id=Y.uid,pg(Y,!0),W()},Se=(Y,K,ve)=>{K.component=Y;const Ae=Y.vnode.props;Y.vnode=K,Y.next=null,Gde(Y,K.props,Ae,ve),Yde(Y,K.children,ve),Gx(),sW(),Xx()},pe=(Y,K,ve,Ae,De,je,Xe,He,ne=!1)=>{const W=Y&&Y.children,O=Y?Y.shapeFlag:0,E=K.children,{patchFlag:F,shapeFlag:z}=K;if(F>0){if(F&128){ae(W,E,ve,Ae,De,je,Xe,He,ne);return}else if(F&256){se(W,E,ve,Ae,De,je,Xe,He,ne);return}}z&8?(O&16&&we(W,De,je),E!==W&&d(ve,E)):O&16?z&16?ae(W,E,ve,Ae,De,je,Xe,He,ne):we(W,De,je,!0):(O&8&&d(ve,""),z&16&&T(E,ve,Ae,De,je,Xe,He,ne))},se=(Y,K,ve,Ae,De,je,Xe,He,ne)=>{Y=Y||Py,K=K||Py;const W=Y.length,O=K.length,E=Math.min(W,O);let F;for(F=0;F<E;F++){const z=K[F]=ne?rm(K[F]):Ph(K[F]);y(Y[F],z,ve,null,De,je,Xe,He,ne)}W>O?we(Y,De,je,!0,!1,E):T(K,ve,Ae,De,je,Xe,He,ne,E)},ae=(Y,K,ve,Ae,De,je,Xe,He,ne)=>{let W=0;const O=K.length;let E=Y.length-1,F=O-1;for(;W<=E&&W<=F;){const z=Y[W],Z=K[W]=ne?rm(K[W]):Ph(K[W]);if(Hg(z,Z))y(z,Z,ve,null,De,je,Xe,He,ne);else break;W++}for(;W<=E&&W<=F;){const z=Y[E],Z=K[F]=ne?rm(K[F]):Ph(K[F]);if(Hg(z,Z))y(z,Z,ve,null,De,je,Xe,He,ne);else break;E--,F--}if(W>E){if(W<=F){const z=F+1,Z=z<O?K[z].el:Ae;for(;W<=F;)y(null,K[W]=ne?rm(K[W]):Ph(K[W]),ve,Z,De,je,Xe,He,ne),W++}}else if(W>F)for(;W<=E;)Re(Y[W],De,je,!0),W++;else{const z=W,Z=W,de=new Map;for(W=Z;W<=F;W++){const pt=K[W]=ne?rm(K[W]):Ph(K[W]);pt.key!=null&&de.set(pt.key,W)}let be,oe=0;const ze=F-Z+1;let ke=!1,Fe=0;const Ge=new Array(ze);for(W=0;W<ze;W++)Ge[W]=0;for(W=z;W<=E;W++){const pt=Y[W];if(oe>=ze){Re(pt,De,je,!0);continue}let Dt;if(pt.key!=null)Dt=de.get(pt.key);else for(be=Z;be<=F;be++)if(Ge[be-Z]===0&&Hg(pt,K[be])){Dt=be;break}Dt===void 0?Re(pt,De,je,!0):(Ge[Dt-Z]=W+1,Dt>=Fe?Fe=Dt:ke=!0,y(pt,K[Dt],ve,null,De,je,Xe,He,ne),oe++)}const at=ke?$de(Ge):Py;for(be=at.length-1,W=ze-1;W>=0;W--){const pt=Z+W,Dt=K[pt],re=pt+1<O?K[pt+1].el:Ae;Ge[W]===0?y(null,Dt,ve,re,De,je,Xe,He,ne):ke&&(be<0||W!==at[be]?Le(Dt,ve,re,2):be--)}}},Le=(Y,K,ve,Ae,De=null)=>{const{el:je,type:Xe,transition:He,children:ne,shapeFlag:W}=Y;if(W&6){Le(Y.component.subTree,K,ve,Ae);return}if(W&128){Y.suspense.move(K,ve,Ae);return}if(W&64){Xe.move(Y,K,ve,it);return}if(Xe===Al){r(je,K,ve);for(let E=0;E<ne.length;E++)Le(ne[E],K,ve,Ae);r(Y.anchor,K,ve);return}if(Xe===FB){A(Y,K,ve);return}if(Ae!==2&&W&1&&He)if(Ae===0)He.beforeEnter(je),r(je,K,ve),El(()=>He.enter(je),De);else{const{leave:E,delayLeave:F,afterLeave:z}=He,Z=()=>r(je,K,ve),de=()=>{E(je,()=>{Z(),z&&z()})};F?F(je,Z,de):de()}else r(je,K,ve)},Re=(Y,K,ve,Ae=!1,De=!1)=>{const{type:je,props:Xe,ref:He,children:ne,dynamicChildren:W,shapeFlag:O,patchFlag:E,dirs:F}=Y;if(He!=null&&p6(He,null,ve,Y,!0),O&256){K.ctx.deactivate(Y);return}const z=O&1&&F,Z=!dM(Y);let de;if(Z&&(de=Xe&&Xe.onVnodeBeforeUnmount)&&bh(de,K,Y),O&6)st(Y.component,ve,Ae);else{if(O&128){Y.suspense.unmount(ve,Ae);return}z&&dg(Y,null,K,"beforeUnmount"),O&64?Y.type.remove(Y,K,ve,De,it,Ae):W&&(je!==Al||E>0&&E&64)?we(W,K,ve,!1,!0):(je===Al&&E&384||!De&&O&16)&&we(ne,K,ve),Ae&&Ue(Y)}(Z&&(de=Xe&&Xe.onVnodeUnmounted)||z)&&El(()=>{de&&bh(de,K,Y),z&&dg(Y,null,K,"unmounted")},ve)},Ue=Y=>{const{type:K,el:ve,anchor:Ae,transition:De}=Y;if(K===Al){Ze(ve,Ae);return}if(K===FB){P(Y);return}const je=()=>{i(ve),De&&!De.persisted&&De.afterLeave&&De.afterLeave()};if(Y.shapeFlag&1&&De&&!De.persisted){const{leave:Xe,delayLeave:He}=De,ne=()=>Xe(ve,je);He?He(Y.el,je,ne):ne()}else je()},Ze=(Y,K)=>{let ve;for(;Y!==K;)ve=f(Y),i(Y),Y=ve;i(K)},st=(Y,K,ve)=>{const{bum:Ae,scope:De,update:je,subTree:Xe,um:He}=Y;Ae&&NB(Ae),De.stop(),je&&(je.active=!1,Re(Xe,Y,K,ve)),He&&El(He,K),El(()=>{Y.isUnmounted=!0},K),K&&K.pendingBranch&&!K.isUnmounted&&Y.asyncDep&&!Y.asyncResolved&&Y.suspenseId===K.pendingId&&(K.deps--,K.deps===0&&K.resolve())},we=(Y,K,ve,Ae=!1,De=!1,je=0)=>{for(let Xe=je;Xe<Y.length;Xe++)Re(Y[Xe],K,ve,Ae,De)},Mt=Y=>Y.shapeFlag&6?Mt(Y.component.subTree):Y.shapeFlag&128?Y.suspense.next():f(Y.anchor||Y.el),rt=(Y,K,ve)=>{Y==null?K._vnode&&Re(K._vnode,null,null,!0):y(K._vnode||null,Y,K,null,null,null,ve),sW(),Cee(),K._vnode=Y},it={p:y,um:Re,m:Le,r:Ue,mt:te,mc:T,pc:pe,pbc:U,n:Mt,o:n};let Ke,Qe;return e&&([Ke,Qe]=e(it)),{render:rt,hydrate:Ke,createApp:Kde(rt,Ke)}}function pg({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function Wee(n,e,t=!1){const r=n.children,i=e.children;if(Bn(r)&&Bn(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=rm(i[s]),a.el=o.el),t||Wee(o,a)),a.type===uL&&(a.el=o.el)}}function $de(n){const e=n.slice(),t=[0];let r,i,s,o,a;const c=n.length;for(r=0;r<c;r++){const u=n[r];if(u!==0){if(i=t[t.length-1],n[i]<u){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<u?s=a+1:o=a;u<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}const epe=n=>n.__isTeleport,Al=Symbol(void 0),uL=Symbol(void 0),Xh=Symbol(void 0),FB=Symbol(void 0),fM=[];let eh=null;function mM(n=!1){fM.push(eh=n?null:[])}function tpe(){fM.pop(),eh=fM[fM.length-1]||null}let HM=1;function mW(n){HM+=n}function Gee(n){return n.dynamicChildren=HM>0?eh||Py:null,tpe(),HM>0&&eh&&eh.push(n),n}function Xee(n,e,t,r,i,s){return Gee(vM(n,e,t,r,i,s,!0))}function f6(n,e,t,r,i){return Gee(sa(n,e,t,r,i,!0))}function qee(n){return n?n.__v_isVNode===!0:!1}function Hg(n,e){return n.type===e.type&&n.key===e.key}const hL="__vInternal",Yee=({key:n})=>n!=null?n:null,f3=({ref:n,ref_key:e,ref_for:t})=>n!=null?ho(n)||La(n)||jn(n)?{i:Da,r:n,k:e,f:!!t}:n:null;function vM(n,e=null,t=null,r=0,i=null,s=n===Al?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Yee(e),ref:e&&f3(e),scopeId:Pee,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Da};return a?(Bj(c,t),s&128&&n.normalize(c)):t&&(c.shapeFlag|=ho(t)?8:16),HM>0&&!o&&eh&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&eh.push(c),c}const sa=npe;function npe(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===Nde)&&(n=Xh),qee(n)){const a=Em(n,e,!0);return t&&Bj(a,t),HM>0&&!s&&eh&&(a.shapeFlag&6?eh[eh.indexOf(n)]=a:eh.push(a)),a.patchFlag|=-2,a}if(fpe(n)&&(n=n.__vccOpts),e){e=Zee(e);let{class:a,style:c}=e;a&&!ho(a)&&(e.class=QO(a)),ws(c)&&(gee(c)&&!Bn(c)&&(c=Ia({},c)),e.style=DC(c))}const o=ho(n)?1:_de(n)?128:epe(n)?64:ws(n)?4:jn(n)?2:0;return vM(n,e,t,r,i,o,s,!0)}function Zee(n){return n?gee(n)||hL in n?Ia({},n):n:null}function Em(n,e,t=!1){const{props:r,ref:i,patchFlag:s,children:o}=n,a=e?ipe(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&Yee(a),ref:e&&e.ref?t&&i?Bn(i)?i.concat(f3(e)):[i,f3(e)]:f3(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Al?s===-1?16:s|16:s,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Em(n.ssContent),ssFallback:n.ssFallback&&Em(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx}}function rpe(n=" ",e=0){return sa(uL,null,n,e)}function Ph(n){return n==null||typeof n=="boolean"?sa(Xh):Bn(n)?sa(Al,null,n.slice()):typeof n=="object"?rm(n):sa(uL,null,String(n))}function rm(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Em(n)}function Bj(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Bn(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),Bj(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!(hL in e)?e._ctx=Da:i===3&&Da&&(Da.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else jn(e)?(e={default:e,_ctx:Da},t=32):(e=String(e),r&64?(t=16,e=[rpe(e)]):t=8);n.children=e,n.shapeFlag|=t}function ipe(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=QO([e.class,r.class]));else if(i==="style")e.style=DC([e.style,r.style]);else if($O(i)){const s=e[i],o=r[i];o&&s!==o&&!(Bn(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function bh(n,e,t,r=null){nu(n,e,7,[t,r])}const spe=Hee();let ope=0;function ape(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||spe,s={uid:ope++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Phe(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Vee(r,i),emitsOptions:Aee(r,i),emit:null,emitted:null,propsDefaults:Ni,inheritAttrs:r.inheritAttrs,ctx:Ni,data:Ni,props:Ni,attrs:Ni,slots:Ni,refs:Ni,setupState:Ni,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=pde.bind(null,s),n.ce&&n.ce(s),s}let Ao=null;const lpe=()=>Ao||Da,$y=n=>{Ao=n,n.scope.on()},i0=()=>{Ao&&Ao.scope.off(),Ao=null};function Kee(n){return n.vnode.shapeFlag&4}let WM=!1;function cpe(n,e=!1){WM=e;const{props:t,children:r}=n.vnode,i=Kee(n);Wde(n,t,i,e),qde(n,r);const s=i?upe(n,e):void 0;return WM=!1,s}function upe(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=_ee(new Proxy(n.ctx,Bde));const{setup:r}=t;if(r){const i=n.setupContext=r.length>1?dpe(n):null;$y(n),Gx();const s=vm(r,n,0,[n.props,i]);if(Xx(),i0(),iee(s)){if(s.then(i0,i0),e)return s.then(o=>{vW(n,o,e)}).catch(o=>{sL(o,n,0)});n.asyncDep=s}else vW(n,s,e)}else Jee(n,e)}function vW(n,e,t){jn(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:ws(e)&&(n.setupState=bee(e)),Jee(n,t)}let gW;function Jee(n,e,t){const r=n.type;if(!n.render){if(!e&&gW&&!r.render){const i=r.template||kj(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:c}=r,u=Ia(Ia({isCustomElement:s,delimiters:a},o),c);r.render=gW(i,u)}}n.render=r.render||rh}$y(n),Gx(),Vde(n),Xx(),i0()}function hpe(n){return new Proxy(n.attrs,{get(e,t){return Ac(n,"get","$attrs"),e[t]}})}function dpe(n){const e=r=>{n.exposed=r||{}};let t;return{get attrs(){return t||(t=hpe(n))},slots:n.slots,emit:n.emit,expose:e}}function Vj(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(bee(_ee(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in pM)return pM[t](n)},has(e,t){return t in e||t in pM}}))}function ppe(n,e=!0){return jn(n)?n.displayName||n.name:n.name||e&&n.__name}function fpe(n){return jn(n)&&"__vccOpts"in n}const Fj=(n,e)=>ode(n,e,WM),mpe=Symbol(""),vpe=()=>r0(mpe),gpe="3.2.45",_pe="http://www.w3.org/2000/svg",Wg=typeof document<"u"?document:null,_W=Wg&&Wg.createElement("template"),ype={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e?Wg.createElementNS(_pe,n):Wg.createElement(n,t?{is:t}:void 0);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>Wg.createTextNode(n),createComment:n=>Wg.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Wg.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{_W.innerHTML=r?`<svg>${n}</svg>`:n;const a=_W.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function xpe(n,e,t){const r=n._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function bpe(n,e,t){const r=n.style,i=ho(t);if(t&&!i){for(const s in t)m6(r,s,t[s]);if(e&&!ho(e))for(const s in e)t[s]==null&&m6(r,s,"")}else{const s=r.display;i?e!==t&&(r.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(r.display=s)}}const yW=/\s*!important$/;function m6(n,e,t){if(Bn(t))t.forEach(r=>m6(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=wpe(n,e);yW.test(t)?n.setProperty(Wx(r),t.replace(yW,""),"important"):n[r]=t}}const xW=["Webkit","Moz","ms"],UB={};function wpe(n,e){const t=UB[e];if(t)return t;let r=td(e);if(r!=="filter"&&r in n)return UB[e]=r;r=nL(r);for(let i=0;i<xW.length;i++){const s=xW[i]+r;if(s in n)return UB[e]=s}return e}const bW="http://www.w3.org/1999/xlink";function Spe(n,e,t,r,i){if(r&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(bW,e.slice(6,e.length)):n.setAttributeNS(bW,e,t);else{const s=ghe(e);t==null||s&&!ree(t)?n.removeAttribute(e):n.setAttribute(e,s?"":t)}}function Mpe(n,e,t,r,i,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,s),n[e]=t==null?"":t;return}if(e==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=t;const c=t==null?"":t;(n.value!==c||n.tagName==="OPTION")&&(n.value=c),t==null&&n.removeAttribute(e);return}let a=!1;if(t===""||t==null){const c=typeof n[e];c==="boolean"?t=ree(t):t==null&&c==="string"?(t="",a=!0):c==="number"&&(t=0,a=!0)}try{n[e]=t}catch{}a&&n.removeAttribute(e)}function Cpe(n,e,t,r){n.addEventListener(e,t,r)}function Epe(n,e,t,r){n.removeEventListener(e,t,r)}function Ape(n,e,t,r,i=null){const s=n._vei||(n._vei={}),o=s[e];if(r&&o)o.value=r;else{const[a,c]=Ppe(e);if(r){const u=s[e]=Ope(r,i);Cpe(n,a,u,c)}else o&&(Epe(n,a,o,c),s[e]=void 0)}}const wW=/(?:Once|Passive|Capture)$/;function Ppe(n){let e;if(wW.test(n)){e={};let r;for(;r=n.match(wW);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Wx(n.slice(2)),e]}let jB=0;const Tpe=Promise.resolve(),Rpe=()=>jB||(Tpe.then(()=>jB=0),jB=Date.now());function Ope(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;nu(Lpe(r,t.value),e,5,[r])};return t.value=n,t.attached=Rpe(),t}function Lpe(n,e){if(Bn(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const SW=/^on[a-z]/,Dpe=(n,e,t,r,i=!1,s,o,a,c)=>{e==="class"?xpe(n,r,i):e==="style"?bpe(n,t,r):$O(e)?bj(e)||Ape(n,e,t,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ipe(n,e,r,i))?Mpe(n,e,r,s,o,a,c):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Spe(n,e,r,i))};function Ipe(n,e,t,r){return r?!!(e==="innerHTML"||e==="textContent"||e in n&&SW.test(e)&&jn(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||SW.test(e)&&ho(t)?!1:e in n}const Npe={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Sde.props;const kpe=Ia({patchProp:Dpe},ype);let MW;function zpe(){return MW||(MW=Jde(kpe))}const Bpe=(...n)=>{const e=zpe().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=Vpe(r);if(!i)return;const s=e._component;!jn(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=t(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Vpe(n){return ho(n)?document.querySelector(n):n}const Fpe="modulepreload",Upe=function(n){return"/"+n},CW={},rr=function(e,t,r){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=Upe(s),s in CW)return;CW[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=i.length-1;d>=0;d--){const p=i[d];if(p.href===s&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Fpe,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,p)=>{u.addEventListener("load",d),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};var jpe=Object.defineProperty,Hpe=(n,e,t)=>e in n?jpe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,le=(n,e,t)=>(Hpe(n,typeof e!="symbol"?e+"":e,t),t),At=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function AQe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var la={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",u=500,d="__lodash_placeholder__",p=1,f=2,v=4,x=1,y=2,_=1,S=2,C=4,A=8,P=16,D=32,N=64,j=128,T=256,k=512,U=30,ee="...",xe=800,ce=16,te=1,fe=2,ge=3,Se=1/0,pe=9007199254740991,se=17976931348623157e292,ae=0/0,Le=4294967295,Re=Le-1,Ue=Le>>>1,Ze=[["ary",j],["bind",_],["bindKey",S],["curry",A],["curryRight",P],["flip",k],["partial",D],["partialRight",N],["rearg",T]],st="[object Arguments]",we="[object Array]",Mt="[object AsyncFunction]",rt="[object Boolean]",it="[object Date]",Ke="[object DOMException]",Qe="[object Error]",Y="[object Function]",K="[object GeneratorFunction]",ve="[object Map]",Ae="[object Number]",De="[object Null]",je="[object Object]",Xe="[object Promise]",He="[object Proxy]",ne="[object RegExp]",W="[object Set]",O="[object String]",E="[object Symbol]",F="[object Undefined]",z="[object WeakMap]",Z="[object WeakSet]",de="[object ArrayBuffer]",be="[object DataView]",oe="[object Float32Array]",ze="[object Float64Array]",ke="[object Int8Array]",Fe="[object Int16Array]",Ge="[object Int32Array]",at="[object Uint8Array]",pt="[object Uint8ClampedArray]",Dt="[object Uint16Array]",re="[object Uint32Array]",$e=/\b__p \+= '';/g,Me=/\b(__p \+=) '' \+/g,tt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Je=/&(?:amp|lt|gt|quot|#39);/g,Ft=/[&<>"']/g,vn=RegExp(Je.source),hn=RegExp(Ft.source),zr=/<%-([\s\S]+?)%>/g,qt=/<%([\s\S]+?)%>/g,xr=/<%=([\s\S]+?)%>/g,or=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ul=/^\w*$/,Vo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fo=/[\\^$.*+?()[\]{}|]/g,Lc=RegExp(Fo.source),va=/^\s+/,ei=/\s/,H=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,Ce=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oe=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bt=/\w*$/,wt=/^[-+]0x[0-9a-f]+$/i,Zt=/^0b[01]+$/i,kt=/^\[object .+?Constructor\]$/,It=/^0o[0-7]+$/i,gn=/^(?:0|[1-9]\d*)$/,Bi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mr=/($^)/,Ln=/['\n\r\u2028\u2029\\]/g,Dn="\\ud800-\\udfff",Wt="\\u0300-\\u036f",ts="\\ufe20-\\ufe2f",Fn="\\u20d0-\\u20ff",Zn=Wt+ts+Fn,Cr="\\u2700-\\u27bf",Xr="a-z\\xdf-\\xf6\\xf8-\\xff",Ts="\\xac\\xb1\\xd7\\xf7",Rn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Vi="\\u2000-\\u206f",Uo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Un="A-Z\\xc0-\\xd6\\xd8-\\xde",fs="\\ufe0e\\ufe0f",jl=Ts+Rn+Vi+Uo,jo="['\u2019]",Hl="["+Dn+"]",Rs="["+jl+"]",Ho="["+Zn+"]",Fa="\\d+",fh="["+Cr+"]",Wo="["+Xr+"]",md="[^"+Dn+jl+Fa+Cr+Xr+Un+"]",Ua="\\ud83c[\\udffb-\\udfff]",vd="(?:"+Ho+"|"+Ua+")",mh="[^"+Dn+"]",xl="(?:\\ud83c[\\udde6-\\uddff]){2}",bl="[\\ud800-\\udbff][\\udc00-\\udfff]",Go="["+Un+"]",Dc="\\u200d",pu="(?:"+Wo+"|"+md+")",df="(?:"+Go+"|"+md+")",fu="(?:"+jo+"(?:d|ll|m|re|s|t|ve))?",gd="(?:"+jo+"(?:D|LL|M|RE|S|T|VE))?",_d=vd+"?",Li="["+fs+"]?",hv="(?:"+Dc+"(?:"+[mh,xl,bl].join("|")+")"+Li+_d+")*",Wl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ja=Li+_d+hv,dv="(?:"+[fh,xl,bl].join("|")+")"+ja,X="(?:"+[mh+Ho+"?",Ho,xl,bl,Hl].join("|")+")",B=RegExp(jo,"g"),q=RegExp(Ho,"g"),he=RegExp(Ua+"(?="+Ua+")|"+X+ja,"g"),qe=RegExp([Go+"?"+Wo+"+"+fu+"(?="+[Rs,Go,"$"].join("|")+")",df+"+"+gd+"(?="+[Rs,Go+pu,"$"].join("|")+")",Go+"?"+pu+"+"+fu,Go+"+"+gd,mu,Wl,Fa,dv].join("|"),"g"),dt=RegExp("["+Dc+Dn+Zn+fs+"]"),on=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],In=-1,gt={};gt[oe]=gt[ze]=gt[ke]=gt[Fe]=gt[Ge]=gt[at]=gt[pt]=gt[Dt]=gt[re]=!0,gt[st]=gt[we]=gt[de]=gt[rt]=gt[be]=gt[it]=gt[Qe]=gt[Y]=gt[ve]=gt[Ae]=gt[je]=gt[ne]=gt[W]=gt[O]=gt[z]=!1;var ht={};ht[st]=ht[we]=ht[de]=ht[be]=ht[rt]=ht[it]=ht[oe]=ht[ze]=ht[ke]=ht[Fe]=ht[Ge]=ht[ve]=ht[Ae]=ht[je]=ht[ne]=ht[W]=ht[O]=ht[E]=ht[at]=ht[pt]=ht[Dt]=ht[re]=!0,ht[Qe]=ht[Y]=ht[z]=!1;var $t={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Kn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},dn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},wn=parseFloat,Xn=parseInt,tn=typeof At=="object"&&At&&At.Object===Object&&At,Nn=typeof self=="object"&&self&&self.Object===Object&&self,ln=tn||Nn||Function("return this")(),pn=e&&!e.nodeType&&e,qn=pn&&!0&&n&&!n.nodeType&&n,Os=qn&&qn.exports===pn,ga=Os&&tn.process,On=function(){try{var $=qn&&qn.require&&qn.require("util").types;return $||ga&&ga.binding&&ga.binding("util")}catch{}}(),ur=On&&On.isArrayBuffer,ti=On&&On.isDate,vu=On&&On.isMap,mr=On&&On.isRegExp,Ic=On&&On.isSet,yo=On&&On.isTypedArray;function Jn($,Ee,_e){switch(_e.length){case 0:return $.call(Ee);case 1:return $.call(Ee,_e[0]);case 2:return $.call(Ee,_e[0],_e[1]);case 3:return $.call(Ee,_e[0],_e[1],_e[2])}return $.apply(Ee,_e)}function yd($,Ee,_e,nt){for(var St=-1,jt=$==null?0:$.length;++St<jt;){var xn=$[St];Ee(nt,xn,_e(xn),$)}return nt}function vr($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt&&Ee($[_e],_e,$)!==!1;);return $}function qb($,Ee){for(var _e=$==null?0:$.length;_e--&&Ee($[_e],_e,$)!==!1;);return $}function pv($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt;)if(!Ee($[_e],_e,$))return!1;return!0}function Gs($,Ee){for(var _e=-1,nt=$==null?0:$.length,St=0,jt=[];++_e<nt;){var xn=$[_e];Ee(xn,_e,$)&&(jt[St++]=xn)}return jt}function Ha($,Ee){var _e=$==null?0:$.length;return!!_e&&fi($,Ee,0)>-1}function ns($,Ee,_e){for(var nt=-1,St=$==null?0:$.length;++nt<St;)if(_e(Ee,$[nt]))return!0;return!1}function cn($,Ee){for(var _e=-1,nt=$==null?0:$.length,St=Array(nt);++_e<nt;)St[_e]=Ee($[_e],_e,$);return St}function ni($,Ee){for(var _e=-1,nt=Ee.length,St=$.length;++_e<nt;)$[St+_e]=Ee[_e];return $}function xd($,Ee,_e,nt){var St=-1,jt=$==null?0:$.length;for(nt&&jt&&(_e=$[++St]);++St<jt;)_e=Ee(_e,$[St],St,$);return _e}function K0($,Ee,_e,nt){var St=$==null?0:$.length;for(nt&&St&&(_e=$[--St]);St--;)_e=Ee(_e,$[St],St,$);return _e}function gu($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt;)if(Ee($[_e],_e,$))return!0;return!1}var _u=wd("length");function qr($){return $.split("")}function J0($){return $.match(ue)||[]}function bi($,Ee,_e){var nt;return _e($,function(St,jt,xn){if(Ee(St,jt,xn))return nt=jt,!1}),nt}function Nc($,Ee,_e,nt){for(var St=$.length,jt=_e+(nt?1:-1);nt?jt--:++jt<St;)if(Ee($[jt],jt,$))return jt;return-1}function fi($,Ee,_e){return Ee===Ee?Q0($,Ee,_e):Nc($,yu,_e)}function Yb($,Ee,_e,nt){for(var St=_e-1,jt=$.length;++St<jt;)if(nt($[St],Ee))return St;return-1}function yu($){return $!==$}function bd($,Ee){var _e=$==null?0:$.length;return _e?xu($,Ee)/_e:ae}function wd($){return function(Ee){return Ee==null?t:Ee[$]}}function Sd($){return function(Ee){return $==null?t:$[Ee]}}function Md($,Ee,_e,nt,St){return St($,function(jt,xn,sn){_e=nt?(nt=!1,jt):Ee(_e,jt,xn,sn)}),_e}function Zb($,Ee){var _e=$.length;for($.sort(Ee);_e--;)$[_e]=$[_e].value;return $}function xu($,Ee){for(var _e,nt=-1,St=$.length;++nt<St;){var jt=Ee($[nt]);jt!==t&&(_e=_e===t?jt:_e+jt)}return _e}function Gl($,Ee){for(var _e=-1,nt=Array($);++_e<$;)nt[_e]=Ee(_e);return nt}function pf($,Ee){return cn(Ee,function(_e){return[_e,$[_e]]})}function ff($){return $&&$.slice(0,gf($)+1).replace(va,"")}function ir($){return function(Ee){return $(Ee)}}function vh($,Ee){return cn(Ee,function(_e){return $[_e]})}function Wa($,Ee){return $.has(Ee)}function Cd($,Ee){for(var _e=-1,nt=$.length;++_e<nt&&fi(Ee,$[_e],0)>-1;);return _e}function fv($,Ee){for(var _e=$.length;_e--&&fi(Ee,$[_e],0)>-1;);return _e}function mf($,Ee){for(var _e=$.length,nt=0;_e--;)$[_e]===Ee&&++nt;return nt}var gh=Sd($t),_h=Sd(Kn);function vf($){return"\\"+dn[$]}function Kb($,Ee){return $==null?t:$[Ee]}function Ga($){return dt.test($)}function Jb($){return on.test($)}function Qb($){for(var Ee,_e=[];!(Ee=$.next()).done;)_e.push(Ee.value);return _e}function Xa($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt,St){_e[++Ee]=[St,nt]}),_e}function mv($,Ee){return function(_e){return $(Ee(_e))}}function Xs($,Ee){for(var _e=-1,nt=$.length,St=0,jt=[];++_e<nt;){var xn=$[_e];(xn===Ee||xn===d)&&($[_e]=d,jt[St++]=_e)}return jt}function bu($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt){_e[++Ee]=nt}),_e}function $b($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt){_e[++Ee]=[nt,nt]}),_e}function Q0($,Ee,_e){for(var nt=_e-1,St=$.length;++nt<St;)if($[nt]===Ee)return nt;return-1}function ew($,Ee,_e){for(var nt=_e+1;nt--;)if($[nt]===Ee)return nt;return nt}function qa($){return Ga($)?_f($):_u($)}function Er($){return Ga($)?nw($):qr($)}function gf($){for(var Ee=$.length;Ee--&&ei.test($.charAt(Ee)););return Ee}var tw=Sd(Mn);function _f($){for(var Ee=he.lastIndex=0;he.test($);)++Ee;return Ee}function nw($){return $.match(he)||[]}function $0($){return $.match(qe)||[]}var rw=function $(Ee){Ee=Ee==null?ln:xo.defaults(ln.Object(),Ee,xo.pick(ln,Gt));var _e=Ee.Array,nt=Ee.Date,St=Ee.Error,jt=Ee.Function,xn=Ee.Math,sn=Ee.Object,Ls=Ee.RegExp,iw=Ee.String,Yr=Ee.TypeError,kc=_e.prototype,e_=jt.prototype,_a=sn.prototype,zc=Ee["__core-js_shared__"],Bc=e_.toString,Yt=_a.hasOwnProperty,t_=0,yf=function(){var l=/[^.]+$/.exec(zc&&zc.keys&&zc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),Vc=_a.toString,sw=Bc.call(sn),n_=ln._,ow=Ls("^"+Bc.call(Yt).replace(Fo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fc=Os?Ee.Buffer:t,Ds=Ee.Symbol,Uc=Ee.Uint8Array,xf=Fc?Fc.allocUnsafe:t,wu=mv(sn.getPrototypeOf,sn),vv=sn.create,Ed=_a.propertyIsEnumerable,jc=kc.splice,gv=Ds?Ds.isConcatSpreadable:t,Ya=Ds?Ds.iterator:t,bo=Ds?Ds.toStringTag:t,Hc=function(){try{var l=$a(sn,"defineProperty");return l({},"",{}),l}catch{}}(),_v=Ee.clearTimeout!==ln.clearTimeout&&Ee.clearTimeout,r_=nt&&nt.now!==ln.Date.now&&nt.now,aw=Ee.setTimeout!==ln.setTimeout&&Ee.setTimeout,wl=xn.ceil,Su=xn.floor,Ad=sn.getOwnPropertySymbols,lw=Fc?Fc.isBuffer:t,bf=Ee.isFinite,cw=kc.join,i_=mv(sn.keys,sn),kn=xn.max,ar=xn.min,yv=nt.now,Pd=Ee.parseInt,xv=xn.random,uw=kc.reverse,Sl=$a(Ee,"DataView"),Xl=$a(Ee,"Map"),Td=$a(Ee,"Promise"),Za=$a(Ee,"Set"),ql=$a(Ee,"WeakMap"),Ka=$a(sn,"create"),Mu=ql&&new ql,Xo={},hw=el(Sl),dw=el(Xl),bv=el(Td),s_=el(Za),pw=el(ql),Cu=Ds?Ds.prototype:t,Yl=Cu?Cu.valueOf:t,Rd=Cu?Cu.toString:t;function I(l){if(Cn(l)&&!Et(l)&&!(l instanceof Bt)){if(l instanceof ri)return l;if(Yt.call(l,"__wrapped__"))return A1(l)}return new ri(l)}var Ja=function(){function l(){}return function(h){if(!bn(h))return{};if(vv)return vv(h);l.prototype=h;var m=new l;return l.prototype=t,m}}();function Zl(){}function ri(l,h){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=t}I.templateSettings={escape:zr,evaluate:qt,interpolate:xr,variable:"",imports:{_:I}},I.prototype=Zl.prototype,I.prototype.constructor=I,ri.prototype=Ja(Zl.prototype),ri.prototype.constructor=ri;function Bt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Le,this.__views__=[]}function fw(){var l=new Bt(this.__wrapped__);return l.__actions__=Ur(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Ur(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Ur(this.__views__),l}function mw(){if(this.__filtered__){var l=new Bt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function vw(){var l=this.__wrapped__.value(),h=this.__dir__,m=Et(l),w=h<0,R=m?l.length:0,V=aI(0,R,this.__views__),G=V.start,J=V.end,ie=J-G,Ie=w?J:G-1,Ne=this.__iteratees__,Be=Ne.length,et=0,ct=ar(ie,this.__takeCount__);if(!m||!w&&R==ie&&ct==ie)return Kw(l,this.__actions__);var mt=[];e:for(;ie--&&et<ct;){Ie+=h;for(var Ot=-1,vt=l[Ie];++Ot<Be;){var Vt=Ne[Ot],Ht=Vt.iteratee,si=Vt.type,Pr=Ht(vt);if(si==fe)vt=Pr;else if(!Pr){if(si==te)continue e;break e}}mt[et++]=vt}return mt}Bt.prototype=Ja(Zl.prototype),Bt.prototype.constructor=Bt;function qo(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function gw(){this.__data__=Ka?Ka(null):{},this.size=0}function _w(l){var h=this.has(l)&&delete this.__data__[l];return this.size-=h?1:0,h}function yw(l){var h=this.__data__;if(Ka){var m=h[l];return m===c?t:m}return Yt.call(h,l)?h[l]:t}function xw(l){var h=this.__data__;return Ka?h[l]!==t:Yt.call(h,l)}function bw(l,h){var m=this.__data__;return this.size+=this.has(l)?0:1,m[l]=Ka&&h===t?c:h,this}qo.prototype.clear=gw,qo.prototype.delete=_w,qo.prototype.get=yw,qo.prototype.has=xw,qo.prototype.set=bw;function ms(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function wv(){this.__data__=[],this.size=0}function ww(l){var h=this.__data__,m=Gc(h,l);if(m<0)return!1;var w=h.length-1;return m==w?h.pop():jc.call(h,m,1),--this.size,!0}function Sw(l){var h=this.__data__,m=Gc(h,l);return m<0?t:h[m][1]}function Mw(l){return Gc(this.__data__,l)>-1}function Cw(l,h){var m=this.__data__,w=Gc(m,l);return w<0?(++this.size,m.push([l,h])):m[w][1]=h,this}ms.prototype.clear=wv,ms.prototype.delete=ww,ms.prototype.get=Sw,ms.prototype.has=Mw,ms.prototype.set=Cw;function vs(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function Ew(){this.size=0,this.__data__={hash:new qo,map:new(Xl||ms),string:new qo}}function Aw(l){var h=qd(this,l).delete(l);return this.size-=h?1:0,h}function Pw(l){return qd(this,l).get(l)}function Wc(l){return qd(this,l).has(l)}function o_(l,h){var m=qd(this,l),w=m.size;return m.set(l,h),this.size+=m.size==w?0:1,this}vs.prototype.clear=Ew,vs.prototype.delete=Aw,vs.prototype.get=Pw,vs.prototype.has=Wc,vs.prototype.set=o_;function Yo(l){var h=-1,m=l==null?0:l.length;for(this.__data__=new vs;++h<m;)this.add(l[h])}function Tw(l){return this.__data__.set(l,c),this}function Sv(l){return this.__data__.has(l)}Yo.prototype.add=Yo.prototype.push=Tw,Yo.prototype.has=Sv;function mi(l){var h=this.__data__=new ms(l);this.size=h.size}function a_(){this.__data__=new ms,this.size=0}function Rw(l){var h=this.__data__,m=h.delete(l);return this.size=h.size,m}function Ow(l){return this.__data__.get(l)}function Lw(l){return this.__data__.has(l)}function Dw(l,h){var m=this.__data__;if(m instanceof ms){var w=m.__data__;if(!Xl||w.length<i-1)return w.push([l,h]),this.size=++m.size,this;m=this.__data__=new vs(w)}return m.set(l,h),this.size=m.size,this}mi.prototype.clear=a_,mi.prototype.delete=Rw,mi.prototype.get=Ow,mi.prototype.has=Lw,mi.prototype.set=Dw;function Ml(l,h){var m=Et(l),w=!m&&tl(l),R=!m&&!w&&ea(l),V=!m&&!w&&!R&&rc(l),G=m||w||R||V,J=G?Gl(l.length,iw):[],ie=J.length;for(var Ie in l)(h||Yt.call(l,Ie))&&!(G&&(Ie=="length"||R&&(Ie=="offset"||Ie=="parent")||V&&(Ie=="buffer"||Ie=="byteLength"||Ie=="byteOffset")||Zs(Ie,ie)))&&J.push(Ie);return J}function wf(l){var h=l.length;return h?l[Fd(0,h-1)]:t}function yh(l,h){return Yd(Ur(l),Ko(h,0,l.length))}function Iw(l){return Yd(Ur(l))}function ya(l,h,m){(m!==t&&!Ui(l[h],m)||m===t&&!(h in l))&&gs(l,h,m)}function Kl(l,h,m){var w=l[h];(!(Yt.call(l,h)&&Ui(w,m))||m===t&&!(h in l))&&gs(l,h,m)}function Gc(l,h){for(var m=l.length;m--;)if(Ui(l[m][0],h))return m;return-1}function Nw(l,h,m,w){return Di(l,function(R,V,G){h(w,R,m(R),G)}),w}function Mv(l,h){return l&&_s(h,$n(h),l)}function kw(l,h){return l&&_s(h,Hr(h),l)}function gs(l,h,m){h=="__proto__"&&Hc?Hc(l,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):l[h]=m}function Zo(l,h){for(var m=-1,w=h.length,R=_e(w),V=l==null;++m<w;)R[m]=V?t:rg(l,h[m]);return R}function Ko(l,h,m){return l===l&&(m!==t&&(l=l<=m?l:m),h!==t&&(l=l>=h?l:h)),l}function Zr(l,h,m,w,R,V){var G,J=h&p,ie=h&f,Ie=h&v;if(m&&(G=R?m(l,w,R,V):m(l)),G!==t)return G;if(!bn(l))return l;var Ne=Et(l);if(Ne){if(G=cI(l),!J)return Ur(l,G)}else{var Be=_r(l),et=Be==Y||Be==K;if(ea(l))return $w(l,J);if(Be==je||Be==st||et&&!R){if(G=ie||et?{}:_1(l),!J)return ie?Q4(l,kw(G,l)):J4(l,Mv(G,l))}else{if(!ht[Be])return R?l:{};G=uI(l,Be,J)}}V||(V=new mi);var ct=V.get(l);if(ct)return ct;V.set(l,G),q1(l)?l.forEach(function(vt){G.add(Zr(vt,h,m,vt,l,V))}):G1(l)&&l.forEach(function(vt,Vt){G.set(Vt,Zr(vt,h,m,Vt,l,V))});var mt=Ie?ie?Hv:jv:ie?Hr:$n,Ot=Ne?t:mt(l);return vr(Ot||l,function(vt,Vt){Ot&&(Vt=vt,vt=l[Vt]),Kl(G,Vt,Zr(vt,h,m,Vt,l,V))}),G}function zw(l){var h=$n(l);return function(m){return Sf(m,l,h)}}function Sf(l,h,m){var w=m.length;if(l==null)return!w;for(l=sn(l);w--;){var R=m[w],V=h[R],G=l[R];if(G===t&&!(R in l)||!V(G))return!1}return!0}function Cv(l,h,m){if(typeof l!="function")throw new Yr(o);return Lu(function(){l.apply(t,m)},h)}function Jl(l,h,m,w){var R=-1,V=Ha,G=!0,J=l.length,ie=[],Ie=h.length;if(!J)return ie;m&&(h=cn(h,ir(m))),w?(V=ns,G=!1):h.length>=i&&(V=Wa,G=!1,h=new Yo(h));e:for(;++R<J;){var Ne=l[R],Be=m==null?Ne:m(Ne);if(Ne=w||Ne!==0?Ne:0,G&&Be===Be){for(var et=Ie;et--;)if(h[et]===Be)continue e;ie.push(Ne)}else V(h,Be,w)||ie.push(Ne)}return ie}var Di=i1(Fi),Mf=i1(Ld,!0);function Bw(l,h){var m=!0;return Di(l,function(w,R,V){return m=!!h(w,R,V),m}),m}function Eu(l,h,m){for(var w=-1,R=l.length;++w<R;){var V=l[w],G=h(V);if(G!=null&&(J===t?G===G&&!ii(G):m(G,J)))var J=G,ie=V}return ie}function Vw(l,h,m,w){var R=l.length;for(m=Tt(m),m<0&&(m=-m>R?0:R+m),w=w===t||w>R?R:Tt(w),w<0&&(w+=R),w=m>w?0:Z1(w);m<w;)l[m++]=h;return l}function Od(l,h){var m=[];return Di(l,function(w,R,V){h(w,R,V)&&m.push(w)}),m}function Qn(l,h,m,w,R){var V=-1,G=l.length;for(m||(m=dI),R||(R=[]);++V<G;){var J=l[V];h>0&&m(J)?h>1?Qn(J,h-1,m,w,R):ni(R,J):w||(R[R.length]=J)}return R}var Cl=s1(),Cf=s1(!0);function Fi(l,h){return l&&Cl(l,h,$n)}function Ld(l,h){return l&&Cf(l,h,$n)}function Au(l,h){return Gs(h,function(m){return Ks(l[m])})}function Jo(l,h){h=Qo(h,l);for(var m=0,w=h.length;l!=null&&m<w;)l=l[ys(h[m++])];return m&&m==w?l:t}function Ev(l,h,m){var w=h(l);return Et(l)?w:ni(w,m(l))}function gr(l){return l==null?l===t?F:De:bo&&bo in sn(l)?oI(l):yI(l)}function Dd(l,h){return l>h}function Id(l,h){return l!=null&&Yt.call(l,h)}function l_(l,h){return l!=null&&h in sn(l)}function Fw(l,h,m){return l>=ar(h,m)&&l<kn(h,m)}function Pu(l,h,m){for(var w=m?ns:Ha,R=l[0].length,V=l.length,G=V,J=_e(V),ie=1/0,Ie=[];G--;){var Ne=l[G];G&&h&&(Ne=cn(Ne,ir(h))),ie=ar(Ne.length,ie),J[G]=!m&&(h||R>=120&&Ne.length>=120)?new Yo(G&&Ne):t}Ne=l[0];var Be=-1,et=J[0];e:for(;++Be<R&&Ie.length<ie;){var ct=Ne[Be],mt=h?h(ct):ct;if(ct=m||ct!==0?ct:0,!(et?Wa(et,mt):w(Ie,mt,m))){for(G=V;--G;){var Ot=J[G];if(!(Ot?Wa(Ot,mt):w(l[G],mt,m)))continue e}et&&et.push(mt),Ie.push(ct)}}return Ie}function c_(l,h,m,w){return Fi(l,function(R,V,G){h(w,m(R),V,G)}),w}function Ql(l,h,m){h=Qo(h,l),l=w1(l,h);var w=l==null?l:l[ys(wi(h))];return w==null?t:Jn(w,l,m)}function Nd(l){return Cn(l)&&gr(l)==st}function Uw(l){return Cn(l)&&gr(l)==de}function Xc(l){return Cn(l)&&gr(l)==it}function $l(l,h,m,w,R){return l===h?!0:l==null||h==null||!Cn(l)&&!Cn(h)?l!==l&&h!==h:jw(l,h,m,w,$l,R)}function jw(l,h,m,w,R,V){var G=Et(l),J=Et(h),ie=G?we:_r(l),Ie=J?we:_r(h);ie=ie==st?je:ie,Ie=Ie==st?je:Ie;var Ne=ie==je,Be=Ie==je,et=ie==Ie;if(et&&ea(l)){if(!ea(h))return!1;G=!0,Ne=!1}if(et&&!Ne)return V||(V=new mi),G||rc(l)?m1(l,h,m,w,R,V):iI(l,h,ie,m,w,R,V);if(!(m&x)){var ct=Ne&&Yt.call(l,"__wrapped__"),mt=Be&&Yt.call(h,"__wrapped__");if(ct||mt){var Ot=ct?l.value():l,vt=mt?h.value():h;return V||(V=new mi),R(Ot,vt,m,w,V)}}return et?(V||(V=new mi),sI(l,h,m,w,R,V)):!1}function Av(l){return Cn(l)&&_r(l)==ve}function kd(l,h,m,w){var R=m.length,V=R,G=!w;if(l==null)return!V;for(l=sn(l);R--;){var J=m[R];if(G&&J[2]?J[1]!==l[J[0]]:!(J[0]in l))return!1}for(;++R<V;){J=m[R];var ie=J[0],Ie=l[ie],Ne=J[1];if(G&&J[2]){if(Ie===t&&!(ie in l))return!1}else{var Be=new mi;if(w)var et=w(Ie,Ne,ie,l,h,Be);if(!(et===t?$l(Ne,Ie,x|y,w,Be):et))return!1}}return!0}function Pv(l){if(!bn(l)||fI(l))return!1;var h=Ks(l)?ow:kt;return h.test(el(l))}function u_(l){return Cn(l)&&gr(l)==ne}function Hw(l){return Cn(l)&&_r(l)==W}function Ww(l){return Cn(l)&&ep(l.length)&&!!gt[gr(l)]}function Tv(l){return typeof l=="function"?l:l==null?Wr:typeof l=="object"?Et(l)?Lv(l[0],l[1]):Ov(l):oS(l)}function zd(l){if(!Ou(l))return i_(l);var h=[];for(var m in sn(l))Yt.call(l,m)&&m!="constructor"&&h.push(m);return h}function Gw(l){if(!bn(l))return _I(l);var h=Ou(l),m=[];for(var w in l)w=="constructor"&&(h||!Yt.call(l,w))||m.push(w);return m}function Bd(l,h){return l<h}function Rv(l,h){var m=-1,w=jr(l)?_e(l.length):[];return Di(l,function(R,V,G){w[++m]=h(R,V,G)}),w}function Ov(l){var h=Gv(l);return h.length==1&&h[0][2]?x1(h[0][0],h[0][1]):function(m){return m===l||kd(m,l,h)}}function Lv(l,h){return qv(l)&&y1(h)?x1(ys(l),h):function(m){var w=rg(m,l);return w===t&&w===h?ig(m,l):$l(h,w,x|y)}}function qc(l,h,m,w,R){l!==h&&Cl(h,function(V,G){if(R||(R=new mi),bn(V))h_(l,h,G,m,qc,w,R);else{var J=w?w(Zv(l,G),V,G+"",l,h,R):t;J===t&&(J=V),ya(l,G,J)}},Hr)}function h_(l,h,m,w,R,V,G){var J=Zv(l,m),ie=Zv(h,m),Ie=G.get(ie);if(Ie){ya(l,m,Ie);return}var Ne=V?V(J,ie,m+"",l,h,G):t,Be=Ne===t;if(Be){var et=Et(ie),ct=!et&&ea(ie),mt=!et&&!ct&&rc(ie);Ne=ie,et||ct||mt?Et(J)?Ne=J:En(J)?Ne=Ur(J):ct?(Be=!1,Ne=$w(ie,!0)):mt?(Be=!1,Ne=e1(ie,!0)):Ne=[]:Du(ie)||tl(ie)?(Ne=J,tl(J)?Ne=K1(J):(!bn(J)||Ks(J))&&(Ne=_1(ie))):Be=!1}Be&&(G.set(ie,Ne),R(Ne,ie,w,V,G),G.delete(ie)),ya(l,m,Ne)}function Ef(l,h){var m=l.length;if(m)return h+=h<0?m:0,Zs(h,m)?l[h]:t}function Dv(l,h,m){h.length?h=cn(h,function(V){return Et(V)?function(G){return Jo(G,V.length===1?V[0]:V)}:V}):h=[Wr];var w=-1;h=cn(h,ir(ft()));var R=Rv(l,function(V,G,J){var ie=cn(h,function(Ie){return Ie(V)});return{criteria:ie,index:++w,value:V}});return Zb(R,function(V,G){return K4(V,G,m)})}function Xw(l,h){return Iv(l,h,function(m,w){return ig(l,w)})}function Iv(l,h,m){for(var w=-1,R=h.length,V={};++w<R;){var G=h[w],J=Jo(l,G);m(J,G)&&g(V,Qo(G,l),J)}return V}function qw(l){return function(h){return Jo(h,l)}}function Vd(l,h,m,w){var R=w?Yb:fi,V=-1,G=h.length,J=l;for(l===h&&(h=Ur(h)),m&&(J=cn(l,ir(m)));++V<G;)for(var ie=0,Ie=h[V],Ne=m?m(Ie):Ie;(ie=R(J,Ne,ie,w))>-1;)J!==l&&jc.call(J,ie,1),jc.call(l,ie,1);return l}function Nv(l,h){for(var m=l?h.length:0,w=m-1;m--;){var R=h[m];if(m==w||R!==V){var V=R;Zs(R)?jc.call(l,R,1):Qa(l,R)}}return l}function Fd(l,h){return l+Su(xv()*(h-l+1))}function Yw(l,h,m,w){for(var R=-1,V=kn(wl((h-l)/(m||1)),0),G=_e(V);V--;)G[w?V:++R]=l,l+=m;return G}function xh(l,h){var m="";if(!l||h<1||h>pe)return m;do h%2&&(m+=l),h=Su(h/2),h&&(l+=l);while(h);return m}function Rt(l,h){return Kv(b1(l,h,Wr),l+"")}function Zw(l){return wf(ic(l))}function M(l,h){var m=ic(l);return Yd(m,Ko(h,0,m.length))}function g(l,h,m,w){if(!bn(l))return l;h=Qo(h,l);for(var R=-1,V=h.length,G=V-1,J=l;J!=null&&++R<V;){var ie=ys(h[R]),Ie=m;if(ie==="__proto__"||ie==="constructor"||ie==="prototype")return l;if(R!=G){var Ne=J[ie];Ie=w?w(Ne,ie,J):t,Ie===t&&(Ie=bn(Ne)?Ne:Zs(h[R+1])?[]:{})}Kl(J,ie,Ie),J=J[ie]}return l}var b=Mu?function(l,h){return Mu.set(l,h),l}:Wr,L=Hc?function(l,h){return Hc(l,"toString",{configurable:!0,enumerable:!1,value:og(h),writable:!0})}:Wr;function Q(l){return Yd(ic(l))}function Pe(l,h,m){var w=-1,R=l.length;h<0&&(h=-h>R?0:R+h),m=m>R?R:m,m<0&&(m+=R),R=h>m?0:m-h>>>0,h>>>=0;for(var V=_e(R);++w<R;)V[w]=l[w+h];return V}function Ye(l,h){var m;return Di(l,function(w,R,V){return m=h(w,R,V),!m}),!!m}function _t(l,h,m){var w=0,R=l==null?w:l.length;if(typeof h=="number"&&h===h&&R<=Ue){for(;w<R;){var V=w+R>>>1,G=l[V];G!==null&&!ii(G)&&(m?G<=h:G<h)?w=V+1:R=V}return R}return Kt(l,h,Wr,m)}function Kt(l,h,m,w){var R=0,V=l==null?0:l.length;if(V===0)return 0;h=m(h);for(var G=h!==h,J=h===null,ie=ii(h),Ie=h===t;R<V;){var Ne=Su((R+V)/2),Be=m(l[Ne]),et=Be!==t,ct=Be===null,mt=Be===Be,Ot=ii(Be);if(G)var vt=w||mt;else Ie?vt=mt&&(w||et):J?vt=mt&&et&&(w||!ct):ie?vt=mt&&et&&!ct&&(w||!Ot):ct||Ot?vt=!1:vt=w?Be<=h:Be<h;vt?R=Ne+1:V=Ne}return ar(V,Re)}function fn(l,h){for(var m=-1,w=l.length,R=0,V=[];++m<w;){var G=l[m],J=h?h(G):G;if(!m||!Ui(J,ie)){var ie=J;V[R++]=G===0?0:G}}return V}function Yn(l){return typeof l=="number"?l:ii(l)?ae:+l}function an(l){if(typeof l=="string")return l;if(Et(l))return cn(l,an)+"";if(ii(l))return Rd?Rd.call(l):"";var h=l+"";return h=="0"&&1/l==-Se?"-0":h}function vi(l,h,m){var w=-1,R=Ha,V=l.length,G=!0,J=[],ie=J;if(m)G=!1,R=ns;else if(V>=i){var Ie=h?null:nI(l);if(Ie)return bu(Ie);G=!1,R=Wa,ie=new Yo}else ie=h?[]:J;e:for(;++w<V;){var Ne=l[w],Be=h?h(Ne):Ne;if(Ne=m||Ne!==0?Ne:0,G&&Be===Be){for(var et=ie.length;et--;)if(ie[et]===Be)continue e;h&&ie.push(Be),J.push(Ne)}else R(ie,Be,m)||(ie!==J&&ie.push(Be),J.push(Ne))}return J}function Qa(l,h){return h=Qo(h,l),l=w1(l,h),l==null||delete l[ys(wi(h))]}function Yc(l,h,m,w){return g(l,h,m(Jo(l,h)),w)}function Tu(l,h,m,w){for(var R=l.length,V=w?R:-1;(w?V--:++V<R)&&h(l[V],V,l););return m?Pe(l,w?0:V,w?V+1:R):Pe(l,w?V+1:0,w?R:V)}function Kw(l,h){var m=l;return m instanceof Bt&&(m=m.value()),xd(h,function(w,R){return R.func.apply(R.thisArg,ni([w],R.args))},m)}function kv(l,h,m){var w=l.length;if(w<2)return w?vi(l[0]):[];for(var R=-1,V=_e(w);++R<w;)for(var G=l[R],J=-1;++J<w;)J!=R&&(V[R]=Jl(V[R]||G,l[J],h,m));return vi(Qn(V,1),h,m)}function Jw(l,h,m){for(var w=-1,R=l.length,V=h.length,G={};++w<R;){var J=w<V?h[w]:t;m(G,l[w],J)}return G}function zv(l){return En(l)?l:[]}function Bv(l){return typeof l=="function"?l:Wr}function Qo(l,h){return Et(l)?l:qv(l,h)?[l]:E1(Jt(l))}var X4=Rt;function $o(l,h,m){var w=l.length;return m=m===t?w:m,!h&&m>=w?l:Pe(l,h,m)}var Qw=_v||function(l){return ln.clearTimeout(l)};function $w(l,h){if(h)return l.slice();var m=l.length,w=xf?xf(m):new l.constructor(m);return l.copy(w),w}function Vv(l){var h=new l.constructor(l.byteLength);return new Uc(h).set(new Uc(l)),h}function q4(l,h){var m=h?Vv(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.byteLength)}function Y4(l){var h=new l.constructor(l.source,bt.exec(l));return h.lastIndex=l.lastIndex,h}function Z4(l){return Yl?sn(Yl.call(l)):{}}function e1(l,h){var m=h?Vv(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.length)}function t1(l,h){if(l!==h){var m=l!==t,w=l===null,R=l===l,V=ii(l),G=h!==t,J=h===null,ie=h===h,Ie=ii(h);if(!J&&!Ie&&!V&&l>h||V&&G&&ie&&!J&&!Ie||w&&G&&ie||!m&&ie||!R)return 1;if(!w&&!V&&!Ie&&l<h||Ie&&m&&R&&!w&&!V||J&&m&&R||!G&&R||!ie)return-1}return 0}function K4(l,h,m){for(var w=-1,R=l.criteria,V=h.criteria,G=R.length,J=m.length;++w<G;){var ie=t1(R[w],V[w]);if(ie){if(w>=J)return ie;var Ie=m[w];return ie*(Ie=="desc"?-1:1)}}return l.index-h.index}function n1(l,h,m,w){for(var R=-1,V=l.length,G=m.length,J=-1,ie=h.length,Ie=kn(V-G,0),Ne=_e(ie+Ie),Be=!w;++J<ie;)Ne[J]=h[J];for(;++R<G;)(Be||R<V)&&(Ne[m[R]]=l[R]);for(;Ie--;)Ne[J++]=l[R++];return Ne}function r1(l,h,m,w){for(var R=-1,V=l.length,G=-1,J=m.length,ie=-1,Ie=h.length,Ne=kn(V-J,0),Be=_e(Ne+Ie),et=!w;++R<Ne;)Be[R]=l[R];for(var ct=R;++ie<Ie;)Be[ct+ie]=h[ie];for(;++G<J;)(et||R<V)&&(Be[ct+m[G]]=l[R++]);return Be}function Ur(l,h){var m=-1,w=l.length;for(h||(h=_e(w));++m<w;)h[m]=l[m];return h}function _s(l,h,m,w){var R=!m;m||(m={});for(var V=-1,G=h.length;++V<G;){var J=h[V],ie=w?w(m[J],l[J],J,m,l):t;ie===t&&(ie=l[J]),R?gs(m,J,ie):Kl(m,J,ie)}return m}function J4(l,h){return _s(l,Xv(l),h)}function Q4(l,h){return _s(l,v1(l),h)}function Ud(l,h){return function(m,w){var R=Et(m)?yd:Nw,V=h?h():{};return R(m,l,ft(w,2),V)}}function ec(l){return Rt(function(h,m){var w=-1,R=m.length,V=R>1?m[R-1]:t,G=R>2?m[2]:t;for(V=l.length>3&&typeof V=="function"?(R--,V):t,G&&Ar(m[0],m[1],G)&&(V=R<3?t:V,R=1),h=sn(h);++w<R;){var J=m[w];J&&l(h,J,w,V)}return h})}function i1(l,h){return function(m,w){if(m==null)return m;if(!jr(m))return l(m,w);for(var R=m.length,V=h?R:-1,G=sn(m);(h?V--:++V<R)&&w(G[V],V,G)!==!1;);return m}}function s1(l){return function(h,m,w){for(var R=-1,V=sn(h),G=w(h),J=G.length;J--;){var ie=G[l?J:++R];if(m(V[ie],ie,V)===!1)break}return h}}function $4(l,h,m){var w=h&_,R=Ru(l);function V(){var G=this&&this!==ln&&this instanceof V?R:l;return G.apply(w?m:this,arguments)}return V}function o1(l){return function(h){h=Jt(h);var m=Ga(h)?Er(h):t,w=m?m[0]:h.charAt(0),R=m?$o(m,1).join(""):h.slice(1);return w[l]()+R}}function tc(l){return function(h){return xd(iS(rS(h).replace(B,"")),l,"")}}function Ru(l){return function(){var h=arguments;switch(h.length){case 0:return new l;case 1:return new l(h[0]);case 2:return new l(h[0],h[1]);case 3:return new l(h[0],h[1],h[2]);case 4:return new l(h[0],h[1],h[2],h[3]);case 5:return new l(h[0],h[1],h[2],h[3],h[4]);case 6:return new l(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new l(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=Ja(l.prototype),w=l.apply(m,h);return bn(w)?w:m}}function eI(l,h,m){var w=Ru(l);function R(){for(var V=arguments.length,G=_e(V),J=V,ie=nc(R);J--;)G[J]=arguments[J];var Ie=V<3&&G[0]!==ie&&G[V-1]!==ie?[]:Xs(G,ie);if(V-=Ie.length,V<m)return h1(l,h,jd,R.placeholder,t,G,Ie,t,t,m-V);var Ne=this&&this!==ln&&this instanceof R?w:l;return Jn(Ne,this,G)}return R}function a1(l){return function(h,m,w){var R=sn(h);if(!jr(h)){var V=ft(m,3);h=$n(h),m=function(J){return V(R[J],J,R)}}var G=l(h,m,w);return G>-1?R[V?h[G]:G]:t}}function l1(l){return Ys(function(h){var m=h.length,w=m,R=ri.prototype.thru;for(l&&h.reverse();w--;){var V=h[w];if(typeof V!="function")throw new Yr(o);if(R&&!G&&Xd(V)=="wrapper")var G=new ri([],!0)}for(w=G?w:m;++w<m;){V=h[w];var J=Xd(V),ie=J=="wrapper"?Wv(V):t;ie&&Yv(ie[0])&&ie[1]==(j|A|D|T)&&!ie[4].length&&ie[9]==1?G=G[Xd(ie[0])].apply(G,ie[3]):G=V.length==1&&Yv(V)?G[J]():G.thru(V)}return function(){var Ie=arguments,Ne=Ie[0];if(G&&Ie.length==1&&Et(Ne))return G.plant(Ne).value();for(var Be=0,et=m?h[Be].apply(this,Ie):Ne;++Be<m;)et=h[Be].call(this,et);return et}})}function jd(l,h,m,w,R,V,G,J,ie,Ie){var Ne=h&j,Be=h&_,et=h&S,ct=h&(A|P),mt=h&k,Ot=et?t:Ru(l);function vt(){for(var Vt=arguments.length,Ht=_e(Vt),si=Vt;si--;)Ht[si]=arguments[si];if(ct)var Pr=nc(vt),oi=mf(Ht,Pr);if(w&&(Ht=n1(Ht,w,R,ct)),V&&(Ht=r1(Ht,V,G,ct)),Vt-=oi,ct&&Vt<Ie){var An=Xs(Ht,Pr);return h1(l,h,jd,vt.placeholder,m,Ht,An,J,ie,Ie-Vt)}var ji=Be?m:this,Qs=et?ji[l]:l;return Vt=Ht.length,J?Ht=xI(Ht,J):mt&&Vt>1&&Ht.reverse(),Ne&&ie<Vt&&(Ht.length=ie),this&&this!==ln&&this instanceof vt&&(Qs=Ot||Ru(Qs)),Qs.apply(ji,Ht)}return vt}function c1(l,h){return function(m,w){return c_(m,l,h(w),{})}}function Hd(l,h){return function(m,w){var R;if(m===t&&w===t)return h;if(m!==t&&(R=m),w!==t){if(R===t)return w;typeof m=="string"||typeof w=="string"?(m=an(m),w=an(w)):(m=Yn(m),w=Yn(w)),R=l(m,w)}return R}}function Fv(l){return Ys(function(h){return h=cn(h,ir(ft())),Rt(function(m){var w=this;return l(h,function(R){return Jn(R,w,m)})})})}function Wd(l,h){h=h===t?" ":an(h);var m=h.length;if(m<2)return m?xh(h,l):h;var w=xh(h,wl(l/qa(h)));return Ga(h)?$o(Er(w),0,l).join(""):w.slice(0,l)}function tI(l,h,m,w){var R=h&_,V=Ru(l);function G(){for(var J=-1,ie=arguments.length,Ie=-1,Ne=w.length,Be=_e(Ne+ie),et=this&&this!==ln&&this instanceof G?V:l;++Ie<Ne;)Be[Ie]=w[Ie];for(;ie--;)Be[Ie++]=arguments[++J];return Jn(et,R?m:this,Be)}return G}function u1(l){return function(h,m,w){return w&&typeof w!="number"&&Ar(h,m,w)&&(m=w=t),h=Js(h),m===t?(m=h,h=0):m=Js(m),w=w===t?h<m?1:-1:Js(w),Yw(h,m,w,l)}}function Gd(l){return function(h,m){return typeof h=="string"&&typeof m=="string"||(h=Si(h),m=Si(m)),l(h,m)}}function h1(l,h,m,w,R,V,G,J,ie,Ie){var Ne=h&A,Be=Ne?G:t,et=Ne?t:G,ct=Ne?V:t,mt=Ne?t:V;h|=Ne?D:N,h&=~(Ne?N:D),h&C||(h&=~(_|S));var Ot=[l,h,R,ct,Be,mt,et,J,ie,Ie],vt=m.apply(t,Ot);return Yv(l)&&S1(vt,Ot),vt.placeholder=w,M1(vt,l,h)}function Uv(l){var h=xn[l];return function(m,w){if(m=Si(m),w=w==null?0:ar(Tt(w),292),w&&bf(m)){var R=(Jt(m)+"e").split("e"),V=h(R[0]+"e"+(+R[1]+w));return R=(Jt(V)+"e").split("e"),+(R[0]+"e"+(+R[1]-w))}return h(m)}}var nI=Za&&1/bu(new Za([,-0]))[1]==Se?function(l){return new Za(l)}:cg;function d1(l){return function(h){var m=_r(h);return m==ve?Xa(h):m==W?$b(h):pf(h,l(h))}}function qs(l,h,m,w,R,V,G,J){var ie=h&S;if(!ie&&typeof l!="function")throw new Yr(o);var Ie=w?w.length:0;if(Ie||(h&=~(D|N),w=R=t),G=G===t?G:kn(Tt(G),0),J=J===t?J:Tt(J),Ie-=R?R.length:0,h&N){var Ne=w,Be=R;w=R=t}var et=ie?t:Wv(l),ct=[l,h,m,w,R,Ne,Be,V,G,J];if(et&&gI(ct,et),l=ct[0],h=ct[1],m=ct[2],w=ct[3],R=ct[4],J=ct[9]=ct[9]===t?ie?0:l.length:kn(ct[9]-Ie,0),!J&&h&(A|P)&&(h&=~(A|P)),!h||h==_)var mt=$4(l,h,m);else h==A||h==P?mt=eI(l,h,J):(h==D||h==(_|D))&&!R.length?mt=tI(l,h,m,w):mt=jd.apply(t,ct);var Ot=et?b:S1;return M1(Ot(mt,ct),l,h)}function p1(l,h,m,w){return l===t||Ui(l,_a[m])&&!Yt.call(w,m)?h:l}function f1(l,h,m,w,R,V){return bn(l)&&bn(h)&&(V.set(h,l),qc(l,h,t,f1,V),V.delete(h)),l}function rI(l){return Du(l)?t:l}function m1(l,h,m,w,R,V){var G=m&x,J=l.length,ie=h.length;if(J!=ie&&!(G&&ie>J))return!1;var Ie=V.get(l),Ne=V.get(h);if(Ie&&Ne)return Ie==h&&Ne==l;var Be=-1,et=!0,ct=m&y?new Yo:t;for(V.set(l,h),V.set(h,l);++Be<J;){var mt=l[Be],Ot=h[Be];if(w)var vt=G?w(Ot,mt,Be,h,l,V):w(mt,Ot,Be,l,h,V);if(vt!==t){if(vt)continue;et=!1;break}if(ct){if(!gu(h,function(Vt,Ht){if(!Wa(ct,Ht)&&(mt===Vt||R(mt,Vt,m,w,V)))return ct.push(Ht)})){et=!1;break}}else if(!(mt===Ot||R(mt,Ot,m,w,V))){et=!1;break}}return V.delete(l),V.delete(h),et}function iI(l,h,m,w,R,V,G){switch(m){case be:if(l.byteLength!=h.byteLength||l.byteOffset!=h.byteOffset)return!1;l=l.buffer,h=h.buffer;case de:return!(l.byteLength!=h.byteLength||!V(new Uc(l),new Uc(h)));case rt:case it:case Ae:return Ui(+l,+h);case Qe:return l.name==h.name&&l.message==h.message;case ne:case O:return l==h+"";case ve:var J=Xa;case W:var ie=w&x;if(J||(J=bu),l.size!=h.size&&!ie)return!1;var Ie=G.get(l);if(Ie)return Ie==h;w|=y,G.set(l,h);var Ne=m1(J(l),J(h),w,R,V,G);return G.delete(l),Ne;case E:if(Yl)return Yl.call(l)==Yl.call(h)}return!1}function sI(l,h,m,w,R,V){var G=m&x,J=jv(l),ie=J.length,Ie=jv(h),Ne=Ie.length;if(ie!=Ne&&!G)return!1;for(var Be=ie;Be--;){var et=J[Be];if(!(G?et in h:Yt.call(h,et)))return!1}var ct=V.get(l),mt=V.get(h);if(ct&&mt)return ct==h&&mt==l;var Ot=!0;V.set(l,h),V.set(h,l);for(var vt=G;++Be<ie;){et=J[Be];var Vt=l[et],Ht=h[et];if(w)var si=G?w(Ht,Vt,et,h,l,V):w(Vt,Ht,et,l,h,V);if(!(si===t?Vt===Ht||R(Vt,Ht,m,w,V):si)){Ot=!1;break}vt||(vt=et=="constructor")}if(Ot&&!vt){var Pr=l.constructor,oi=h.constructor;Pr!=oi&&"constructor"in l&&"constructor"in h&&!(typeof Pr=="function"&&Pr instanceof Pr&&typeof oi=="function"&&oi instanceof oi)&&(Ot=!1)}return V.delete(l),V.delete(h),Ot}function Ys(l){return Kv(b1(l,t,R1),l+"")}function jv(l){return Ev(l,$n,Xv)}function Hv(l){return Ev(l,Hr,v1)}var Wv=Mu?function(l){return Mu.get(l)}:cg;function Xd(l){for(var h=l.name+"",m=Xo[h],w=Yt.call(Xo,h)?m.length:0;w--;){var R=m[w],V=R.func;if(V==null||V==l)return R.name}return h}function nc(l){var h=Yt.call(I,"placeholder")?I:l;return h.placeholder}function ft(){var l=I.iteratee||ag;return l=l===ag?Tv:l,arguments.length?l(arguments[0],arguments[1]):l}function qd(l,h){var m=l.__data__;return pI(h)?m[typeof h=="string"?"string":"hash"]:m.map}function Gv(l){for(var h=$n(l),m=h.length;m--;){var w=h[m],R=l[w];h[m]=[w,R,y1(R)]}return h}function $a(l,h){var m=Kb(l,h);return Pv(m)?m:t}function oI(l){var h=Yt.call(l,bo),m=l[bo];try{l[bo]=t;var w=!0}catch{}var R=Vc.call(l);return w&&(h?l[bo]=m:delete l[bo]),R}var Xv=Ad?function(l){return l==null?[]:(l=sn(l),Gs(Ad(l),function(h){return Ed.call(l,h)}))}:ug,v1=Ad?function(l){for(var h=[];l;)ni(h,Xv(l)),l=wu(l);return h}:ug,_r=gr;(Sl&&_r(new Sl(new ArrayBuffer(1)))!=be||Xl&&_r(new Xl)!=ve||Td&&_r(Td.resolve())!=Xe||Za&&_r(new Za)!=W||ql&&_r(new ql)!=z)&&(_r=function(l){var h=gr(l),m=h==je?l.constructor:t,w=m?el(m):"";if(w)switch(w){case hw:return be;case dw:return ve;case bv:return Xe;case s_:return W;case pw:return z}return h});function aI(l,h,m){for(var w=-1,R=m.length;++w<R;){var V=m[w],G=V.size;switch(V.type){case"drop":l+=G;break;case"dropRight":h-=G;break;case"take":h=ar(h,l+G);break;case"takeRight":l=kn(l,h-G);break}}return{start:l,end:h}}function lI(l){var h=l.match(me);return h?h[1].split(Ce):[]}function g1(l,h,m){h=Qo(h,l);for(var w=-1,R=h.length,V=!1;++w<R;){var G=ys(h[w]);if(!(V=l!=null&&m(l,G)))break;l=l[G]}return V||++w!=R?V:(R=l==null?0:l.length,!!R&&ep(R)&&Zs(G,R)&&(Et(l)||tl(l)))}function cI(l){var h=l.length,m=new l.constructor(h);return h&&typeof l[0]=="string"&&Yt.call(l,"index")&&(m.index=l.index,m.input=l.input),m}function _1(l){return typeof l.constructor=="function"&&!Ou(l)?Ja(wu(l)):{}}function uI(l,h,m){var w=l.constructor;switch(h){case de:return Vv(l);case rt:case it:return new w(+l);case be:return q4(l,m);case oe:case ze:case ke:case Fe:case Ge:case at:case pt:case Dt:case re:return e1(l,m);case ve:return new w;case Ae:case O:return new w(l);case ne:return Y4(l);case W:return new w;case E:return Z4(l)}}function hI(l,h){var m=h.length;if(!m)return l;var w=m-1;return h[w]=(m>1?"& ":"")+h[w],h=h.join(m>2?", ":" "),l.replace(H,`{
/* [wrapped with `+h+`] */
`)}function dI(l){return Et(l)||tl(l)||!!(gv&&l&&l[gv])}function Zs(l,h){var m=typeof l;return h=h==null?pe:h,!!h&&(m=="number"||m!="symbol"&&gn.test(l))&&l>-1&&l%1==0&&l<h}function Ar(l,h,m){if(!bn(m))return!1;var w=typeof h;return(w=="number"?jr(m)&&Zs(h,m.length):w=="string"&&h in m)?Ui(m[h],l):!1}function qv(l,h){if(Et(l))return!1;var m=typeof l;return m=="number"||m=="symbol"||m=="boolean"||l==null||ii(l)?!0:Ul.test(l)||!or.test(l)||h!=null&&l in sn(h)}function pI(l){var h=typeof l;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?l!=="__proto__":l===null}function Yv(l){var h=Xd(l),m=I[h];if(typeof m!="function"||!(h in Bt.prototype))return!1;if(l===m)return!0;var w=Wv(m);return!!w&&l===w[0]}function fI(l){return!!yf&&yf in l}var mI=zc?Ks:hg;function Ou(l){var h=l&&l.constructor,m=typeof h=="function"&&h.prototype||_a;return l===m}function y1(l){return l===l&&!bn(l)}function x1(l,h){return function(m){return m==null?!1:m[l]===h&&(h!==t||l in sn(m))}}function vI(l){var h=Qd(l,function(w){return m.size===u&&m.clear(),w}),m=h.cache;return h}function gI(l,h){var m=l[1],w=h[1],R=m|w,V=R<(_|S|j),G=w==j&&m==A||w==j&&m==T&&l[7].length<=h[8]||w==(j|T)&&h[7].length<=h[8]&&m==A;if(!(V||G))return l;w&_&&(l[2]=h[2],R|=m&_?0:C);var J=h[3];if(J){var ie=l[3];l[3]=ie?n1(ie,J,h[4]):J,l[4]=ie?Xs(l[3],d):h[4]}return J=h[5],J&&(ie=l[5],l[5]=ie?r1(ie,J,h[6]):J,l[6]=ie?Xs(l[5],d):h[6]),J=h[7],J&&(l[7]=J),w&j&&(l[8]=l[8]==null?h[8]:ar(l[8],h[8])),l[9]==null&&(l[9]=h[9]),l[0]=h[0],l[1]=R,l}function _I(l){var h=[];if(l!=null)for(var m in sn(l))h.push(m);return h}function yI(l){return Vc.call(l)}function b1(l,h,m){return h=kn(h===t?l.length-1:h,0),function(){for(var w=arguments,R=-1,V=kn(w.length-h,0),G=_e(V);++R<V;)G[R]=w[h+R];R=-1;for(var J=_e(h+1);++R<h;)J[R]=w[R];return J[h]=m(G),Jn(l,this,J)}}function w1(l,h){return h.length<2?l:Jo(l,Pe(h,0,-1))}function xI(l,h){for(var m=l.length,w=ar(h.length,m),R=Ur(l);w--;){var V=h[w];l[w]=Zs(V,m)?R[V]:t}return l}function Zv(l,h){if(!(h==="constructor"&&typeof l[h]=="function")&&h!="__proto__")return l[h]}var S1=C1(b),Lu=aw||function(l,h){return ln.setTimeout(l,h)},Kv=C1(L);function M1(l,h,m){var w=h+"";return Kv(l,hI(w,bI(lI(w),m)))}function C1(l){var h=0,m=0;return function(){var w=yv(),R=ce-(w-m);if(m=w,R>0){if(++h>=xe)return arguments[0]}else h=0;return l.apply(t,arguments)}}function Yd(l,h){var m=-1,w=l.length,R=w-1;for(h=h===t?w:h;++m<h;){var V=Fd(m,R),G=l[V];l[V]=l[m],l[m]=G}return l.length=h,l}var E1=vI(function(l){var h=[];return l.charCodeAt(0)===46&&h.push(""),l.replace(Vo,function(m,w,R,V){h.push(R?V.replace(lt,"$1"):w||m)}),h});function ys(l){if(typeof l=="string"||ii(l))return l;var h=l+"";return h=="0"&&1/l==-Se?"-0":h}function el(l){if(l!=null){try{return Bc.call(l)}catch{}try{return l+""}catch{}}return""}function bI(l,h){return vr(Ze,function(m){var w="_."+m[0];h&m[1]&&!Ha(l,w)&&l.push(w)}),l.sort()}function A1(l){if(l instanceof Bt)return l.clone();var h=new ri(l.__wrapped__,l.__chain__);return h.__actions__=Ur(l.__actions__),h.__index__=l.__index__,h.__values__=l.__values__,h}function wI(l,h,m){(m?Ar(l,h,m):h===t)?h=1:h=kn(Tt(h),0);var w=l==null?0:l.length;if(!w||h<1)return[];for(var R=0,V=0,G=_e(wl(w/h));R<w;)G[V++]=Pe(l,R,R+=h);return G}function SI(l){for(var h=-1,m=l==null?0:l.length,w=0,R=[];++h<m;){var V=l[h];V&&(R[w++]=V)}return R}function MI(){var l=arguments.length;if(!l)return[];for(var h=_e(l-1),m=arguments[0],w=l;w--;)h[w-1]=arguments[w];return ni(Et(m)?Ur(m):[m],Qn(h,1))}var CI=Rt(function(l,h){return En(l)?Jl(l,Qn(h,1,En,!0)):[]}),EI=Rt(function(l,h){var m=wi(h);return En(m)&&(m=t),En(l)?Jl(l,Qn(h,1,En,!0),ft(m,2)):[]}),AI=Rt(function(l,h){var m=wi(h);return En(m)&&(m=t),En(l)?Jl(l,Qn(h,1,En,!0),t,m):[]});function PI(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),Pe(l,h<0?0:h,w)):[]}function TI(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),h=w-h,Pe(l,0,h<0?0:h)):[]}function RI(l,h){return l&&l.length?Tu(l,ft(h,3),!0,!0):[]}function OI(l,h){return l&&l.length?Tu(l,ft(h,3),!0):[]}function LI(l,h,m,w){var R=l==null?0:l.length;return R?(m&&typeof m!="number"&&Ar(l,h,m)&&(m=0,w=R),Vw(l,h,m,w)):[]}function P1(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=m==null?0:Tt(m);return R<0&&(R=kn(w+R,0)),Nc(l,ft(h,3),R)}function T1(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=w-1;return m!==t&&(R=Tt(m),R=m<0?kn(w+R,0):ar(R,w-1)),Nc(l,ft(h,3),R,!0)}function R1(l){var h=l==null?0:l.length;return h?Qn(l,1):[]}function DI(l){var h=l==null?0:l.length;return h?Qn(l,Se):[]}function II(l,h){var m=l==null?0:l.length;return m?(h=h===t?1:Tt(h),Qn(l,h)):[]}function NI(l){for(var h=-1,m=l==null?0:l.length,w={};++h<m;){var R=l[h];w[R[0]]=R[1]}return w}function O1(l){return l&&l.length?l[0]:t}function kI(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=m==null?0:Tt(m);return R<0&&(R=kn(w+R,0)),fi(l,h,R)}function zI(l){var h=l==null?0:l.length;return h?Pe(l,0,-1):[]}var BI=Rt(function(l){var h=cn(l,zv);return h.length&&h[0]===l[0]?Pu(h):[]}),VI=Rt(function(l){var h=wi(l),m=cn(l,zv);return h===wi(m)?h=t:m.pop(),m.length&&m[0]===l[0]?Pu(m,ft(h,2)):[]}),FI=Rt(function(l){var h=wi(l),m=cn(l,zv);return h=typeof h=="function"?h:t,h&&m.pop(),m.length&&m[0]===l[0]?Pu(m,t,h):[]});function UI(l,h){return l==null?"":cw.call(l,h)}function wi(l){var h=l==null?0:l.length;return h?l[h-1]:t}function jI(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=w;return m!==t&&(R=Tt(m),R=R<0?kn(w+R,0):ar(R,w-1)),h===h?ew(l,h,R):Nc(l,yu,R,!0)}function HI(l,h){return l&&l.length?Ef(l,Tt(h)):t}var WI=Rt(L1);function L1(l,h){return l&&l.length&&h&&h.length?Vd(l,h):l}function GI(l,h,m){return l&&l.length&&h&&h.length?Vd(l,h,ft(m,2)):l}function XI(l,h,m){return l&&l.length&&h&&h.length?Vd(l,h,t,m):l}var qI=Ys(function(l,h){var m=l==null?0:l.length,w=Zo(l,h);return Nv(l,cn(h,function(R){return Zs(R,m)?+R:R}).sort(t1)),w});function YI(l,h){var m=[];if(!(l&&l.length))return m;var w=-1,R=[],V=l.length;for(h=ft(h,3);++w<V;){var G=l[w];h(G,w,l)&&(m.push(G),R.push(w))}return Nv(l,R),m}function Jv(l){return l==null?l:uw.call(l)}function ZI(l,h,m){var w=l==null?0:l.length;return w?(m&&typeof m!="number"&&Ar(l,h,m)?(h=0,m=w):(h=h==null?0:Tt(h),m=m===t?w:Tt(m)),Pe(l,h,m)):[]}function KI(l,h){return _t(l,h)}function JI(l,h,m){return Kt(l,h,ft(m,2))}function QI(l,h){var m=l==null?0:l.length;if(m){var w=_t(l,h);if(w<m&&Ui(l[w],h))return w}return-1}function $I(l,h){return _t(l,h,!0)}function eN(l,h,m){return Kt(l,h,ft(m,2),!0)}function tN(l,h){var m=l==null?0:l.length;if(m){var w=_t(l,h,!0)-1;if(Ui(l[w],h))return w}return-1}function nN(l){return l&&l.length?fn(l):[]}function rN(l,h){return l&&l.length?fn(l,ft(h,2)):[]}function iN(l){var h=l==null?0:l.length;return h?Pe(l,1,h):[]}function sN(l,h,m){return l&&l.length?(h=m||h===t?1:Tt(h),Pe(l,0,h<0?0:h)):[]}function oN(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),h=w-h,Pe(l,h<0?0:h,w)):[]}function aN(l,h){return l&&l.length?Tu(l,ft(h,3),!1,!0):[]}function lN(l,h){return l&&l.length?Tu(l,ft(h,3)):[]}var cN=Rt(function(l){return vi(Qn(l,1,En,!0))}),uN=Rt(function(l){var h=wi(l);return En(h)&&(h=t),vi(Qn(l,1,En,!0),ft(h,2))}),hN=Rt(function(l){var h=wi(l);return h=typeof h=="function"?h:t,vi(Qn(l,1,En,!0),t,h)});function dN(l){return l&&l.length?vi(l):[]}function pN(l,h){return l&&l.length?vi(l,ft(h,2)):[]}function fN(l,h){return h=typeof h=="function"?h:t,l&&l.length?vi(l,t,h):[]}function Qv(l){if(!(l&&l.length))return[];var h=0;return l=Gs(l,function(m){if(En(m))return h=kn(m.length,h),!0}),Gl(h,function(m){return cn(l,wd(m))})}function D1(l,h){if(!(l&&l.length))return[];var m=Qv(l);return h==null?m:cn(m,function(w){return Jn(h,t,w)})}var mN=Rt(function(l,h){return En(l)?Jl(l,h):[]}),vN=Rt(function(l){return kv(Gs(l,En))}),gN=Rt(function(l){var h=wi(l);return En(h)&&(h=t),kv(Gs(l,En),ft(h,2))}),_N=Rt(function(l){var h=wi(l);return h=typeof h=="function"?h:t,kv(Gs(l,En),t,h)}),yN=Rt(Qv);function xN(l,h){return Jw(l||[],h||[],Kl)}function bN(l,h){return Jw(l||[],h||[],g)}var wN=Rt(function(l){var h=l.length,m=h>1?l[h-1]:t;return m=typeof m=="function"?(l.pop(),m):t,D1(l,m)});function I1(l){var h=I(l);return h.__chain__=!0,h}function SN(l,h){return h(l),l}function Zd(l,h){return h(l)}var MN=Ys(function(l){var h=l.length,m=h?l[0]:0,w=this.__wrapped__,R=function(V){return Zo(V,l)};return h>1||this.__actions__.length||!(w instanceof Bt)||!Zs(m)?this.thru(R):(w=w.slice(m,+m+(h?1:0)),w.__actions__.push({func:Zd,args:[R],thisArg:t}),new ri(w,this.__chain__).thru(function(V){return h&&!V.length&&V.push(t),V}))});function CN(){return I1(this)}function EN(){return new ri(this.value(),this.__chain__)}function AN(){this.__values__===t&&(this.__values__=Y1(this.value()));var l=this.__index__>=this.__values__.length,h=l?t:this.__values__[this.__index__++];return{done:l,value:h}}function PN(){return this}function TN(l){for(var h,m=this;m instanceof Zl;){var w=A1(m);w.__index__=0,w.__values__=t,h?R.__wrapped__=w:h=w;var R=w;m=m.__wrapped__}return R.__wrapped__=l,h}function RN(){var l=this.__wrapped__;if(l instanceof Bt){var h=l;return this.__actions__.length&&(h=new Bt(this)),h=h.reverse(),h.__actions__.push({func:Zd,args:[Jv],thisArg:t}),new ri(h,this.__chain__)}return this.thru(Jv)}function ON(){return Kw(this.__wrapped__,this.__actions__)}var LN=Ud(function(l,h,m){Yt.call(l,m)?++l[m]:gs(l,m,1)});function DN(l,h,m){var w=Et(l)?pv:Bw;return m&&Ar(l,h,m)&&(h=t),w(l,ft(h,3))}function IN(l,h){var m=Et(l)?Gs:Od;return m(l,ft(h,3))}var NN=a1(P1),kN=a1(T1);function zN(l,h){return Qn(Kd(l,h),1)}function BN(l,h){return Qn(Kd(l,h),Se)}function VN(l,h,m){return m=m===t?1:Tt(m),Qn(Kd(l,h),m)}function N1(l,h){var m=Et(l)?vr:Di;return m(l,ft(h,3))}function k1(l,h){var m=Et(l)?qb:Mf;return m(l,ft(h,3))}var FN=Ud(function(l,h,m){Yt.call(l,m)?l[m].push(h):gs(l,m,[h])});function UN(l,h,m,w){l=jr(l)?l:ic(l),m=m&&!w?Tt(m):0;var R=l.length;return m<0&&(m=kn(R+m,0)),tp(l)?m<=R&&l.indexOf(h,m)>-1:!!R&&fi(l,h,m)>-1}var jN=Rt(function(l,h,m){var w=-1,R=typeof h=="function",V=jr(l)?_e(l.length):[];return Di(l,function(G){V[++w]=R?Jn(h,G,m):Ql(G,h,m)}),V}),HN=Ud(function(l,h,m){gs(l,m,h)});function Kd(l,h){var m=Et(l)?cn:Rv;return m(l,ft(h,3))}function WN(l,h,m,w){return l==null?[]:(Et(h)||(h=h==null?[]:[h]),m=w?t:m,Et(m)||(m=m==null?[]:[m]),Dv(l,h,m))}var GN=Ud(function(l,h,m){l[m?0:1].push(h)},function(){return[[],[]]});function XN(l,h,m){var w=Et(l)?xd:Md,R=arguments.length<3;return w(l,ft(h,4),m,R,Di)}function qN(l,h,m){var w=Et(l)?K0:Md,R=arguments.length<3;return w(l,ft(h,4),m,R,Mf)}function YN(l,h){var m=Et(l)?Gs:Od;return m(l,$d(ft(h,3)))}function ZN(l){var h=Et(l)?wf:Zw;return h(l)}function KN(l,h,m){(m?Ar(l,h,m):h===t)?h=1:h=Tt(h);var w=Et(l)?yh:M;return w(l,h)}function JN(l){var h=Et(l)?Iw:Q;return h(l)}function QN(l){if(l==null)return 0;if(jr(l))return tp(l)?qa(l):l.length;var h=_r(l);return h==ve||h==W?l.size:zd(l).length}function $N(l,h,m){var w=Et(l)?gu:Ye;return m&&Ar(l,h,m)&&(h=t),w(l,ft(h,3))}var ek=Rt(function(l,h){if(l==null)return[];var m=h.length;return m>1&&Ar(l,h[0],h[1])?h=[]:m>2&&Ar(h[0],h[1],h[2])&&(h=[h[0]]),Dv(l,Qn(h,1),[])}),Jd=r_||function(){return ln.Date.now()};function tk(l,h){if(typeof h!="function")throw new Yr(o);return l=Tt(l),function(){if(--l<1)return h.apply(this,arguments)}}function z1(l,h,m){return h=m?t:h,h=l&&h==null?l.length:h,qs(l,j,t,t,t,t,h)}function B1(l,h){var m;if(typeof h!="function")throw new Yr(o);return l=Tt(l),function(){return--l>0&&(m=h.apply(this,arguments)),l<=1&&(h=t),m}}var $v=Rt(function(l,h,m){var w=_;if(m.length){var R=Xs(m,nc($v));w|=D}return qs(l,w,h,m,R)}),V1=Rt(function(l,h,m){var w=_|S;if(m.length){var R=Xs(m,nc(V1));w|=D}return qs(h,w,l,m,R)});function F1(l,h,m){h=m?t:h;var w=qs(l,A,t,t,t,t,t,h);return w.placeholder=F1.placeholder,w}function U1(l,h,m){h=m?t:h;var w=qs(l,P,t,t,t,t,t,h);return w.placeholder=U1.placeholder,w}function j1(l,h,m){var w,R,V,G,J,ie,Ie=0,Ne=!1,Be=!1,et=!0;if(typeof l!="function")throw new Yr(o);h=Si(h)||0,bn(m)&&(Ne=!!m.leading,Be="maxWait"in m,V=Be?kn(Si(m.maxWait)||0,h):V,et="trailing"in m?!!m.trailing:et);function ct(An){var ji=w,Qs=R;return w=R=t,Ie=An,G=l.apply(Qs,ji),G}function mt(An){return Ie=An,J=Lu(Vt,h),Ne?ct(An):G}function Ot(An){var ji=An-ie,Qs=An-Ie,aS=h-ji;return Be?ar(aS,V-Qs):aS}function vt(An){var ji=An-ie,Qs=An-Ie;return ie===t||ji>=h||ji<0||Be&&Qs>=V}function Vt(){var An=Jd();if(vt(An))return Ht(An);J=Lu(Vt,Ot(An))}function Ht(An){return J=t,et&&w?ct(An):(w=R=t,G)}function si(){J!==t&&Qw(J),Ie=0,w=ie=R=J=t}function Pr(){return J===t?G:Ht(Jd())}function oi(){var An=Jd(),ji=vt(An);if(w=arguments,R=this,ie=An,ji){if(J===t)return mt(ie);if(Be)return Qw(J),J=Lu(Vt,h),ct(ie)}return J===t&&(J=Lu(Vt,h)),G}return oi.cancel=si,oi.flush=Pr,oi}var nk=Rt(function(l,h){return Cv(l,1,h)}),rk=Rt(function(l,h,m){return Cv(l,Si(h)||0,m)});function ik(l){return qs(l,k)}function Qd(l,h){if(typeof l!="function"||h!=null&&typeof h!="function")throw new Yr(o);var m=function(){var w=arguments,R=h?h.apply(this,w):w[0],V=m.cache;if(V.has(R))return V.get(R);var G=l.apply(this,w);return m.cache=V.set(R,G)||V,G};return m.cache=new(Qd.Cache||vs),m}Qd.Cache=vs;function $d(l){if(typeof l!="function")throw new Yr(o);return function(){var h=arguments;switch(h.length){case 0:return!l.call(this);case 1:return!l.call(this,h[0]);case 2:return!l.call(this,h[0],h[1]);case 3:return!l.call(this,h[0],h[1],h[2])}return!l.apply(this,h)}}function sk(l){return B1(2,l)}var ok=X4(function(l,h){h=h.length==1&&Et(h[0])?cn(h[0],ir(ft())):cn(Qn(h,1),ir(ft()));var m=h.length;return Rt(function(w){for(var R=-1,V=ar(w.length,m);++R<V;)w[R]=h[R].call(this,w[R]);return Jn(l,this,w)})}),eg=Rt(function(l,h){var m=Xs(h,nc(eg));return qs(l,D,t,h,m)}),H1=Rt(function(l,h){var m=Xs(h,nc(H1));return qs(l,N,t,h,m)}),ak=Ys(function(l,h){return qs(l,T,t,t,t,h)});function lk(l,h){if(typeof l!="function")throw new Yr(o);return h=h===t?h:Tt(h),Rt(l,h)}function ck(l,h){if(typeof l!="function")throw new Yr(o);return h=h==null?0:kn(Tt(h),0),Rt(function(m){var w=m[h],R=$o(m,0,h);return w&&ni(R,w),Jn(l,this,R)})}function uk(l,h,m){var w=!0,R=!0;if(typeof l!="function")throw new Yr(o);return bn(m)&&(w="leading"in m?!!m.leading:w,R="trailing"in m?!!m.trailing:R),j1(l,h,{leading:w,maxWait:h,trailing:R})}function hk(l){return z1(l,1)}function dk(l,h){return eg(Bv(h),l)}function pk(){if(!arguments.length)return[];var l=arguments[0];return Et(l)?l:[l]}function fk(l){return Zr(l,v)}function mk(l,h){return h=typeof h=="function"?h:t,Zr(l,v,h)}function vk(l){return Zr(l,p|v)}function gk(l,h){return h=typeof h=="function"?h:t,Zr(l,p|v,h)}function _k(l,h){return h==null||Sf(l,h,$n(h))}function Ui(l,h){return l===h||l!==l&&h!==h}var yk=Gd(Dd),xk=Gd(function(l,h){return l>=h}),tl=Nd(function(){return arguments}())?Nd:function(l){return Cn(l)&&Yt.call(l,"callee")&&!Ed.call(l,"callee")},Et=_e.isArray,bk=ur?ir(ur):Uw;function jr(l){return l!=null&&ep(l.length)&&!Ks(l)}function En(l){return Cn(l)&&jr(l)}function wk(l){return l===!0||l===!1||Cn(l)&&gr(l)==rt}var ea=lw||hg,Sk=ti?ir(ti):Xc;function Mk(l){return Cn(l)&&l.nodeType===1&&!Du(l)}function Ck(l){if(l==null)return!0;if(jr(l)&&(Et(l)||typeof l=="string"||typeof l.splice=="function"||ea(l)||rc(l)||tl(l)))return!l.length;var h=_r(l);if(h==ve||h==W)return!l.size;if(Ou(l))return!zd(l).length;for(var m in l)if(Yt.call(l,m))return!1;return!0}function Ek(l,h){return $l(l,h)}function Ak(l,h,m){m=typeof m=="function"?m:t;var w=m?m(l,h):t;return w===t?$l(l,h,t,m):!!w}function tg(l){if(!Cn(l))return!1;var h=gr(l);return h==Qe||h==Ke||typeof l.message=="string"&&typeof l.name=="string"&&!Du(l)}function Pk(l){return typeof l=="number"&&bf(l)}function Ks(l){if(!bn(l))return!1;var h=gr(l);return h==Y||h==K||h==Mt||h==He}function W1(l){return typeof l=="number"&&l==Tt(l)}function ep(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=pe}function bn(l){var h=typeof l;return l!=null&&(h=="object"||h=="function")}function Cn(l){return l!=null&&typeof l=="object"}var G1=vu?ir(vu):Av;function Tk(l,h){return l===h||kd(l,h,Gv(h))}function Rk(l,h,m){return m=typeof m=="function"?m:t,kd(l,h,Gv(h),m)}function Ok(l){return X1(l)&&l!=+l}function Lk(l){if(mI(l))throw new St(s);return Pv(l)}function Dk(l){return l===null}function Ik(l){return l==null}function X1(l){return typeof l=="number"||Cn(l)&&gr(l)==Ae}function Du(l){if(!Cn(l)||gr(l)!=je)return!1;var h=wu(l);if(h===null)return!0;var m=Yt.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&Bc.call(m)==sw}var ng=mr?ir(mr):u_;function Nk(l){return W1(l)&&l>=-pe&&l<=pe}var q1=Ic?ir(Ic):Hw;function tp(l){return typeof l=="string"||!Et(l)&&Cn(l)&&gr(l)==O}function ii(l){return typeof l=="symbol"||Cn(l)&&gr(l)==E}var rc=yo?ir(yo):Ww;function kk(l){return l===t}function zk(l){return Cn(l)&&_r(l)==z}function Bk(l){return Cn(l)&&gr(l)==Z}var Vk=Gd(Bd),Fk=Gd(function(l,h){return l<=h});function Y1(l){if(!l)return[];if(jr(l))return tp(l)?Er(l):Ur(l);if(Ya&&l[Ya])return Qb(l[Ya]());var h=_r(l),m=h==ve?Xa:h==W?bu:ic;return m(l)}function Js(l){if(!l)return l===0?l:0;if(l=Si(l),l===Se||l===-Se){var h=l<0?-1:1;return h*se}return l===l?l:0}function Tt(l){var h=Js(l),m=h%1;return h===h?m?h-m:h:0}function Z1(l){return l?Ko(Tt(l),0,Le):0}function Si(l){if(typeof l=="number")return l;if(ii(l))return ae;if(bn(l)){var h=typeof l.valueOf=="function"?l.valueOf():l;l=bn(h)?h+"":h}if(typeof l!="string")return l===0?l:+l;l=ff(l);var m=Zt.test(l);return m||It.test(l)?Xn(l.slice(2),m?2:8):wt.test(l)?ae:+l}function K1(l){return _s(l,Hr(l))}function Uk(l){return l?Ko(Tt(l),-pe,pe):l===0?l:0}function Jt(l){return l==null?"":an(l)}var jk=ec(function(l,h){if(Ou(h)||jr(h)){_s(h,$n(h),l);return}for(var m in h)Yt.call(h,m)&&Kl(l,m,h[m])}),J1=ec(function(l,h){_s(h,Hr(h),l)}),np=ec(function(l,h,m,w){_s(h,Hr(h),l,w)}),Hk=ec(function(l,h,m,w){_s(h,$n(h),l,w)}),Wk=Ys(Zo);function Gk(l,h){var m=Ja(l);return h==null?m:Mv(m,h)}var Xk=Rt(function(l,h){l=sn(l);var m=-1,w=h.length,R=w>2?h[2]:t;for(R&&Ar(h[0],h[1],R)&&(w=1);++m<w;)for(var V=h[m],G=Hr(V),J=-1,ie=G.length;++J<ie;){var Ie=G[J],Ne=l[Ie];(Ne===t||Ui(Ne,_a[Ie])&&!Yt.call(l,Ie))&&(l[Ie]=V[Ie])}return l}),qk=Rt(function(l){return l.push(t,f1),Jn(Q1,t,l)});function Yk(l,h){return bi(l,ft(h,3),Fi)}function Zk(l,h){return bi(l,ft(h,3),Ld)}function Kk(l,h){return l==null?l:Cl(l,ft(h,3),Hr)}function Jk(l,h){return l==null?l:Cf(l,ft(h,3),Hr)}function Qk(l,h){return l&&Fi(l,ft(h,3))}function $k(l,h){return l&&Ld(l,ft(h,3))}function ez(l){return l==null?[]:Au(l,$n(l))}function tz(l){return l==null?[]:Au(l,Hr(l))}function rg(l,h,m){var w=l==null?t:Jo(l,h);return w===t?m:w}function nz(l,h){return l!=null&&g1(l,h,Id)}function ig(l,h){return l!=null&&g1(l,h,l_)}var rz=c1(function(l,h,m){h!=null&&typeof h.toString!="function"&&(h=Vc.call(h)),l[h]=m},og(Wr)),iz=c1(function(l,h,m){h!=null&&typeof h.toString!="function"&&(h=Vc.call(h)),Yt.call(l,h)?l[h].push(m):l[h]=[m]},ft),sz=Rt(Ql);function $n(l){return jr(l)?Ml(l):zd(l)}function Hr(l){return jr(l)?Ml(l,!0):Gw(l)}function oz(l,h){var m={};return h=ft(h,3),Fi(l,function(w,R,V){gs(m,h(w,R,V),w)}),m}function az(l,h){var m={};return h=ft(h,3),Fi(l,function(w,R,V){gs(m,R,h(w,R,V))}),m}var lz=ec(function(l,h,m){qc(l,h,m)}),Q1=ec(function(l,h,m,w){qc(l,h,m,w)}),cz=Ys(function(l,h){var m={};if(l==null)return m;var w=!1;h=cn(h,function(V){return V=Qo(V,l),w||(w=V.length>1),V}),_s(l,Hv(l),m),w&&(m=Zr(m,p|f|v,rI));for(var R=h.length;R--;)Qa(m,h[R]);return m});function uz(l,h){return $1(l,$d(ft(h)))}var hz=Ys(function(l,h){return l==null?{}:Xw(l,h)});function $1(l,h){if(l==null)return{};var m=cn(Hv(l),function(w){return[w]});return h=ft(h),Iv(l,m,function(w,R){return h(w,R[0])})}function dz(l,h,m){h=Qo(h,l);var w=-1,R=h.length;for(R||(R=1,l=t);++w<R;){var V=l==null?t:l[ys(h[w])];V===t&&(w=R,V=m),l=Ks(V)?V.call(l):V}return l}function pz(l,h,m){return l==null?l:g(l,h,m)}function fz(l,h,m,w){return w=typeof w=="function"?w:t,l==null?l:g(l,h,m,w)}var eS=d1($n),tS=d1(Hr);function mz(l,h,m){var w=Et(l),R=w||ea(l)||rc(l);if(h=ft(h,4),m==null){var V=l&&l.constructor;R?m=w?new V:[]:bn(l)?m=Ks(V)?Ja(wu(l)):{}:m={}}return(R?vr:Fi)(l,function(G,J,ie){return h(m,G,J,ie)}),m}function vz(l,h){return l==null?!0:Qa(l,h)}function gz(l,h,m){return l==null?l:Yc(l,h,Bv(m))}function _z(l,h,m,w){return w=typeof w=="function"?w:t,l==null?l:Yc(l,h,Bv(m),w)}function ic(l){return l==null?[]:vh(l,$n(l))}function yz(l){return l==null?[]:vh(l,Hr(l))}function xz(l,h,m){return m===t&&(m=h,h=t),m!==t&&(m=Si(m),m=m===m?m:0),h!==t&&(h=Si(h),h=h===h?h:0),Ko(Si(l),h,m)}function bz(l,h,m){return h=Js(h),m===t?(m=h,h=0):m=Js(m),l=Si(l),Fw(l,h,m)}function wz(l,h,m){if(m&&typeof m!="boolean"&&Ar(l,h,m)&&(h=m=t),m===t&&(typeof h=="boolean"?(m=h,h=t):typeof l=="boolean"&&(m=l,l=t)),l===t&&h===t?(l=0,h=1):(l=Js(l),h===t?(h=l,l=0):h=Js(h)),l>h){var w=l;l=h,h=w}if(m||l%1||h%1){var R=xv();return ar(l+R*(h-l+wn("1e-"+((R+"").length-1))),h)}return Fd(l,h)}var Sz=tc(function(l,h,m){return h=h.toLowerCase(),l+(m?nS(h):h)});function nS(l){return sg(Jt(l).toLowerCase())}function rS(l){return l=Jt(l),l&&l.replace(Bi,gh).replace(q,"")}function Mz(l,h,m){l=Jt(l),h=an(h);var w=l.length;m=m===t?w:Ko(Tt(m),0,w);var R=m;return m-=h.length,m>=0&&l.slice(m,R)==h}function Cz(l){return l=Jt(l),l&&hn.test(l)?l.replace(Ft,_h):l}function Ez(l){return l=Jt(l),l&&Lc.test(l)?l.replace(Fo,"\\$&"):l}var Az=tc(function(l,h,m){return l+(m?"-":"")+h.toLowerCase()}),Pz=tc(function(l,h,m){return l+(m?" ":"")+h.toLowerCase()}),Tz=o1("toLowerCase");function Rz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;if(!h||w>=h)return l;var R=(h-w)/2;return Wd(Su(R),m)+l+Wd(wl(R),m)}function Oz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;return h&&w<h?l+Wd(h-w,m):l}function Lz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;return h&&w<h?Wd(h-w,m)+l:l}function Dz(l,h,m){return m||h==null?h=0:h&&(h=+h),Pd(Jt(l).replace(va,""),h||0)}function Iz(l,h,m){return(m?Ar(l,h,m):h===t)?h=1:h=Tt(h),xh(Jt(l),h)}function Nz(){var l=arguments,h=Jt(l[0]);return l.length<3?h:h.replace(l[1],l[2])}var kz=tc(function(l,h,m){return l+(m?"_":"")+h.toLowerCase()});function zz(l,h,m){return m&&typeof m!="number"&&Ar(l,h,m)&&(h=m=t),m=m===t?Le:m>>>0,m?(l=Jt(l),l&&(typeof h=="string"||h!=null&&!ng(h))&&(h=an(h),!h&&Ga(l))?$o(Er(l),0,m):l.split(h,m)):[]}var Bz=tc(function(l,h,m){return l+(m?" ":"")+sg(h)});function Vz(l,h,m){return l=Jt(l),m=m==null?0:Ko(Tt(m),0,l.length),h=an(h),l.slice(m,m+h.length)==h}function Fz(l,h,m){var w=I.templateSettings;m&&Ar(l,h,m)&&(h=t),l=Jt(l),h=np({},h,w,p1);var R=np({},h.imports,w.imports,p1),V=$n(R),G=vh(R,V),J,ie,Ie=0,Ne=h.interpolate||Mr,Be="__p += '",et=Ls((h.escape||Mr).source+"|"+Ne.source+"|"+(Ne===xr?xt:Mr).source+"|"+(h.evaluate||Mr).source+"|$","g"),ct="//# sourceURL="+(Yt.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++In+"]")+`
`;l.replace(et,function(vt,Vt,Ht,si,Pr,oi){return Ht||(Ht=si),Be+=l.slice(Ie,oi).replace(Ln,vf),Vt&&(J=!0,Be+=`' +
__e(`+Vt+`) +
'`),Pr&&(ie=!0,Be+=`';
`+Pr+`;
__p += '`),Ht&&(Be+=`' +
((__t = (`+Ht+`)) == null ? '' : __t) +
'`),Ie=oi+vt.length,vt}),Be+=`';
`;var mt=Yt.call(h,"variable")&&h.variable;if(!mt)Be=`with (obj) {
`+Be+`
}
`;else if(Oe.test(mt))throw new St(a);Be=(ie?Be.replace($e,""):Be).replace(Me,"$1").replace(tt,"$1;"),Be="function("+(mt||"obj")+`) {
`+(mt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(J?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Be+`return __p
}`;var Ot=sS(function(){return jt(V,ct+"return "+Be).apply(t,G)});if(Ot.source=Be,tg(Ot))throw Ot;return Ot}function Uz(l){return Jt(l).toLowerCase()}function jz(l){return Jt(l).toUpperCase()}function Hz(l,h,m){if(l=Jt(l),l&&(m||h===t))return ff(l);if(!l||!(h=an(h)))return l;var w=Er(l),R=Er(h),V=Cd(w,R),G=fv(w,R)+1;return $o(w,V,G).join("")}function Wz(l,h,m){if(l=Jt(l),l&&(m||h===t))return l.slice(0,gf(l)+1);if(!l||!(h=an(h)))return l;var w=Er(l),R=fv(w,Er(h))+1;return $o(w,0,R).join("")}function Gz(l,h,m){if(l=Jt(l),l&&(m||h===t))return l.replace(va,"");if(!l||!(h=an(h)))return l;var w=Er(l),R=Cd(w,Er(h));return $o(w,R).join("")}function Xz(l,h){var m=U,w=ee;if(bn(h)){var R="separator"in h?h.separator:R;m="length"in h?Tt(h.length):m,w="omission"in h?an(h.omission):w}l=Jt(l);var V=l.length;if(Ga(l)){var G=Er(l);V=G.length}if(m>=V)return l;var J=m-qa(w);if(J<1)return w;var ie=G?$o(G,0,J).join(""):l.slice(0,J);if(R===t)return ie+w;if(G&&(J+=ie.length-J),ng(R)){if(l.slice(J).search(R)){var Ie,Ne=ie;for(R.global||(R=Ls(R.source,Jt(bt.exec(R))+"g")),R.lastIndex=0;Ie=R.exec(Ne);)var Be=Ie.index;ie=ie.slice(0,Be===t?J:Be)}}else if(l.indexOf(an(R),J)!=J){var et=ie.lastIndexOf(R);et>-1&&(ie=ie.slice(0,et))}return ie+w}function qz(l){return l=Jt(l),l&&vn.test(l)?l.replace(Je,tw):l}var Yz=tc(function(l,h,m){return l+(m?" ":"")+h.toUpperCase()}),sg=o1("toUpperCase");function iS(l,h,m){return l=Jt(l),h=m?t:h,h===t?Jb(l)?$0(l):J0(l):l.match(h)||[]}var sS=Rt(function(l,h){try{return Jn(l,t,h)}catch(m){return tg(m)?m:new St(m)}}),Zz=Ys(function(l,h){return vr(h,function(m){m=ys(m),gs(l,m,$v(l[m],l))}),l});function Kz(l){var h=l==null?0:l.length,m=ft();return l=h?cn(l,function(w){if(typeof w[1]!="function")throw new Yr(o);return[m(w[0]),w[1]]}):[],Rt(function(w){for(var R=-1;++R<h;){var V=l[R];if(Jn(V[0],this,w))return Jn(V[1],this,w)}})}function Jz(l){return zw(Zr(l,p))}function og(l){return function(){return l}}function Qz(l,h){return l==null||l!==l?h:l}var $z=l1(),eB=l1(!0);function Wr(l){return l}function ag(l){return Tv(typeof l=="function"?l:Zr(l,p))}function tB(l){return Ov(Zr(l,p))}function nB(l,h){return Lv(l,Zr(h,p))}var rB=Rt(function(l,h){return function(m){return Ql(m,l,h)}}),iB=Rt(function(l,h){return function(m){return Ql(l,m,h)}});function lg(l,h,m){var w=$n(h),R=Au(h,w);m==null&&!(bn(h)&&(R.length||!w.length))&&(m=h,h=l,l=this,R=Au(h,$n(h)));var V=!(bn(m)&&"chain"in m)||!!m.chain,G=Ks(l);return vr(R,function(J){var ie=h[J];l[J]=ie,G&&(l.prototype[J]=function(){var Ie=this.__chain__;if(V||Ie){var Ne=l(this.__wrapped__),Be=Ne.__actions__=Ur(this.__actions__);return Be.push({func:ie,args:arguments,thisArg:l}),Ne.__chain__=Ie,Ne}return ie.apply(l,ni([this.value()],arguments))})}),l}function sB(){return ln._===this&&(ln._=n_),this}function cg(){}function oB(l){return l=Tt(l),Rt(function(h){return Ef(h,l)})}var aB=Fv(cn),lB=Fv(pv),cB=Fv(gu);function oS(l){return qv(l)?wd(ys(l)):qw(l)}function uB(l){return function(h){return l==null?t:Jo(l,h)}}var hB=u1(),dB=u1(!0);function ug(){return[]}function hg(){return!1}function pB(){return{}}function fB(){return""}function mB(){return!0}function vB(l,h){if(l=Tt(l),l<1||l>pe)return[];var m=Le,w=ar(l,Le);h=ft(h),l-=Le;for(var R=Gl(w,h);++m<l;)h(m);return R}function gB(l){return Et(l)?cn(l,ys):ii(l)?[l]:Ur(E1(Jt(l)))}function _B(l){var h=++t_;return Jt(l)+h}var yB=Hd(function(l,h){return l+h},0),xB=Uv("ceil"),bB=Hd(function(l,h){return l/h},1),wB=Uv("floor");function SB(l){return l&&l.length?Eu(l,Wr,Dd):t}function MB(l,h){return l&&l.length?Eu(l,ft(h,2),Dd):t}function CB(l){return bd(l,Wr)}function EB(l,h){return bd(l,ft(h,2))}function AB(l){return l&&l.length?Eu(l,Wr,Bd):t}function PB(l,h){return l&&l.length?Eu(l,ft(h,2),Bd):t}var TB=Hd(function(l,h){return l*h},1),RB=Uv("round"),OB=Hd(function(l,h){return l-h},0);function LB(l){return l&&l.length?xu(l,Wr):0}function DB(l,h){return l&&l.length?xu(l,ft(h,2)):0}return I.after=tk,I.ary=z1,I.assign=jk,I.assignIn=J1,I.assignInWith=np,I.assignWith=Hk,I.at=Wk,I.before=B1,I.bind=$v,I.bindAll=Zz,I.bindKey=V1,I.castArray=pk,I.chain=I1,I.chunk=wI,I.compact=SI,I.concat=MI,I.cond=Kz,I.conforms=Jz,I.constant=og,I.countBy=LN,I.create=Gk,I.curry=F1,I.curryRight=U1,I.debounce=j1,I.defaults=Xk,I.defaultsDeep=qk,I.defer=nk,I.delay=rk,I.difference=CI,I.differenceBy=EI,I.differenceWith=AI,I.drop=PI,I.dropRight=TI,I.dropRightWhile=RI,I.dropWhile=OI,I.fill=LI,I.filter=IN,I.flatMap=zN,I.flatMapDeep=BN,I.flatMapDepth=VN,I.flatten=R1,I.flattenDeep=DI,I.flattenDepth=II,I.flip=ik,I.flow=$z,I.flowRight=eB,I.fromPairs=NI,I.functions=ez,I.functionsIn=tz,I.groupBy=FN,I.initial=zI,I.intersection=BI,I.intersectionBy=VI,I.intersectionWith=FI,I.invert=rz,I.invertBy=iz,I.invokeMap=jN,I.iteratee=ag,I.keyBy=HN,I.keys=$n,I.keysIn=Hr,I.map=Kd,I.mapKeys=oz,I.mapValues=az,I.matches=tB,I.matchesProperty=nB,I.memoize=Qd,I.merge=lz,I.mergeWith=Q1,I.method=rB,I.methodOf=iB,I.mixin=lg,I.negate=$d,I.nthArg=oB,I.omit=cz,I.omitBy=uz,I.once=sk,I.orderBy=WN,I.over=aB,I.overArgs=ok,I.overEvery=lB,I.overSome=cB,I.partial=eg,I.partialRight=H1,I.partition=GN,I.pick=hz,I.pickBy=$1,I.property=oS,I.propertyOf=uB,I.pull=WI,I.pullAll=L1,I.pullAllBy=GI,I.pullAllWith=XI,I.pullAt=qI,I.range=hB,I.rangeRight=dB,I.rearg=ak,I.reject=YN,I.remove=YI,I.rest=lk,I.reverse=Jv,I.sampleSize=KN,I.set=pz,I.setWith=fz,I.shuffle=JN,I.slice=ZI,I.sortBy=ek,I.sortedUniq=nN,I.sortedUniqBy=rN,I.split=zz,I.spread=ck,I.tail=iN,I.take=sN,I.takeRight=oN,I.takeRightWhile=aN,I.takeWhile=lN,I.tap=SN,I.throttle=uk,I.thru=Zd,I.toArray=Y1,I.toPairs=eS,I.toPairsIn=tS,I.toPath=gB,I.toPlainObject=K1,I.transform=mz,I.unary=hk,I.union=cN,I.unionBy=uN,I.unionWith=hN,I.uniq=dN,I.uniqBy=pN,I.uniqWith=fN,I.unset=vz,I.unzip=Qv,I.unzipWith=D1,I.update=gz,I.updateWith=_z,I.values=ic,I.valuesIn=yz,I.without=mN,I.words=iS,I.wrap=dk,I.xor=vN,I.xorBy=gN,I.xorWith=_N,I.zip=yN,I.zipObject=xN,I.zipObjectDeep=bN,I.zipWith=wN,I.entries=eS,I.entriesIn=tS,I.extend=J1,I.extendWith=np,lg(I,I),I.add=yB,I.attempt=sS,I.camelCase=Sz,I.capitalize=nS,I.ceil=xB,I.clamp=xz,I.clone=fk,I.cloneDeep=vk,I.cloneDeepWith=gk,I.cloneWith=mk,I.conformsTo=_k,I.deburr=rS,I.defaultTo=Qz,I.divide=bB,I.endsWith=Mz,I.eq=Ui,I.escape=Cz,I.escapeRegExp=Ez,I.every=DN,I.find=NN,I.findIndex=P1,I.findKey=Yk,I.findLast=kN,I.findLastIndex=T1,I.findLastKey=Zk,I.floor=wB,I.forEach=N1,I.forEachRight=k1,I.forIn=Kk,I.forInRight=Jk,I.forOwn=Qk,I.forOwnRight=$k,I.get=rg,I.gt=yk,I.gte=xk,I.has=nz,I.hasIn=ig,I.head=O1,I.identity=Wr,I.includes=UN,I.indexOf=kI,I.inRange=bz,I.invoke=sz,I.isArguments=tl,I.isArray=Et,I.isArrayBuffer=bk,I.isArrayLike=jr,I.isArrayLikeObject=En,I.isBoolean=wk,I.isBuffer=ea,I.isDate=Sk,I.isElement=Mk,I.isEmpty=Ck,I.isEqual=Ek,I.isEqualWith=Ak,I.isError=tg,I.isFinite=Pk,I.isFunction=Ks,I.isInteger=W1,I.isLength=ep,I.isMap=G1,I.isMatch=Tk,I.isMatchWith=Rk,I.isNaN=Ok,I.isNative=Lk,I.isNil=Ik,I.isNull=Dk,I.isNumber=X1,I.isObject=bn,I.isObjectLike=Cn,I.isPlainObject=Du,I.isRegExp=ng,I.isSafeInteger=Nk,I.isSet=q1,I.isString=tp,I.isSymbol=ii,I.isTypedArray=rc,I.isUndefined=kk,I.isWeakMap=zk,I.isWeakSet=Bk,I.join=UI,I.kebabCase=Az,I.last=wi,I.lastIndexOf=jI,I.lowerCase=Pz,I.lowerFirst=Tz,I.lt=Vk,I.lte=Fk,I.max=SB,I.maxBy=MB,I.mean=CB,I.meanBy=EB,I.min=AB,I.minBy=PB,I.stubArray=ug,I.stubFalse=hg,I.stubObject=pB,I.stubString=fB,I.stubTrue=mB,I.multiply=TB,I.nth=HI,I.noConflict=sB,I.noop=cg,I.now=Jd,I.pad=Rz,I.padEnd=Oz,I.padStart=Lz,I.parseInt=Dz,I.random=wz,I.reduce=XN,I.reduceRight=qN,I.repeat=Iz,I.replace=Nz,I.result=dz,I.round=RB,I.runInContext=$,I.sample=ZN,I.size=QN,I.snakeCase=kz,I.some=$N,I.sortedIndex=KI,I.sortedIndexBy=JI,I.sortedIndexOf=QI,I.sortedLastIndex=$I,I.sortedLastIndexBy=eN,I.sortedLastIndexOf=tN,I.startCase=Bz,I.startsWith=Vz,I.subtract=OB,I.sum=LB,I.sumBy=DB,I.template=Fz,I.times=vB,I.toFinite=Js,I.toInteger=Tt,I.toLength=Z1,I.toLower=Uz,I.toNumber=Si,I.toSafeInteger=Uk,I.toString=Jt,I.toUpper=jz,I.trim=Hz,I.trimEnd=Wz,I.trimStart=Gz,I.truncate=Xz,I.unescape=qz,I.uniqueId=_B,I.upperCase=Yz,I.upperFirst=sg,I.each=N1,I.eachRight=k1,I.first=O1,lg(I,function(){var l={};return Fi(I,function(h,m){Yt.call(I.prototype,m)||(l[m]=h)}),l}(),{chain:!1}),I.VERSION=r,vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){I[l].placeholder=I}),vr(["drop","take"],function(l,h){Bt.prototype[l]=function(m){m=m===t?1:kn(Tt(m),0);var w=this.__filtered__&&!h?new Bt(this):this.clone();return w.__filtered__?w.__takeCount__=ar(m,w.__takeCount__):w.__views__.push({size:ar(m,Le),type:l+(w.__dir__<0?"Right":"")}),w},Bt.prototype[l+"Right"]=function(m){return this.reverse()[l](m).reverse()}}),vr(["filter","map","takeWhile"],function(l,h){var m=h+1,w=m==te||m==ge;Bt.prototype[l]=function(R){var V=this.clone();return V.__iteratees__.push({iteratee:ft(R,3),type:m}),V.__filtered__=V.__filtered__||w,V}}),vr(["head","last"],function(l,h){var m="take"+(h?"Right":"");Bt.prototype[l]=function(){return this[m](1).value()[0]}}),vr(["initial","tail"],function(l,h){var m="drop"+(h?"":"Right");Bt.prototype[l]=function(){return this.__filtered__?new Bt(this):this[m](1)}}),Bt.prototype.compact=function(){return this.filter(Wr)},Bt.prototype.find=function(l){return this.filter(l).head()},Bt.prototype.findLast=function(l){return this.reverse().find(l)},Bt.prototype.invokeMap=Rt(function(l,h){return typeof l=="function"?new Bt(this):this.map(function(m){return Ql(m,l,h)})}),Bt.prototype.reject=function(l){return this.filter($d(ft(l)))},Bt.prototype.slice=function(l,h){l=Tt(l);var m=this;return m.__filtered__&&(l>0||h<0)?new Bt(m):(l<0?m=m.takeRight(-l):l&&(m=m.drop(l)),h!==t&&(h=Tt(h),m=h<0?m.dropRight(-h):m.take(h-l)),m)},Bt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Bt.prototype.toArray=function(){return this.take(Le)},Fi(Bt.prototype,function(l,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),w=/^(?:head|last)$/.test(h),R=I[w?"take"+(h=="last"?"Right":""):h],V=w||/^find/.test(h);!R||(I.prototype[h]=function(){var G=this.__wrapped__,J=w?[1]:arguments,ie=G instanceof Bt,Ie=J[0],Ne=ie||Et(G),Be=function(Vt){var Ht=R.apply(I,ni([Vt],J));return w&&et?Ht[0]:Ht};Ne&&m&&typeof Ie=="function"&&Ie.length!=1&&(ie=Ne=!1);var et=this.__chain__,ct=!!this.__actions__.length,mt=V&&!et,Ot=ie&&!ct;if(!V&&Ne){G=Ot?G:new Bt(this);var vt=l.apply(G,J);return vt.__actions__.push({func:Zd,args:[Be],thisArg:t}),new ri(vt,et)}return mt&&Ot?l.apply(this,J):(vt=this.thru(Be),mt?w?vt.value()[0]:vt.value():vt)})}),vr(["pop","push","shift","sort","splice","unshift"],function(l){var h=kc[l],m=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",w=/^(?:pop|shift)$/.test(l);I.prototype[l]=function(){var R=arguments;if(w&&!this.__chain__){var V=this.value();return h.apply(Et(V)?V:[],R)}return this[m](function(G){return h.apply(Et(G)?G:[],R)})}}),Fi(Bt.prototype,function(l,h){var m=I[h];if(m){var w=m.name+"";Yt.call(Xo,w)||(Xo[w]=[]),Xo[w].push({name:h,func:m})}}),Xo[jd(t,S).name]=[{name:"wrapper",func:t}],Bt.prototype.clone=fw,Bt.prototype.reverse=mw,Bt.prototype.value=vw,I.prototype.at=MN,I.prototype.chain=CN,I.prototype.commit=EN,I.prototype.next=AN,I.prototype.plant=TN,I.prototype.reverse=RN,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=ON,I.prototype.first=I.prototype.head,Ya&&(I.prototype[Ya]=PN),I},xo=rw();qn?((qn.exports=xo)._=xo,pn._=xo):ln._=xo}).call(At)})(la,la.exports);const hh=(n,e,t)=>{if(!n.has(e)){const r=t();return n.set(e,r),r}return n.get(e)},Wpe=n=>{throw new Error("unexpected value: "+n)},Gpe=(n,e,t)=>{var r,i;let s=n;const o=e.length-1;for(let a=0;a<o;++a)s=(r=s[i=e[a]])!==null&&r!==void 0?r:s[i]={};s[e[o]]=t},PR=(n,e,t=new WeakSet)=>{if(Array.isArray(n)){if(t.has(n))return;t.add(n);for(let r=0;r<n.length;++r){const i=n[r];e(r,i,n),PR(i,e,t)}}else if(n&&typeof n=="object"){if(t.has(n))return;t.add(n);for(const[r,i]of Object.entries(n))e(r,i,n),PR(i,e,t)}},Uj=(n,e)=>{const t=n.indexOf(e);return t===-1?!1:(n.splice(t,1),!0)},Yx=(n,e=-1)=>n[n.length+e],dL=n=>{const e=n.split(".");if(e.length===1)return e;const t=e.pop();return[e.join("."),t]},Qee=(n,e,t)=>{let r,i=!1,s,o,a=t==="trailingPromise"?new Promise(c=>o=c):void 0;return(...c)=>{if(s=c,i)return a!=null?a:r;i=!0,(t==="leading"||t==="both")&&(r=n(...s));const u=()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(r=n(...s),o==null||o(r),a=t==="trailingPromise"?new Promise(d=>o=d):void 0),i=!1};return e>0?setTimeout(u,e):queueMicrotask(u),a!=null?a:r}},$ee=(n,e)=>{if(e===0){let r=!0;return queueMicrotask(()=>r&&n()),()=>r=!1}const t=setTimeout(n,e);return()=>clearTimeout(t)},uu=(n,e,t)=>{let r,i,s,o,a=t==="trailingPromise"?new Promise(c=>o=c):void 0;return(...c)=>(s=c,r?r():(t==="leading"||t==="both")&&(i=n(...s)),r=$ee(()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(i=n(...s),o==null||o(i),a=t==="trailingPromise"?new Promise(u=>o=u):void 0),r=void 0},e),a!=null?a:i)},ete=(n,e,t)=>{const r=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap;return(c,...u)=>{var d;return t==="trailingPromise"&&!a.has(c)&&a.set(c,new Promise(p=>o.set(c,p))),s.set(c,u),r.has(c)?r.get(c)():(t==="leading"||t==="both")&&i.set(c,n(...u)),r.set(c,$ee(()=>{var p;if(t==="trailing"||t==="both"||t==="trailingPromise"){const f=n(...s.get(c));i.set(c,f),(p=o.get(c))===null||p===void 0||p(f),a.set(c,t==="trailingPromise"?new Promise(v=>o.set(c,v)):void 0)}r.delete(c)},e)),(d=a.get(c))!==null&&d!==void 0?d:i.get(c)}},Xpe=n=>n,pL=(n,e)=>{let t,r=!1,i=e==null?void 0:e();return(...s)=>{if(e){const o=e();i!==o&&(r=!1),i=o}return r?t:(r=!0,t=n(...s))}},NC=(n,e)=>{for(const t of e)for(const r of Object.getOwnPropertyNames(t.prototype))!(r in n.prototype)&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))};class jj{constructor(e=void 0){this._cb=e,this.done=void 0,this._value=void 0,this._callbacks=void 0,this._watched=void 0}then(e){var t;return this.done?(e(this._value),rte):(((t=this._callbacks)!==null&&t!==void 0?t:this._callbacks=new Set).add(e),new br(()=>this._callbacks.delete(e)))}watch(e){var t;return this.done?e._resolve(this._value):(((t=this._watched)!==null&&t!==void 0?t:this._watched=new Set).add(e),e.then(()=>this._watched.delete(e)),e)}_resolve(e){var t;if(this.done)return this;if(this.done=!0,this._value=e,(t=this._cb)===null||t===void 0||t.call(this,e),this._callbacks)for(const r of this._callbacks)r(e);if(this._watched)for(const r of this._watched)r._resolve(e);return this}}class tte extends jj{constructor(e){super(e)}resolve(e){return this._resolve(e)}}class br extends jj{constructor(e){super(e)}cancel(){return this._resolve()}}class nte extends jj{constructor(e){super(e)}_resolve(){return this.dispose(),this}dispose(){return super._resolve()}}const rte=new br().cancel();class PQe{constructor(){this.queue=[],this.count=0}then(e){return this.count++===0?(e(),rte):(this.queue.push(e),new br(()=>Uj(this.queue,e)))}resolve(){var e;return this.count--,(e=this.queue.shift())===null||e===void 0||e(),this}}class ite{constructor(){this.cbsMap=new Map}on(e,t){var r;if(Array.isArray(e)){const s=new br;for(const o of e)s.watch(this.on(o,t));return s}!((r=this.states)===null||r===void 0)&&r.has(e)&&t(this.states.get(e));const i=hh(this.cbsMap,e,()=>new Set);return i.add(t),new br(()=>i.delete(t))}once(e,t){const r=new br;return r.watch(this.on(e,i=>{r.cancel(),t(i)})),r}emit(e,t){if(this.cbsMap.has(e))for(const r of this.cbsMap.get(e))r(t)}hasState(e){var t;return!!(!((t=this.states)===null||t===void 0)&&t.has(e))}setState(e,t){var r;(r=this.states)!==null&&r!==void 0||(this.states=new Map),!(this.states.has(e)&&this.states.get(e)===t)&&(this.states.set(e,t),this.emit(e,t))}getState(e){var t;return(t=this.states)===null||t===void 0?void 0:t.get(e)}deleteState(e){var t;(t=this.states)===null||t===void 0||t.delete(e)}clear(){var e;this.cbsMap.clear(),(e=this.states)===null||e===void 0||e.clear()}}class qpe{constructor(){this.cbs=new Set}on(e){return"state"in this&&e(this.state),this.cbs.add(e),new br(()=>this.cbs.delete(e))}once(e){const t=new br;return t.watch(this.on(r=>{t.cancel(),e(r)})),t}emit(e){for(const t of this.cbs)t(e)}setState(e){"state"in this&&this.state===e||(this.state=e,this.emit(e))}getState(){return this.state}}const Bo=()=>{const n=new qpe;return[e=>n.emit(e),(e,t)=>t?n.once(e):n.on(e),e=>n.setState(e),()=>n.getState()]},Ype=new WeakSet,yt=n=>{const[,e,t,r]=Bo();t(n);const i=s=>{if(s){const o=new br;return o.watch(e(a=>s(a,o))),o}return r()};return Ype.add(i),[t,i]},Zx=(n,e)=>t=>{const r=e();r&&n([...r,t])},Kx=(n,e)=>t=>{const r=e();r&&n(r.filter(i=>i!==t))},ste=(n,e)=>()=>{const t=e();!t||(Array.isArray(t)?n([...t]):n({...t}))},Zpe=(n,e)=>{const t=e();return t&&typeof t=="object"&&(PR(t,(r,i)=>Object.freeze(i)),Object.freeze(t)),()=>n(t)},nd=[],EW=n=>{var e,t,r;const i=nd[nd.length-1];return(e=(t=i.fiber)[r=i.count++])!==null&&e!==void 0?e:t[r]=n()},AW=n=>{var e,t;const r=nd[nd.length-1],i=r.count++;return(e=(t=r.fiber)[i])!==null&&e!==void 0||(t[i]=n),[()=>r.fiber[i],s=>r.fiber[i]=s]},ote=(n,e,t,r,i,s)=>{nd.push({count:0,fiber:t,handle:n});const o=r.map(u=>typeof u=="function"?u():u),a=!i||o.some((u,d)=>u!==i[d]);a&&typeof e=="function"&&e();const c=a?s():void 0;return nd.pop(),[c,o,a]},ex=(n,e)=>{const t=EW(()=>nd[nd.length-1].handle.watch(new br(()=>{var v;return(v=i())===null||v===void 0?void 0:v()})));if(t.done)return t;const r=EW(()=>[]),[i,s]=AW(void 0),[o,a]=AW(void 0),c=i(),u=o();c&&typeof c!="function"&&console.warn("cleanup is not a function");const[d,p,f]=ote(t,c,r,e,u,n);return f&&s(typeof d=="function"?d:void 0),a(p),t},_n=(n,e)=>{const t=new br(()=>setTimeout(()=>i==null?void 0:i())),r=[];let i,s;const o=uu(()=>{const[a,c,u]=ote(t,i,r,e,s,n);u&&(i=typeof a=="function"?a:void 0),s=c},0,"trailing");o();for(const a of e)typeof a=="function"&&t.watch(a(o));return t},GM=n=>{var e,t,r;const i=nd[nd.length-1];return(e=(t=i.fiber)[r=i.count++])!==null&&e!==void 0?e:t[r]={current:typeof n=="function"?n():n}},Kpe=(n,e)=>{const t=GM(n),r=GM(!0);return ex(()=>{if(r.current){r.current=!1;return}t.current=n()},e),t.current};class nn{constructor(e){[this.set,this.get]=yt(e)}}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Hj="144",Jpe=0,PW=1,Qpe=2,ate=1,lte=2,JS=3,tx=0,Ol=1,zh=2,ks=0,Oy=1,TR=2,TW=3,RW=4,v6=5,cm=100,$pe=101,efe=102,OW=103,LW=104,g6=200,tfe=201,nfe=202,rfe=203,cte=204,ute=205,hte=206,ife=207,dte=208,sfe=209,ofe=210,afe=0,lfe=1,cfe=2,_6=3,ufe=4,hfe=5,dfe=6,pfe=7,pte=0,ffe=1,mfe=2,qh=0,fte=1,vfe=2,gfe=3,_fe=4,yfe=5,mte=300,nx=301,rx=302,XM=303,y6=304,fL=306,ix=1e3,mc=1001,x6=1002,us=1003,DW=1004,IW=1005,Vs=1006,xfe=1007,kC=1008,m0=1009,bfe=1010,wfe=1011,Wj=1012,Sfe=1013,Kg=1014,th=1015,Op=1016,Mfe=1017,Cfe=1018,Ly=1020,Efe=1021,Afe=1022,nh=1023,Pfe=1024,Tfe=1025,s0=1026,sx=1027,Rfe=1028,Ofe=1029,Lfe=1030,Dfe=1031,Ife=1033,HB=33776,WB=33777,GB=33778,XB=33779,NW=35840,kW=35841,zW=35842,BW=35843,Nfe=36196,VW=37492,FW=37496,UW=37808,jW=37809,HW=37810,WW=37811,GW=37812,XW=37813,qW=37814,YW=37815,ZW=37816,KW=37817,JW=37818,QW=37819,$W=37820,eG=37821,tG=36492,b6=2200,w6=2201,kfe=2202,RR=2300,OR=2301,qB=2302,gy=2400,_y=2401,LR=2402,Gj=2500,zfe=2501,TQe=1,RQe=2,Am=3e3,ss=3001,Bfe=3200,mL=3201,zC=0,vte=1,Mp="srgb",Jg="srgb-linear",YB=7680,Vfe=519,S6=35044,nG="300 es",M6=1035;class E0{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const r=t.slice(0);for(let i=0,s=r.length;i<s;i++)r[i].call(this,e);e.target=null}}}const xa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let rG=1234567;const gM=Math.PI/180,qM=180/Math.PI;function ru(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(xa[n&255]+xa[n>>8&255]+xa[n>>16&255]+xa[n>>24&255]+"-"+xa[e&255]+xa[e>>8&255]+"-"+xa[e>>16&15|64]+xa[e>>24&255]+"-"+xa[t&63|128]+xa[t>>8&255]+"-"+xa[t>>16&255]+xa[t>>24&255]+xa[r&255]+xa[r>>8&255]+xa[r>>16&255]+xa[r>>24&255]).toLowerCase()}function so(n,e,t){return Math.max(e,Math.min(t,n))}function Xj(n,e){return(n%e+e)%e}function Ffe(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function Ufe(n,e,t){return n!==e?(t-n)/(e-n):0}function _M(n,e,t){return(1-t)*n+t*e}function jfe(n,e,t,r){return _M(n,e,1-Math.exp(-t*r))}function Hfe(n,e=1){return e-Math.abs(Xj(n,e*2)-e)}function Wfe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Gfe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Xfe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function qfe(n,e){return n+Math.random()*(e-n)}function Yfe(n){return n*(.5-Math.random())}function Zfe(n){n!==void 0&&(rG=n);let e=rG+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Kfe(n){return n*gM}function Jfe(n){return n*qM}function C6(n){return(n&n-1)===0&&n!==0}function gte(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function DR(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Qfe(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),u=s((e+r)/2),d=o((e+r)/2),p=s((e-r)/2),f=o((e-r)/2),v=s((r-e)/2),x=o((r-e)/2);switch(i){case"XYX":n.set(a*d,c*p,c*f,a*u);break;case"YZY":n.set(c*f,a*d,c*p,a*u);break;case"ZXZ":n.set(c*p,c*f,a*d,a*u);break;case"XZX":n.set(a*d,c*x,c*v,a*u);break;case"YXY":n.set(c*v,a*d,c*x,a*u);break;case"ZYZ":n.set(c*x,c*v,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Lp(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function li(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var ZB=Object.freeze({__proto__:null,DEG2RAD:gM,RAD2DEG:qM,generateUUID:ru,clamp:so,euclideanModulo:Xj,mapLinear:Ffe,inverseLerp:Ufe,lerp:_M,damp:jfe,pingpong:Hfe,smoothstep:Wfe,smootherstep:Gfe,randInt:Xfe,randFloat:qfe,randFloatSpread:Yfe,seededRandom:Zfe,degToRad:Kfe,radToDeg:Jfe,isPowerOfTwo:C6,ceilPowerOfTwo:gte,floorPowerOfTwo:DR,setQuaternionFromProperEuler:Qfe,normalize:li,denormalize:Lp});class ot{constructor(e=0,t=0){ot.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ca{constructor(){ca.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,s,o,a,c,u){const d=this.elements;return d[0]=e,d[1]=i,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=r,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],c=r[6],u=r[1],d=r[4],p=r[7],f=r[2],v=r[5],x=r[8],y=i[0],_=i[3],S=i[6],C=i[1],A=i[4],P=i[7],D=i[2],N=i[5],j=i[8];return s[0]=o*y+a*C+c*D,s[3]=o*_+a*A+c*N,s[6]=o*S+a*P+c*j,s[1]=u*y+d*C+p*D,s[4]=u*_+d*A+p*N,s[7]=u*S+d*P+p*j,s[2]=f*y+v*C+x*D,s[5]=f*_+v*A+x*N,s[8]=f*S+v*P+x*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-r*s*d+r*a*c+i*s*u-i*o*c}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=d*o-a*u,f=a*c-d*s,v=u*s-o*c,x=t*p+r*f+i*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return e[0]=p*y,e[1]=(i*u-d*r)*y,e[2]=(a*r-i*o)*y,e[3]=f*y,e[4]=(d*t-i*c)*y,e[5]=(i*s-a*t)*y,e[6]=v*y,e[7]=(r*c-u*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const c=Math.cos(s),u=Math.sin(s);return this.set(r*c,r*u,-r*(c*o+u*a)+o+e,-i*u,i*c,-i*(-u*o+c*a)+a+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],u=i[4],d=i[7];return i[0]=t*s+r*c,i[3]=t*o+r*u,i[6]=t*a+r*d,i[1]=-r*s+t*c,i[4]=-r*o+t*u,i[7]=-r*a+t*d,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function _te(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function YM(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function o0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function m3(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const KB={[Mp]:{[Jg]:o0},[Jg]:{[Mp]:m3}},Iu={legacyMode:!0,get workingColorSpace(){return Jg},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(KB[e]&&KB[e][t]!==void 0){const r=KB[e][t];return n.r=r(n.r),n.g=r(n.g),n.b=r(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},yte={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$s={r:0,g:0,b:0},Nu={h:0,s:0,l:0},bA={h:0,s:0,l:0};function JB(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function wA(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class Xt{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Mp){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Iu.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Jg){return this.r=e,this.g=t,this.b=r,Iu.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Jg){if(e=Xj(e,1),t=so(t,0,1),r=so(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=JB(o,s,e+1/3),this.g=JB(o,s,e),this.b=JB(o,s,e-1/3)}return Iu.toWorkingColorSpace(this,i),this}setStyle(e,t=Mp){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Iu.toWorkingColorSpace(this,t),r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Iu.toWorkingColorSpace(this,t),r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const c=parseFloat(s[1])/360,u=parseFloat(s[2])/100,d=parseFloat(s[3])/100;return r(s[4]),this.setHSL(c,u,d,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Iu.toWorkingColorSpace(this,t),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Iu.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Mp){const r=yte[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=o0(e.r),this.g=o0(e.g),this.b=o0(e.b),this}copyLinearToSRGB(e){return this.r=m3(e.r),this.g=m3(e.g),this.b=m3(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Mp){return Iu.fromWorkingColorSpace(wA(this,$s),e),so($s.r*255,0,255)<<16^so($s.g*255,0,255)<<8^so($s.b*255,0,255)<<0}getHexString(e=Mp){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Jg){Iu.fromWorkingColorSpace(wA(this,$s),t);const r=$s.r,i=$s.g,s=$s.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let c,u;const d=(a+o)/2;if(a===o)c=0,u=0;else{const p=o-a;switch(u=d<=.5?p/(o+a):p/(2-o-a),o){case r:c=(i-s)/p+(i<s?6:0);break;case i:c=(s-r)/p+2;break;case s:c=(r-i)/p+4;break}c/=6}return e.h=c,e.s=u,e.l=d,e}getRGB(e,t=Jg){return Iu.fromWorkingColorSpace(wA(this,$s),t),e.r=$s.r,e.g=$s.g,e.b=$s.b,e}getStyle(e=Mp){return Iu.fromWorkingColorSpace(wA(this,$s),e),e!==Mp?`color(${e} ${$s.r} ${$s.g} ${$s.b})`:`rgb(${$s.r*255|0},${$s.g*255|0},${$s.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Nu),Nu.h+=e,Nu.s+=t,Nu.l+=r,this.setHSL(Nu.h,Nu.s,Nu.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Nu),e.getHSL(bA);const r=_M(Nu.h,bA.h,t),i=_M(Nu.s,bA.s,t),s=_M(Nu.l,bA.l,t);return this.setHSL(r,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Xt.NAMES=yte;let d_;class xte{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{d_===void 0&&(d_=YM("canvas")),d_.width=e.width,d_.height=e.height;const r=d_.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=d_}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=YM("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=o0(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(o0(t[r]/255)*255):t[r]=o0(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class bte{constructor(e=null){this.isSource=!0,this.uuid=ru(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(QB(i[o].image)):s.push(QB(i[o]))}else s=QB(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function QB(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?xte.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let $fe=0;class da extends E0{constructor(e=da.DEFAULT_IMAGE,t=da.DEFAULT_MAPPING,r=mc,i=mc,s=Vs,o=kC,a=nh,c=m0,u=1,d=Am){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$fe++}),this.uuid=ru(),this.name="",this.source=new bte(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=c,this.offset=new ot(0,0),this.repeat=new ot(1,1),this.center=new ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ca,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==mte)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ix:e.x=e.x-Math.floor(e.x);break;case mc:e.x=e.x<0?0:1;break;case x6:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ix:e.y=e.y-Math.floor(e.y);break;case mc:e.y=e.y<0?0:1;break;case x6:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}da.DEFAULT_IMAGE=null;da.DEFAULT_MAPPING=mte;class Ir{constructor(e=0,t=0,r=0,i=1){Ir.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const o=e.elements,a=o[0],c=o[4],u=o[8],d=o[1],p=o[5],f=o[9],v=o[2],x=o[6],y=o[10];if(Math.abs(c-d)<.01&&Math.abs(u-v)<.01&&Math.abs(f-x)<.01){if(Math.abs(c+d)<.1&&Math.abs(u+v)<.1&&Math.abs(f+x)<.1&&Math.abs(a+p+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(a+1)/2,C=(p+1)/2,A=(y+1)/2,P=(c+d)/4,D=(u+v)/4,N=(f+x)/4;return S>C&&S>A?S<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(S),i=P/r,s=D/r):C>A?C<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(C),r=P/i,s=N/i):A<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(A),r=D/s,i=N/s),this.set(r,i,s,t),this}let _=Math.sqrt((x-f)*(x-f)+(u-v)*(u-v)+(d-c)*(d-c));return Math.abs(_)<.001&&(_=1),this.x=(x-f)/_,this.y=(u-v)/_,this.z=(d-c)/_,this.w=Math.acos((a+p+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ei extends E0{constructor(e,t,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ir(0,0,e,t),this.scissorTest=!1,this.viewport=new Ir(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new da(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Vs,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new bte(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wte extends da{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=us,this.minFilter=us,this.wrapR=mc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eme extends da{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=us,this.minFilter=us,this.wrapR=mc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hl{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let c=r[i+0],u=r[i+1],d=r[i+2],p=r[i+3];const f=s[o+0],v=s[o+1],x=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p;return}if(a===1){e[t+0]=f,e[t+1]=v,e[t+2]=x,e[t+3]=y;return}if(p!==y||c!==f||u!==v||d!==x){let _=1-a;const S=c*f+u*v+d*x+p*y,C=S>=0?1:-1,A=1-S*S;if(A>Number.EPSILON){const D=Math.sqrt(A),N=Math.atan2(D,S*C);_=Math.sin(_*N)/D,a=Math.sin(a*N)/D}const P=a*C;if(c=c*_+f*P,u=u*_+v*P,d=d*_+x*P,p=p*_+y*P,_===1-a){const D=1/Math.sqrt(c*c+u*u+d*d+p*p);c*=D,u*=D,d*=D,p*=D}}e[t]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],c=r[i+1],u=r[i+2],d=r[i+3],p=s[o],f=s[o+1],v=s[o+2],x=s[o+3];return e[t]=a*x+d*p+c*v-u*f,e[t+1]=c*x+d*f+u*p-a*v,e[t+2]=u*x+d*v+a*f-c*p,e[t+3]=d*x-a*p-c*f-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,u=a(r/2),d=a(i/2),p=a(s/2),f=c(r/2),v=c(i/2),x=c(s/2);switch(o){case"XYZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"YXZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"ZXY":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"ZYX":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"YZX":this._x=f*d*p+u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p-f*v*x;break;case"XZY":this._x=f*d*p-u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p+f*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],c=t[9],u=t[2],d=t[6],p=t[10],f=r+a+p;if(f>0){const v=.5/Math.sqrt(f+1);this._w=.25/v,this._x=(d-c)*v,this._y=(s-u)*v,this._z=(o-i)*v}else if(r>a&&r>p){const v=2*Math.sqrt(1+r-a-p);this._w=(d-c)/v,this._x=.25*v,this._y=(i+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-r-p);this._w=(s-u)/v,this._x=(i+o)/v,this._y=.25*v,this._z=(c+d)/v}else{const v=2*Math.sqrt(1+p-r-a);this._w=(o-i)/v,this._x=(s+u)/v,this._y=(c+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(so(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,c=t._y,u=t._z,d=t._w;return this._x=r*d+o*a+i*u-s*c,this._y=i*d+o*c+s*a-r*u,this._z=s*d+o*u+r*c-i*a,this._w=o*d-r*a-i*c-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*r+t*this._x,this._y=v*i+t*this._y,this._z=v*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(c),d=Math.atan2(u,a),p=Math.sin((1-t)*d)/u,f=Math.sin(t*d)/u;return this._w=o*p+this._w*f,this._x=r*p+this._x*f,this._y=i*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ye{constructor(e=0,t=0,r=0){ye.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(iG.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(iG.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,c=e.w,u=c*t+o*i-a*r,d=c*r+a*t-s*i,p=c*i+s*r-o*t,f=-s*t-o*r-a*i;return this.x=u*c+f*-s+d*-a-p*-o,this.y=d*c+f*-o+p*-s-u*-a,this.z=p*c+f*-a+u*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=i*c-s*a,this.y=s*o-r*c,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return $B.copy(this).projectOnVector(e),this.sub($B)}reflect(e){return this.sub($B.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(so(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $B=new ye,iG=new hl;class sd{constructor(e=new ye(1/0,1/0,1/0),t=new ye(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,u=e.length;c<u;c+=3){const d=e[c],p=e[c+1],f=e[c+2];d<t&&(t=d),p<r&&(r=p),f<i&&(i=f),d>s&&(s=d),p>o&&(o=p),f>a&&(a=f)}return this.min.set(t,r,i),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,u=e.count;c<u;c++){const d=e.getX(c),p=e.getY(c),f=e.getZ(c);d<t&&(t=d),p<r&&(r=p),f<i&&(i=f),d>s&&(s=d),p>o&&(o=p),f>a&&(a=f)}return this.min.set(t,r,i),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=fg.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)fg.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(fg)}else r.boundingBox===null&&r.computeBoundingBox(),e5.copy(r.boundingBox),e5.applyMatrix4(e.matrixWorld),this.union(e5);const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,fg),fg.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lS),SA.subVectors(this.max,lS),p_.subVectors(e.a,lS),f_.subVectors(e.b,lS),m_.subVectors(e.c,lS),Pf.subVectors(f_,p_),Tf.subVectors(m_,f_),mg.subVectors(p_,m_);let t=[0,-Pf.z,Pf.y,0,-Tf.z,Tf.y,0,-mg.z,mg.y,Pf.z,0,-Pf.x,Tf.z,0,-Tf.x,mg.z,0,-mg.x,-Pf.y,Pf.x,0,-Tf.y,Tf.x,0,-mg.y,mg.x,0];return!t5(t,p_,f_,m_,SA)||(t=[1,0,0,0,1,0,0,0,1],!t5(t,p_,f_,m_,SA))?!1:(MA.crossVectors(Pf,Tf),t=[MA.x,MA.y,MA.z],t5(t,p_,f_,m_,SA))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return fg.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(fg).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(rp[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),rp[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),rp[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),rp[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),rp[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),rp[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),rp[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),rp[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(rp),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const rp=[new ye,new ye,new ye,new ye,new ye,new ye,new ye,new ye],fg=new ye,e5=new sd,p_=new ye,f_=new ye,m_=new ye,Pf=new ye,Tf=new ye,mg=new ye,lS=new ye,SA=new ye,MA=new ye,vg=new ye;function t5(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){vg.fromArray(n,s);const a=i.x*Math.abs(vg.x)+i.y*Math.abs(vg.y)+i.z*Math.abs(vg.z),c=e.dot(vg),u=t.dot(vg),d=r.dot(vg);if(Math.max(-Math.max(c,u,d),Math.min(c,u,d))>a)return!1}return!0}const tme=new sd,sG=new ye,CA=new ye,n5=new ye;class Jx{constructor(e=new ye,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):tme.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){n5.subVectors(e,this.center);const t=n5.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.add(n5.multiplyScalar(i/r)),this.radius+=i}return this}union(e){return this.center.equals(e.center)===!0?CA.set(0,0,1).multiplyScalar(e.radius):CA.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(sG.copy(e.center).add(CA)),this.expandByPoint(sG.copy(e.center).sub(CA)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ip=new ye,r5=new ye,EA=new ye,Rf=new ye,i5=new ye,AA=new ye,s5=new ye;class Qx{constructor(e=new ye,t=new ye(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ip)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ip.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ip.copy(this.direction).multiplyScalar(t).add(this.origin),ip.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){r5.copy(e).add(t).multiplyScalar(.5),EA.copy(t).sub(e).normalize(),Rf.copy(this.origin).sub(r5);const s=e.distanceTo(t)*.5,o=-this.direction.dot(EA),a=Rf.dot(this.direction),c=-Rf.dot(EA),u=Rf.lengthSq(),d=Math.abs(1-o*o);let p,f,v,x;if(d>0)if(p=o*c-a,f=o*a-c,x=s*d,p>=0)if(f>=-x)if(f<=x){const y=1/d;p*=y,f*=y,v=p*(p+o*f+2*a)+f*(o*p+f+2*c)+u}else f=s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;else f=-s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;else f<=-x?(p=Math.max(0,-(-o*s+a)),f=p>0?-s:Math.min(Math.max(-s,-c),s),v=-p*p+f*(f+2*c)+u):f<=x?(p=0,f=Math.min(Math.max(-s,-c),s),v=f*(f+2*c)+u):(p=Math.max(0,-(o*s+a)),f=p>0?s:Math.min(Math.max(-s,-c),s),v=-p*p+f*(f+2*c)+u);else f=o>0?-s:s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;return r&&r.copy(this.direction).multiplyScalar(p).add(this.origin),i&&i.copy(EA).multiplyScalar(f).add(r5),v}intersectSphere(e,t){ip.subVectors(e.center,this.origin);const r=ip.dot(this.direction),i=ip.dot(ip)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,c=r+o;return a<0&&c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,c;const u=1/this.direction.x,d=1/this.direction.y,p=1/this.direction.z,f=this.origin;return u>=0?(r=(e.min.x-f.x)*u,i=(e.max.x-f.x)*u):(r=(e.max.x-f.x)*u,i=(e.min.x-f.x)*u),d>=0?(s=(e.min.y-f.y)*d,o=(e.max.y-f.y)*d):(s=(e.max.y-f.y)*d,o=(e.min.y-f.y)*d),r>o||s>i||((s>r||r!==r)&&(r=s),(o<i||i!==i)&&(i=o),p>=0?(a=(e.min.z-f.z)*p,c=(e.max.z-f.z)*p):(a=(e.max.z-f.z)*p,c=(e.min.z-f.z)*p),r>c||a>i)||((a>r||r!==r)&&(r=a),(c<i||i!==i)&&(i=c),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,ip)!==null}intersectTriangle(e,t,r,i,s){i5.subVectors(t,e),AA.subVectors(r,e),s5.crossVectors(i5,AA);let o=this.direction.dot(s5),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Rf.subVectors(this.origin,e);const c=a*this.direction.dot(AA.crossVectors(Rf,AA));if(c<0)return null;const u=a*this.direction.dot(i5.cross(Rf));if(u<0||c+u>o)return null;const d=-a*Rf.dot(s5);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class zn{constructor(){zn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,s,o,a,c,u,d,p,f,v,x,y,_){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=i,S[1]=s,S[5]=o,S[9]=a,S[13]=c,S[2]=u,S[6]=d,S[10]=p,S[14]=f,S[3]=v,S[7]=x,S[11]=y,S[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zn().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/v_.setFromMatrixColumn(e,0).length(),s=1/v_.setFromMatrixColumn(e,1).length(),o=1/v_.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),c=Math.cos(i),u=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=-c*p,t[8]=u,t[1]=v+x*u,t[5]=f-y*u,t[9]=-a*c,t[2]=y-f*u,t[6]=x+v*u,t[10]=o*c}else if(e.order==="YXZ"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f+y*a,t[4]=x*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*d,t[9]=-a,t[2]=v*a-x,t[6]=y+f*a,t[10]=o*c}else if(e.order==="ZXY"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f-y*a,t[4]=-o*p,t[8]=x+v*a,t[1]=v+x*a,t[5]=o*d,t[9]=y-f*a,t[2]=-o*u,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=x*u-v,t[8]=f*u+y,t[1]=c*p,t[5]=y*u+f,t[9]=v*u-x,t[2]=-u,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=y-f*p,t[8]=x*p+v,t[1]=p,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=v*p+x,t[10]=f-y*p}else if(e.order==="XZY"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=-p,t[8]=u*d,t[1]=f*p+y,t[5]=o*d,t[9]=v*p-x,t[2]=x*p-v,t[6]=a*d,t[10]=y*p+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(nme,e,rme)}lookAt(e,t,r){const i=this.elements;return sc.subVectors(e,t),sc.lengthSq()===0&&(sc.z=1),sc.normalize(),Of.crossVectors(r,sc),Of.lengthSq()===0&&(Math.abs(r.z)===1?sc.x+=1e-4:sc.z+=1e-4,sc.normalize(),Of.crossVectors(r,sc)),Of.normalize(),PA.crossVectors(sc,Of),i[0]=Of.x,i[4]=PA.x,i[8]=sc.x,i[1]=Of.y,i[5]=PA.y,i[9]=sc.y,i[2]=Of.z,i[6]=PA.z,i[10]=sc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],c=r[8],u=r[12],d=r[1],p=r[5],f=r[9],v=r[13],x=r[2],y=r[6],_=r[10],S=r[14],C=r[3],A=r[7],P=r[11],D=r[15],N=i[0],j=i[4],T=i[8],k=i[12],U=i[1],ee=i[5],xe=i[9],ce=i[13],te=i[2],fe=i[6],ge=i[10],Se=i[14],pe=i[3],se=i[7],ae=i[11],Le=i[15];return s[0]=o*N+a*U+c*te+u*pe,s[4]=o*j+a*ee+c*fe+u*se,s[8]=o*T+a*xe+c*ge+u*ae,s[12]=o*k+a*ce+c*Se+u*Le,s[1]=d*N+p*U+f*te+v*pe,s[5]=d*j+p*ee+f*fe+v*se,s[9]=d*T+p*xe+f*ge+v*ae,s[13]=d*k+p*ce+f*Se+v*Le,s[2]=x*N+y*U+_*te+S*pe,s[6]=x*j+y*ee+_*fe+S*se,s[10]=x*T+y*xe+_*ge+S*ae,s[14]=x*k+y*ce+_*Se+S*Le,s[3]=C*N+A*U+P*te+D*pe,s[7]=C*j+A*ee+P*fe+D*se,s[11]=C*T+A*xe+P*ge+D*ae,s[15]=C*k+A*ce+P*Se+D*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],c=e[9],u=e[13],d=e[2],p=e[6],f=e[10],v=e[14],x=e[3],y=e[7],_=e[11],S=e[15];return x*(+s*c*p-i*u*p-s*a*f+r*u*f+i*a*v-r*c*v)+y*(+t*c*v-t*u*f+s*o*f-i*o*v+i*u*d-s*c*d)+_*(+t*u*p-t*a*v-s*o*p+r*o*v+s*a*d-r*u*d)+S*(-i*a*d-t*c*p+t*a*f+i*o*p-r*o*f+r*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=e[9],f=e[10],v=e[11],x=e[12],y=e[13],_=e[14],S=e[15],C=p*_*u-y*f*u+y*c*v-a*_*v-p*c*S+a*f*S,A=x*f*u-d*_*u-x*c*v+o*_*v+d*c*S-o*f*S,P=d*y*u-x*p*u+x*a*v-o*y*v-d*a*S+o*p*S,D=x*p*c-d*y*c-x*a*f+o*y*f+d*a*_-o*p*_,N=t*C+r*A+i*P+s*D;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const j=1/N;return e[0]=C*j,e[1]=(y*f*s-p*_*s-y*i*v+r*_*v+p*i*S-r*f*S)*j,e[2]=(a*_*s-y*c*s+y*i*u-r*_*u-a*i*S+r*c*S)*j,e[3]=(p*c*s-a*f*s-p*i*u+r*f*u+a*i*v-r*c*v)*j,e[4]=A*j,e[5]=(d*_*s-x*f*s+x*i*v-t*_*v-d*i*S+t*f*S)*j,e[6]=(x*c*s-o*_*s-x*i*u+t*_*u+o*i*S-t*c*S)*j,e[7]=(o*f*s-d*c*s+d*i*u-t*f*u-o*i*v+t*c*v)*j,e[8]=P*j,e[9]=(x*p*s-d*y*s-x*r*v+t*y*v+d*r*S-t*p*S)*j,e[10]=(o*y*s-x*a*s+x*r*u-t*y*u-o*r*S+t*a*S)*j,e[11]=(d*a*s-o*p*s-d*r*u+t*p*u+o*r*v-t*a*v)*j,e[12]=D*j,e[13]=(d*y*i-x*p*i+x*r*f-t*y*f-d*r*_+t*p*_)*j,e[14]=(x*a*i-o*y*i-x*r*c+t*y*c+o*r*_-t*a*_)*j,e[15]=(o*p*i-d*a*i+d*r*c-t*p*c-o*r*f+t*a*f)*j,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,c=e.z,u=s*o,d=s*a;return this.set(u*o+r,u*a-i*c,u*c+i*a,0,u*a+i*c,d*a+r,d*c-i*o,0,u*c-i*a,d*c+i*o,s*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,u=s+s,d=o+o,p=a+a,f=s*u,v=s*d,x=s*p,y=o*d,_=o*p,S=a*p,C=c*u,A=c*d,P=c*p,D=r.x,N=r.y,j=r.z;return i[0]=(1-(y+S))*D,i[1]=(v+P)*D,i[2]=(x-A)*D,i[3]=0,i[4]=(v-P)*N,i[5]=(1-(f+S))*N,i[6]=(_+C)*N,i[7]=0,i[8]=(x+A)*j,i[9]=(_-C)*j,i[10]=(1-(f+y))*j,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=v_.set(i[0],i[1],i[2]).length();const o=v_.set(i[4],i[5],i[6]).length(),a=v_.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],ku.copy(this);const c=1/s,u=1/o,d=1/a;return ku.elements[0]*=c,ku.elements[1]*=c,ku.elements[2]*=c,ku.elements[4]*=u,ku.elements[5]*=u,ku.elements[6]*=u,ku.elements[8]*=d,ku.elements[9]*=d,ku.elements[10]*=d,t.setFromRotationMatrix(ku),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o){const a=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),p=(r+i)/(r-i),f=-(o+s)/(o-s),v=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=u,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=v,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,s,o){const a=this.elements,c=1/(t-e),u=1/(r-i),d=1/(o-s),p=(t+e)*c,f=(r+i)*u,v=(o+s)*d;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-v,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const v_=new ye,ku=new zn,nme=new ye(0,0,0),rme=new ye(1,1,1),Of=new ye,PA=new ye,sc=new ye,oG=new zn,aG=new hl;class $x{constructor(e=0,t=0,r=0,i=$x.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],c=i[1],u=i[5],d=i[9],p=i[2],f=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(so(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-so(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(so(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-so(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(f,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(so(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-so(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return oG.makeRotationFromQuaternion(e),this.setFromRotationMatrix(oG,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return aG.setFromEuler(this),this.setFromQuaternion(aG,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}$x.DefaultOrder="XYZ";$x.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class qj{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ime=0;const lG=new ye,g_=new hl,sp=new zn,TA=new ye,cS=new ye,sme=new ye,ome=new hl,cG=new ye(1,0,0),uG=new ye(0,1,0),hG=new ye(0,0,1),ame={type:"added"},dG={type:"removed"};class wr extends E0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ime++}),this.uuid=ru(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=wr.DefaultUp.clone();const e=new ye,t=new $x,r=new hl,i=new ye(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new zn},normalMatrix:{value:new ca}}),this.matrix=new zn,this.matrixWorld=new zn,this.matrixAutoUpdate=wr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=wr.DefaultMatrixWorldAutoUpdate,this.layers=new qj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return g_.setFromAxisAngle(e,t),this.quaternion.multiply(g_),this}rotateOnWorldAxis(e,t){return g_.setFromAxisAngle(e,t),this.quaternion.premultiply(g_),this}rotateX(e){return this.rotateOnAxis(cG,e)}rotateY(e){return this.rotateOnAxis(uG,e)}rotateZ(e){return this.rotateOnAxis(hG,e)}translateOnAxis(e,t){return lG.copy(e).applyQuaternion(this.quaternion),this.position.add(lG.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(cG,e)}translateY(e){return this.translateOnAxis(uG,e)}translateZ(e){return this.translateOnAxis(hG,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(sp.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?TA.copy(e):TA.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),cS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?sp.lookAt(cS,TA,this.up):sp.lookAt(TA,cS,this.up),this.quaternion.setFromRotationMatrix(sp),i&&(sp.extractRotation(i.matrixWorld),g_.setFromRotationMatrix(sp),this.quaternion.premultiply(g_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ame)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(dG)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(dG)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),sp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),sp.multiply(e.parent.matrixWorld)),e.applyMatrix4(sp),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r].getObjectByProperty(e,t);if(s!==void 0)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cS,e,sme),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cS,ome,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const p=c[u];s(e.shapes,p)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,u=this.material.length;c<u;c++)a.push(s(e.materials,this.material[c]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];i.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),u=o(e.textures),d=o(e.images),p=o(e.shapes),f=o(e.skeletons),v=o(e.animations),x=o(e.nodes);a.length>0&&(r.geometries=a),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),f.length>0&&(r.skeletons=f),v.length>0&&(r.animations=v),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(a){const c=[];for(const u in a){const d=a[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}wr.DefaultUp=new ye(0,1,0);wr.DefaultMatrixAutoUpdate=!0;wr.DefaultMatrixWorldAutoUpdate=!0;const zu=new ye,op=new ye,o5=new ye,ap=new ye,__=new ye,y_=new ye,pG=new ye,a5=new ye,l5=new ye,c5=new ye;class Nh{constructor(e=new ye,t=new ye,r=new ye){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),zu.subVectors(e,t),i.cross(zu);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){zu.subVectors(i,t),op.subVectors(r,t),o5.subVectors(e,t);const o=zu.dot(zu),a=zu.dot(op),c=zu.dot(o5),u=op.dot(op),d=op.dot(o5),p=o*u-a*a;if(p===0)return s.set(-2,-1,-1);const f=1/p,v=(u*c-a*d)*f,x=(o*d-a*c)*f;return s.set(1-v-x,x,v)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,ap),ap.x>=0&&ap.y>=0&&ap.x+ap.y<=1}static getUV(e,t,r,i,s,o,a,c){return this.getBarycoord(e,t,r,i,ap),c.set(0,0),c.addScaledVector(s,ap.x),c.addScaledVector(o,ap.y),c.addScaledVector(a,ap.z),c}static isFrontFacing(e,t,r,i){return zu.subVectors(r,t),op.subVectors(e,t),zu.cross(op).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return zu.subVectors(this.c,this.b),op.subVectors(this.a,this.b),zu.cross(op).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Nh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Nh.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return Nh.getUV(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Nh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Nh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;__.subVectors(i,r),y_.subVectors(s,r),a5.subVectors(e,r);const c=__.dot(a5),u=y_.dot(a5);if(c<=0&&u<=0)return t.copy(r);l5.subVectors(e,i);const d=__.dot(l5),p=y_.dot(l5);if(d>=0&&p<=d)return t.copy(i);const f=c*p-d*u;if(f<=0&&c>=0&&d<=0)return o=c/(c-d),t.copy(r).addScaledVector(__,o);c5.subVectors(e,s);const v=__.dot(c5),x=y_.dot(c5);if(x>=0&&v<=x)return t.copy(s);const y=v*u-c*x;if(y<=0&&u>=0&&x<=0)return a=u/(u-x),t.copy(r).addScaledVector(y_,a);const _=d*x-v*p;if(_<=0&&p-d>=0&&v-x>=0)return pG.subVectors(s,i),a=(p-d)/(p-d+(v-x)),t.copy(i).addScaledVector(pG,a);const S=1/(_+y+f);return o=y*S,a=f*S,t.copy(r).addScaledVector(__,o).addScaledVector(y_,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let lme=0;class od extends E0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:lme++}),this.uuid=ru(),this.name="",this.type="Material",this.blending=Oy,this.side=tx,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=cte,this.blendDst=ute,this.blendEquation=cm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=_6,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Vfe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=YB,this.stencilZFail=YB,this.stencilZPass=YB,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Oy&&(r.blending=this.blending),this.side!==tx&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class eb extends od{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pte,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Is=new ye,RA=new ot;class bc{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=S6,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)RA.fromBufferAttribute(this,t),RA.applyMatrix3(e),this.setXY(t,RA.x,RA.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix3(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix4(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Is.fromBufferAttribute(this,t),Is.applyNormalMatrix(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Is.fromBufferAttribute(this,t),Is.transformDirection(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Lp(t,this.array)),t}setX(e,t){return this.normalized&&(t=li(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Lp(t,this.array)),t}setY(e,t){return this.normalized&&(t=li(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Lp(t,this.array)),t}setZ(e,t){return this.normalized&&(t=li(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Lp(t,this.array)),t}setW(e,t){return this.normalized&&(t=li(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=li(t,this.array),r=li(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=li(t,this.array),r=li(r,this.array),i=li(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=li(t,this.array),r=li(r,this.array),i=li(i,this.array),s=li(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==S6&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Ste extends bc{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Mte extends bc{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Hn extends bc{constructor(e,t,r){super(new Float32Array(e),t,r)}}let cme=0;const Kc=new zn,u5=new wr,x_=new ye,oc=new sd,uS=new sd,wo=new ye;class Oi extends E0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cme++}),this.uuid=ru(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(_te(e)?Mte:Ste)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new ca().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Kc.makeRotationFromQuaternion(e),this.applyMatrix4(Kc),this}rotateX(e){return Kc.makeRotationX(e),this.applyMatrix4(Kc),this}rotateY(e){return Kc.makeRotationY(e),this.applyMatrix4(Kc),this}rotateZ(e){return Kc.makeRotationZ(e),this.applyMatrix4(Kc),this}translate(e,t,r){return Kc.makeTranslation(e,t,r),this.applyMatrix4(Kc),this}scale(e,t,r){return Kc.makeScale(e,t,r),this.applyMatrix4(Kc),this}lookAt(e){return u5.lookAt(e),u5.updateMatrix(),this.applyMatrix4(u5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(x_).negate(),this.translate(x_.x,x_.y,x_.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Hn(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new sd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ye(-1/0,-1/0,-1/0),new ye(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];oc.setFromBufferAttribute(s),this.morphTargetsRelative?(wo.addVectors(this.boundingBox.min,oc.min),this.boundingBox.expandByPoint(wo),wo.addVectors(this.boundingBox.max,oc.max),this.boundingBox.expandByPoint(wo)):(this.boundingBox.expandByPoint(oc.min),this.boundingBox.expandByPoint(oc.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jx);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ye,1/0);return}if(e){const r=this.boundingSphere.center;if(oc.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];uS.setFromBufferAttribute(a),this.morphTargetsRelative?(wo.addVectors(oc.min,uS.min),oc.expandByPoint(wo),wo.addVectors(oc.max,uS.max),oc.expandByPoint(wo)):(oc.expandByPoint(uS.min),oc.expandByPoint(uS.max))}oc.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)wo.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(wo));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)wo.fromBufferAttribute(a,u),c&&(x_.fromBufferAttribute(e,u),wo.add(x_)),i=Math.max(i,r.distanceToSquared(wo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new bc(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,u=[],d=[];for(let U=0;U<a;U++)u[U]=new ye,d[U]=new ye;const p=new ye,f=new ye,v=new ye,x=new ot,y=new ot,_=new ot,S=new ye,C=new ye;function A(U,ee,xe){p.fromArray(i,U*3),f.fromArray(i,ee*3),v.fromArray(i,xe*3),x.fromArray(o,U*2),y.fromArray(o,ee*2),_.fromArray(o,xe*2),f.sub(p),v.sub(p),y.sub(x),_.sub(x);const ce=1/(y.x*_.y-_.x*y.y);!isFinite(ce)||(S.copy(f).multiplyScalar(_.y).addScaledVector(v,-y.y).multiplyScalar(ce),C.copy(v).multiplyScalar(y.x).addScaledVector(f,-_.x).multiplyScalar(ce),u[U].add(S),u[ee].add(S),u[xe].add(S),d[U].add(C),d[ee].add(C),d[xe].add(C))}let P=this.groups;P.length===0&&(P=[{start:0,count:r.length}]);for(let U=0,ee=P.length;U<ee;++U){const xe=P[U],ce=xe.start,te=xe.count;for(let fe=ce,ge=ce+te;fe<ge;fe+=3)A(r[fe+0],r[fe+1],r[fe+2])}const D=new ye,N=new ye,j=new ye,T=new ye;function k(U){j.fromArray(s,U*3),T.copy(j);const ee=u[U];D.copy(ee),D.sub(j.multiplyScalar(j.dot(ee))).normalize(),N.crossVectors(T,ee);const xe=N.dot(d[U])<0?-1:1;c[U*4]=D.x,c[U*4+1]=D.y,c[U*4+2]=D.z,c[U*4+3]=xe}for(let U=0,ee=P.length;U<ee;++U){const xe=P[U],ce=xe.start,te=xe.count;for(let fe=ce,ge=ce+te;fe<ge;fe+=3)k(r[fe+0]),k(r[fe+1]),k(r[fe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new bc(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let f=0,v=r.count;f<v;f++)r.setXYZ(f,0,0,0);const i=new ye,s=new ye,o=new ye,a=new ye,c=new ye,u=new ye,d=new ye,p=new ye;if(e)for(let f=0,v=e.count;f<v;f+=3){const x=e.getX(f+0),y=e.getX(f+1),_=e.getX(f+2);i.fromBufferAttribute(t,x),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,_),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),a.fromBufferAttribute(r,x),c.fromBufferAttribute(r,y),u.fromBufferAttribute(r,_),a.add(d),c.add(d),u.add(d),r.setXYZ(x,a.x,a.y,a.z),r.setXYZ(y,c.x,c.y,c.z),r.setXYZ(_,u.x,u.y,u.z)}else for(let f=0,v=t.count;f<v;f+=3)i.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),r.setXYZ(f+0,d.x,d.y,d.z),r.setXYZ(f+1,d.x,d.y,d.z),r.setXYZ(f+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)wo.fromBufferAttribute(e,t),wo.normalize(),e.setXYZ(t,wo.x,wo.y,wo.z)}toNonIndexed(){function e(a,c){const u=a.array,d=a.itemSize,p=a.normalized,f=new u.constructor(c.length*d);let v=0,x=0;for(let y=0,_=c.length;y<_;y++){a.isInterleavedBufferAttribute?v=c[y]*a.data.stride+a.offset:v=c[y]*d;for(let S=0;S<d;S++)f[x++]=u[v++]}return new bc(f,d,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Oi,r=this.index.array,i=this.attributes;for(const a in i){const c=i[a],u=e(c,r);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const c=[],u=s[a];for(let d=0,p=u.length;d<p;d++){const f=u[d],v=e(f,r);c.push(v)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const c in r){const u=r[c];e.data.attributes[c]=u.toJSON(e.data)}const i={};let s=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],d=[];for(let p=0,f=u.length;p<f;p++){const v=u[p];d.push(v.toJSON(e.data))}d.length>0&&(i[c]=d,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const u in i){const d=i[u];this.setAttribute(u,d.clone(t))}const s=e.morphAttributes;for(const u in s){const d=[],p=s[u];for(let f=0,v=p.length;f<v;f++)d.push(p[f].clone(t));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const fG=new zn,b_=new Qx,h5=new Jx,Lf=new ye,Df=new ye,If=new ye,d5=new ye,p5=new ye,f5=new ye,OA=new ye,LA=new ye,DA=new ye,IA=new ot,NA=new ot,kA=new ot,m5=new ye,zA=new ye;class Io extends wr{constructor(e=new Oi,t=new eb){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=r.length;i<s;i++){const o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),h5.copy(r.boundingSphere),h5.applyMatrix4(s),e.ray.intersectsSphere(h5)===!1)||(fG.copy(s).invert(),b_.copy(e.ray).applyMatrix4(fG),r.boundingBox!==null&&b_.intersectsBox(r.boundingBox)===!1))return;let o;const a=r.index,c=r.attributes.position,u=r.morphAttributes.position,d=r.morphTargetsRelative,p=r.attributes.uv,f=r.attributes.uv2,v=r.groups,x=r.drawRange;if(a!==null)if(Array.isArray(i))for(let y=0,_=v.length;y<_;y++){const S=v[y],C=i[S.materialIndex],A=Math.max(S.start,x.start),P=Math.min(a.count,Math.min(S.start+S.count,x.start+x.count));for(let D=A,N=P;D<N;D+=3){const j=a.getX(D),T=a.getX(D+1),k=a.getX(D+2);o=BA(this,C,e,b_,c,u,d,p,f,j,T,k),o&&(o.faceIndex=Math.floor(D/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const y=Math.max(0,x.start),_=Math.min(a.count,x.start+x.count);for(let S=y,C=_;S<C;S+=3){const A=a.getX(S),P=a.getX(S+1),D=a.getX(S+2);o=BA(this,i,e,b_,c,u,d,p,f,A,P,D),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}else if(c!==void 0)if(Array.isArray(i))for(let y=0,_=v.length;y<_;y++){const S=v[y],C=i[S.materialIndex],A=Math.max(S.start,x.start),P=Math.min(c.count,Math.min(S.start+S.count,x.start+x.count));for(let D=A,N=P;D<N;D+=3){const j=D,T=D+1,k=D+2;o=BA(this,C,e,b_,c,u,d,p,f,j,T,k),o&&(o.faceIndex=Math.floor(D/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const y=Math.max(0,x.start),_=Math.min(c.count,x.start+x.count);for(let S=y,C=_;S<C;S+=3){const A=S,P=S+1,D=S+2;o=BA(this,i,e,b_,c,u,d,p,f,A,P,D),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}}}function ume(n,e,t,r,i,s,o,a){let c;if(e.side===Ol?c=r.intersectTriangle(o,s,i,!0,a):c=r.intersectTriangle(i,s,o,e.side!==zh,a),c===null)return null;zA.copy(a),zA.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(zA);return u<t.near||u>t.far?null:{distance:u,point:zA.clone(),object:n}}function BA(n,e,t,r,i,s,o,a,c,u,d,p){Lf.fromBufferAttribute(i,u),Df.fromBufferAttribute(i,d),If.fromBufferAttribute(i,p);const f=n.morphTargetInfluences;if(s&&f){OA.set(0,0,0),LA.set(0,0,0),DA.set(0,0,0);for(let x=0,y=s.length;x<y;x++){const _=f[x],S=s[x];_!==0&&(d5.fromBufferAttribute(S,u),p5.fromBufferAttribute(S,d),f5.fromBufferAttribute(S,p),o?(OA.addScaledVector(d5,_),LA.addScaledVector(p5,_),DA.addScaledVector(f5,_)):(OA.addScaledVector(d5.sub(Lf),_),LA.addScaledVector(p5.sub(Df),_),DA.addScaledVector(f5.sub(If),_)))}Lf.add(OA),Df.add(LA),If.add(DA)}n.isSkinnedMesh&&(n.boneTransform(u,Lf),n.boneTransform(d,Df),n.boneTransform(p,If));const v=ume(n,e,t,r,Lf,Df,If,m5);if(v){a&&(IA.fromBufferAttribute(a,u),NA.fromBufferAttribute(a,d),kA.fromBufferAttribute(a,p),v.uv=Nh.getUV(m5,Lf,Df,If,IA,NA,kA,new ot)),c&&(IA.fromBufferAttribute(c,u),NA.fromBufferAttribute(c,d),kA.fromBufferAttribute(c,p),v.uv2=Nh.getUV(m5,Lf,Df,If,IA,NA,kA,new ot));const x={a:u,b:d,c:p,normal:new ye,materialIndex:0};Nh.getNormal(Lf,Df,If,x.normal),v.face=x}return v}class A0 extends Oi{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const c=[],u=[],d=[],p=[];let f=0,v=0;x("z","y","x",-1,-1,r,t,e,o,s,0),x("z","y","x",1,-1,r,t,-e,o,s,1),x("x","z","y",1,1,e,r,t,i,o,2),x("x","z","y",1,-1,e,r,-t,i,o,3),x("x","y","z",1,-1,e,t,r,i,s,4),x("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(c),this.setAttribute("position",new Hn(u,3)),this.setAttribute("normal",new Hn(d,3)),this.setAttribute("uv",new Hn(p,2));function x(y,_,S,C,A,P,D,N,j,T,k){const U=P/j,ee=D/T,xe=P/2,ce=D/2,te=N/2,fe=j+1,ge=T+1;let Se=0,pe=0;const se=new ye;for(let ae=0;ae<ge;ae++){const Le=ae*ee-ce;for(let Re=0;Re<fe;Re++){const Ue=Re*U-xe;se[y]=Ue*C,se[_]=Le*A,se[S]=te,u.push(se.x,se.y,se.z),se[y]=0,se[_]=0,se[S]=N>0?1:-1,d.push(se.x,se.y,se.z),p.push(Re/j),p.push(1-ae/T),Se+=1}}for(let ae=0;ae<T;ae++)for(let Le=0;Le<j;Le++){const Re=f+Le+fe*ae,Ue=f+Le+fe*(ae+1),Ze=f+(Le+1)+fe*(ae+1),st=f+(Le+1)+fe*ae;c.push(Re,Ue,st),c.push(Ue,Ze,st),pe+=6}a.addGroup(v,pe,k),v+=pe,f+=Se}}static fromJSON(e){return new A0(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ox(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Ca(n){const e={};for(let t=0;t<n.length;t++){const r=ox(n[t]);for(const i in r)e[i]=r[i]}return e}function hme(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}const aa={clone:ox,merge:Ca};var dme=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,pme=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Nr extends od{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=dme,this.fragmentShader=pme,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ox(e.uniforms),this.uniformsGroups=hme(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const s=this.uniforms[i].value;s&&s.isTexture?t.uniforms[i]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[i]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[i]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[i]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[i]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[i]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[i]={type:"m4",value:s.toArray()}:t.uniforms[i]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Yj extends wr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new zn,this.projectionMatrix=new zn,this.projectionMatrixInverse=new zn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class oo extends Yj{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=qM*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(gM*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return qM*2*Math.atan(Math.tan(gM*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(gM*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,u=o.fullHeight;s+=o.offsetX*i/c,t-=o.offsetY*r/u,i*=o.width/c,r*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const w_=90,S_=1;class Zj extends wr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;const i=new oo(w_,S_,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new ye(1,0,0)),this.add(i);const s=new oo(w_,S_,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ye(-1,0,0)),this.add(s);const o=new oo(w_,S_,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new ye(0,1,0)),this.add(o);const a=new oo(w_,S_,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new ye(0,-1,0)),this.add(a);const c=new oo(w_,S_,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new ye(0,0,1)),this.add(c);const u=new oo(w_,S_,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new ye(0,0,-1)),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[i,s,o,a,c,u]=this.children,d=e.getRenderTarget(),p=e.toneMapping,f=e.xr.enabled;e.toneMapping=qh,e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,s),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=v,e.setRenderTarget(r,5),e.render(t,u),e.setRenderTarget(d),e.toneMapping=p,e.xr.enabled=f,r.texture.needsPMREMUpdate=!0}}class Kj extends da{constructor(e,t,r,i,s,o,a,c,u,d){e=e!==void 0?e:[],t=t!==void 0?t:nx,super(e,t,r,i,s,o,a,c,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Jj extends Ei{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new Kj(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Vs}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new A0(5,5,5),s=new Nr({name:"CubemapFromEquirect",uniforms:ox(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ol,blending:ks});s.uniforms.tEquirect.value=t;const o=new Io(i,s),a=t.minFilter;return t.minFilter===kC&&(t.minFilter=Vs),new Zj(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const v5=new ye,fme=new ye,mme=new ca;class zg{constructor(e=new ye(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=v5.subVectors(r,t).cross(fme.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(v5),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(r).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||mme.getNormalMatrix(e),i=this.coplanarPoint(v5).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const M_=new Jx,VA=new ye;class vL{constructor(e=new zg,t=new zg,r=new zg,i=new zg,s=new zg,o=new zg){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],d=r[6],p=r[7],f=r[8],v=r[9],x=r[10],y=r[11],_=r[12],S=r[13],C=r[14],A=r[15];return t[0].setComponents(a-i,p-c,y-f,A-_).normalize(),t[1].setComponents(a+i,p+c,y+f,A+_).normalize(),t[2].setComponents(a+s,p+u,y+v,A+S).normalize(),t[3].setComponents(a-s,p-u,y-v,A-S).normalize(),t[4].setComponents(a-o,p-d,y-x,A-C).normalize(),t[5].setComponents(a+o,p+d,y+x,A+C).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),M_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(M_)}intersectsSprite(e){return M_.center.set(0,0,0),M_.radius=.7071067811865476,M_.applyMatrix4(e.matrixWorld),this.intersectsSphere(M_)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(VA.x=i.normal.x>0?e.max.x:e.min.x,VA.y=i.normal.y>0?e.max.y:e.min.y,VA.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(VA)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Cte(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function vme(n,e){const t=e.isWebGL2,r=new WeakMap;function i(u,d){const p=u.array,f=u.usage,v=n.createBuffer();n.bindBuffer(d,v),n.bufferData(d,p,f),u.onUploadCallback();let x;if(p instanceof Float32Array)x=5126;else if(p instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)x=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=5123;else if(p instanceof Int16Array)x=5122;else if(p instanceof Uint32Array)x=5125;else if(p instanceof Int32Array)x=5124;else if(p instanceof Int8Array)x=5120;else if(p instanceof Uint8Array)x=5121;else if(p instanceof Uint8ClampedArray)x=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version}}function s(u,d,p){const f=d.array,v=d.updateRange;n.bindBuffer(p,u),v.count===-1?n.bufferSubData(p,0,f):(t?n.bufferSubData(p,v.offset*f.BYTES_PER_ELEMENT,f,v.offset,v.count):n.bufferSubData(p,v.offset*f.BYTES_PER_ELEMENT,f.subarray(v.offset,v.offset+v.count)),v.count=-1)}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=r.get(u);d&&(n.deleteBuffer(d.buffer),r.delete(u))}function c(u,d){if(u.isGLBufferAttribute){const f=r.get(u);(!f||f.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const p=r.get(u);p===void 0?r.set(u,i(u,d)):p.version<u.version&&(s(p.buffer,u,d),p.version=u.version)}return{get:o,remove:a,update:c}}class BC extends Oi{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),c=Math.floor(i),u=a+1,d=c+1,p=e/a,f=t/c,v=[],x=[],y=[],_=[];for(let S=0;S<d;S++){const C=S*f-o;for(let A=0;A<u;A++){const P=A*p-s;x.push(P,-C,0),y.push(0,0,1),_.push(A/a),_.push(1-S/c)}}for(let S=0;S<c;S++)for(let C=0;C<a;C++){const A=C+u*S,P=C+u*(S+1),D=C+1+u*(S+1),N=C+1+u*S;v.push(A,P,N),v.push(P,D,N)}this.setIndex(v),this.setAttribute("position",new Hn(x,3)),this.setAttribute("normal",new Hn(y,3)),this.setAttribute("uv",new Hn(_,2))}static fromJSON(e){return new BC(e.width,e.height,e.widthSegments,e.heightSegments)}}var gme=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,_me=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,yme=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,xme=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,bme=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,wme=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Sme="vec3 transformed = vec3( position );",Mme=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Cme=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Eme=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Ame=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Pme=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Tme=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Rme=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Ome=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Lme=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Dme=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ime=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Nme=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,kme=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,zme=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Bme=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Vme=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Fme=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Ume=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,jme=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Hme="gl_FragColor = linearToOutputTexel( gl_FragColor );",Wme=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Gme=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Xme=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,qme=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Yme=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Zme=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Kme=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Jme=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Qme=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,$me=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,eve=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,tve=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,nve=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,rve=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ive=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
#define Material_LightProbeLOD( material )	(0)`,sve=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,ove=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,ave=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lve=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,cve=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,uve=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,hve=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,dve=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,pve=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,fve=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,mve=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,vve=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,gve=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,_ve=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,yve=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,xve=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,bve=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wve=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Sve=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Mve=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Cve=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Eve=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ave=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Pve=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Tve=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Rve=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Ove=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Lve=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dve=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Ive=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Nve=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,kve=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,zve=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Bve=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Vve=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Fve=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Uve=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,jve=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Hve=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Wve=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Gve=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Xve=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,qve=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Yve=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Zve=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Kve=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Jve=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Qve=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,$ve=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,ege=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,tge=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,nge=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,rge=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,ige=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,sge=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,oge=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,age=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,lge=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,cge=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uge=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,hge=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,dge=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,pge=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,fge=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const mge=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,vge=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,gge=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_ge=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,yge=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,xge=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,bge=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,wge=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Sge=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Mge=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Cge=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ege=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Age=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Pge=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tge=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rge=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Oge=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Lge=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dge=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Ige=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Nge=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kge=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zge=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Bge=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vge=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Fge=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Uge=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,jge=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Hge=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Wge=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Gge=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xge=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,er={alphamap_fragment:gme,alphamap_pars_fragment:_me,alphatest_fragment:yme,alphatest_pars_fragment:xme,aomap_fragment:bme,aomap_pars_fragment:wme,begin_vertex:Sme,beginnormal_vertex:Mme,bsdfs:Cme,iridescence_fragment:Eme,bumpmap_pars_fragment:Ame,clipping_planes_fragment:Pme,clipping_planes_pars_fragment:Tme,clipping_planes_pars_vertex:Rme,clipping_planes_vertex:Ome,color_fragment:Lme,color_pars_fragment:Dme,color_pars_vertex:Ime,color_vertex:Nme,common:kme,cube_uv_reflection_fragment:zme,defaultnormal_vertex:Bme,displacementmap_pars_vertex:Vme,displacementmap_vertex:Fme,emissivemap_fragment:Ume,emissivemap_pars_fragment:jme,encodings_fragment:Hme,encodings_pars_fragment:Wme,envmap_fragment:Gme,envmap_common_pars_fragment:Xme,envmap_pars_fragment:qme,envmap_pars_vertex:Yme,envmap_physical_pars_fragment:ove,envmap_vertex:Zme,fog_vertex:Kme,fog_pars_vertex:Jme,fog_fragment:Qme,fog_pars_fragment:$me,gradientmap_pars_fragment:eve,lightmap_fragment:tve,lightmap_pars_fragment:nve,lights_lambert_fragment:rve,lights_lambert_pars_fragment:ive,lights_pars_begin:sve,lights_toon_fragment:ave,lights_toon_pars_fragment:lve,lights_phong_fragment:cve,lights_phong_pars_fragment:uve,lights_physical_fragment:hve,lights_physical_pars_fragment:dve,lights_fragment_begin:pve,lights_fragment_maps:fve,lights_fragment_end:mve,logdepthbuf_fragment:vve,logdepthbuf_pars_fragment:gve,logdepthbuf_pars_vertex:_ve,logdepthbuf_vertex:yve,map_fragment:xve,map_pars_fragment:bve,map_particle_fragment:wve,map_particle_pars_fragment:Sve,metalnessmap_fragment:Mve,metalnessmap_pars_fragment:Cve,morphcolor_vertex:Eve,morphnormal_vertex:Ave,morphtarget_pars_vertex:Pve,morphtarget_vertex:Tve,normal_fragment_begin:Rve,normal_fragment_maps:Ove,normal_pars_fragment:Lve,normal_pars_vertex:Dve,normal_vertex:Ive,normalmap_pars_fragment:Nve,clearcoat_normal_fragment_begin:kve,clearcoat_normal_fragment_maps:zve,clearcoat_pars_fragment:Bve,iridescence_pars_fragment:Vve,output_fragment:Fve,packing:Uve,premultiplied_alpha_fragment:jve,project_vertex:Hve,dithering_fragment:Wve,dithering_pars_fragment:Gve,roughnessmap_fragment:Xve,roughnessmap_pars_fragment:qve,shadowmap_pars_fragment:Yve,shadowmap_pars_vertex:Zve,shadowmap_vertex:Kve,shadowmask_pars_fragment:Jve,skinbase_vertex:Qve,skinning_pars_vertex:$ve,skinning_vertex:ege,skinnormal_vertex:tge,specularmap_fragment:nge,specularmap_pars_fragment:rge,tonemapping_fragment:ige,tonemapping_pars_fragment:sge,transmission_fragment:oge,transmission_pars_fragment:age,uv_pars_fragment:lge,uv_pars_vertex:cge,uv_vertex:uge,uv2_pars_fragment:hge,uv2_pars_vertex:dge,uv2_vertex:pge,worldpos_vertex:fge,background_vert:mge,background_frag:vge,cube_vert:gge,cube_frag:_ge,depth_vert:yge,depth_frag:xge,distanceRGBA_vert:bge,distanceRGBA_frag:wge,equirect_vert:Sge,equirect_frag:Mge,linedashed_vert:Cge,linedashed_frag:Ege,meshbasic_vert:Age,meshbasic_frag:Pge,meshlambert_vert:Tge,meshlambert_frag:Rge,meshmatcap_vert:Oge,meshmatcap_frag:Lge,meshnormal_vert:Dge,meshnormal_frag:Ige,meshphong_vert:Nge,meshphong_frag:kge,meshphysical_vert:zge,meshphysical_frag:Bge,meshtoon_vert:Vge,meshtoon_frag:Fge,points_vert:Uge,points_frag:jge,shadow_vert:Hge,shadow_frag:Wge,sprite_vert:Gge,sprite_frag:Xge},Lt={common:{diffuse:{value:new Xt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ca},uv2Transform:{value:new ca},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ca}},sprite:{diffuse:{value:new Xt(16777215)},opacity:{value:1},center:{value:new ot(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ca}}},Ju={basic:{uniforms:Ca([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.fog]),vertexShader:er.meshbasic_vert,fragmentShader:er.meshbasic_frag},lambert:{uniforms:Ca([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,Lt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:er.meshlambert_vert,fragmentShader:er.meshlambert_frag},phong:{uniforms:Ca([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,Lt.lights,{emissive:{value:new Xt(0)},specular:{value:new Xt(1118481)},shininess:{value:30}}]),vertexShader:er.meshphong_vert,fragmentShader:er.meshphong_frag},standard:{uniforms:Ca([Lt.common,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.roughnessmap,Lt.metalnessmap,Lt.fog,Lt.lights,{emissive:{value:new Xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:er.meshphysical_vert,fragmentShader:er.meshphysical_frag},toon:{uniforms:Ca([Lt.common,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.gradientmap,Lt.fog,Lt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:er.meshtoon_vert,fragmentShader:er.meshtoon_frag},matcap:{uniforms:Ca([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,{matcap:{value:null}}]),vertexShader:er.meshmatcap_vert,fragmentShader:er.meshmatcap_frag},points:{uniforms:Ca([Lt.points,Lt.fog]),vertexShader:er.points_vert,fragmentShader:er.points_frag},dashed:{uniforms:Ca([Lt.common,Lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:er.linedashed_vert,fragmentShader:er.linedashed_frag},depth:{uniforms:Ca([Lt.common,Lt.displacementmap]),vertexShader:er.depth_vert,fragmentShader:er.depth_frag},normal:{uniforms:Ca([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,{opacity:{value:1}}]),vertexShader:er.meshnormal_vert,fragmentShader:er.meshnormal_frag},sprite:{uniforms:Ca([Lt.sprite,Lt.fog]),vertexShader:er.sprite_vert,fragmentShader:er.sprite_frag},background:{uniforms:{uvTransform:{value:new ca},t2D:{value:null}},vertexShader:er.background_vert,fragmentShader:er.background_frag},cube:{uniforms:Ca([Lt.envmap,{opacity:{value:1}}]),vertexShader:er.cube_vert,fragmentShader:er.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:er.equirect_vert,fragmentShader:er.equirect_frag},distanceRGBA:{uniforms:Ca([Lt.common,Lt.displacementmap,{referencePosition:{value:new ye},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:er.distanceRGBA_vert,fragmentShader:er.distanceRGBA_frag},shadow:{uniforms:Ca([Lt.lights,Lt.fog,{color:{value:new Xt(0)},opacity:{value:1}}]),vertexShader:er.shadow_vert,fragmentShader:er.shadow_frag}};Ju.physical={uniforms:Ca([Ju.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ot(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Xt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ot},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Xt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Xt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:er.meshphysical_vert,fragmentShader:er.meshphysical_frag};function qge(n,e,t,r,i,s){const o=new Xt(0);let a=i===!0?0:1,c,u,d=null,p=0,f=null;function v(y,_){let S=!1,C=_.isScene===!0?_.background:null;C&&C.isTexture&&(C=e.get(C));const A=n.xr,P=A.getSession&&A.getSession();P&&P.environmentBlendMode==="additive"&&(C=null),C===null?x(o,a):C&&C.isColor&&(x(C,1),S=!0),(n.autoClear||S)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),C&&(C.isCubeTexture||C.mapping===fL)?(u===void 0&&(u=new Io(new A0(1,1,1),new Nr({name:"BackgroundCubeMaterial",uniforms:ox(Ju.cube.uniforms),vertexShader:Ju.cube.vertexShader,fragmentShader:Ju.cube.fragmentShader,side:Ol,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(D,N,j){this.matrixWorld.copyPosition(j.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=C,u.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,(d!==C||p!==C.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=C,p=C.version,f=n.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null)):C&&C.isTexture&&(c===void 0&&(c=new Io(new BC(2,2),new Nr({name:"BackgroundMaterial",uniforms:ox(Ju.background.uniforms),vertexShader:Ju.background.vertexShader,fragmentShader:Ju.background.fragmentShader,side:tx,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=C,C.matrixAutoUpdate===!0&&C.updateMatrix(),c.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||p!==C.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=C,p=C.version,f=n.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null))}function x(y,_){t.buffers.color.setClear(y.r,y.g,y.b,_,s)}return{getClearColor:function(){return o},setClearColor:function(y,_=1){o.set(y),a=_,x(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(y){a=y,x(o,a)},render:v}}function Yge(n,e,t,r){const i=n.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},c=_(null);let u=c,d=!1;function p(te,fe,ge,Se,pe){let se=!1;if(o){const ae=y(Se,ge,fe);u!==ae&&(u=ae,v(u.object)),se=S(te,Se,ge,pe),se&&C(te,Se,ge,pe)}else{const ae=fe.wireframe===!0;(u.geometry!==Se.id||u.program!==ge.id||u.wireframe!==ae)&&(u.geometry=Se.id,u.program=ge.id,u.wireframe=ae,se=!0)}pe!==null&&t.update(pe,34963),(se||d)&&(d=!1,T(te,fe,ge,Se),pe!==null&&n.bindBuffer(34963,t.get(pe).buffer))}function f(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function v(te){return r.isWebGL2?n.bindVertexArray(te):s.bindVertexArrayOES(te)}function x(te){return r.isWebGL2?n.deleteVertexArray(te):s.deleteVertexArrayOES(te)}function y(te,fe,ge){const Se=ge.wireframe===!0;let pe=a[te.id];pe===void 0&&(pe={},a[te.id]=pe);let se=pe[fe.id];se===void 0&&(se={},pe[fe.id]=se);let ae=se[Se];return ae===void 0&&(ae=_(f()),se[Se]=ae),ae}function _(te){const fe=[],ge=[],Se=[];for(let pe=0;pe<i;pe++)fe[pe]=0,ge[pe]=0,Se[pe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:ge,attributeDivisors:Se,object:te,attributes:{},index:null}}function S(te,fe,ge,Se){const pe=u.attributes,se=fe.attributes;let ae=0;const Le=ge.getAttributes();for(const Re in Le)if(Le[Re].location>=0){const Ue=pe[Re];let Ze=se[Re];if(Ze===void 0&&(Re==="instanceMatrix"&&te.instanceMatrix&&(Ze=te.instanceMatrix),Re==="instanceColor"&&te.instanceColor&&(Ze=te.instanceColor)),Ue===void 0||Ue.attribute!==Ze||Ze&&Ue.data!==Ze.data)return!0;ae++}return u.attributesNum!==ae||u.index!==Se}function C(te,fe,ge,Se){const pe={},se=fe.attributes;let ae=0;const Le=ge.getAttributes();for(const Re in Le)if(Le[Re].location>=0){let Ue=se[Re];Ue===void 0&&(Re==="instanceMatrix"&&te.instanceMatrix&&(Ue=te.instanceMatrix),Re==="instanceColor"&&te.instanceColor&&(Ue=te.instanceColor));const Ze={};Ze.attribute=Ue,Ue&&Ue.data&&(Ze.data=Ue.data),pe[Re]=Ze,ae++}u.attributes=pe,u.attributesNum=ae,u.index=Se}function A(){const te=u.newAttributes;for(let fe=0,ge=te.length;fe<ge;fe++)te[fe]=0}function P(te){D(te,0)}function D(te,fe){const ge=u.newAttributes,Se=u.enabledAttributes,pe=u.attributeDivisors;ge[te]=1,Se[te]===0&&(n.enableVertexAttribArray(te),Se[te]=1),pe[te]!==fe&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](te,fe),pe[te]=fe)}function N(){const te=u.newAttributes,fe=u.enabledAttributes;for(let ge=0,Se=fe.length;ge<Se;ge++)fe[ge]!==te[ge]&&(n.disableVertexAttribArray(ge),fe[ge]=0)}function j(te,fe,ge,Se,pe,se){r.isWebGL2===!0&&(ge===5124||ge===5125)?n.vertexAttribIPointer(te,fe,ge,pe,se):n.vertexAttribPointer(te,fe,ge,Se,pe,se)}function T(te,fe,ge,Se){if(r.isWebGL2===!1&&(te.isInstancedMesh||Se.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;A();const pe=Se.attributes,se=ge.getAttributes(),ae=fe.defaultAttributeValues;for(const Le in se){const Re=se[Le];if(Re.location>=0){let Ue=pe[Le];if(Ue===void 0&&(Le==="instanceMatrix"&&te.instanceMatrix&&(Ue=te.instanceMatrix),Le==="instanceColor"&&te.instanceColor&&(Ue=te.instanceColor)),Ue!==void 0){const Ze=Ue.normalized,st=Ue.itemSize,we=t.get(Ue);if(we===void 0)continue;const Mt=we.buffer,rt=we.type,it=we.bytesPerElement;if(Ue.isInterleavedBufferAttribute){const Ke=Ue.data,Qe=Ke.stride,Y=Ue.offset;if(Ke.isInstancedInterleavedBuffer){for(let K=0;K<Re.locationSize;K++)D(Re.location+K,Ke.meshPerAttribute);te.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Ke.meshPerAttribute*Ke.count)}else for(let K=0;K<Re.locationSize;K++)P(Re.location+K);n.bindBuffer(34962,Mt);for(let K=0;K<Re.locationSize;K++)j(Re.location+K,st/Re.locationSize,rt,Ze,Qe*it,(Y+st/Re.locationSize*K)*it)}else{if(Ue.isInstancedBufferAttribute){for(let Ke=0;Ke<Re.locationSize;Ke++)D(Re.location+Ke,Ue.meshPerAttribute);te.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Ue.meshPerAttribute*Ue.count)}else for(let Ke=0;Ke<Re.locationSize;Ke++)P(Re.location+Ke);n.bindBuffer(34962,Mt);for(let Ke=0;Ke<Re.locationSize;Ke++)j(Re.location+Ke,st/Re.locationSize,rt,Ze,st*it,st/Re.locationSize*Ke*it)}}else if(ae!==void 0){const Ze=ae[Le];if(Ze!==void 0)switch(Ze.length){case 2:n.vertexAttrib2fv(Re.location,Ze);break;case 3:n.vertexAttrib3fv(Re.location,Ze);break;case 4:n.vertexAttrib4fv(Re.location,Ze);break;default:n.vertexAttrib1fv(Re.location,Ze)}}}}N()}function k(){xe();for(const te in a){const fe=a[te];for(const ge in fe){const Se=fe[ge];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete fe[ge]}delete a[te]}}function U(te){if(a[te.id]===void 0)return;const fe=a[te.id];for(const ge in fe){const Se=fe[ge];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete fe[ge]}delete a[te.id]}function ee(te){for(const fe in a){const ge=a[fe];if(ge[te.id]===void 0)continue;const Se=ge[te.id];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete ge[te.id]}}function xe(){ce(),d=!0,u!==c&&(u=c,v(u.object))}function ce(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:p,reset:xe,resetDefaultState:ce,dispose:k,releaseStatesOfGeometry:U,releaseStatesOfProgram:ee,initAttributes:A,enableAttribute:P,disableUnusedAttributes:N}}function Zge(n,e,t,r){const i=r.isWebGL2;let s;function o(u){s=u}function a(u,d){n.drawArrays(s,u,d),t.update(d,s,1)}function c(u,d,p){if(p===0)return;let f,v;if(i)f=n,v="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[v](s,u,d,p),t.update(d,s,p)}this.setMode=o,this.render=a,this.renderInstances=c}function Kge(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const j=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(j.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(j){if(j==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";j="mediump"}return j==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const u=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,p=n.getParameter(34930),f=n.getParameter(35660),v=n.getParameter(3379),x=n.getParameter(34076),y=n.getParameter(34921),_=n.getParameter(36347),S=n.getParameter(36348),C=n.getParameter(36349),A=f>0,P=o||e.has("OES_texture_float"),D=A&&P,N=o?n.getParameter(36183):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:p,maxVertexTextures:f,maxTextureSize:v,maxCubemapSize:x,maxAttributes:y,maxVertexUniforms:_,maxVaryings:S,maxFragmentUniforms:C,vertexTextures:A,floatFragmentTextures:P,floatVertexTextures:D,maxSamples:N}}function Jge(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new zg,a=new ca,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(p,f,v){const x=p.length!==0||f||r!==0||i;return i=f,t=d(p,v,0),r=p.length,x},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,u()},this.setState=function(p,f,v){const x=p.clippingPlanes,y=p.clipIntersection,_=p.clipShadows,S=n.get(p);if(!i||x===null||x.length===0||s&&!_)s?d(null):u();else{const C=s?0:r,A=C*4;let P=S.clippingState||null;c.value=P,P=d(x,f,A,v);for(let D=0;D!==A;++D)P[D]=t[D];S.clippingState=P,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=C}};function u(){c.value!==t&&(c.value=t,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(p,f,v,x){const y=p!==null?p.length:0;let _=null;if(y!==0){if(_=c.value,x!==!0||_===null){const S=v+y*4,C=f.matrixWorldInverse;a.getNormalMatrix(C),(_===null||_.length<S)&&(_=new Float32Array(S));for(let A=0,P=v;A!==y;++A,P+=4)o.copy(p[A]).applyMatrix4(C,a),o.normal.toArray(_,P),_[P+3]=o.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,_}}function Qge(n){let e=new WeakMap;function t(o,a){return a===XM?o.mapping=nx:a===y6&&(o.mapping=rx),o}function r(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===XM||a===y6)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const u=new Jj(c.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class VC extends Yj{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,c=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,c=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const yy=4,mG=[.125,.215,.35,.446,.526,.582],Gg=20,g5=new VC,vG=new Xt;let _5=null;const Bg=(1+Math.sqrt(5))/2,C_=1/Bg,gG=[new ye(1,1,1),new ye(-1,1,1),new ye(1,1,-1),new ye(-1,1,-1),new ye(0,Bg,C_),new ye(0,Bg,-C_),new ye(C_,0,Bg),new ye(-C_,0,Bg),new ye(Bg,C_,0),new ye(-Bg,C_,0)];class _G{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){_5=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=bG(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=xG(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_5),e.scissorTest=!1,FA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===nx||e.mapping===rx?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_5=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Vs,minFilter:Vs,generateMipmaps:!1,type:Op,format:nh,encoding:Am,depthBuffer:!1},i=yG(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=yG(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=$ge(s)),this._blurMaterial=e0e(s,e,t)}return i}_compileMaterial(e){const t=new Io(this._lodPlanes[0],e);this._renderer.compile(t,g5)}_sceneToCubeUV(e,t,r,i){const s=new oo(90,1,t,r),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,d=c.toneMapping;c.getClearColor(vG),c.toneMapping=qh,c.autoClear=!1;const p=new eb({name:"PMREM.Background",side:Ol,depthWrite:!1,depthTest:!1}),f=new Io(new A0,p);let v=!1;const x=e.background;x?x.isColor&&(p.color.copy(x),e.background=null,v=!0):(p.color.copy(vG),v=!0);for(let y=0;y<6;y++){const _=y%3;_===0?(s.up.set(0,o[y],0),s.lookAt(a[y],0,0)):_===1?(s.up.set(0,0,o[y]),s.lookAt(0,a[y],0)):(s.up.set(0,o[y],0),s.lookAt(0,0,a[y]));const S=this._cubeSize;FA(i,_*S,y>2?S:0,S,S),c.setRenderTarget(i),v&&c.render(f,s),c.render(e,s)}f.geometry.dispose(),f.material.dispose(),c.toneMapping=d,c.autoClear=u,e.background=x}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===nx||e.mapping===rx;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=bG()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=xG());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new Io(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;FA(t,0,0,3*c,2*c),r.setRenderTarget(t),r.render(o,g5)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=gG[(i-1)%gG.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const c=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,p=new Io(this._lodPlanes[i],u),f=u.uniforms,v=this._sizeLods[r]-1,x=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Gg-1),y=s/x,_=isFinite(s)?1+Math.floor(d*y):Gg;_>Gg&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${Gg}`);const S=[];let C=0;for(let j=0;j<Gg;++j){const T=j/y,k=Math.exp(-T*T/2);S.push(k),j===0?C+=k:j<_&&(C+=2*k)}for(let j=0;j<S.length;j++)S[j]=S[j]/C;f.envMap.value=e.texture,f.samples.value=_,f.weights.value=S,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a);const{_lodMax:A}=this;f.dTheta.value=x,f.mipInt.value=A-r;const P=this._sizeLods[i],D=3*P*(i>A-yy?i-A+yy:0),N=4*(this._cubeSize-P);FA(t,D,N,3*P,2*P),c.setRenderTarget(t),c.render(p,g5)}}function $ge(n){const e=[],t=[],r=[];let i=n;const s=n-yy+1+mG.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let c=1/a;o>n-yy?c=mG[o-n+yy-1]:o===0&&(c=0),r.push(c);const u=1/(a-2),d=-u,p=1+u,f=[d,d,p,d,p,p,d,d,p,p,d,p],v=6,x=6,y=3,_=2,S=1,C=new Float32Array(y*x*v),A=new Float32Array(_*x*v),P=new Float32Array(S*x*v);for(let N=0;N<v;N++){const j=N%3*2/3-1,T=N>2?0:-1,k=[j,T,0,j+2/3,T,0,j+2/3,T+1,0,j,T,0,j+2/3,T+1,0,j,T+1,0];C.set(k,y*x*N),A.set(f,_*x*N);const U=[N,N,N,N,N,N];P.set(U,S*x*N)}const D=new Oi;D.setAttribute("position",new bc(C,y)),D.setAttribute("uv",new bc(A,_)),D.setAttribute("faceIndex",new bc(P,S)),e.push(D),i>yy&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function yG(n,e,t){const r=new Ei(n,e,t);return r.texture.mapping=fL,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function FA(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function e0e(n,e,t){const r=new Float32Array(Gg),i=new ye(0,1,0);return new Nr({name:"SphericalGaussianBlur",defines:{n:Gg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Qj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ks,depthTest:!1,depthWrite:!1})}function xG(){return new Nr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Qj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ks,depthTest:!1,depthWrite:!1})}function bG(){return new Nr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Qj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ks,depthTest:!1,depthWrite:!1})}function Qj(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function t0e(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const c=a.mapping,u=c===XM||c===y6,d=c===nx||c===rx;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let p=e.get(a);return t===null&&(t=new _G(n)),p=u?t.fromEquirectangular(a,p):t.fromCubemap(a,p),e.set(a,p),p.texture}else{if(e.has(a))return e.get(a).texture;{const p=a.image;if(u&&p&&p.height>0||d&&p&&i(p)){t===null&&(t=new _G(n));const f=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,f),a.addEventListener("dispose",s),f.texture}else return null}}}return a}function i(a){let c=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&c++;return c===u}function s(a){const c=a.target;c.removeEventListener("dispose",s);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function n0e(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function r0e(n,e,t,r){const i={},s=new WeakMap;function o(p){const f=p.target;f.index!==null&&e.remove(f.index);for(const x in f.attributes)e.remove(f.attributes[x]);f.removeEventListener("dispose",o),delete i[f.id];const v=s.get(f);v&&(e.remove(v),s.delete(f)),r.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function a(p,f){return i[f.id]===!0||(f.addEventListener("dispose",o),i[f.id]=!0,t.memory.geometries++),f}function c(p){const f=p.attributes;for(const x in f)e.update(f[x],34962);const v=p.morphAttributes;for(const x in v){const y=v[x];for(let _=0,S=y.length;_<S;_++)e.update(y[_],34962)}}function u(p){const f=[],v=p.index,x=p.attributes.position;let y=0;if(v!==null){const C=v.array;y=v.version;for(let A=0,P=C.length;A<P;A+=3){const D=C[A+0],N=C[A+1],j=C[A+2];f.push(D,N,N,j,j,D)}}else{const C=x.array;y=x.version;for(let A=0,P=C.length/3-1;A<P;A+=3){const D=A+0,N=A+1,j=A+2;f.push(D,N,N,j,j,D)}}const _=new(_te(f)?Mte:Ste)(f,1);_.version=y;const S=s.get(p);S&&e.remove(S),s.set(p,_)}function d(p){const f=s.get(p);if(f){const v=p.index;v!==null&&f.version<v.version&&u(p)}else u(p);return s.get(p)}return{get:a,update:c,getWireframeAttribute:d}}function i0e(n,e,t,r){const i=r.isWebGL2;let s;function o(f){s=f}let a,c;function u(f){a=f.type,c=f.bytesPerElement}function d(f,v){n.drawElements(s,v,a,f*c),t.update(v,s,1)}function p(f,v,x){if(x===0)return;let y,_;if(i)y=n,_="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[_](s,v,a,f*c,x),t.update(v,s,x)}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=p}function s0e(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function o0e(n,e){return n[0]-e[0]}function a0e(n,e){return Math.abs(e[1])-Math.abs(n[1])}function l0e(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new Ir,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function c(u,d,p,f){const v=u.morphTargetInfluences;if(e.isWebGL2===!0){const x=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,y=x!==void 0?x.length:0;let _=s.get(d);if(_===void 0||_.count!==y){let A=function(){te.dispose(),s.delete(d),d.removeEventListener("dispose",A)};_!==void 0&&_.texture.dispose();const P=d.morphAttributes.position!==void 0,D=d.morphAttributes.normal!==void 0,N=d.morphAttributes.color!==void 0,j=d.morphAttributes.position||[],T=d.morphAttributes.normal||[],k=d.morphAttributes.color||[];let U=0;P===!0&&(U=1),D===!0&&(U=2),N===!0&&(U=3);let ee=d.attributes.position.count*U,xe=1;ee>e.maxTextureSize&&(xe=Math.ceil(ee/e.maxTextureSize),ee=e.maxTextureSize);const ce=new Float32Array(ee*xe*4*y),te=new wte(ce,ee,xe,y);te.type=th,te.needsUpdate=!0;const fe=U*4;for(let ge=0;ge<y;ge++){const Se=j[ge],pe=T[ge],se=k[ge],ae=ee*xe*4*ge;for(let Le=0;Le<Se.count;Le++){const Re=Le*fe;P===!0&&(o.fromBufferAttribute(Se,Le),ce[ae+Re+0]=o.x,ce[ae+Re+1]=o.y,ce[ae+Re+2]=o.z,ce[ae+Re+3]=0),D===!0&&(o.fromBufferAttribute(pe,Le),ce[ae+Re+4]=o.x,ce[ae+Re+5]=o.y,ce[ae+Re+6]=o.z,ce[ae+Re+7]=0),N===!0&&(o.fromBufferAttribute(se,Le),ce[ae+Re+8]=o.x,ce[ae+Re+9]=o.y,ce[ae+Re+10]=o.z,ce[ae+Re+11]=se.itemSize===4?o.w:1)}}_={count:y,texture:te,size:new ot(ee,xe)},s.set(d,_),d.addEventListener("dispose",A)}let S=0;for(let A=0;A<v.length;A++)S+=v[A];const C=d.morphTargetsRelative?1:1-S;f.getUniforms().setValue(n,"morphTargetBaseInfluence",C),f.getUniforms().setValue(n,"morphTargetInfluences",v),f.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const x=v===void 0?0:v.length;let y=r[d.id];if(y===void 0||y.length!==x){y=[];for(let P=0;P<x;P++)y[P]=[P,0];r[d.id]=y}for(let P=0;P<x;P++){const D=y[P];D[0]=P,D[1]=v[P]}y.sort(a0e);for(let P=0;P<8;P++)P<x&&y[P][1]?(a[P][0]=y[P][0],a[P][1]=y[P][1]):(a[P][0]=Number.MAX_SAFE_INTEGER,a[P][1]=0);a.sort(o0e);const _=d.morphAttributes.position,S=d.morphAttributes.normal;let C=0;for(let P=0;P<8;P++){const D=a[P],N=D[0],j=D[1];N!==Number.MAX_SAFE_INTEGER&&j?(_&&d.getAttribute("morphTarget"+P)!==_[N]&&d.setAttribute("morphTarget"+P,_[N]),S&&d.getAttribute("morphNormal"+P)!==S[N]&&d.setAttribute("morphNormal"+P,S[N]),i[P]=j,C+=j):(_&&d.hasAttribute("morphTarget"+P)===!0&&d.deleteAttribute("morphTarget"+P),S&&d.hasAttribute("morphNormal"+P)===!0&&d.deleteAttribute("morphNormal"+P),i[P]=0)}const A=d.morphTargetsRelative?1:1-C;f.getUniforms().setValue(n,"morphTargetBaseInfluence",A),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:c}}function c0e(n,e,t,r){let i=new WeakMap;function s(c){const u=r.render.frame,d=c.geometry,p=e.get(c,d);return i.get(p)!==u&&(e.update(p),i.set(p,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),c.instanceColor!==null&&t.update(c.instanceColor,34962)),p}function o(){i=new WeakMap}function a(c){const u=c.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const Ete=new da,Ate=new wte,Pte=new eme,Tte=new Kj,wG=[],SG=[],MG=new Float32Array(16),CG=new Float32Array(9),EG=new Float32Array(4);function tb(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=wG[i];if(s===void 0&&(s=new Float32Array(i),wG[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function pl(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function fl(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function gL(n,e){let t=SG[e];t===void 0&&(t=new Int32Array(e),SG[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function u0e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function h0e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(pl(t,e))return;n.uniform2fv(this.addr,e),fl(t,e)}}function d0e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(pl(t,e))return;n.uniform3fv(this.addr,e),fl(t,e)}}function p0e(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(pl(t,e))return;n.uniform4fv(this.addr,e),fl(t,e)}}function f0e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(pl(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),fl(t,e)}else{if(pl(t,r))return;EG.set(r),n.uniformMatrix2fv(this.addr,!1,EG),fl(t,r)}}function m0e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(pl(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),fl(t,e)}else{if(pl(t,r))return;CG.set(r),n.uniformMatrix3fv(this.addr,!1,CG),fl(t,r)}}function v0e(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(pl(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),fl(t,e)}else{if(pl(t,r))return;MG.set(r),n.uniformMatrix4fv(this.addr,!1,MG),fl(t,r)}}function g0e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function _0e(n,e){const t=this.cache;pl(t,e)||(n.uniform2iv(this.addr,e),fl(t,e))}function y0e(n,e){const t=this.cache;pl(t,e)||(n.uniform3iv(this.addr,e),fl(t,e))}function x0e(n,e){const t=this.cache;pl(t,e)||(n.uniform4iv(this.addr,e),fl(t,e))}function b0e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function w0e(n,e){const t=this.cache;pl(t,e)||(n.uniform2uiv(this.addr,e),fl(t,e))}function S0e(n,e){const t=this.cache;pl(t,e)||(n.uniform3uiv(this.addr,e),fl(t,e))}function M0e(n,e){const t=this.cache;pl(t,e)||(n.uniform4uiv(this.addr,e),fl(t,e))}function C0e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2D(e||Ete,i)}function E0e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||Pte,i)}function A0e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||Tte,i)}function P0e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Ate,i)}function T0e(n){switch(n){case 5126:return u0e;case 35664:return h0e;case 35665:return d0e;case 35666:return p0e;case 35674:return f0e;case 35675:return m0e;case 35676:return v0e;case 5124:case 35670:return g0e;case 35667:case 35671:return _0e;case 35668:case 35672:return y0e;case 35669:case 35673:return x0e;case 5125:return b0e;case 36294:return w0e;case 36295:return S0e;case 36296:return M0e;case 35678:case 36198:case 36298:case 36306:case 35682:return C0e;case 35679:case 36299:case 36307:return E0e;case 35680:case 36300:case 36308:case 36293:return A0e;case 36289:case 36303:case 36311:case 36292:return P0e}}function R0e(n,e){n.uniform1fv(this.addr,e)}function O0e(n,e){const t=tb(e,this.size,2);n.uniform2fv(this.addr,t)}function L0e(n,e){const t=tb(e,this.size,3);n.uniform3fv(this.addr,t)}function D0e(n,e){const t=tb(e,this.size,4);n.uniform4fv(this.addr,t)}function I0e(n,e){const t=tb(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function N0e(n,e){const t=tb(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function k0e(n,e){const t=tb(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function z0e(n,e){n.uniform1iv(this.addr,e)}function B0e(n,e){n.uniform2iv(this.addr,e)}function V0e(n,e){n.uniform3iv(this.addr,e)}function F0e(n,e){n.uniform4iv(this.addr,e)}function U0e(n,e){n.uniform1uiv(this.addr,e)}function j0e(n,e){n.uniform2uiv(this.addr,e)}function H0e(n,e){n.uniform3uiv(this.addr,e)}function W0e(n,e){n.uniform4uiv(this.addr,e)}function G0e(n,e,t){const r=e.length,i=gL(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture2D(e[s]||Ete,i[s])}function X0e(n,e,t){const r=e.length,i=gL(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture3D(e[s]||Pte,i[s])}function q0e(n,e,t){const r=e.length,i=gL(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTextureCube(e[s]||Tte,i[s])}function Y0e(n,e,t){const r=e.length,i=gL(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||Ate,i[s])}function Z0e(n){switch(n){case 5126:return R0e;case 35664:return O0e;case 35665:return L0e;case 35666:return D0e;case 35674:return I0e;case 35675:return N0e;case 35676:return k0e;case 5124:case 35670:return z0e;case 35667:case 35671:return B0e;case 35668:case 35672:return V0e;case 35669:case 35673:return F0e;case 5125:return U0e;case 36294:return j0e;case 36295:return H0e;case 36296:return W0e;case 35678:case 36198:case 36298:case 36306:case 35682:return G0e;case 35679:case 36299:case 36307:return X0e;case 35680:case 36300:case 36308:case 36293:return q0e;case 36289:case 36303:case 36311:case 36292:return Y0e}}class K0e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=T0e(t.type)}}class J0e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=Z0e(t.type)}}class Q0e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const y5=/(\w+)(\])?(\[|\.)?/g;function AG(n,e){n.seq.push(e),n.map[e.id]=e}function $0e(n,e,t){const r=n.name,i=r.length;for(y5.lastIndex=0;;){const s=y5.exec(r),o=y5.lastIndex;let a=s[1];const c=s[2]==="]",u=s[3];if(c&&(a=a|0),u===void 0||u==="["&&o+2===i){AG(t,u===void 0?new K0e(a,n,e):new J0e(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new Q0e(a),AG(t,d)),t=d}}}class v3{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);$0e(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=r[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function PG(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}let e_e=0;function t_e(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function n_e(n){switch(n){case Am:return["Linear","( value )"];case ss:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function TG(n,e,t){const r=n.getShaderParameter(e,35713),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+t_e(n.getShaderSource(e),o)}else return i}function r_e(n,e){const t=n_e(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function i_e(n,e){let t;switch(e){case fte:t="Linear";break;case vfe:t="Reinhard";break;case gfe:t="OptimizedCineon";break;case _fe:t="ACESFilmic";break;case yfe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function s_e(n){return[n.extensionDerivatives||!!n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(QS).join(`
`)}function o_e(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function a_e(n,e){const t={},r=n.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function QS(n){return n!==""}function RG(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function OG(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const l_e=/^[ \t]*#include +<([\w\d./]+)>/gm;function E6(n){return n.replace(l_e,c_e)}function c_e(n,e){const t=er[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return E6(t)}const u_e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LG(n){return n.replace(u_e,h_e)}function h_e(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function DG(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function d_e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===ate?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===lte?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===JS&&(e="SHADOWMAP_TYPE_VSM"),e}function p_e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case nx:case rx:e="ENVMAP_TYPE_CUBE";break;case fL:e="ENVMAP_TYPE_CUBE_UV";break}return e}function f_e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case rx:e="ENVMAP_MODE_REFRACTION";break}return e}function m_e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case pte:e="ENVMAP_BLENDING_MULTIPLY";break;case ffe:e="ENVMAP_BLENDING_MIX";break;case mfe:e="ENVMAP_BLENDING_ADD";break}return e}function v_e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function g_e(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=d_e(t),u=p_e(t),d=f_e(t),p=m_e(t),f=v_e(t),v=t.isWebGL2?"":s_e(t),x=o_e(s),y=i.createProgram();let _,S,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(_=[x].filter(QS).join(`
`),_.length>0&&(_+=`
`),S=[v,x].filter(QS).join(`
`),S.length>0&&(S+=`
`)):(_=[DG(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(QS).join(`
`),S=[v,DG(t),"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",t.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==qh?"#define TONE_MAPPING":"",t.toneMapping!==qh?er.tonemapping_pars_fragment:"",t.toneMapping!==qh?i_e("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",er.encodings_pars_fragment,r_e("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(QS).join(`
`)),o=E6(o),o=RG(o,t),o=OG(o,t),a=E6(a),a=RG(a,t),a=OG(a,t),o=LG(o),a=LG(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,S=["#define varying in",t.glslVersion===nG?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===nG?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const A=C+_+o,P=C+S+a,D=PG(i,35633,A),N=PG(i,35632,P);if(i.attachShader(y,D),i.attachShader(y,N),t.index0AttributeName!==void 0?i.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),n.debug.checkShaderErrors){const k=i.getProgramInfoLog(y).trim(),U=i.getShaderInfoLog(D).trim(),ee=i.getShaderInfoLog(N).trim();let xe=!0,ce=!0;if(i.getProgramParameter(y,35714)===!1){xe=!1;const te=TG(i,D,"vertex"),fe=TG(i,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(y,35715)+`

Program Info Log: `+k+`
`+te+`
`+fe)}else k!==""?console.warn("THREE.WebGLProgram: Program Info Log:",k):(U===""||ee==="")&&(ce=!1);ce&&(this.diagnostics={runnable:xe,programLog:k,vertexShader:{log:U,prefix:_},fragmentShader:{log:ee,prefix:S}})}i.deleteShader(D),i.deleteShader(N);let j;this.getUniforms=function(){return j===void 0&&(j=new v3(i,y)),j};let T;return this.getAttributes=function(){return T===void 0&&(T=a_e(i,y)),T},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=e_e++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=D,this.fragmentShader=N,this}let __e=0;class y_e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new x_e(e),t.set(e,r)),r}}class x_e{constructor(e){this.id=__e++,this.code=e,this.usedTimes=0}}function b_e(n,e,t,r,i,s,o){const a=new qj,c=new y_e,u=[],d=i.isWebGL2,p=i.logarithmicDepthBuffer,f=i.vertexTextures;let v=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(T,k,U,ee,xe){const ce=ee.fog,te=xe.geometry,fe=T.isMeshStandardMaterial?ee.environment:null,ge=(T.isMeshStandardMaterial?t:e).get(T.envMap||fe),Se=!!ge&&ge.mapping===fL?ge.image.height:null,pe=x[T.type];T.precision!==null&&(v=i.getMaxPrecision(T.precision),v!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",v,"instead."));const se=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,ae=se!==void 0?se.length:0;let Le=0;te.morphAttributes.position!==void 0&&(Le=1),te.morphAttributes.normal!==void 0&&(Le=2),te.morphAttributes.color!==void 0&&(Le=3);let Re,Ue,Ze,st;if(pe){const Ke=Ju[pe];Re=Ke.vertexShader,Ue=Ke.fragmentShader}else Re=T.vertexShader,Ue=T.fragmentShader,c.update(T),Ze=c.getVertexShaderID(T),st=c.getFragmentShaderID(T);const we=n.getRenderTarget(),Mt=T.alphaTest>0,rt=T.clearcoat>0,it=T.iridescence>0;return{isWebGL2:d,shaderID:pe,shaderName:T.type,vertexShader:Re,fragmentShader:Ue,defines:T.defines,customVertexShaderID:Ze,customFragmentShaderID:st,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:v,instancing:xe.isInstancedMesh===!0,instancingColor:xe.isInstancedMesh===!0&&xe.instanceColor!==null,supportsVertexTextures:f,outputEncoding:we===null?n.outputEncoding:we.isXRRenderTarget===!0?we.texture.encoding:Am,map:!!T.map,matcap:!!T.matcap,envMap:!!ge,envMapMode:ge&&ge.mapping,envMapCubeUVHeight:Se,lightMap:!!T.lightMap,aoMap:!!T.aoMap,emissiveMap:!!T.emissiveMap,bumpMap:!!T.bumpMap,normalMap:!!T.normalMap,objectSpaceNormalMap:T.normalMapType===vte,tangentSpaceNormalMap:T.normalMapType===zC,decodeVideoTexture:!!T.map&&T.map.isVideoTexture===!0&&T.map.encoding===ss,clearcoat:rt,clearcoatMap:rt&&!!T.clearcoatMap,clearcoatRoughnessMap:rt&&!!T.clearcoatRoughnessMap,clearcoatNormalMap:rt&&!!T.clearcoatNormalMap,iridescence:it,iridescenceMap:it&&!!T.iridescenceMap,iridescenceThicknessMap:it&&!!T.iridescenceThicknessMap,displacementMap:!!T.displacementMap,roughnessMap:!!T.roughnessMap,metalnessMap:!!T.metalnessMap,specularMap:!!T.specularMap,specularIntensityMap:!!T.specularIntensityMap,specularColorMap:!!T.specularColorMap,opaque:T.transparent===!1&&T.blending===Oy,alphaMap:!!T.alphaMap,alphaTest:Mt,gradientMap:!!T.gradientMap,sheen:T.sheen>0,sheenColorMap:!!T.sheenColorMap,sheenRoughnessMap:!!T.sheenRoughnessMap,transmission:T.transmission>0,transmissionMap:!!T.transmissionMap,thicknessMap:!!T.thicknessMap,combine:T.combine,vertexTangents:!!T.normalMap&&!!te.attributes.tangent,vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,vertexUvs:!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatMap||!!T.clearcoatRoughnessMap||!!T.clearcoatNormalMap||!!T.iridescenceMap||!!T.iridescenceThicknessMap||!!T.displacementMap||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularColorMap||!!T.sheenColorMap||!!T.sheenRoughnessMap,uvsVertexOnly:!(!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatNormalMap||!!T.iridescenceMap||!!T.iridescenceThicknessMap||T.transmission>0||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularColorMap||T.sheen>0||!!T.sheenColorMap||!!T.sheenRoughnessMap)&&!!T.displacementMap,fog:!!ce,useFog:T.fog===!0,fogExp2:ce&&ce.isFogExp2,flatShading:!!T.flatShading,sizeAttenuation:T.sizeAttenuation,logarithmicDepthBuffer:p,skinning:xe.isSkinnedMesh===!0,morphTargets:te.morphAttributes.position!==void 0,morphNormals:te.morphAttributes.normal!==void 0,morphColors:te.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:Le,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&U.length>0,shadowMapType:n.shadowMap.type,toneMapping:T.toneMapped?n.toneMapping:qh,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===zh,flipSided:T.side===Ol,useDepthPacking:!!T.depthPacking,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:T.extensions&&T.extensions.derivatives,extensionFragDepth:T.extensions&&T.extensions.fragDepth,extensionDrawBuffers:T.extensions&&T.extensions.drawBuffers,extensionShaderTextureLOD:T.extensions&&T.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}}function _(T){const k=[];if(T.shaderID?k.push(T.shaderID):(k.push(T.customVertexShaderID),k.push(T.customFragmentShaderID)),T.defines!==void 0)for(const U in T.defines)k.push(U),k.push(T.defines[U]);return T.isRawShaderMaterial===!1&&(S(k,T),C(k,T),k.push(n.outputEncoding)),k.push(T.customProgramCacheKey),k.join()}function S(T,k){T.push(k.precision),T.push(k.outputEncoding),T.push(k.envMapMode),T.push(k.envMapCubeUVHeight),T.push(k.combine),T.push(k.vertexUvs),T.push(k.fogExp2),T.push(k.sizeAttenuation),T.push(k.morphTargetsCount),T.push(k.morphAttributeCount),T.push(k.numDirLights),T.push(k.numPointLights),T.push(k.numSpotLights),T.push(k.numSpotLightMaps),T.push(k.numHemiLights),T.push(k.numRectAreaLights),T.push(k.numDirLightShadows),T.push(k.numPointLightShadows),T.push(k.numSpotLightShadows),T.push(k.numSpotLightShadowsWithMaps),T.push(k.shadowMapType),T.push(k.toneMapping),T.push(k.numClippingPlanes),T.push(k.numClipIntersection),T.push(k.depthPacking)}function C(T,k){a.disableAll(),k.isWebGL2&&a.enable(0),k.supportsVertexTextures&&a.enable(1),k.instancing&&a.enable(2),k.instancingColor&&a.enable(3),k.map&&a.enable(4),k.matcap&&a.enable(5),k.envMap&&a.enable(6),k.lightMap&&a.enable(7),k.aoMap&&a.enable(8),k.emissiveMap&&a.enable(9),k.bumpMap&&a.enable(10),k.normalMap&&a.enable(11),k.objectSpaceNormalMap&&a.enable(12),k.tangentSpaceNormalMap&&a.enable(13),k.clearcoat&&a.enable(14),k.clearcoatMap&&a.enable(15),k.clearcoatRoughnessMap&&a.enable(16),k.clearcoatNormalMap&&a.enable(17),k.iridescence&&a.enable(18),k.iridescenceMap&&a.enable(19),k.iridescenceThicknessMap&&a.enable(20),k.displacementMap&&a.enable(21),k.specularMap&&a.enable(22),k.roughnessMap&&a.enable(23),k.metalnessMap&&a.enable(24),k.gradientMap&&a.enable(25),k.alphaMap&&a.enable(26),k.alphaTest&&a.enable(27),k.vertexColors&&a.enable(28),k.vertexAlphas&&a.enable(29),k.vertexUvs&&a.enable(30),k.vertexTangents&&a.enable(31),k.uvsVertexOnly&&a.enable(32),T.push(a.mask),a.disableAll(),k.fog&&a.enable(0),k.useFog&&a.enable(1),k.flatShading&&a.enable(2),k.logarithmicDepthBuffer&&a.enable(3),k.skinning&&a.enable(4),k.morphTargets&&a.enable(5),k.morphNormals&&a.enable(6),k.morphColors&&a.enable(7),k.premultipliedAlpha&&a.enable(8),k.shadowMapEnabled&&a.enable(9),k.physicallyCorrectLights&&a.enable(10),k.doubleSided&&a.enable(11),k.flipSided&&a.enable(12),k.useDepthPacking&&a.enable(13),k.dithering&&a.enable(14),k.specularIntensityMap&&a.enable(15),k.specularColorMap&&a.enable(16),k.transmission&&a.enable(17),k.transmissionMap&&a.enable(18),k.thicknessMap&&a.enable(19),k.sheen&&a.enable(20),k.sheenColorMap&&a.enable(21),k.sheenRoughnessMap&&a.enable(22),k.decodeVideoTexture&&a.enable(23),k.opaque&&a.enable(24),T.push(a.mask)}function A(T){const k=x[T.type];let U;if(k){const ee=Ju[k];U=aa.clone(ee.uniforms)}else U=T.uniforms;return U}function P(T,k){let U;for(let ee=0,xe=u.length;ee<xe;ee++){const ce=u[ee];if(ce.cacheKey===k){U=ce,++U.usedTimes;break}}return U===void 0&&(U=new g_e(n,k,T,s),u.push(U)),U}function D(T){if(--T.usedTimes===0){const k=u.indexOf(T);u[k]=u[u.length-1],u.pop(),T.destroy()}}function N(T){c.remove(T)}function j(){c.dispose()}return{getParameters:y,getProgramCacheKey:_,getUniforms:A,acquireProgram:P,releaseProgram:D,releaseShaderCache:N,programs:u,dispose:j}}function w_e(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function S_e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function IG(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function NG(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(p,f,v,x,y,_){let S=n[e];return S===void 0?(S={id:p.id,object:p,geometry:f,material:v,groupOrder:x,renderOrder:p.renderOrder,z:y,group:_},n[e]=S):(S.id=p.id,S.object=p,S.geometry=f,S.material=v,S.groupOrder=x,S.renderOrder=p.renderOrder,S.z=y,S.group=_),e++,S}function a(p,f,v,x,y,_){const S=o(p,f,v,x,y,_);v.transmission>0?r.push(S):v.transparent===!0?i.push(S):t.push(S)}function c(p,f,v,x,y,_){const S=o(p,f,v,x,y,_);v.transmission>0?r.unshift(S):v.transparent===!0?i.unshift(S):t.unshift(S)}function u(p,f){t.length>1&&t.sort(p||S_e),r.length>1&&r.sort(f||IG),i.length>1&&i.sort(f||IG)}function d(){for(let p=e,f=n.length;p<f;p++){const v=n[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:c,finish:d,sort:u}}function M_e(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new NG,n.set(r,[o])):i>=s.length?(o=new NG,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function C_e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ye,color:new Xt};break;case"SpotLight":t={position:new ye,direction:new ye,color:new Xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ye,color:new Xt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ye,skyColor:new Xt,groundColor:new Xt};break;case"RectAreaLight":t={color:new Xt,position:new ye,halfWidth:new ye,halfHeight:new ye};break}return n[e.id]=t,t}}}function E_e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let A_e=0;function P_e(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function T_e(n,e){const t=new C_e,r=E_e(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)i.probe.push(new ye);const s=new ye,o=new zn,a=new zn;function c(d,p){let f=0,v=0,x=0;for(let ee=0;ee<9;ee++)i.probe[ee].set(0,0,0);let y=0,_=0,S=0,C=0,A=0,P=0,D=0,N=0,j=0,T=0;d.sort(P_e);const k=p!==!0?Math.PI:1;for(let ee=0,xe=d.length;ee<xe;ee++){const ce=d[ee],te=ce.color,fe=ce.intensity,ge=ce.distance,Se=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)f+=te.r*fe*k,v+=te.g*fe*k,x+=te.b*fe*k;else if(ce.isLightProbe)for(let pe=0;pe<9;pe++)i.probe[pe].addScaledVector(ce.sh.coefficients[pe],fe);else if(ce.isDirectionalLight){const pe=t.get(ce);if(pe.color.copy(ce.color).multiplyScalar(ce.intensity*k),ce.castShadow){const se=ce.shadow,ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,i.directionalShadow[y]=ae,i.directionalShadowMap[y]=Se,i.directionalShadowMatrix[y]=ce.shadow.matrix,P++}i.directional[y]=pe,y++}else if(ce.isSpotLight){const pe=t.get(ce);pe.position.setFromMatrixPosition(ce.matrixWorld),pe.color.copy(te).multiplyScalar(fe*k),pe.distance=ge,pe.coneCos=Math.cos(ce.angle),pe.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),pe.decay=ce.decay,i.spot[S]=pe;const se=ce.shadow;if(ce.map&&(i.spotLightMap[j]=ce.map,j++,se.updateMatrices(ce),ce.castShadow&&T++),i.spotLightMatrix[S]=se.matrix,ce.castShadow){const ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,i.spotShadow[S]=ae,i.spotShadowMap[S]=Se,N++}S++}else if(ce.isRectAreaLight){const pe=t.get(ce);pe.color.copy(te).multiplyScalar(fe),pe.halfWidth.set(ce.width*.5,0,0),pe.halfHeight.set(0,ce.height*.5,0),i.rectArea[C]=pe,C++}else if(ce.isPointLight){const pe=t.get(ce);if(pe.color.copy(ce.color).multiplyScalar(ce.intensity*k),pe.distance=ce.distance,pe.decay=ce.decay,ce.castShadow){const se=ce.shadow,ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,ae.shadowCameraNear=se.camera.near,ae.shadowCameraFar=se.camera.far,i.pointShadow[_]=ae,i.pointShadowMap[_]=Se,i.pointShadowMatrix[_]=ce.shadow.matrix,D++}i.point[_]=pe,_++}else if(ce.isHemisphereLight){const pe=t.get(ce);pe.skyColor.copy(ce.color).multiplyScalar(fe*k),pe.groundColor.copy(ce.groundColor).multiplyScalar(fe*k),i.hemi[A]=pe,A++}}C>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Lt.LTC_FLOAT_1,i.rectAreaLTC2=Lt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Lt.LTC_HALF_1,i.rectAreaLTC2=Lt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=f,i.ambient[1]=v,i.ambient[2]=x;const U=i.hash;(U.directionalLength!==y||U.pointLength!==_||U.spotLength!==S||U.rectAreaLength!==C||U.hemiLength!==A||U.numDirectionalShadows!==P||U.numPointShadows!==D||U.numSpotShadows!==N||U.numSpotMaps!==j)&&(i.directional.length=y,i.spot.length=S,i.rectArea.length=C,i.point.length=_,i.hemi.length=A,i.directionalShadow.length=P,i.directionalShadowMap.length=P,i.pointShadow.length=D,i.pointShadowMap.length=D,i.spotShadow.length=N,i.spotShadowMap.length=N,i.directionalShadowMatrix.length=P,i.pointShadowMatrix.length=D,i.spotLightMatrix.length=N+j-T,i.spotLightMap.length=j,i.numSpotLightShadowsWithMaps=T,U.directionalLength=y,U.pointLength=_,U.spotLength=S,U.rectAreaLength=C,U.hemiLength=A,U.numDirectionalShadows=P,U.numPointShadows=D,U.numSpotShadows=N,U.numSpotMaps=j,i.version=A_e++)}function u(d,p){let f=0,v=0,x=0,y=0,_=0;const S=p.matrixWorldInverse;for(let C=0,A=d.length;C<A;C++){const P=d[C];if(P.isDirectionalLight){const D=i.directional[f];D.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),D.direction.sub(s),D.direction.transformDirection(S),f++}else if(P.isSpotLight){const D=i.spot[x];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),D.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),D.direction.sub(s),D.direction.transformDirection(S),x++}else if(P.isRectAreaLight){const D=i.rectArea[y];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),a.identity(),o.copy(P.matrixWorld),o.premultiply(S),a.extractRotation(o),D.halfWidth.set(P.width*.5,0,0),D.halfHeight.set(0,P.height*.5,0),D.halfWidth.applyMatrix4(a),D.halfHeight.applyMatrix4(a),y++}else if(P.isPointLight){const D=i.point[v];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),v++}else if(P.isHemisphereLight){const D=i.hemi[_];D.direction.setFromMatrixPosition(P.matrixWorld),D.direction.transformDirection(S),_++}}}return{setup:c,setupView:u,state:i}}function kG(n,e){const t=new T_e(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(d){r.push(d)}function a(d){i.push(d)}function c(d){t.setup(r,d)}function u(d){t.setupView(r,d)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:c,setupLightsView:u,pushLight:o,pushShadow:a}}function R_e(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let c;return a===void 0?(c=new kG(n,e),t.set(s,[c])):o>=a.length?(c=new kG(n,e),a.push(c)):c=a[o],c}function i(){t=new WeakMap}return{get:r,dispose:i}}class _L extends od{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Bfe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class O_e extends od{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new ye,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const L_e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,D_e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function I_e(n,e,t){let r=new vL;const i=new ot,s=new ot,o=new Ir,a=new _L({depthPacking:mL}),c=new O_e,u={},d=t.maxTextureSize,p={0:Ol,1:tx,2:zh},f=new Nr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ot},radius:{value:4}},vertexShader:L_e,fragmentShader:D_e}),v=f.clone();v.defines.HORIZONTAL_PASS=1;const x=new Oi;x.setAttribute("position",new bc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Io(x,f),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ate,this.render=function(P,D,N){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||P.length===0)return;const j=n.getRenderTarget(),T=n.getActiveCubeFace(),k=n.getActiveMipmapLevel(),U=n.state;U.setBlending(ks),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);for(let ee=0,xe=P.length;ee<xe;ee++){const ce=P[ee],te=ce.shadow;if(te===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(te.autoUpdate===!1&&te.needsUpdate===!1)continue;i.copy(te.mapSize);const fe=te.getFrameExtents();if(i.multiply(fe),s.copy(te.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/fe.x),i.x=s.x*fe.x,te.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/fe.y),i.y=s.y*fe.y,te.mapSize.y=s.y)),te.map===null){const Se=this.type!==JS?{minFilter:us,magFilter:us}:{};te.map=new Ei(i.x,i.y,Se),te.map.texture.name=ce.name+".shadowMap",te.camera.updateProjectionMatrix()}n.setRenderTarget(te.map),n.clear();const ge=te.getViewportCount();for(let Se=0;Se<ge;Se++){const pe=te.getViewport(Se);o.set(s.x*pe.x,s.y*pe.y,s.x*pe.z,s.y*pe.w),U.viewport(o),te.updateMatrices(ce,Se),r=te.getFrustum(),A(D,N,te.camera,ce,this.type)}te.isPointLightShadow!==!0&&this.type===JS&&S(te,N),te.needsUpdate=!1}_.needsUpdate=!1,n.setRenderTarget(j,T,k)};function S(P,D){const N=e.update(y);f.defines.VSM_SAMPLES!==P.blurSamples&&(f.defines.VSM_SAMPLES=P.blurSamples,v.defines.VSM_SAMPLES=P.blurSamples,f.needsUpdate=!0,v.needsUpdate=!0),P.mapPass===null&&(P.mapPass=new Ei(i.x,i.y)),f.uniforms.shadow_pass.value=P.map.texture,f.uniforms.resolution.value=P.mapSize,f.uniforms.radius.value=P.radius,n.setRenderTarget(P.mapPass),n.clear(),n.renderBufferDirect(D,null,N,f,y,null),v.uniforms.shadow_pass.value=P.mapPass.texture,v.uniforms.resolution.value=P.mapSize,v.uniforms.radius.value=P.radius,n.setRenderTarget(P.map),n.clear(),n.renderBufferDirect(D,null,N,v,y,null)}function C(P,D,N,j,T,k){let U=null;const ee=N.isPointLight===!0?P.customDistanceMaterial:P.customDepthMaterial;if(ee!==void 0?U=ee:U=N.isPointLight===!0?c:a,n.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0){const xe=U.uuid,ce=D.uuid;let te=u[xe];te===void 0&&(te={},u[xe]=te);let fe=te[ce];fe===void 0&&(fe=U.clone(),te[ce]=fe),U=fe}return U.visible=D.visible,U.wireframe=D.wireframe,k===JS?U.side=D.shadowSide!==null?D.shadowSide:D.side:U.side=D.shadowSide!==null?D.shadowSide:p[D.side],U.alphaMap=D.alphaMap,U.alphaTest=D.alphaTest,U.clipShadows=D.clipShadows,U.clippingPlanes=D.clippingPlanes,U.clipIntersection=D.clipIntersection,U.displacementMap=D.displacementMap,U.displacementScale=D.displacementScale,U.displacementBias=D.displacementBias,U.wireframeLinewidth=D.wireframeLinewidth,U.linewidth=D.linewidth,N.isPointLight===!0&&U.isMeshDistanceMaterial===!0&&(U.referencePosition.setFromMatrixPosition(N.matrixWorld),U.nearDistance=j,U.farDistance=T),U}function A(P,D,N,j,T){if(P.visible===!1)return;if(P.layers.test(D.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&T===JS)&&(!P.frustumCulled||r.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,P.matrixWorld);const U=e.update(P),ee=P.material;if(Array.isArray(ee)){const xe=U.groups;for(let ce=0,te=xe.length;ce<te;ce++){const fe=xe[ce],ge=ee[fe.materialIndex];if(ge&&ge.visible){const Se=C(P,ge,j,N.near,N.far,T);n.renderBufferDirect(N,null,U,Se,P,fe)}}}else if(ee.visible){const xe=C(P,ee,j,N.near,N.far,T);n.renderBufferDirect(N,null,U,xe,P,null)}}const k=P.children;for(let U=0,ee=k.length;U<ee;U++)A(k[U],D,N,j,T)}}function N_e(n,e,t){const r=t.isWebGL2;function i(){let re=!1;const $e=new Ir;let Me=null;const tt=new Ir(0,0,0,0);return{setMask:function(Je){Me!==Je&&!re&&(n.colorMask(Je,Je,Je,Je),Me=Je)},setLocked:function(Je){re=Je},setClear:function(Je,Ft,vn,hn,zr){zr===!0&&(Je*=hn,Ft*=hn,vn*=hn),$e.set(Je,Ft,vn,hn),tt.equals($e)===!1&&(n.clearColor(Je,Ft,vn,hn),tt.copy($e))},reset:function(){re=!1,Me=null,tt.set(-1,0,0,0)}}}function s(){let re=!1,$e=null,Me=null,tt=null;return{setTest:function(Je){Je?Mt(2929):rt(2929)},setMask:function(Je){$e!==Je&&!re&&(n.depthMask(Je),$e=Je)},setFunc:function(Je){if(Me!==Je){if(Je)switch(Je){case afe:n.depthFunc(512);break;case lfe:n.depthFunc(519);break;case cfe:n.depthFunc(513);break;case _6:n.depthFunc(515);break;case ufe:n.depthFunc(514);break;case hfe:n.depthFunc(518);break;case dfe:n.depthFunc(516);break;case pfe:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);Me=Je}},setLocked:function(Je){re=Je},setClear:function(Je){tt!==Je&&(n.clearDepth(Je),tt=Je)},reset:function(){re=!1,$e=null,Me=null,tt=null}}}function o(){let re=!1,$e=null,Me=null,tt=null,Je=null,Ft=null,vn=null,hn=null,zr=null;return{setTest:function(qt){re||(qt?Mt(2960):rt(2960))},setMask:function(qt){$e!==qt&&!re&&(n.stencilMask(qt),$e=qt)},setFunc:function(qt,xr,or){(Me!==qt||tt!==xr||Je!==or)&&(n.stencilFunc(qt,xr,or),Me=qt,tt=xr,Je=or)},setOp:function(qt,xr,or){(Ft!==qt||vn!==xr||hn!==or)&&(n.stencilOp(qt,xr,or),Ft=qt,vn=xr,hn=or)},setLocked:function(qt){re=qt},setClear:function(qt){zr!==qt&&(n.clearStencil(qt),zr=qt)},reset:function(){re=!1,$e=null,Me=null,tt=null,Je=null,Ft=null,vn=null,hn=null,zr=null}}}const a=new i,c=new s,u=new o,d=new WeakMap,p=new WeakMap;let f={},v={},x=new WeakMap,y=[],_=null,S=!1,C=null,A=null,P=null,D=null,N=null,j=null,T=null,k=!1,U=null,ee=null,xe=null,ce=null,te=null;const fe=n.getParameter(35661);let ge=!1,Se=0;const pe=n.getParameter(7938);pe.indexOf("WebGL")!==-1?(Se=parseFloat(/^WebGL (\d)/.exec(pe)[1]),ge=Se>=1):pe.indexOf("OpenGL ES")!==-1&&(Se=parseFloat(/^OpenGL ES (\d)/.exec(pe)[1]),ge=Se>=2);let se=null,ae={};const Le=n.getParameter(3088),Re=n.getParameter(2978),Ue=new Ir().fromArray(Le),Ze=new Ir().fromArray(Re);function st(re,$e,Me){const tt=new Uint8Array(4),Je=n.createTexture();n.bindTexture(re,Je),n.texParameteri(re,10241,9728),n.texParameteri(re,10240,9728);for(let Ft=0;Ft<Me;Ft++)n.texImage2D($e+Ft,0,6408,1,1,0,6408,5121,tt);return Je}const we={};we[3553]=st(3553,3553,1),we[34067]=st(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),u.setClear(0),Mt(2929),c.setFunc(_6),De(!1),je(PW),Mt(2884),ve(ks);function Mt(re){f[re]!==!0&&(n.enable(re),f[re]=!0)}function rt(re){f[re]!==!1&&(n.disable(re),f[re]=!1)}function it(re,$e){return v[re]!==$e?(n.bindFramebuffer(re,$e),v[re]=$e,r&&(re===36009&&(v[36160]=$e),re===36160&&(v[36009]=$e)),!0):!1}function Ke(re,$e){let Me=y,tt=!1;if(re)if(Me=x.get($e),Me===void 0&&(Me=[],x.set($e,Me)),re.isWebGLMultipleRenderTargets){const Je=re.texture;if(Me.length!==Je.length||Me[0]!==36064){for(let Ft=0,vn=Je.length;Ft<vn;Ft++)Me[Ft]=36064+Ft;Me.length=Je.length,tt=!0}}else Me[0]!==36064&&(Me[0]=36064,tt=!0);else Me[0]!==1029&&(Me[0]=1029,tt=!0);tt&&(t.isWebGL2?n.drawBuffers(Me):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Me))}function Qe(re){return _!==re?(n.useProgram(re),_=re,!0):!1}const Y={[cm]:32774,[$pe]:32778,[efe]:32779};if(r)Y[OW]=32775,Y[LW]=32776;else{const re=e.get("EXT_blend_minmax");re!==null&&(Y[OW]=re.MIN_EXT,Y[LW]=re.MAX_EXT)}const K={[g6]:0,[tfe]:1,[nfe]:768,[cte]:770,[ofe]:776,[dte]:774,[hte]:772,[rfe]:769,[ute]:771,[sfe]:775,[ife]:773};function ve(re,$e,Me,tt,Je,Ft,vn,hn){if(re===ks){S===!0&&(rt(3042),S=!1);return}if(S===!1&&(Mt(3042),S=!0),re!==v6){if(re!==C||hn!==k){if((A!==cm||N!==cm)&&(n.blendEquation(32774),A=cm,N=cm),hn)switch(re){case Oy:n.blendFuncSeparate(1,771,1,771);break;case TR:n.blendFunc(1,1);break;case TW:n.blendFuncSeparate(0,769,0,1);break;case RW:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case Oy:n.blendFuncSeparate(770,771,1,771);break;case TR:n.blendFunc(770,1);break;case TW:n.blendFuncSeparate(0,769,0,1);break;case RW:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}P=null,D=null,j=null,T=null,C=re,k=hn}return}Je=Je||$e,Ft=Ft||Me,vn=vn||tt,($e!==A||Je!==N)&&(n.blendEquationSeparate(Y[$e],Y[Je]),A=$e,N=Je),(Me!==P||tt!==D||Ft!==j||vn!==T)&&(n.blendFuncSeparate(K[Me],K[tt],K[Ft],K[vn]),P=Me,D=tt,j=Ft,T=vn),C=re,k=null}function Ae(re,$e){re.side===zh?rt(2884):Mt(2884);let Me=re.side===Ol;$e&&(Me=!Me),De(Me),re.blending===Oy&&re.transparent===!1?ve(ks):ve(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.premultipliedAlpha),c.setFunc(re.depthFunc),c.setTest(re.depthTest),c.setMask(re.depthWrite),a.setMask(re.colorWrite);const tt=re.stencilWrite;u.setTest(tt),tt&&(u.setMask(re.stencilWriteMask),u.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),u.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),He(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?Mt(32926):rt(32926)}function De(re){U!==re&&(re?n.frontFace(2304):n.frontFace(2305),U=re)}function je(re){re!==Jpe?(Mt(2884),re!==ee&&(re===PW?n.cullFace(1029):re===Qpe?n.cullFace(1028):n.cullFace(1032))):rt(2884),ee=re}function Xe(re){re!==xe&&(ge&&n.lineWidth(re),xe=re)}function He(re,$e,Me){re?(Mt(32823),(ce!==$e||te!==Me)&&(n.polygonOffset($e,Me),ce=$e,te=Me)):rt(32823)}function ne(re){re?Mt(3089):rt(3089)}function W(re){re===void 0&&(re=33984+fe-1),se!==re&&(n.activeTexture(re),se=re)}function O(re,$e){se===null&&W();let Me=ae[se];Me===void 0&&(Me={type:void 0,texture:void 0},ae[se]=Me),(Me.type!==re||Me.texture!==$e)&&(n.bindTexture(re,$e||we[re]),Me.type=re,Me.texture=$e)}function E(){const re=ae[se];re!==void 0&&re.type!==void 0&&(n.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function F(){try{n.compressedTexImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function z(){try{n.texSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Z(){try{n.texSubImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function de(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function be(){try{n.texStorage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function oe(){try{n.texStorage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ze(){try{n.texImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ke(){try{n.texImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Fe(re){Ue.equals(re)===!1&&(n.scissor(re.x,re.y,re.z,re.w),Ue.copy(re))}function Ge(re){Ze.equals(re)===!1&&(n.viewport(re.x,re.y,re.z,re.w),Ze.copy(re))}function at(re,$e){let Me=p.get($e);Me===void 0&&(Me=new WeakMap,p.set($e,Me));let tt=Me.get(re);tt===void 0&&(tt=n.getUniformBlockIndex($e,re.name),Me.set(re,tt))}function pt(re,$e){const Me=p.get($e).get(re);d.get(re)!==Me&&(n.uniformBlockBinding($e,Me,re.__bindingPointIndex),d.set(re,Me))}function Dt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),r===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),f={},se=null,ae={},v={},x=new WeakMap,y=[],_=null,S=!1,C=null,A=null,P=null,D=null,N=null,j=null,T=null,k=!1,U=null,ee=null,xe=null,ce=null,te=null,Ue.set(0,0,n.canvas.width,n.canvas.height),Ze.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),u.reset()}return{buffers:{color:a,depth:c,stencil:u},enable:Mt,disable:rt,bindFramebuffer:it,drawBuffers:Ke,useProgram:Qe,setBlending:ve,setMaterial:Ae,setFlipSided:De,setCullFace:je,setLineWidth:Xe,setPolygonOffset:He,setScissorTest:ne,activeTexture:W,bindTexture:O,unbindTexture:E,compressedTexImage2D:F,texImage2D:ze,texImage3D:ke,updateUBOMapping:at,uniformBlockBinding:pt,texStorage2D:be,texStorage3D:oe,texSubImage2D:z,texSubImage3D:Z,compressedTexSubImage2D:de,scissor:Fe,viewport:Ge,reset:Dt}}function k_e(n,e,t,r,i,s,o){const a=i.isWebGL2,c=i.maxTextures,u=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let y;const _=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function C(O,E){return S?new OffscreenCanvas(O,E):YM("canvas")}function A(O,E,F,z){let Z=1;if((O.width>z||O.height>z)&&(Z=z/Math.max(O.width,O.height)),Z<1||E===!0)if(typeof HTMLImageElement<"u"&&O instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&O instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&O instanceof ImageBitmap){const de=E?DR:Math.floor,be=de(Z*O.width),oe=de(Z*O.height);y===void 0&&(y=C(be,oe));const ze=F?C(be,oe):y;return ze.width=be,ze.height=oe,ze.getContext("2d").drawImage(O,0,0,be,oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+O.width+"x"+O.height+") to ("+be+"x"+oe+")."),ze}else return"data"in O&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+O.width+"x"+O.height+")."),O;return O}function P(O){return C6(O.width)&&C6(O.height)}function D(O){return a?!1:O.wrapS!==mc||O.wrapT!==mc||O.minFilter!==us&&O.minFilter!==Vs}function N(O,E){return O.generateMipmaps&&E&&O.minFilter!==us&&O.minFilter!==Vs}function j(O){n.generateMipmap(O)}function T(O,E,F,z,Z=!1){if(a===!1)return E;if(O!==null){if(n[O]!==void 0)return n[O];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+O+"'")}let de=E;return E===6403&&(F===5126&&(de=33326),F===5131&&(de=33325),F===5121&&(de=33321)),E===33319&&(F===5126&&(de=33328),F===5131&&(de=33327),F===5121&&(de=33323)),E===6408&&(F===5126&&(de=34836),F===5131&&(de=34842),F===5121&&(de=z===ss&&Z===!1?35907:32856),F===32819&&(de=32854),F===32820&&(de=32855)),(de===33325||de===33326||de===33327||de===33328||de===34842||de===34836)&&e.get("EXT_color_buffer_float"),de}function k(O,E,F){return N(O,F)===!0||O.isFramebufferTexture&&O.minFilter!==us&&O.minFilter!==Vs?Math.log2(Math.max(E.width,E.height))+1:O.mipmaps!==void 0&&O.mipmaps.length>0?O.mipmaps.length:O.isCompressedTexture&&Array.isArray(O.image)?E.mipmaps.length:1}function U(O){return O===us||O===DW||O===IW?9728:9729}function ee(O){const E=O.target;E.removeEventListener("dispose",ee),ce(E),E.isVideoTexture&&x.delete(E)}function xe(O){const E=O.target;E.removeEventListener("dispose",xe),fe(E)}function ce(O){const E=r.get(O);if(E.__webglInit===void 0)return;const F=O.source,z=_.get(F);if(z){const Z=z[E.__cacheKey];Z.usedTimes--,Z.usedTimes===0&&te(O),Object.keys(z).length===0&&_.delete(F)}r.remove(O)}function te(O){const E=r.get(O);n.deleteTexture(E.__webglTexture);const F=O.source,z=_.get(F);delete z[E.__cacheKey],o.memory.textures--}function fe(O){const E=O.texture,F=r.get(O),z=r.get(E);if(z.__webglTexture!==void 0&&(n.deleteTexture(z.__webglTexture),o.memory.textures--),O.depthTexture&&O.depthTexture.dispose(),O.isWebGLCubeRenderTarget)for(let Z=0;Z<6;Z++)n.deleteFramebuffer(F.__webglFramebuffer[Z]),F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer[Z]);else{if(n.deleteFramebuffer(F.__webglFramebuffer),F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer),F.__webglMultisampledFramebuffer&&n.deleteFramebuffer(F.__webglMultisampledFramebuffer),F.__webglColorRenderbuffer)for(let Z=0;Z<F.__webglColorRenderbuffer.length;Z++)F.__webglColorRenderbuffer[Z]&&n.deleteRenderbuffer(F.__webglColorRenderbuffer[Z]);F.__webglDepthRenderbuffer&&n.deleteRenderbuffer(F.__webglDepthRenderbuffer)}if(O.isWebGLMultipleRenderTargets)for(let Z=0,de=E.length;Z<de;Z++){const be=r.get(E[Z]);be.__webglTexture&&(n.deleteTexture(be.__webglTexture),o.memory.textures--),r.remove(E[Z])}r.remove(E),r.remove(O)}let ge=0;function Se(){ge=0}function pe(){const O=ge;return O>=c&&console.warn("THREE.WebGLTextures: Trying to use "+O+" texture units while this GPU supports only "+c),ge+=1,O}function se(O){const E=[];return E.push(O.wrapS),E.push(O.wrapT),E.push(O.magFilter),E.push(O.minFilter),E.push(O.anisotropy),E.push(O.internalFormat),E.push(O.format),E.push(O.type),E.push(O.generateMipmaps),E.push(O.premultiplyAlpha),E.push(O.flipY),E.push(O.unpackAlignment),E.push(O.encoding),E.join()}function ae(O,E){const F=r.get(O);if(O.isVideoTexture&&ne(O),O.isRenderTargetTexture===!1&&O.version>0&&F.__version!==O.version){const z=O.image;if(z===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(z.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{rt(F,O,E);return}}t.activeTexture(33984+E),t.bindTexture(3553,F.__webglTexture)}function Le(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){rt(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(35866,F.__webglTexture)}function Re(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){rt(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(32879,F.__webglTexture)}function Ue(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){it(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(34067,F.__webglTexture)}const Ze={[ix]:10497,[mc]:33071,[x6]:33648},st={[us]:9728,[DW]:9984,[IW]:9986,[Vs]:9729,[xfe]:9985,[kC]:9987};function we(O,E,F){if(F?(n.texParameteri(O,10242,Ze[E.wrapS]),n.texParameteri(O,10243,Ze[E.wrapT]),(O===32879||O===35866)&&n.texParameteri(O,32882,Ze[E.wrapR]),n.texParameteri(O,10240,st[E.magFilter]),n.texParameteri(O,10241,st[E.minFilter])):(n.texParameteri(O,10242,33071),n.texParameteri(O,10243,33071),(O===32879||O===35866)&&n.texParameteri(O,32882,33071),(E.wrapS!==mc||E.wrapT!==mc)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(O,10240,U(E.magFilter)),n.texParameteri(O,10241,U(E.minFilter)),E.minFilter!==us&&E.minFilter!==Vs&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");if(E.type===th&&e.has("OES_texture_float_linear")===!1||a===!1&&E.type===Op&&e.has("OES_texture_half_float_linear")===!1)return;(E.anisotropy>1||r.get(E).__currentAnisotropy)&&(n.texParameterf(O,z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,i.getMaxAnisotropy())),r.get(E).__currentAnisotropy=E.anisotropy)}}function Mt(O,E){let F=!1;O.__webglInit===void 0&&(O.__webglInit=!0,E.addEventListener("dispose",ee));const z=E.source;let Z=_.get(z);Z===void 0&&(Z={},_.set(z,Z));const de=se(E);if(de!==O.__cacheKey){Z[de]===void 0&&(Z[de]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,F=!0),Z[de].usedTimes++;const be=Z[O.__cacheKey];be!==void 0&&(Z[O.__cacheKey].usedTimes--,be.usedTimes===0&&te(E)),O.__cacheKey=de,O.__webglTexture=Z[de].texture}return F}function rt(O,E,F){let z=3553;E.isDataArrayTexture&&(z=35866),E.isData3DTexture&&(z=32879);const Z=Mt(O,E),de=E.source;if(t.activeTexture(33984+F),t.bindTexture(z,O.__webglTexture),de.version!==de.__currentVersion||Z===!0){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const be=D(E)&&P(E.image)===!1;let oe=A(E.image,be,!1,d);oe=W(E,oe);const ze=P(oe)||a,ke=s.convert(E.format,E.encoding);let Fe=s.convert(E.type),Ge=T(E.internalFormat,ke,Fe,E.encoding,E.isVideoTexture);we(z,E,ze);let at;const pt=E.mipmaps,Dt=a&&E.isVideoTexture!==!0,re=de.__currentVersion===void 0||Z===!0,$e=k(E,oe,ze);if(E.isDepthTexture)Ge=6402,a?E.type===th?Ge=36012:E.type===Kg?Ge=33190:E.type===Ly?Ge=35056:Ge=33189:E.type===th&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===s0&&Ge===6402&&E.type!==Wj&&E.type!==Kg&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=Kg,Fe=s.convert(E.type)),E.format===sx&&Ge===6402&&(Ge=34041,E.type!==Ly&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=Ly,Fe=s.convert(E.type))),re&&(Dt?t.texStorage2D(3553,1,Ge,oe.width,oe.height):t.texImage2D(3553,0,Ge,oe.width,oe.height,0,ke,Fe,null));else if(E.isDataTexture)if(pt.length>0&&ze){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],Dt?t.texSubImage2D(3553,Me,0,0,at.width,at.height,ke,Fe,at.data):t.texImage2D(3553,Me,Ge,at.width,at.height,0,ke,Fe,at.data);E.generateMipmaps=!1}else Dt?(re&&t.texStorage2D(3553,$e,Ge,oe.width,oe.height),t.texSubImage2D(3553,0,0,0,oe.width,oe.height,ke,Fe,oe.data)):t.texImage2D(3553,0,Ge,oe.width,oe.height,0,ke,Fe,oe.data);else if(E.isCompressedTexture){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],E.format!==nh?ke!==null?Dt?t.compressedTexSubImage2D(3553,Me,0,0,at.width,at.height,ke,at.data):t.compressedTexImage2D(3553,Me,Ge,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Dt?t.texSubImage2D(3553,Me,0,0,at.width,at.height,ke,Fe,at.data):t.texImage2D(3553,Me,Ge,at.width,at.height,0,ke,Fe,at.data)}else if(E.isDataArrayTexture)Dt?(re&&t.texStorage3D(35866,$e,Ge,oe.width,oe.height,oe.depth),t.texSubImage3D(35866,0,0,0,0,oe.width,oe.height,oe.depth,ke,Fe,oe.data)):t.texImage3D(35866,0,Ge,oe.width,oe.height,oe.depth,0,ke,Fe,oe.data);else if(E.isData3DTexture)Dt?(re&&t.texStorage3D(32879,$e,Ge,oe.width,oe.height,oe.depth),t.texSubImage3D(32879,0,0,0,0,oe.width,oe.height,oe.depth,ke,Fe,oe.data)):t.texImage3D(32879,0,Ge,oe.width,oe.height,oe.depth,0,ke,Fe,oe.data);else if(E.isFramebufferTexture){if(re)if(Dt)t.texStorage2D(3553,$e,Ge,oe.width,oe.height);else{let Me=oe.width,tt=oe.height;for(let Je=0;Je<$e;Je++)t.texImage2D(3553,Je,Ge,Me,tt,0,ke,Fe,null),Me>>=1,tt>>=1}}else if(pt.length>0&&ze){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],Dt?t.texSubImage2D(3553,Me,0,0,ke,Fe,at):t.texImage2D(3553,Me,Ge,ke,Fe,at);E.generateMipmaps=!1}else Dt?(re&&t.texStorage2D(3553,$e,Ge,oe.width,oe.height),t.texSubImage2D(3553,0,0,0,ke,Fe,oe)):t.texImage2D(3553,0,Ge,ke,Fe,oe);N(E,ze)&&j(z),de.__currentVersion=de.version,E.onUpdate&&E.onUpdate(E)}O.__version=E.version}function it(O,E,F){if(E.image.length!==6)return;const z=Mt(O,E),Z=E.source;if(t.activeTexture(33984+F),t.bindTexture(34067,O.__webglTexture),Z.version!==Z.__currentVersion||z===!0){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const de=E.isCompressedTexture||E.image[0].isCompressedTexture,be=E.image[0]&&E.image[0].isDataTexture,oe=[];for(let Me=0;Me<6;Me++)!de&&!be?oe[Me]=A(E.image[Me],!1,!0,u):oe[Me]=be?E.image[Me].image:E.image[Me],oe[Me]=W(E,oe[Me]);const ze=oe[0],ke=P(ze)||a,Fe=s.convert(E.format,E.encoding),Ge=s.convert(E.type),at=T(E.internalFormat,Fe,Ge,E.encoding),pt=a&&E.isVideoTexture!==!0,Dt=Z.__currentVersion===void 0||z===!0;let re=k(E,ze,ke);we(34067,E,ke);let $e;if(de){pt&&Dt&&t.texStorage2D(34067,re,at,ze.width,ze.height);for(let Me=0;Me<6;Me++){$e=oe[Me].mipmaps;for(let tt=0;tt<$e.length;tt++){const Je=$e[tt];E.format!==nh?Fe!==null?pt?t.compressedTexSubImage2D(34069+Me,tt,0,0,Je.width,Je.height,Fe,Je.data):t.compressedTexImage2D(34069+Me,tt,at,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?t.texSubImage2D(34069+Me,tt,0,0,Je.width,Je.height,Fe,Ge,Je.data):t.texImage2D(34069+Me,tt,at,Je.width,Je.height,0,Fe,Ge,Je.data)}}}else{$e=E.mipmaps,pt&&Dt&&($e.length>0&&re++,t.texStorage2D(34067,re,at,oe[0].width,oe[0].height));for(let Me=0;Me<6;Me++)if(be){pt?t.texSubImage2D(34069+Me,0,0,0,oe[Me].width,oe[Me].height,Fe,Ge,oe[Me].data):t.texImage2D(34069+Me,0,at,oe[Me].width,oe[Me].height,0,Fe,Ge,oe[Me].data);for(let tt=0;tt<$e.length;tt++){const Je=$e[tt].image[Me].image;pt?t.texSubImage2D(34069+Me,tt+1,0,0,Je.width,Je.height,Fe,Ge,Je.data):t.texImage2D(34069+Me,tt+1,at,Je.width,Je.height,0,Fe,Ge,Je.data)}}else{pt?t.texSubImage2D(34069+Me,0,0,0,Fe,Ge,oe[Me]):t.texImage2D(34069+Me,0,at,Fe,Ge,oe[Me]);for(let tt=0;tt<$e.length;tt++){const Je=$e[tt];pt?t.texSubImage2D(34069+Me,tt+1,0,0,Fe,Ge,Je.image[Me]):t.texImage2D(34069+Me,tt+1,at,Fe,Ge,Je.image[Me])}}}N(E,ke)&&j(34067),Z.__currentVersion=Z.version,E.onUpdate&&E.onUpdate(E)}O.__version=E.version}function Ke(O,E,F,z,Z){const de=s.convert(F.format,F.encoding),be=s.convert(F.type),oe=T(F.internalFormat,de,be,F.encoding);r.get(E).__hasExternalTextures||(Z===32879||Z===35866?t.texImage3D(Z,0,oe,E.width,E.height,E.depth,0,de,be,null):t.texImage2D(Z,0,oe,E.width,E.height,0,de,be,null)),t.bindFramebuffer(36160,O),He(E)?f.framebufferTexture2DMultisampleEXT(36160,z,Z,r.get(F).__webglTexture,0,Xe(E)):n.framebufferTexture2D(36160,z,Z,r.get(F).__webglTexture,0),t.bindFramebuffer(36160,null)}function Qe(O,E,F){if(n.bindRenderbuffer(36161,O),E.depthBuffer&&!E.stencilBuffer){let z=33189;if(F||He(E)){const Z=E.depthTexture;Z&&Z.isDepthTexture&&(Z.type===th?z=36012:Z.type===Kg&&(z=33190));const de=Xe(E);He(E)?f.renderbufferStorageMultisampleEXT(36161,de,z,E.width,E.height):n.renderbufferStorageMultisample(36161,de,z,E.width,E.height)}else n.renderbufferStorage(36161,z,E.width,E.height);n.framebufferRenderbuffer(36160,36096,36161,O)}else if(E.depthBuffer&&E.stencilBuffer){const z=Xe(E);F&&He(E)===!1?n.renderbufferStorageMultisample(36161,z,35056,E.width,E.height):He(E)?f.renderbufferStorageMultisampleEXT(36161,z,35056,E.width,E.height):n.renderbufferStorage(36161,34041,E.width,E.height),n.framebufferRenderbuffer(36160,33306,36161,O)}else{const z=E.isWebGLMultipleRenderTargets===!0?E.texture:[E.texture];for(let Z=0;Z<z.length;Z++){const de=z[Z],be=s.convert(de.format,de.encoding),oe=s.convert(de.type),ze=T(de.internalFormat,be,oe,de.encoding),ke=Xe(E);F&&He(E)===!1?n.renderbufferStorageMultisample(36161,ke,ze,E.width,E.height):He(E)?f.renderbufferStorageMultisampleEXT(36161,ke,ze,E.width,E.height):n.renderbufferStorage(36161,ze,E.width,E.height)}}n.bindRenderbuffer(36161,null)}function Y(O,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,O),!(E.depthTexture&&E.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),ae(E.depthTexture,0);const F=r.get(E.depthTexture).__webglTexture,z=Xe(E);if(E.depthTexture.format===s0)He(E)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,F,0,z):n.framebufferTexture2D(36160,36096,3553,F,0);else if(E.depthTexture.format===sx)He(E)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,F,0,z):n.framebufferTexture2D(36160,33306,3553,F,0);else throw new Error("Unknown depthTexture format")}function K(O){const E=r.get(O),F=O.isWebGLCubeRenderTarget===!0;if(O.depthTexture&&!E.__autoAllocateDepthBuffer){if(F)throw new Error("target.depthTexture not supported in Cube render targets");Y(E.__webglFramebuffer,O)}else if(F){E.__webglDepthbuffer=[];for(let z=0;z<6;z++)t.bindFramebuffer(36160,E.__webglFramebuffer[z]),E.__webglDepthbuffer[z]=n.createRenderbuffer(),Qe(E.__webglDepthbuffer[z],O,!1)}else t.bindFramebuffer(36160,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),Qe(E.__webglDepthbuffer,O,!1);t.bindFramebuffer(36160,null)}function ve(O,E,F){const z=r.get(O);E!==void 0&&Ke(z.__webglFramebuffer,O,O.texture,36064,3553),F!==void 0&&K(O)}function Ae(O){const E=O.texture,F=r.get(O),z=r.get(E);O.addEventListener("dispose",xe),O.isWebGLMultipleRenderTargets!==!0&&(z.__webglTexture===void 0&&(z.__webglTexture=n.createTexture()),z.__version=E.version,o.memory.textures++);const Z=O.isWebGLCubeRenderTarget===!0,de=O.isWebGLMultipleRenderTargets===!0,be=P(O)||a;if(Z){F.__webglFramebuffer=[];for(let oe=0;oe<6;oe++)F.__webglFramebuffer[oe]=n.createFramebuffer()}else{if(F.__webglFramebuffer=n.createFramebuffer(),de)if(i.drawBuffers){const oe=O.texture;for(let ze=0,ke=oe.length;ze<ke;ze++){const Fe=r.get(oe[ze]);Fe.__webglTexture===void 0&&(Fe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&O.samples>0&&He(O)===!1){const oe=de?E:[E];F.__webglMultisampledFramebuffer=n.createFramebuffer(),F.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,F.__webglMultisampledFramebuffer);for(let ze=0;ze<oe.length;ze++){const ke=oe[ze];F.__webglColorRenderbuffer[ze]=n.createRenderbuffer(),n.bindRenderbuffer(36161,F.__webglColorRenderbuffer[ze]);const Fe=s.convert(ke.format,ke.encoding),Ge=s.convert(ke.type),at=T(ke.internalFormat,Fe,Ge,ke.encoding),pt=Xe(O);n.renderbufferStorageMultisample(36161,pt,at,O.width,O.height),n.framebufferRenderbuffer(36160,36064+ze,36161,F.__webglColorRenderbuffer[ze])}n.bindRenderbuffer(36161,null),O.depthBuffer&&(F.__webglDepthRenderbuffer=n.createRenderbuffer(),Qe(F.__webglDepthRenderbuffer,O,!0)),t.bindFramebuffer(36160,null)}}if(Z){t.bindTexture(34067,z.__webglTexture),we(34067,E,be);for(let oe=0;oe<6;oe++)Ke(F.__webglFramebuffer[oe],O,E,36064,34069+oe);N(E,be)&&j(34067),t.unbindTexture()}else if(de){const oe=O.texture;for(let ze=0,ke=oe.length;ze<ke;ze++){const Fe=oe[ze],Ge=r.get(Fe);t.bindTexture(3553,Ge.__webglTexture),we(3553,Fe,be),Ke(F.__webglFramebuffer,O,Fe,36064+ze,3553),N(Fe,be)&&j(3553)}t.unbindTexture()}else{let oe=3553;(O.isWebGL3DRenderTarget||O.isWebGLArrayRenderTarget)&&(a?oe=O.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(oe,z.__webglTexture),we(oe,E,be),Ke(F.__webglFramebuffer,O,E,36064,oe),N(E,be)&&j(oe),t.unbindTexture()}O.depthBuffer&&K(O)}function De(O){const E=P(O)||a,F=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let z=0,Z=F.length;z<Z;z++){const de=F[z];if(N(de,E)){const be=O.isWebGLCubeRenderTarget?34067:3553,oe=r.get(de).__webglTexture;t.bindTexture(be,oe),j(be),t.unbindTexture()}}}function je(O){if(a&&O.samples>0&&He(O)===!1){const E=O.isWebGLMultipleRenderTargets?O.texture:[O.texture],F=O.width,z=O.height;let Z=16384;const de=[],be=O.stencilBuffer?33306:36096,oe=r.get(O),ze=O.isWebGLMultipleRenderTargets===!0;if(ze)for(let ke=0;ke<E.length;ke++)t.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ke,36161,null),t.bindFramebuffer(36160,oe.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ke,3553,null,0);t.bindFramebuffer(36008,oe.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,oe.__webglFramebuffer);for(let ke=0;ke<E.length;ke++){de.push(36064+ke),O.depthBuffer&&de.push(be);const Fe=oe.__ignoreDepthValues!==void 0?oe.__ignoreDepthValues:!1;if(Fe===!1&&(O.depthBuffer&&(Z|=256),O.stencilBuffer&&(Z|=1024)),ze&&n.framebufferRenderbuffer(36008,36064,36161,oe.__webglColorRenderbuffer[ke]),Fe===!0&&(n.invalidateFramebuffer(36008,[be]),n.invalidateFramebuffer(36009,[be])),ze){const Ge=r.get(E[ke]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ge,0)}n.blitFramebuffer(0,0,F,z,0,0,F,z,Z,9728),v&&n.invalidateFramebuffer(36008,de)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ze)for(let ke=0;ke<E.length;ke++){t.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ke,36161,oe.__webglColorRenderbuffer[ke]);const Fe=r.get(E[ke]).__webglTexture;t.bindFramebuffer(36160,oe.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ke,3553,Fe,0)}t.bindFramebuffer(36009,oe.__webglMultisampledFramebuffer)}}function Xe(O){return Math.min(p,O.samples)}function He(O){const E=r.get(O);return a&&O.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&E.__useRenderToTexture!==!1}function ne(O){const E=o.render.frame;x.get(O)!==E&&(x.set(O,E),O.update())}function W(O,E){const F=O.encoding,z=O.format,Z=O.type;return O.isCompressedTexture===!0||O.isVideoTexture===!0||O.format===M6||F!==Am&&(F===ss?a===!1?e.has("EXT_sRGB")===!0&&z===nh?(O.format=M6,O.minFilter=Vs,O.generateMipmaps=!1):E=xte.sRGBToLinear(E):(z!==nh||Z!==m0)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",F)),E}this.allocateTextureUnit=pe,this.resetTextureUnits=Se,this.setTexture2D=ae,this.setTexture2DArray=Le,this.setTexture3D=Re,this.setTextureCube=Ue,this.rebindTextures=ve,this.setupRenderTarget=Ae,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=je,this.setupDepthRenderbuffer=K,this.setupFrameBufferTexture=Ke,this.useMultisampledRTT=He}function z_e(n,e,t){const r=t.isWebGL2;function i(s,o=null){let a;if(s===m0)return 5121;if(s===Mfe)return 32819;if(s===Cfe)return 32820;if(s===bfe)return 5120;if(s===wfe)return 5122;if(s===Wj)return 5123;if(s===Sfe)return 5124;if(s===Kg)return 5125;if(s===th)return 5126;if(s===Op)return r?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Efe)return 6406;if(s===nh)return 6408;if(s===Pfe)return 6409;if(s===Tfe)return 6410;if(s===s0)return 6402;if(s===sx)return 34041;if(s===Rfe)return 6403;if(s===Afe)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===M6)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===Ofe)return 36244;if(s===Lfe)return 33319;if(s===Dfe)return 33320;if(s===Ife)return 36249;if(s===HB||s===WB||s===GB||s===XB)if(o===ss)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===HB)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===WB)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===GB)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===XB)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===HB)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===WB)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===GB)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===XB)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===NW||s===kW||s===zW||s===BW)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===NW)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===kW)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===zW)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===BW)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Nfe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===VW||s===FW)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===VW)return o===ss?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===FW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===UW||s===jW||s===HW||s===WW||s===GW||s===XW||s===qW||s===YW||s===ZW||s===KW||s===JW||s===QW||s===$W||s===eG)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===UW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===jW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===HW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===WW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===GW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===XW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===qW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===YW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===ZW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===KW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===JW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===QW)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===$W)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===eG)return o===ss?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===tG)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===tG)return o===ss?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===Ly?r?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class B_e extends oo{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Bh extends wr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const V_e={type:"move"};class x5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Bh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Bh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ye,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ye),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Bh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ye,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ye),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,c=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const y of e.hand.values()){const _=t.getJointPose(y,r);if(u.joints[y.jointName]===void 0){const C=new Bh;C.matrixAutoUpdate=!1,C.visible=!1,u.joints[y.jointName]=C,u.add(C)}const S=u.joints[y.jointName];_!==null&&(S.matrix.fromArray(_.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=_.radius),S.visible=_!==null}const d=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],f=d.position.distanceTo(p.position),v=.02,x=.005;u.inputState.pinching&&f>v+x?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&f<=v-x&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(V_e)))}return a!==null&&(a.visible=i!==null),c!==null&&(c.visible=s!==null),u!==null&&(u.visible=o!==null),this}}class Rte extends da{constructor(e,t,r,i,s,o,a,c,u,d){if(d=d!==void 0?d:s0,d!==s0&&d!==sx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===s0&&(r=Kg),r===void 0&&d===sx&&(r=Ly),super(null,i,s,o,a,c,d,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:us,this.minFilter=c!==void 0?c:us,this.flipY=!1,this.generateMipmaps=!1}}class F_e extends E0{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",c=null,u=null,d=null,p=null,f=null,v=null;const x=t.getContextAttributes();let y=null,_=null;const S=[],C=[],A=new oo;A.layers.enable(1),A.viewport=new Ir;const P=new oo;P.layers.enable(2),P.viewport=new Ir;const D=[A,P],N=new B_e;N.layers.enable(1),N.layers.enable(2);let j=null,T=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let ae=S[se];return ae===void 0&&(ae=new x5,S[se]=ae),ae.getTargetRaySpace()},this.getControllerGrip=function(se){let ae=S[se];return ae===void 0&&(ae=new x5,S[se]=ae),ae.getGripSpace()},this.getHand=function(se){let ae=S[se];return ae===void 0&&(ae=new x5,S[se]=ae),ae.getHandSpace()};function k(se){const ae=C.indexOf(se.inputSource);if(ae===-1)return;const Le=S[ae];Le!==void 0&&Le.dispatchEvent({type:se.type,data:se.inputSource})}function U(){i.removeEventListener("select",k),i.removeEventListener("selectstart",k),i.removeEventListener("selectend",k),i.removeEventListener("squeeze",k),i.removeEventListener("squeezestart",k),i.removeEventListener("squeezeend",k),i.removeEventListener("end",U),i.removeEventListener("inputsourceschange",ee);for(let se=0;se<S.length;se++){const ae=C[se];ae!==null&&(C[se]=null,S[se].disconnect(ae))}j=null,T=null,e.setRenderTarget(y),f=null,p=null,d=null,i=null,_=null,pe.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){s=se,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){a=se,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(se){c=se},this.getBaseLayer=function(){return p!==null?p:f},this.getBinding=function(){return d},this.getFrame=function(){return v},this.getSession=function(){return i},this.setSession=async function(se){if(i=se,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",k),i.addEventListener("selectstart",k),i.addEventListener("selectend",k),i.addEventListener("squeeze",k),i.addEventListener("squeezestart",k),i.addEventListener("squeezeend",k),i.addEventListener("end",U),i.addEventListener("inputsourceschange",ee),x.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ae={antialias:i.renderState.layers===void 0?x.antialias:!0,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,ae),i.updateRenderState({baseLayer:f}),_=new Ei(f.framebufferWidth,f.framebufferHeight,{format:nh,type:m0,encoding:e.outputEncoding,stencilBuffer:x.stencil})}else{let ae=null,Le=null,Re=null;x.depth&&(Re=x.stencil?35056:33190,ae=x.stencil?sx:s0,Le=x.stencil?Ly:Kg);const Ue={colorFormat:32856,depthFormat:Re,scaleFactor:s};d=new XRWebGLBinding(i,t),p=d.createProjectionLayer(Ue),i.updateRenderState({layers:[p]}),_=new Ei(p.textureWidth,p.textureHeight,{format:nh,type:m0,depthTexture:new Rte(p.textureWidth,p.textureHeight,Le,void 0,void 0,void 0,void 0,void 0,void 0,ae),stencilBuffer:x.stencil,encoding:e.outputEncoding,samples:x.antialias?4:0});const Ze=e.properties.get(_);Ze.__ignoreDepthValues=p.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(1),c=null,o=await i.requestReferenceSpace(a),pe.setContext(i),pe.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function ee(se){for(let ae=0;ae<se.removed.length;ae++){const Le=se.removed[ae],Re=C.indexOf(Le);Re>=0&&(C[Re]=null,S[Re].dispatchEvent({type:"disconnected",data:Le}))}for(let ae=0;ae<se.added.length;ae++){const Le=se.added[ae];let Re=C.indexOf(Le);if(Re===-1){for(let Ze=0;Ze<S.length;Ze++)if(Ze>=C.length){C.push(Le),Re=Ze;break}else if(C[Ze]===null){C[Ze]=Le,Re=Ze;break}if(Re===-1)break}const Ue=S[Re];Ue&&Ue.dispatchEvent({type:"connected",data:Le})}}const xe=new ye,ce=new ye;function te(se,ae,Le){xe.setFromMatrixPosition(ae.matrixWorld),ce.setFromMatrixPosition(Le.matrixWorld);const Re=xe.distanceTo(ce),Ue=ae.projectionMatrix.elements,Ze=Le.projectionMatrix.elements,st=Ue[14]/(Ue[10]-1),we=Ue[14]/(Ue[10]+1),Mt=(Ue[9]+1)/Ue[5],rt=(Ue[9]-1)/Ue[5],it=(Ue[8]-1)/Ue[0],Ke=(Ze[8]+1)/Ze[0],Qe=st*it,Y=st*Ke,K=Re/(-it+Ke),ve=K*-it;ae.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(ve),se.translateZ(K),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert();const Ae=st+K,De=we+K,je=Qe-ve,Xe=Y+(Re-ve),He=Mt*we/De*Ae,ne=rt*we/De*Ae;se.projectionMatrix.makePerspective(je,Xe,He,ne,Ae,De)}function fe(se,ae){ae===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(ae.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(i===null)return;N.near=P.near=A.near=se.near,N.far=P.far=A.far=se.far,(j!==N.near||T!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),j=N.near,T=N.far);const ae=se.parent,Le=N.cameras;fe(N,ae);for(let Ue=0;Ue<Le.length;Ue++)fe(Le[Ue],ae);N.matrixWorld.decompose(N.position,N.quaternion,N.scale),se.matrix.copy(N.matrix),se.matrix.decompose(se.position,se.quaternion,se.scale);const Re=se.children;for(let Ue=0,Ze=Re.length;Ue<Ze;Ue++)Re[Ue].updateMatrixWorld(!0);Le.length===2?te(N,A,P):N.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return N},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(f!==null)return f.fixedFoveation},this.setFoveation=function(se){p!==null&&(p.fixedFoveation=se),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=se)};let ge=null;function Se(se,ae){if(u=ae.getViewerPose(c||o),v=ae,u!==null){const Le=u.views;f!==null&&(e.setRenderTargetFramebuffer(_,f.framebuffer),e.setRenderTarget(_));let Re=!1;Le.length!==N.cameras.length&&(N.cameras.length=0,Re=!0);for(let Ue=0;Ue<Le.length;Ue++){const Ze=Le[Ue];let st=null;if(f!==null)st=f.getViewport(Ze);else{const Mt=d.getViewSubImage(p,Ze);st=Mt.viewport,Ue===0&&(e.setRenderTargetTextures(_,Mt.colorTexture,p.ignoreDepthValues?void 0:Mt.depthStencilTexture),e.setRenderTarget(_))}let we=D[Ue];we===void 0&&(we=new oo,we.layers.enable(Ue),we.viewport=new Ir,D[Ue]=we),we.matrix.fromArray(Ze.transform.matrix),we.projectionMatrix.fromArray(Ze.projectionMatrix),we.viewport.set(st.x,st.y,st.width,st.height),Ue===0&&N.matrix.copy(we.matrix),Re===!0&&N.cameras.push(we)}}for(let Le=0;Le<S.length;Le++){const Re=C[Le],Ue=S[Le];Re!==null&&Ue!==void 0&&Ue.update(Re,ae,c||o)}ge&&ge(se,ae),v=null}const pe=new Cte;pe.setAnimationLoop(Se),this.setAnimationLoop=function(se){ge=se},this.dispose=function(){}}}function U_e(n,e){function t(y,_){y.fogColor.value.copy(_.color),_.isFog?(y.fogNear.value=_.near,y.fogFar.value=_.far):_.isFogExp2&&(y.fogDensity.value=_.density)}function r(y,_,S,C,A){_.isMeshBasicMaterial||_.isMeshLambertMaterial?i(y,_):_.isMeshToonMaterial?(i(y,_),d(y,_)):_.isMeshPhongMaterial?(i(y,_),u(y,_)):_.isMeshStandardMaterial?(i(y,_),p(y,_),_.isMeshPhysicalMaterial&&f(y,_,A)):_.isMeshMatcapMaterial?(i(y,_),v(y,_)):_.isMeshDepthMaterial?i(y,_):_.isMeshDistanceMaterial?(i(y,_),x(y,_)):_.isMeshNormalMaterial?i(y,_):_.isLineBasicMaterial?(s(y,_),_.isLineDashedMaterial&&o(y,_)):_.isPointsMaterial?a(y,_,S,C):_.isSpriteMaterial?c(y,_):_.isShadowMaterial?(y.color.value.copy(_.color),y.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function i(y,_){y.opacity.value=_.opacity,_.color&&y.diffuse.value.copy(_.color),_.emissive&&y.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.bumpMap&&(y.bumpMap.value=_.bumpMap,y.bumpScale.value=_.bumpScale,_.side===Ol&&(y.bumpScale.value*=-1)),_.displacementMap&&(y.displacementMap.value=_.displacementMap,y.displacementScale.value=_.displacementScale,y.displacementBias.value=_.displacementBias),_.emissiveMap&&(y.emissiveMap.value=_.emissiveMap),_.normalMap&&(y.normalMap.value=_.normalMap,y.normalScale.value.copy(_.normalScale),_.side===Ol&&y.normalScale.value.negate()),_.specularMap&&(y.specularMap.value=_.specularMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);const S=e.get(_).envMap;if(S&&(y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=_.reflectivity,y.ior.value=_.ior,y.refractionRatio.value=_.refractionRatio),_.lightMap){y.lightMap.value=_.lightMap;const P=n.physicallyCorrectLights!==!0?Math.PI:1;y.lightMapIntensity.value=_.lightMapIntensity*P}_.aoMap&&(y.aoMap.value=_.aoMap,y.aoMapIntensity.value=_.aoMapIntensity);let C;_.map?C=_.map:_.specularMap?C=_.specularMap:_.displacementMap?C=_.displacementMap:_.normalMap?C=_.normalMap:_.bumpMap?C=_.bumpMap:_.roughnessMap?C=_.roughnessMap:_.metalnessMap?C=_.metalnessMap:_.alphaMap?C=_.alphaMap:_.emissiveMap?C=_.emissiveMap:_.clearcoatMap?C=_.clearcoatMap:_.clearcoatNormalMap?C=_.clearcoatNormalMap:_.clearcoatRoughnessMap?C=_.clearcoatRoughnessMap:_.iridescenceMap?C=_.iridescenceMap:_.iridescenceThicknessMap?C=_.iridescenceThicknessMap:_.specularIntensityMap?C=_.specularIntensityMap:_.specularColorMap?C=_.specularColorMap:_.transmissionMap?C=_.transmissionMap:_.thicknessMap?C=_.thicknessMap:_.sheenColorMap?C=_.sheenColorMap:_.sheenRoughnessMap&&(C=_.sheenRoughnessMap),C!==void 0&&(C.isWebGLRenderTarget&&(C=C.texture),C.matrixAutoUpdate===!0&&C.updateMatrix(),y.uvTransform.value.copy(C.matrix));let A;_.aoMap?A=_.aoMap:_.lightMap&&(A=_.lightMap),A!==void 0&&(A.isWebGLRenderTarget&&(A=A.texture),A.matrixAutoUpdate===!0&&A.updateMatrix(),y.uv2Transform.value.copy(A.matrix))}function s(y,_){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity}function o(y,_){y.dashSize.value=_.dashSize,y.totalSize.value=_.dashSize+_.gapSize,y.scale.value=_.scale}function a(y,_,S,C){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity,y.size.value=_.size*S,y.scale.value=C*.5,_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);let A;_.map?A=_.map:_.alphaMap&&(A=_.alphaMap),A!==void 0&&(A.matrixAutoUpdate===!0&&A.updateMatrix(),y.uvTransform.value.copy(A.matrix))}function c(y,_){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity,y.rotation.value=_.rotation,_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);let S;_.map?S=_.map:_.alphaMap&&(S=_.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function u(y,_){y.specular.value.copy(_.specular),y.shininess.value=Math.max(_.shininess,1e-4)}function d(y,_){_.gradientMap&&(y.gradientMap.value=_.gradientMap)}function p(y,_){y.roughness.value=_.roughness,y.metalness.value=_.metalness,_.roughnessMap&&(y.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(y.metalnessMap.value=_.metalnessMap),e.get(_).envMap&&(y.envMapIntensity.value=_.envMapIntensity)}function f(y,_,S){y.ior.value=_.ior,_.sheen>0&&(y.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),y.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(y.sheenColorMap.value=_.sheenColorMap),_.sheenRoughnessMap&&(y.sheenRoughnessMap.value=_.sheenRoughnessMap)),_.clearcoat>0&&(y.clearcoat.value=_.clearcoat,y.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(y.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),y.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===Ol&&y.clearcoatNormalScale.value.negate())),_.iridescence>0&&(y.iridescence.value=_.iridescence,y.iridescenceIOR.value=_.iridescenceIOR,y.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(y.iridescenceMap.value=_.iridescenceMap),_.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=_.iridescenceThicknessMap)),_.transmission>0&&(y.transmission.value=_.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),_.transmissionMap&&(y.transmissionMap.value=_.transmissionMap),y.thickness.value=_.thickness,_.thicknessMap&&(y.thicknessMap.value=_.thicknessMap),y.attenuationDistance.value=_.attenuationDistance,y.attenuationColor.value.copy(_.attenuationColor)),y.specularIntensity.value=_.specularIntensity,y.specularColor.value.copy(_.specularColor),_.specularIntensityMap&&(y.specularIntensityMap.value=_.specularIntensityMap),_.specularColorMap&&(y.specularColorMap.value=_.specularColorMap)}function v(y,_){_.matcap&&(y.matcap.value=_.matcap)}function x(y,_){y.referencePosition.value.copy(_.referencePosition),y.nearDistance.value=_.nearDistance,y.farDistance.value=_.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:r}}function j_e(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function c(C,A){const P=A.program;r.uniformBlockBinding(C,P)}function u(C,A){let P=i[C.id];P===void 0&&(x(C),P=d(C),i[C.id]=P,C.addEventListener("dispose",_));const D=A.program;r.updateUBOMapping(C,D);const N=e.render.frame;s[C.id]!==N&&(f(C),s[C.id]=N)}function d(C){const A=p();C.__bindingPointIndex=A;const P=n.createBuffer(),D=C.__size,N=C.usage;return n.bindBuffer(35345,P),n.bufferData(35345,D,N),n.bindBuffer(35345,null),n.bindBufferBase(35345,A,P),P}function p(){for(let C=0;C<a;C++)if(o.indexOf(C)===-1)return o.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(C){const A=i[C.id],P=C.uniforms,D=C.__cache;n.bindBuffer(35345,A);for(let N=0,j=P.length;N<j;N++){const T=P[N];if(v(T,N,D)===!0){const k=T.value,U=T.__offset;typeof k=="number"?(T.__data[0]=k,n.bufferSubData(35345,U,T.__data)):(T.value.isMatrix3?(T.__data[0]=T.value.elements[0],T.__data[1]=T.value.elements[1],T.__data[2]=T.value.elements[2],T.__data[3]=T.value.elements[0],T.__data[4]=T.value.elements[3],T.__data[5]=T.value.elements[4],T.__data[6]=T.value.elements[5],T.__data[7]=T.value.elements[0],T.__data[8]=T.value.elements[6],T.__data[9]=T.value.elements[7],T.__data[10]=T.value.elements[8],T.__data[11]=T.value.elements[0]):k.toArray(T.__data),n.bufferSubData(35345,U,T.__data))}}n.bindBuffer(35345,null)}function v(C,A,P){const D=C.value;if(P[A]===void 0)return typeof D=="number"?P[A]=D:P[A]=D.clone(),!0;if(typeof D=="number"){if(P[A]!==D)return P[A]=D,!0}else{const N=P[A];if(N.equals(D)===!1)return N.copy(D),!0}return!1}function x(C){const A=C.uniforms;let P=0;const D=16;let N=0;for(let j=0,T=A.length;j<T;j++){const k=A[j],U=y(k);if(k.__data=new Float32Array(U.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=P,j>0){N=P%D;const ee=D-N;N!==0&&ee-U.boundary<0&&(P+=D-N,k.__offset=P)}P+=U.storage}return N=P%D,N>0&&(P+=D-N),C.__size=P,C.__cache={},this}function y(C){const A=C.value,P={boundary:0,storage:0};return typeof A=="number"?(P.boundary=4,P.storage=4):A.isVector2?(P.boundary=8,P.storage=8):A.isVector3||A.isColor?(P.boundary=16,P.storage=12):A.isVector4?(P.boundary=16,P.storage=16):A.isMatrix3?(P.boundary=48,P.storage=48):A.isMatrix4?(P.boundary=64,P.storage=64):A.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",A),P}function _(C){const A=C.target;A.removeEventListener("dispose",_);const P=o.indexOf(A.__bindingPointIndex);o.splice(P,1),n.deleteBuffer(i[A.id]),delete i[A.id],delete s[A.id]}function S(){for(const C in i)n.deleteBuffer(i[C]);o=[],i={},s={}}return{bind:c,update:u,dispose:S}}function H_e(){const n=YM("canvas");return n.style.display="block",n}function Ote(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:H_e(),t=n.context!==void 0?n.context:null,r=n.depth!==void 0?n.depth:!0,i=n.stencil!==void 0?n.stencil:!0,s=n.antialias!==void 0?n.antialias:!1,o=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,c=n.powerPreference!==void 0?n.powerPreference:"default",u=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let d;t!==null?d=t.getContextAttributes().alpha:d=n.alpha!==void 0?n.alpha:!1;let p=null,f=null;const v=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Am,this.physicallyCorrectLights=!1,this.toneMapping=qh,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const y=this;let _=!1,S=0,C=0,A=null,P=-1,D=null;const N=new Ir,j=new Ir;let T=null,k=e.width,U=e.height,ee=1,xe=null,ce=null;const te=new Ir(0,0,k,U),fe=new Ir(0,0,k,U);let ge=!1;const Se=new vL;let pe=!1,se=!1,ae=null;const Le=new zn,Re=new ot,Ue=new ye,Ze={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function st(){return A===null?ee:1}let we=t;function Mt(H,me){for(let Ce=0;Ce<H.length;Ce++){const ue=H[Ce],Oe=e.getContext(ue,me);if(Oe!==null)return Oe}return null}try{const H={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Hj}`),e.addEventListener("webglcontextlost",at,!1),e.addEventListener("webglcontextrestored",pt,!1),e.addEventListener("webglcontextcreationerror",Dt,!1),we===null){const me=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&me.shift(),we=Mt(me,H),we===null)throw Mt(me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}we.getShaderPrecisionFormat===void 0&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H}let rt,it,Ke,Qe,Y,K,ve,Ae,De,je,Xe,He,ne,W,O,E,F,z,Z,de,be,oe,ze,ke;function Fe(){rt=new n0e(we),it=new Kge(we,rt,n),rt.init(it),oe=new z_e(we,rt,it),Ke=new N_e(we,rt,it),Qe=new s0e,Y=new w_e,K=new k_e(we,rt,Ke,Y,it,oe,Qe),ve=new Qge(y),Ae=new t0e(y),De=new vme(we,it),ze=new Yge(we,rt,De,it),je=new r0e(we,De,Qe,ze),Xe=new c0e(we,je,De,Qe),Z=new l0e(we,it,K),E=new Jge(Y),He=new b_e(y,ve,Ae,rt,it,ze,E),ne=new U_e(y,Y),W=new M_e,O=new R_e(rt,it),z=new qge(y,ve,Ke,Xe,d,o),F=new I_e(y,Xe,it),ke=new j_e(we,Qe,it,Ke),de=new Zge(we,rt,Qe,it),be=new i0e(we,rt,Qe,it),Qe.programs=He.programs,y.capabilities=it,y.extensions=rt,y.properties=Y,y.renderLists=W,y.shadowMap=F,y.state=Ke,y.info=Qe}Fe();const Ge=new F_e(y,we);this.xr=Ge,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const H=rt.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){const H=rt.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(H){H!==void 0&&(ee=H,this.setSize(k,U,!1))},this.getSize=function(H){return H.set(k,U)},this.setSize=function(H,me,Ce){if(Ge.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}k=H,U=me,e.width=Math.floor(H*ee),e.height=Math.floor(me*ee),Ce!==!1&&(e.style.width=H+"px",e.style.height=me+"px"),this.setViewport(0,0,H,me)},this.getDrawingBufferSize=function(H){return H.set(k*ee,U*ee).floor()},this.setDrawingBufferSize=function(H,me,Ce){k=H,U=me,ee=Ce,e.width=Math.floor(H*Ce),e.height=Math.floor(me*Ce),this.setViewport(0,0,H,me)},this.getCurrentViewport=function(H){return H.copy(N)},this.getViewport=function(H){return H.copy(te)},this.setViewport=function(H,me,Ce,ue){H.isVector4?te.set(H.x,H.y,H.z,H.w):te.set(H,me,Ce,ue),Ke.viewport(N.copy(te).multiplyScalar(ee).floor())},this.getScissor=function(H){return H.copy(fe)},this.setScissor=function(H,me,Ce,ue){H.isVector4?fe.set(H.x,H.y,H.z,H.w):fe.set(H,me,Ce,ue),Ke.scissor(j.copy(fe).multiplyScalar(ee).floor())},this.getScissorTest=function(){return ge},this.setScissorTest=function(H){Ke.setScissorTest(ge=H)},this.setOpaqueSort=function(H){xe=H},this.setTransparentSort=function(H){ce=H},this.getClearColor=function(H){return H.copy(z.getClearColor())},this.setClearColor=function(){z.setClearColor.apply(z,arguments)},this.getClearAlpha=function(){return z.getClearAlpha()},this.setClearAlpha=function(){z.setClearAlpha.apply(z,arguments)},this.clear=function(H=!0,me=!0,Ce=!0){let ue=0;H&&(ue|=16384),me&&(ue|=256),Ce&&(ue|=1024),we.clear(ue)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",at,!1),e.removeEventListener("webglcontextrestored",pt,!1),e.removeEventListener("webglcontextcreationerror",Dt,!1),W.dispose(),O.dispose(),Y.dispose(),ve.dispose(),Ae.dispose(),Xe.dispose(),ze.dispose(),ke.dispose(),He.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",Ft),Ge.removeEventListener("sessionend",vn),ae&&(ae.dispose(),ae=null),hn.stop()};function at(H){H.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const H=Qe.autoReset,me=F.enabled,Ce=F.autoUpdate,ue=F.needsUpdate,Oe=F.type;Fe(),Qe.autoReset=H,F.enabled=me,F.autoUpdate=Ce,F.needsUpdate=ue,F.type=Oe}function Dt(H){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function re(H){const me=H.target;me.removeEventListener("dispose",re),$e(me)}function $e(H){Me(H),Y.remove(H)}function Me(H){const me=Y.get(H).programs;me!==void 0&&(me.forEach(function(Ce){He.releaseProgram(Ce)}),H.isShaderMaterial&&He.releaseShaderCache(H))}this.renderBufferDirect=function(H,me,Ce,ue,Oe,lt){me===null&&(me=Ze);const xt=Oe.isMesh&&Oe.matrixWorld.determinant()<0,bt=Lc(H,me,Ce,ue,Oe);Ke.setMaterial(ue,xt);let wt=Ce.index;const Zt=Ce.attributes.position;if(wt===null){if(Zt===void 0||Zt.count===0)return}else if(wt.count===0)return;let kt=1;ue.wireframe===!0&&(wt=je.getWireframeAttribute(Ce),kt=2),ze.setup(Oe,ue,bt,Ce,wt);let It,gn=de;wt!==null&&(It=De.get(wt),gn=be,gn.setIndex(It));const Bi=wt!==null?wt.count:Zt.count,Mr=Ce.drawRange.start*kt,Ln=Ce.drawRange.count*kt,Dn=lt!==null?lt.start*kt:0,Wt=lt!==null?lt.count*kt:1/0,ts=Math.max(Mr,Dn),Fn=Math.min(Bi,Mr+Ln,Dn+Wt)-1,Zn=Math.max(0,Fn-ts+1);if(Zn!==0){if(Oe.isMesh)ue.wireframe===!0?(Ke.setLineWidth(ue.wireframeLinewidth*st()),gn.setMode(1)):gn.setMode(4);else if(Oe.isLine){let Cr=ue.linewidth;Cr===void 0&&(Cr=1),Ke.setLineWidth(Cr*st()),Oe.isLineSegments?gn.setMode(1):Oe.isLineLoop?gn.setMode(2):gn.setMode(3)}else Oe.isPoints?gn.setMode(0):Oe.isSprite&&gn.setMode(4);if(Oe.isInstancedMesh)gn.renderInstances(ts,Zn,Oe.count);else if(Ce.isInstancedBufferGeometry){const Cr=Math.min(Ce.instanceCount,Ce._maxInstanceCount);gn.renderInstances(ts,Zn,Cr)}else gn.render(ts,Zn)}},this.compile=function(H,me){function Ce(ue,Oe,lt){ue.transparent===!0&&ue.side===zh?(ue.side=Ol,ue.needsUpdate=!0,Vo(ue,Oe,lt),ue.side=tx,ue.needsUpdate=!0,Vo(ue,Oe,lt),ue.side=zh):Vo(ue,Oe,lt)}f=O.get(H),f.init(),x.push(f),H.traverseVisible(function(ue){ue.isLight&&ue.layers.test(me.layers)&&(f.pushLight(ue),ue.castShadow&&f.pushShadow(ue))}),f.setupLights(y.physicallyCorrectLights),H.traverse(function(ue){const Oe=ue.material;if(Oe)if(Array.isArray(Oe))for(let lt=0;lt<Oe.length;lt++){const xt=Oe[lt];Ce(xt,H,ue)}else Ce(Oe,H,ue)}),x.pop(),f=null};let tt=null;function Je(H){tt&&tt(H)}function Ft(){hn.stop()}function vn(){hn.start()}const hn=new Cte;hn.setAnimationLoop(Je),typeof self<"u"&&hn.setContext(self),this.setAnimationLoop=function(H){tt=H,Ge.setAnimationLoop(H),H===null?hn.stop():hn.start()},Ge.addEventListener("sessionstart",Ft),Ge.addEventListener("sessionend",vn),this.render=function(H,me){if(me!==void 0&&me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),me.parent===null&&me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(me),me=Ge.getCamera()),H.isScene===!0&&H.onBeforeRender(y,H,me,A),f=O.get(H,x.length),f.init(),x.push(f),Le.multiplyMatrices(me.projectionMatrix,me.matrixWorldInverse),Se.setFromProjectionMatrix(Le),se=this.localClippingEnabled,pe=E.init(this.clippingPlanes,se,me),p=W.get(H,v.length),p.init(),v.push(p),zr(H,me,0,y.sortObjects),p.finish(),y.sortObjects===!0&&p.sort(xe,ce),pe===!0&&E.beginShadows();const Ce=f.state.shadowsArray;if(F.render(Ce,H,me),pe===!0&&E.endShadows(),this.info.autoReset===!0&&this.info.reset(),z.render(p,H),f.setupLights(y.physicallyCorrectLights),me.isArrayCamera){const ue=me.cameras;for(let Oe=0,lt=ue.length;Oe<lt;Oe++){const xt=ue[Oe];qt(p,H,xt,xt.viewport)}}else qt(p,H,me);A!==null&&(K.updateMultisampleRenderTarget(A),K.updateRenderTargetMipmap(A)),H.isScene===!0&&H.onAfterRender(y,H,me),ze.resetDefaultState(),P=-1,D=null,x.pop(),x.length>0?f=x[x.length-1]:f=null,v.pop(),v.length>0?p=v[v.length-1]:p=null};function zr(H,me,Ce,ue){if(H.visible===!1)return;if(H.layers.test(me.layers)){if(H.isGroup)Ce=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(me);else if(H.isLight)f.pushLight(H),H.castShadow&&f.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||Se.intersectsSprite(H)){ue&&Ue.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Le);const lt=Xe.update(H),xt=H.material;xt.visible&&p.push(H,lt,xt,Ce,Ue.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(H.isSkinnedMesh&&H.skeleton.frame!==Qe.render.frame&&(H.skeleton.update(),H.skeleton.frame=Qe.render.frame),!H.frustumCulled||Se.intersectsObject(H))){ue&&Ue.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Le);const lt=Xe.update(H),xt=H.material;if(Array.isArray(xt)){const bt=lt.groups;for(let wt=0,Zt=bt.length;wt<Zt;wt++){const kt=bt[wt],It=xt[kt.materialIndex];It&&It.visible&&p.push(H,lt,It,Ce,Ue.z,kt)}}else xt.visible&&p.push(H,lt,xt,Ce,Ue.z,null)}}const Oe=H.children;for(let lt=0,xt=Oe.length;lt<xt;lt++)zr(Oe[lt],me,Ce,ue)}function qt(H,me,Ce,ue){const Oe=H.opaque,lt=H.transmissive,xt=H.transparent;f.setupLightsView(Ce),lt.length>0&&xr(Oe,me,Ce),ue&&Ke.viewport(N.copy(ue)),Oe.length>0&&or(Oe,me,Ce),lt.length>0&&or(lt,me,Ce),xt.length>0&&or(xt,me,Ce),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1)}function xr(H,me,Ce){const ue=it.isWebGL2;ae===null&&(ae=new Ei(1,1,{generateMipmaps:!0,type:rt.has("EXT_color_buffer_half_float")?Op:m0,minFilter:kC,samples:ue&&s===!0?4:0})),y.getDrawingBufferSize(Re),ue?ae.setSize(Re.x,Re.y):ae.setSize(DR(Re.x),DR(Re.y));const Oe=y.getRenderTarget();y.setRenderTarget(ae),y.clear();const lt=y.toneMapping;y.toneMapping=qh,or(H,me,Ce),y.toneMapping=lt,K.updateMultisampleRenderTarget(ae),K.updateRenderTargetMipmap(ae),y.setRenderTarget(Oe)}function or(H,me,Ce){const ue=me.isScene===!0?me.overrideMaterial:null;for(let Oe=0,lt=H.length;Oe<lt;Oe++){const xt=H[Oe],bt=xt.object,wt=xt.geometry,Zt=ue===null?xt.material:ue,kt=xt.group;bt.layers.test(Ce.layers)&&Ul(bt,me,Ce,wt,Zt,kt)}}function Ul(H,me,Ce,ue,Oe,lt){H.onBeforeRender(y,me,Ce,ue,Oe,lt),H.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),Oe.onBeforeRender(y,me,Ce,ue,H,lt),Oe.transparent===!0&&Oe.side===zh?(Oe.side=Ol,Oe.needsUpdate=!0,y.renderBufferDirect(Ce,me,ue,Oe,H,lt),Oe.side=tx,Oe.needsUpdate=!0,y.renderBufferDirect(Ce,me,ue,Oe,H,lt),Oe.side=zh):y.renderBufferDirect(Ce,me,ue,Oe,H,lt),H.onAfterRender(y,me,Ce,ue,Oe,lt)}function Vo(H,me,Ce){me.isScene!==!0&&(me=Ze);const ue=Y.get(H),Oe=f.state.lights,lt=f.state.shadowsArray,xt=Oe.state.version,bt=He.getParameters(H,Oe.state,lt,me,Ce),wt=He.getProgramCacheKey(bt);let Zt=ue.programs;ue.environment=H.isMeshStandardMaterial?me.environment:null,ue.fog=me.fog,ue.envMap=(H.isMeshStandardMaterial?Ae:ve).get(H.envMap||ue.environment),Zt===void 0&&(H.addEventListener("dispose",re),Zt=new Map,ue.programs=Zt);let kt=Zt.get(wt);if(kt!==void 0){if(ue.currentProgram===kt&&ue.lightsStateVersion===xt)return Fo(H,bt),kt}else bt.uniforms=He.getUniforms(H),H.onBuild(Ce,bt,y),H.onBeforeCompile(bt,y),kt=He.acquireProgram(bt,wt),Zt.set(wt,kt),ue.uniforms=bt.uniforms;const It=ue.uniforms;(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(It.clippingPlanes=E.uniform),Fo(H,bt),ue.needsLights=ei(H),ue.lightsStateVersion=xt,ue.needsLights&&(It.ambientLightColor.value=Oe.state.ambient,It.lightProbe.value=Oe.state.probe,It.directionalLights.value=Oe.state.directional,It.directionalLightShadows.value=Oe.state.directionalShadow,It.spotLights.value=Oe.state.spot,It.spotLightShadows.value=Oe.state.spotShadow,It.rectAreaLights.value=Oe.state.rectArea,It.ltc_1.value=Oe.state.rectAreaLTC1,It.ltc_2.value=Oe.state.rectAreaLTC2,It.pointLights.value=Oe.state.point,It.pointLightShadows.value=Oe.state.pointShadow,It.hemisphereLights.value=Oe.state.hemi,It.directionalShadowMap.value=Oe.state.directionalShadowMap,It.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,It.spotShadowMap.value=Oe.state.spotShadowMap,It.spotLightMatrix.value=Oe.state.spotLightMatrix,It.spotLightMap.value=Oe.state.spotLightMap,It.pointShadowMap.value=Oe.state.pointShadowMap,It.pointShadowMatrix.value=Oe.state.pointShadowMatrix);const gn=kt.getUniforms(),Bi=v3.seqWithValue(gn.seq,It);return ue.currentProgram=kt,ue.uniformsList=Bi,kt}function Fo(H,me){const Ce=Y.get(H);Ce.outputEncoding=me.outputEncoding,Ce.instancing=me.instancing,Ce.skinning=me.skinning,Ce.morphTargets=me.morphTargets,Ce.morphNormals=me.morphNormals,Ce.morphColors=me.morphColors,Ce.morphTargetsCount=me.morphTargetsCount,Ce.numClippingPlanes=me.numClippingPlanes,Ce.numIntersection=me.numClipIntersection,Ce.vertexAlphas=me.vertexAlphas,Ce.vertexTangents=me.vertexTangents,Ce.toneMapping=me.toneMapping}function Lc(H,me,Ce,ue,Oe){me.isScene!==!0&&(me=Ze),K.resetTextureUnits();const lt=me.fog,xt=ue.isMeshStandardMaterial?me.environment:null,bt=A===null?y.outputEncoding:A.isXRRenderTarget===!0?A.texture.encoding:Am,wt=(ue.isMeshStandardMaterial?Ae:ve).get(ue.envMap||xt),Zt=ue.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,kt=!!ue.normalMap&&!!Ce.attributes.tangent,It=!!Ce.morphAttributes.position,gn=!!Ce.morphAttributes.normal,Bi=!!Ce.morphAttributes.color,Mr=ue.toneMapped?y.toneMapping:qh,Ln=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,Dn=Ln!==void 0?Ln.length:0,Wt=Y.get(ue),ts=f.state.lights;if(pe===!0&&(se===!0||H!==D)){const Un=H===D&&ue.id===P;E.setState(ue,H,Un)}let Fn=!1;ue.version===Wt.__version?(Wt.needsLights&&Wt.lightsStateVersion!==ts.state.version||Wt.outputEncoding!==bt||Oe.isInstancedMesh&&Wt.instancing===!1||!Oe.isInstancedMesh&&Wt.instancing===!0||Oe.isSkinnedMesh&&Wt.skinning===!1||!Oe.isSkinnedMesh&&Wt.skinning===!0||Wt.envMap!==wt||ue.fog===!0&&Wt.fog!==lt||Wt.numClippingPlanes!==void 0&&(Wt.numClippingPlanes!==E.numPlanes||Wt.numIntersection!==E.numIntersection)||Wt.vertexAlphas!==Zt||Wt.vertexTangents!==kt||Wt.morphTargets!==It||Wt.morphNormals!==gn||Wt.morphColors!==Bi||Wt.toneMapping!==Mr||it.isWebGL2===!0&&Wt.morphTargetsCount!==Dn)&&(Fn=!0):(Fn=!0,Wt.__version=ue.version);let Zn=Wt.currentProgram;Fn===!0&&(Zn=Vo(ue,me,Oe));let Cr=!1,Xr=!1,Ts=!1;const Rn=Zn.getUniforms(),Vi=Wt.uniforms;if(Ke.useProgram(Zn.program)&&(Cr=!0,Xr=!0,Ts=!0),ue.id!==P&&(P=ue.id,Xr=!0),Cr||D!==H){if(Rn.setValue(we,"projectionMatrix",H.projectionMatrix),it.logarithmicDepthBuffer&&Rn.setValue(we,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),D!==H&&(D=H,Xr=!0,Ts=!0),ue.isShaderMaterial||ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshStandardMaterial||ue.envMap){const Un=Rn.map.cameraPosition;Un!==void 0&&Un.setValue(we,Ue.setFromMatrixPosition(H.matrixWorld))}(ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshLambertMaterial||ue.isMeshBasicMaterial||ue.isMeshStandardMaterial||ue.isShaderMaterial)&&Rn.setValue(we,"isOrthographic",H.isOrthographicCamera===!0),(ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshLambertMaterial||ue.isMeshBasicMaterial||ue.isMeshStandardMaterial||ue.isShaderMaterial||ue.isShadowMaterial||Oe.isSkinnedMesh)&&Rn.setValue(we,"viewMatrix",H.matrixWorldInverse)}if(Oe.isSkinnedMesh){Rn.setOptional(we,Oe,"bindMatrix"),Rn.setOptional(we,Oe,"bindMatrixInverse");const Un=Oe.skeleton;Un&&(it.floatVertexTextures?(Un.boneTexture===null&&Un.computeBoneTexture(),Rn.setValue(we,"boneTexture",Un.boneTexture,K),Rn.setValue(we,"boneTextureSize",Un.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Uo=Ce.morphAttributes;if((Uo.position!==void 0||Uo.normal!==void 0||Uo.color!==void 0&&it.isWebGL2===!0)&&Z.update(Oe,Ce,ue,Zn),(Xr||Wt.receiveShadow!==Oe.receiveShadow)&&(Wt.receiveShadow=Oe.receiveShadow,Rn.setValue(we,"receiveShadow",Oe.receiveShadow)),ue.isMeshGouraudMaterial&&ue.envMap!==null&&(Vi.envMap.value=wt,Vi.flipEnvMap.value=wt.isCubeTexture&&wt.isRenderTargetTexture===!1?-1:1),Xr&&(Rn.setValue(we,"toneMappingExposure",y.toneMappingExposure),Wt.needsLights&&va(Vi,Ts),lt&&ue.fog===!0&&ne.refreshFogUniforms(Vi,lt),ne.refreshMaterialUniforms(Vi,ue,ee,U,ae),v3.upload(we,Wt.uniformsList,Vi,K)),ue.isShaderMaterial&&ue.uniformsNeedUpdate===!0&&(v3.upload(we,Wt.uniformsList,Vi,K),ue.uniformsNeedUpdate=!1),ue.isSpriteMaterial&&Rn.setValue(we,"center",Oe.center),Rn.setValue(we,"modelViewMatrix",Oe.modelViewMatrix),Rn.setValue(we,"normalMatrix",Oe.normalMatrix),Rn.setValue(we,"modelMatrix",Oe.matrixWorld),ue.isShaderMaterial||ue.isRawShaderMaterial){const Un=ue.uniformsGroups;for(let fs=0,jl=Un.length;fs<jl;fs++)if(it.isWebGL2){const jo=Un[fs];ke.update(jo,Zn),ke.bind(jo,Zn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Zn}function va(H,me){H.ambientLightColor.needsUpdate=me,H.lightProbe.needsUpdate=me,H.directionalLights.needsUpdate=me,H.directionalLightShadows.needsUpdate=me,H.pointLights.needsUpdate=me,H.pointLightShadows.needsUpdate=me,H.spotLights.needsUpdate=me,H.spotLightShadows.needsUpdate=me,H.rectAreaLights.needsUpdate=me,H.hemisphereLights.needsUpdate=me}function ei(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(H,me,Ce){Y.get(H.texture).__webglTexture=me,Y.get(H.depthTexture).__webglTexture=Ce;const ue=Y.get(H);ue.__hasExternalTextures=!0,ue.__hasExternalTextures&&(ue.__autoAllocateDepthBuffer=Ce===void 0,ue.__autoAllocateDepthBuffer||rt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ue.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(H,me){const Ce=Y.get(H);Ce.__webglFramebuffer=me,Ce.__useDefaultFramebuffer=me===void 0},this.setRenderTarget=function(H,me=0,Ce=0){A=H,S=me,C=Ce;let ue=!0;if(H){const bt=Y.get(H);bt.__useDefaultFramebuffer!==void 0?(Ke.bindFramebuffer(36160,null),ue=!1):bt.__webglFramebuffer===void 0?K.setupRenderTarget(H):bt.__hasExternalTextures&&K.rebindTextures(H,Y.get(H.texture).__webglTexture,Y.get(H.depthTexture).__webglTexture)}let Oe=null,lt=!1,xt=!1;if(H){const bt=H.texture;(bt.isData3DTexture||bt.isDataArrayTexture)&&(xt=!0);const wt=Y.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Oe=wt[me],lt=!0):it.isWebGL2&&H.samples>0&&K.useMultisampledRTT(H)===!1?Oe=Y.get(H).__webglMultisampledFramebuffer:Oe=wt,N.copy(H.viewport),j.copy(H.scissor),T=H.scissorTest}else N.copy(te).multiplyScalar(ee).floor(),j.copy(fe).multiplyScalar(ee).floor(),T=ge;if(Ke.bindFramebuffer(36160,Oe)&&it.drawBuffers&&ue&&Ke.drawBuffers(H,Oe),Ke.viewport(N),Ke.scissor(j),Ke.setScissorTest(T),lt){const bt=Y.get(H.texture);we.framebufferTexture2D(36160,36064,34069+me,bt.__webglTexture,Ce)}else if(xt){const bt=Y.get(H.texture),wt=me||0;we.framebufferTextureLayer(36160,36064,bt.__webglTexture,Ce||0,wt)}P=-1},this.readRenderTargetPixels=function(H,me,Ce,ue,Oe,lt,xt){if(!(H&&H.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let bt=Y.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&xt!==void 0&&(bt=bt[xt]),bt){Ke.bindFramebuffer(36160,bt);try{const wt=H.texture,Zt=wt.format,kt=wt.type;if(Zt!==nh&&oe.convert(Zt)!==we.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const It=kt===Op&&(rt.has("EXT_color_buffer_half_float")||it.isWebGL2&&rt.has("EXT_color_buffer_float"));if(kt!==m0&&oe.convert(kt)!==we.getParameter(35738)&&!(kt===th&&(it.isWebGL2||rt.has("OES_texture_float")||rt.has("WEBGL_color_buffer_float")))&&!It){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}me>=0&&me<=H.width-ue&&Ce>=0&&Ce<=H.height-Oe&&we.readPixels(me,Ce,ue,Oe,oe.convert(Zt),oe.convert(kt),lt)}finally{const wt=A!==null?Y.get(A).__webglFramebuffer:null;Ke.bindFramebuffer(36160,wt)}}},this.copyFramebufferToTexture=function(H,me,Ce=0){const ue=Math.pow(2,-Ce),Oe=Math.floor(me.image.width*ue),lt=Math.floor(me.image.height*ue);K.setTexture2D(me,0),we.copyTexSubImage2D(3553,Ce,0,0,H.x,H.y,Oe,lt),Ke.unbindTexture()},this.copyTextureToTexture=function(H,me,Ce,ue=0){const Oe=me.image.width,lt=me.image.height,xt=oe.convert(Ce.format),bt=oe.convert(Ce.type);K.setTexture2D(Ce,0),we.pixelStorei(37440,Ce.flipY),we.pixelStorei(37441,Ce.premultiplyAlpha),we.pixelStorei(3317,Ce.unpackAlignment),me.isDataTexture?we.texSubImage2D(3553,ue,H.x,H.y,Oe,lt,xt,bt,me.image.data):me.isCompressedTexture?we.compressedTexSubImage2D(3553,ue,H.x,H.y,me.mipmaps[0].width,me.mipmaps[0].height,xt,me.mipmaps[0].data):we.texSubImage2D(3553,ue,H.x,H.y,xt,bt,me.image),ue===0&&Ce.generateMipmaps&&we.generateMipmap(3553),Ke.unbindTexture()},this.copyTextureToTexture3D=function(H,me,Ce,ue,Oe=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const lt=H.max.x-H.min.x+1,xt=H.max.y-H.min.y+1,bt=H.max.z-H.min.z+1,wt=oe.convert(ue.format),Zt=oe.convert(ue.type);let kt;if(ue.isData3DTexture)K.setTexture3D(ue,0),kt=32879;else if(ue.isDataArrayTexture)K.setTexture2DArray(ue,0),kt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}we.pixelStorei(37440,ue.flipY),we.pixelStorei(37441,ue.premultiplyAlpha),we.pixelStorei(3317,ue.unpackAlignment);const It=we.getParameter(3314),gn=we.getParameter(32878),Bi=we.getParameter(3316),Mr=we.getParameter(3315),Ln=we.getParameter(32877),Dn=Ce.isCompressedTexture?Ce.mipmaps[0]:Ce.image;we.pixelStorei(3314,Dn.width),we.pixelStorei(32878,Dn.height),we.pixelStorei(3316,H.min.x),we.pixelStorei(3315,H.min.y),we.pixelStorei(32877,H.min.z),Ce.isDataTexture||Ce.isData3DTexture?we.texSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Zt,Dn.data):Ce.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),we.compressedTexSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Dn.data)):we.texSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Zt,Dn),we.pixelStorei(3314,It),we.pixelStorei(32878,gn),we.pixelStorei(3316,Bi),we.pixelStorei(3315,Mr),we.pixelStorei(32877,Ln),Oe===0&&ue.generateMipmaps&&we.generateMipmap(kt),Ke.unbindTexture()},this.initTexture=function(H){H.isCubeTexture?K.setTextureCube(H,0):H.isData3DTexture?K.setTexture3D(H,0):H.isDataArrayTexture?K.setTexture2DArray(H,0):K.setTexture2D(H,0),Ke.unbindTexture()},this.resetState=function(){S=0,C=0,A=null,Ke.reset(),ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class W_e extends Ote{}W_e.prototype.isWebGL1Renderer=!0;class G_e extends wr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class X_e{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=S6,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ru()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ru()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ru()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const nl=new ye;class IR{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)nl.fromBufferAttribute(this,t),nl.applyMatrix4(e),this.setXYZ(t,nl.x,nl.y,nl.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)nl.fromBufferAttribute(this,t),nl.applyNormalMatrix(e),this.setXYZ(t,nl.x,nl.y,nl.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)nl.fromBufferAttribute(this,t),nl.transformDirection(e),this.setXYZ(t,nl.x,nl.y,nl.z);return this}setX(e,t){return this.normalized&&(t=li(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=li(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=li(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=li(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Lp(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Lp(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Lp(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Lp(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=li(t,this.array),r=li(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=li(t,this.array),r=li(r,this.array),i=li(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=li(t,this.array),r=li(r,this.array),i=li(i,this.array),s=li(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new bc(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new IR(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Lte extends od{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Xt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let E_;const hS=new ye,A_=new ye,P_=new ye,T_=new ot,dS=new ot,Dte=new zn,UA=new ye,pS=new ye,jA=new ye,zG=new ot,b5=new ot,BG=new ot;class q_e extends wr{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",E_===void 0){E_=new Oi;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new X_e(t,5);E_.setIndex([0,1,2,0,2,3]),E_.setAttribute("position",new IR(r,3,0,!1)),E_.setAttribute("uv",new IR(r,2,3,!1))}this.geometry=E_,this.material=e!==void 0?e:new Lte,this.center=new ot(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),A_.setFromMatrixScale(this.matrixWorld),Dte.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),P_.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&A_.multiplyScalar(-P_.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;HA(UA.set(-.5,-.5,0),P_,o,A_,i,s),HA(pS.set(.5,-.5,0),P_,o,A_,i,s),HA(jA.set(.5,.5,0),P_,o,A_,i,s),zG.set(0,0),b5.set(1,0),BG.set(1,1);let a=e.ray.intersectTriangle(UA,pS,jA,!1,hS);if(a===null&&(HA(pS.set(-.5,.5,0),P_,o,A_,i,s),b5.set(0,1),a=e.ray.intersectTriangle(UA,jA,pS,!1,hS),a===null))return;const c=e.ray.origin.distanceTo(hS);c<e.near||c>e.far||t.push({distance:c,point:hS.clone(),uv:Nh.getUV(hS,UA,pS,jA,zG,b5,BG,new ot),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function HA(n,e,t,r,i,s){T_.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(dS.x=s*T_.x-i*T_.y,dS.y=i*T_.x+s*T_.y):dS.copy(T_),n.copy(e),n.x+=dS.x,n.y+=dS.y,n.applyMatrix4(Dte)}const VG=new ye,FG=new Ir,UG=new Ir,Y_e=new ye,jG=new zn;class OQe extends Io{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zn,this.bindMatrixInverse=new zn}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ir,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const r=this.skeleton,i=this.geometry;FG.fromBufferAttribute(i.attributes.skinIndex,e),UG.fromBufferAttribute(i.attributes.skinWeight,e),VG.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=UG.getComponent(s);if(o!==0){const a=FG.getComponent(s);jG.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(Y_e.copy(VG).applyMatrix4(jG),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ite extends wr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Nte extends da{constructor(e=null,t=1,r=1,i,s,o,a,c,u=us,d=us,p,f){super(null,o,a,c,u,d,i,s,p,f),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const HG=new zn,Z_e=new zn;class kte{constructor(e=[],t=[]){this.uuid=ru(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new zn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new zn;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Z_e;HG.multiplyMatrices(a,t[s]),HG.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new kte(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=gte(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Nte(t,e,e,nh,th);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Ite),this.bones.push(o),this.boneInverses.push(new zn().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class P0 extends od{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const WG=new ye,GG=new ye,XG=new zn,w5=new Qx,WA=new Jx;class $j extends wr{constructor(e=new Oi,t=new P0){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)WG.fromBufferAttribute(t,i-1),GG.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=WG.distanceTo(GG);e.setAttribute("lineDistance",new Hn(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),WA.copy(r.boundingSphere),WA.applyMatrix4(i),WA.radius+=s,e.ray.intersectsSphere(WA)===!1)return;XG.copy(i).invert(),w5.copy(e.ray).applyMatrix4(XG);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,u=new ye,d=new ye,p=new ye,f=new ye,v=this.isLineSegments?2:1,x=r.index,y=r.attributes.position;if(x!==null){const _=Math.max(0,o.start),S=Math.min(x.count,o.start+o.count);for(let C=_,A=S-1;C<A;C+=v){const P=x.getX(C),D=x.getX(C+1);if(u.fromBufferAttribute(y,P),d.fromBufferAttribute(y,D),w5.distanceSqToSegment(u,d,f,p)>c)continue;f.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(f);N<e.near||N>e.far||t.push({distance:N,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else{const _=Math.max(0,o.start),S=Math.min(y.count,o.start+o.count);for(let C=_,A=S-1;C<A;C+=v){if(u.fromBufferAttribute(y,C),d.fromBufferAttribute(y,C+1),w5.distanceSqToSegment(u,d,f,p)>c)continue;f.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(f);P<e.near||P>e.far||t.push({distance:P,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=r.length;i<s;i++){const o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}}const qG=new ye,YG=new ye;class FC extends $j{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)qG.fromBufferAttribute(t,i),YG.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+qG.distanceTo(YG);e.setAttribute("lineDistance",new Hn(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LQe extends $j{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class K_e extends od{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const ZG=new zn,A6=new Qx,GA=new Jx,XA=new ye;class DQe extends wr{constructor(e=new Oi,t=new K_e){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),GA.copy(r.boundingSphere),GA.applyMatrix4(i),GA.radius+=s,e.ray.intersectsSphere(GA)===!1)return;ZG.copy(i).invert(),A6.copy(e.ray).applyMatrix4(ZG);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,u=r.index,d=r.attributes.position;if(u!==null){const p=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let v=p,x=f;v<x;v++){const y=u.getX(v);XA.fromBufferAttribute(d,y),KG(XA,y,c,i,e,t,this)}}else{const p=Math.max(0,o.start),f=Math.min(d.count,o.start+o.count);for(let v=p,x=f;v<x;v++)XA.fromBufferAttribute(d,v),KG(XA,v,c,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,s=r.length;i<s;i++){const o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}}function KG(n,e,t,r,i,s,o){const a=A6.distanceSqToPoint(n);if(a<t){const c=new ye;A6.closestPointToPoint(n,c),c.applyMatrix4(r);const u=i.ray.origin.distanceTo(c);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class J_e extends da{constructor(e,t,r,i,s,o,a,c,u){super(e,t,r,i,s,o,a,c,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Vs,this.magFilter=s!==void 0?s:Vs,this.generateMipmaps=!1;const d=this;function p(){d.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class IQe extends da{constructor(e,t,r,i,s,o,a,c,u){super(e,t,r,i,s,o,a,c,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ad{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,c=s-1,u;for(;a<=c;)if(i=Math.floor(a+(c-a)/2),u=r[i]-o,u<0)a=i+1;else if(u>0)c=i-1;else{c=i;break}if(i=c,r[i]===o)return i/(s-1);const d=r[i],p=r[i+1]-d,f=(o-d)/p;return(i+f)/(s-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const s=this.getPoint(r),o=this.getPoint(i),a=t||(s.isVector2?new ot:new ye);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new ye,i=[],s=[],o=[],a=new ye,c=new zn;for(let v=0;v<=e;v++){const x=v/e;i[v]=this.getTangentAt(x,new ye)}s[0]=new ye,o[0]=new ye;let u=Number.MAX_VALUE;const d=Math.abs(i[0].x),p=Math.abs(i[0].y),f=Math.abs(i[0].z);d<=u&&(u=d,r.set(1,0,0)),p<=u&&(u=p,r.set(0,1,0)),f<=u&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(i[v-1],i[v]),a.length()>Number.EPSILON){a.normalize();const x=Math.acos(so(i[v-1].dot(i[v]),-1,1));s[v].applyMatrix4(c.makeRotationAxis(a,x))}o[v].crossVectors(i[v],s[v])}if(t===!0){let v=Math.acos(so(s[0].dot(s[e]),-1,1));v/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let x=1;x<=e;x++)s[x].applyMatrix4(c.makeRotationAxis(i[x],v*x)),o[x].crossVectors(i[x],s[x])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class e9 extends ad{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const r=t||new ot,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),p=Math.sin(this.aRotation),f=c-this.aX,v=u-this.aY;c=f*d-v*p+this.aX,u=f*p+v*d+this.aY}return r.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Q_e extends e9{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function t9(){let n=0,e=0,t=0,r=0;function i(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,r=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,u){i(o,a,u*(a-s),u*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,u,d,p){let f=(o-s)/u-(a-s)/(u+d)+(a-o)/d,v=(a-o)/d-(c-o)/(d+p)+(c-a)/p;f*=d,v*=d,i(o,a,f,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const qA=new ye,S5=new t9,M5=new t9,C5=new t9;class $_e extends ad{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new ye){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let u,d;this.closed||a>0?u=i[(a-1)%s]:(qA.subVectors(i[0],i[1]).add(i[0]),u=qA);const p=i[a%s],f=i[(a+1)%s];if(this.closed||a+2<s?d=i[(a+2)%s]:(qA.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=qA),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let x=Math.pow(u.distanceToSquared(p),v),y=Math.pow(p.distanceToSquared(f),v),_=Math.pow(f.distanceToSquared(d),v);y<1e-4&&(y=1),x<1e-4&&(x=y),_<1e-4&&(_=y),S5.initNonuniformCatmullRom(u.x,p.x,f.x,d.x,x,y,_),M5.initNonuniformCatmullRom(u.y,p.y,f.y,d.y,x,y,_),C5.initNonuniformCatmullRom(u.z,p.z,f.z,d.z,x,y,_)}else this.curveType==="catmullrom"&&(S5.initCatmullRom(u.x,p.x,f.x,d.x,this.tension),M5.initCatmullRom(u.y,p.y,f.y,d.y,this.tension),C5.initCatmullRom(u.z,p.z,f.z,d.z,this.tension));return r.set(S5.calc(c),M5.calc(c),C5.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ye().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function JG(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,c=n*a;return(2*t-2*r+s+o)*c+(-3*t+3*r-2*s-o)*a+s*n+t}function eye(n,e){const t=1-n;return t*t*e}function tye(n,e){return 2*(1-n)*n*e}function nye(n,e){return n*n*e}function yM(n,e,t,r){return eye(n,e)+tye(n,t)+nye(n,r)}function rye(n,e){const t=1-n;return t*t*t*e}function iye(n,e){const t=1-n;return 3*t*t*n*e}function sye(n,e){return 3*(1-n)*n*n*e}function oye(n,e){return n*n*n*e}function xM(n,e,t,r,i){return rye(n,e)+iye(n,t)+sye(n,r)+oye(n,i)}class zte extends ad{constructor(e=new ot,t=new ot,r=new ot,i=new ot){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ot){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(xM(e,i.x,s.x,o.x,a.x),xM(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class aye extends ad{constructor(e=new ye,t=new ye,r=new ye,i=new ye){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ye){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(xM(e,i.x,s.x,o.x,a.x),xM(e,i.y,s.y,o.y,a.y),xM(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class n9 extends ad{constructor(e=new ot,t=new ot){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ot){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const r=t||new ot;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lye extends ad{constructor(e=new ye,t=new ye){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ye){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Bte extends ad{constructor(e=new ot,t=new ot,r=new ot){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ot){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(yM(e,i.x,s.x,o.x),yM(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cye extends ad{constructor(e=new ye,t=new ye,r=new ye){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ye){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(yM(e,i.x,s.x,o.x),yM(e,i.y,s.y,o.y),yM(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vte extends ad{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ot){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,c=i[o===0?o:o-1],u=i[o],d=i[o>i.length-2?i.length-1:o+1],p=i[o>i.length-3?i.length-1:o+2];return r.set(JG(a,c.x,u.x,d.x,p.x),JG(a,c.y,u.y,d.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ot().fromArray(i))}return this}}var Fte=Object.freeze({__proto__:null,ArcCurve:Q_e,CatmullRomCurve3:$_e,CubicBezierCurve:zte,CubicBezierCurve3:aye,EllipseCurve:e9,LineCurve:n9,LineCurve3:lye,QuadraticBezierCurve:Bte,QuadraticBezierCurve3:cye,SplineCurve:Vte});class uye extends ad{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new n9(t,e))}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],c=a.getLength(),u=c===0?0:1-o/c;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let u=0;u<c.length;u++){const d=c[u];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new Fte[i.type]().fromJSON(i))}return this}}class P6 extends uye{constructor(e){super(),this.type="Path",this.currentPoint=new ot,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new n9(this.currentPoint.clone(),new ot(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new Bte(this.currentPoint.clone(),new ot(e,t),new ot(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new zte(this.currentPoint.clone(),new ot(e,t),new ot(r,i),new ot(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new Vte(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,c){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+u,t+d,r,i,s,o,a,c),this}absellipse(e,t,r,i,s,o,a,c){const u=new e9(e,t,r,i,s,o,a,c);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const d=u.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class r9 extends Oi{constructor(e=1,t=8,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],c=[],u=new ye,d=new ot;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let p=0,f=3;p<=t;p++,f+=3){const v=r+p/t*i;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),a.push(0,0,1),d.x=(o[f]/e+1)/2,d.y=(o[f+1]/e+1)/2,c.push(d.x,d.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new Hn(o,3)),this.setAttribute("normal",new Hn(a,3)),this.setAttribute("uv",new Hn(c,2))}static fromJSON(e){return new r9(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class yL extends Oi{constructor(e=1,t=1,r=1,i=8,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const u=this;i=Math.floor(i),s=Math.floor(s);const d=[],p=[],f=[],v=[];let x=0;const y=[],_=r/2;let S=0;C(),o===!1&&(e>0&&A(!0),t>0&&A(!1)),this.setIndex(d),this.setAttribute("position",new Hn(p,3)),this.setAttribute("normal",new Hn(f,3)),this.setAttribute("uv",new Hn(v,2));function C(){const P=new ye,D=new ye;let N=0;const j=(t-e)/r;for(let T=0;T<=s;T++){const k=[],U=T/s,ee=U*(t-e)+e;for(let xe=0;xe<=i;xe++){const ce=xe/i,te=ce*c+a,fe=Math.sin(te),ge=Math.cos(te);D.x=ee*fe,D.y=-U*r+_,D.z=ee*ge,p.push(D.x,D.y,D.z),P.set(fe,j,ge).normalize(),f.push(P.x,P.y,P.z),v.push(ce,1-U),k.push(x++)}y.push(k)}for(let T=0;T<i;T++)for(let k=0;k<s;k++){const U=y[k][T],ee=y[k+1][T],xe=y[k+1][T+1],ce=y[k][T+1];d.push(U,ee,ce),d.push(ee,xe,ce),N+=6}u.addGroup(S,N,0),S+=N}function A(P){const D=x,N=new ot,j=new ye;let T=0;const k=P===!0?e:t,U=P===!0?1:-1;for(let xe=1;xe<=i;xe++)p.push(0,_*U,0),f.push(0,U,0),v.push(.5,.5),x++;const ee=x;for(let xe=0;xe<=i;xe++){const ce=xe/i*c+a,te=Math.cos(ce),fe=Math.sin(ce);j.x=k*fe,j.y=_*U,j.z=k*te,p.push(j.x,j.y,j.z),f.push(0,U,0),N.x=te*.5+.5,N.y=fe*.5*U+.5,v.push(N.x,N.y),x++}for(let xe=0;xe<i;xe++){const ce=D+xe,te=ee+xe;P===!0?d.push(te,te+1,ce):d.push(te+1,te,ce),T+=3}u.addGroup(S,T,P===!0?1:2),S+=T}}static fromJSON(e){return new yL(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class i9 extends yL{constructor(e=1,t=1,r=8,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new i9(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xL extends Oi{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),u(r),d(),this.setAttribute("position",new Hn(s,3)),this.setAttribute("normal",new Hn(s.slice(),3)),this.setAttribute("uv",new Hn(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(C){const A=new ye,P=new ye,D=new ye;for(let N=0;N<t.length;N+=3)v(t[N+0],A),v(t[N+1],P),v(t[N+2],D),c(A,P,D,C)}function c(C,A,P,D){const N=D+1,j=[];for(let T=0;T<=N;T++){j[T]=[];const k=C.clone().lerp(P,T/N),U=A.clone().lerp(P,T/N),ee=N-T;for(let xe=0;xe<=ee;xe++)xe===0&&T===N?j[T][xe]=k:j[T][xe]=k.clone().lerp(U,xe/ee)}for(let T=0;T<N;T++)for(let k=0;k<2*(N-T)-1;k++){const U=Math.floor(k/2);k%2===0?(f(j[T][U+1]),f(j[T+1][U]),f(j[T][U])):(f(j[T][U+1]),f(j[T+1][U+1]),f(j[T+1][U]))}}function u(C){const A=new ye;for(let P=0;P<s.length;P+=3)A.x=s[P+0],A.y=s[P+1],A.z=s[P+2],A.normalize().multiplyScalar(C),s[P+0]=A.x,s[P+1]=A.y,s[P+2]=A.z}function d(){const C=new ye;for(let A=0;A<s.length;A+=3){C.x=s[A+0],C.y=s[A+1],C.z=s[A+2];const P=_(C)/2/Math.PI+.5,D=S(C)/Math.PI+.5;o.push(P,1-D)}x(),p()}function p(){for(let C=0;C<o.length;C+=6){const A=o[C+0],P=o[C+2],D=o[C+4],N=Math.max(A,P,D),j=Math.min(A,P,D);N>.9&&j<.1&&(A<.2&&(o[C+0]+=1),P<.2&&(o[C+2]+=1),D<.2&&(o[C+4]+=1))}}function f(C){s.push(C.x,C.y,C.z)}function v(C,A){const P=C*3;A.x=e[P+0],A.y=e[P+1],A.z=e[P+2]}function x(){const C=new ye,A=new ye,P=new ye,D=new ye,N=new ot,j=new ot,T=new ot;for(let k=0,U=0;k<s.length;k+=9,U+=6){C.set(s[k+0],s[k+1],s[k+2]),A.set(s[k+3],s[k+4],s[k+5]),P.set(s[k+6],s[k+7],s[k+8]),N.set(o[U+0],o[U+1]),j.set(o[U+2],o[U+3]),T.set(o[U+4],o[U+5]),D.copy(C).add(A).add(P).divideScalar(3);const ee=_(D);y(N,U+0,C,ee),y(j,U+2,A,ee),y(T,U+4,P,ee)}}function y(C,A,P,D){D<0&&C.x===1&&(o[A]=C.x-1),P.x===0&&P.z===0&&(o[A]=D/2/Math.PI+.5)}function _(C){return Math.atan2(C.z,-C.x)}function S(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}static fromJSON(e){return new xL(e.vertices,e.indices,e.radius,e.details)}}class g3 extends P6{constructor(e){super(e),this.uuid=ru(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new P6().fromJSON(i))}return this}}const hye={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=Ute(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,u,d,p,f,v;if(r&&(s=vye(n,e,s,t)),n.length>80*t){a=u=n[0],c=d=n[1];for(let x=t;x<i;x+=t)p=n[x],f=n[x+1],p<a&&(a=p),f<c&&(c=f),p>u&&(u=p),f>d&&(d=f);v=Math.max(u-a,d-c),v=v!==0?1/v:0}return ZM(s,o,t,a,c,v),o}};function Ute(n,e,t,r,i){let s,o;if(i===Aye(n,e,t,r)>0)for(s=e;s<t;s+=r)o=QG(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=QG(s,n[s],n[s+1],o);return o&&bL(o,o.next)&&(JM(o),o=o.next),o}function Pm(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(bL(t,t.next)||Yi(t.prev,t,t.next)===0)){if(JM(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function ZM(n,e,t,r,i,s,o){if(!n)return;!o&&s&&bye(n,r,i,s);let a=n,c,u;for(;n.prev!==n.next;){if(c=n.prev,u=n.next,s?pye(n,r,i,s):dye(n)){e.push(c.i/t),e.push(n.i/t),e.push(u.i/t),JM(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=fye(Pm(n),e,t),ZM(n,e,t,r,i,s,2)):o===2&&mye(n,e,t,r,i,s):ZM(Pm(n),e,t,r,i,s,1);break}}}function dye(n){const e=n.prev,t=n,r=n.next;if(Yi(e,t,r)>=0)return!1;let i=n.next.next;for(;i!==n.prev;){if(xy(e.x,e.y,t.x,t.y,r.x,r.y,i.x,i.y)&&Yi(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function pye(n,e,t,r){const i=n.prev,s=n,o=n.next;if(Yi(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,c=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,u=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,d=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,p=T6(a,c,e,t,r),f=T6(u,d,e,t,r);let v=n.prevZ,x=n.nextZ;for(;v&&v.z>=p&&x&&x.z<=f;){if(v!==n.prev&&v!==n.next&&xy(i.x,i.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Yi(v.prev,v,v.next)>=0||(v=v.prevZ,x!==n.prev&&x!==n.next&&xy(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&Yi(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;v&&v.z>=p;){if(v!==n.prev&&v!==n.next&&xy(i.x,i.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Yi(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=f;){if(x!==n.prev&&x!==n.next&&xy(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&Yi(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function fye(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!bL(i,s)&&jte(i,r,r.next,s)&&KM(i,s)&&KM(s,i)&&(e.push(i.i/t),e.push(r.i/t),e.push(s.i/t),JM(r),JM(r.next),r=n=s),r=r.next}while(r!==n);return Pm(r)}function mye(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Mye(o,a)){let c=Hte(o,a);o=Pm(o,o.next),c=Pm(c,c.next),ZM(o,e,t,r,i,s),ZM(c,e,t,r,i,s);return}a=a.next}o=o.next}while(o!==n)}function vye(n,e,t,r){const i=[];let s,o,a,c,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,c=s<o-1?e[s+1]*r:n.length,u=Ute(n,a,c,r,!1),u===u.next&&(u.steiner=!0),i.push(Sye(u));for(i.sort(gye),s=0;s<i.length;s++)_ye(i[s],t),t=Pm(t,t.next);return t}function gye(n,e){return n.x-e.x}function _ye(n,e){if(e=yye(n,e),e){const t=Hte(e,n);Pm(e,e.next),Pm(t,t.next)}}function yye(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=r&&f>s){if(s=f,f===r){if(i===t.y)return t;if(i===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(r===s)return o;const a=o,c=o.x,u=o.y;let d=1/0,p;t=o;do r>=t.x&&t.x>=c&&r!==t.x&&xy(i<u?r:s,i,c,u,i<u?s:r,i,t.x,t.y)&&(p=Math.abs(i-t.y)/(r-t.x),KM(t,n)&&(p<d||p===d&&(t.x>o.x||t.x===o.x&&xye(o,t)))&&(o=t,d=p)),t=t.next;while(t!==a);return o}function xye(n,e){return Yi(n.prev,n,e.prev)<0&&Yi(e.next,n,n.next)<0}function bye(n,e,t,r){let i=n;do i.z===null&&(i.z=T6(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,wye(i)}function wye(n){let e,t,r,i,s,o,a,c,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(c=u;a>0||c>0&&r;)a!==0&&(c===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,c--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,u*=2}while(o>1);return n}function T6(n,e,t,r,i){return n=32767*(n-t)*i,e=32767*(e-r)*i,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Sye(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function xy(n,e,t,r,i,s,o,a){return(i-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(r-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(i-o)*(r-a)>=0}function Mye(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Cye(n,e)&&(KM(n,e)&&KM(e,n)&&Eye(n,e)&&(Yi(n.prev,n,e.prev)||Yi(n,e.prev,e))||bL(n,e)&&Yi(n.prev,n,n.next)>0&&Yi(e.prev,e,e.next)>0)}function Yi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function bL(n,e){return n.x===e.x&&n.y===e.y}function jte(n,e,t,r){const i=ZA(Yi(n,e,t)),s=ZA(Yi(n,e,r)),o=ZA(Yi(t,r,n)),a=ZA(Yi(t,r,e));return!!(i!==s&&o!==a||i===0&&YA(n,t,e)||s===0&&YA(n,r,e)||o===0&&YA(t,n,r)||a===0&&YA(t,e,r))}function YA(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ZA(n){return n>0?1:n<0?-1:0}function Cye(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&jte(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function KM(n,e){return Yi(n.prev,n,n.next)<0?Yi(n,e,n.next)>=0&&Yi(n,n.prev,e)>=0:Yi(n,e,n.prev)<0||Yi(n,n.next,e)<0}function Eye(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function Hte(n,e){const t=new R6(n.i,n.x,n.y),r=new R6(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function QG(n,e,t,r){const i=new R6(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function JM(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function R6(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Aye(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class Dy{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return Dy.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];$G(e),eX(r,e);let o=e.length;t.forEach($G);for(let c=0;c<t.length;c++)i.push(o),o+=t[c].length,eX(r,t[c]);const a=hye.triangulate(r,i);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function $G(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function eX(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class NR extends Oi{constructor(e=new g3([new ot(.5,.5),new ot(-.5,.5),new ot(-.5,-.5),new ot(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,c=e.length;a<c;a++){const u=e[a];o(u)}this.setAttribute("position",new Hn(i,3)),this.setAttribute("uv",new Hn(s,2)),this.computeVertexNormals();function o(a){const c=[],u=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:v-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:Pye;let A,P=!1,D,N,j,T;S&&(A=S.getSpacedPoints(d),P=!0,f=!1,D=S.computeFrenetFrames(d,!1),N=new ye,j=new ye,T=new ye),f||(_=0,v=0,x=0,y=0);const k=a.extractPoints(u);let U=k.shape;const ee=k.holes;if(!Dy.isClockWise(U)){U=U.reverse();for(let Qe=0,Y=ee.length;Qe<Y;Qe++){const K=ee[Qe];Dy.isClockWise(K)&&(ee[Qe]=K.reverse())}}const xe=Dy.triangulateShape(U,ee),ce=U;for(let Qe=0,Y=ee.length;Qe<Y;Qe++){const K=ee[Qe];U=U.concat(K)}function te(Qe,Y,K){return Y||console.error("THREE.ExtrudeGeometry: vec does not exist"),Y.clone().multiplyScalar(K).add(Qe)}const fe=U.length,ge=xe.length;function Se(Qe,Y,K){let ve,Ae,De;const je=Qe.x-Y.x,Xe=Qe.y-Y.y,He=K.x-Qe.x,ne=K.y-Qe.y,W=je*je+Xe*Xe,O=je*ne-Xe*He;if(Math.abs(O)>Number.EPSILON){const E=Math.sqrt(W),F=Math.sqrt(He*He+ne*ne),z=Y.x-Xe/E,Z=Y.y+je/E,de=K.x-ne/F,be=K.y+He/F,oe=((de-z)*ne-(be-Z)*He)/(je*ne-Xe*He);ve=z+je*oe-Qe.x,Ae=Z+Xe*oe-Qe.y;const ze=ve*ve+Ae*Ae;if(ze<=2)return new ot(ve,Ae);De=Math.sqrt(ze/2)}else{let E=!1;je>Number.EPSILON?He>Number.EPSILON&&(E=!0):je<-Number.EPSILON?He<-Number.EPSILON&&(E=!0):Math.sign(Xe)===Math.sign(ne)&&(E=!0),E?(ve=-Xe,Ae=je,De=Math.sqrt(W)):(ve=je,Ae=Xe,De=Math.sqrt(W/2))}return new ot(ve/De,Ae/De)}const pe=[];for(let Qe=0,Y=ce.length,K=Y-1,ve=Qe+1;Qe<Y;Qe++,K++,ve++)K===Y&&(K=0),ve===Y&&(ve=0),pe[Qe]=Se(ce[Qe],ce[K],ce[ve]);const se=[];let ae,Le=pe.concat();for(let Qe=0,Y=ee.length;Qe<Y;Qe++){const K=ee[Qe];ae=[];for(let ve=0,Ae=K.length,De=Ae-1,je=ve+1;ve<Ae;ve++,De++,je++)De===Ae&&(De=0),je===Ae&&(je=0),ae[ve]=Se(K[ve],K[De],K[je]);se.push(ae),Le=Le.concat(ae)}for(let Qe=0;Qe<_;Qe++){const Y=Qe/_,K=v*Math.cos(Y*Math.PI/2),ve=x*Math.sin(Y*Math.PI/2)+y;for(let Ae=0,De=ce.length;Ae<De;Ae++){const je=te(ce[Ae],pe[Ae],ve);we(je.x,je.y,-K)}for(let Ae=0,De=ee.length;Ae<De;Ae++){const je=ee[Ae];ae=se[Ae];for(let Xe=0,He=je.length;Xe<He;Xe++){const ne=te(je[Xe],ae[Xe],ve);we(ne.x,ne.y,-K)}}}const Re=x+y;for(let Qe=0;Qe<fe;Qe++){const Y=f?te(U[Qe],Le[Qe],Re):U[Qe];P?(j.copy(D.normals[0]).multiplyScalar(Y.x),N.copy(D.binormals[0]).multiplyScalar(Y.y),T.copy(A[0]).add(j).add(N),we(T.x,T.y,T.z)):we(Y.x,Y.y,0)}for(let Qe=1;Qe<=d;Qe++)for(let Y=0;Y<fe;Y++){const K=f?te(U[Y],Le[Y],Re):U[Y];P?(j.copy(D.normals[Qe]).multiplyScalar(K.x),N.copy(D.binormals[Qe]).multiplyScalar(K.y),T.copy(A[Qe]).add(j).add(N),we(T.x,T.y,T.z)):we(K.x,K.y,p/d*Qe)}for(let Qe=_-1;Qe>=0;Qe--){const Y=Qe/_,K=v*Math.cos(Y*Math.PI/2),ve=x*Math.sin(Y*Math.PI/2)+y;for(let Ae=0,De=ce.length;Ae<De;Ae++){const je=te(ce[Ae],pe[Ae],ve);we(je.x,je.y,p+K)}for(let Ae=0,De=ee.length;Ae<De;Ae++){const je=ee[Ae];ae=se[Ae];for(let Xe=0,He=je.length;Xe<He;Xe++){const ne=te(je[Xe],ae[Xe],ve);P?we(ne.x,ne.y+A[d-1].y,A[d-1].x+K):we(ne.x,ne.y,p+K)}}}Ue(),Ze();function Ue(){const Qe=i.length/3;if(f){let Y=0,K=fe*Y;for(let ve=0;ve<ge;ve++){const Ae=xe[ve];Mt(Ae[2]+K,Ae[1]+K,Ae[0]+K)}Y=d+_*2,K=fe*Y;for(let ve=0;ve<ge;ve++){const Ae=xe[ve];Mt(Ae[0]+K,Ae[1]+K,Ae[2]+K)}}else{for(let Y=0;Y<ge;Y++){const K=xe[Y];Mt(K[2],K[1],K[0])}for(let Y=0;Y<ge;Y++){const K=xe[Y];Mt(K[0]+fe*d,K[1]+fe*d,K[2]+fe*d)}}r.addGroup(Qe,i.length/3-Qe,0)}function Ze(){const Qe=i.length/3;let Y=0;st(ce,Y),Y+=ce.length;for(let K=0,ve=ee.length;K<ve;K++){const Ae=ee[K];st(Ae,Y),Y+=Ae.length}r.addGroup(Qe,i.length/3-Qe,1)}function st(Qe,Y){let K=Qe.length;for(;--K>=0;){const ve=K;let Ae=K-1;Ae<0&&(Ae=Qe.length-1);for(let De=0,je=d+_*2;De<je;De++){const Xe=fe*De,He=fe*(De+1),ne=Y+ve+Xe,W=Y+Ae+Xe,O=Y+Ae+He,E=Y+ve+He;rt(ne,W,O,E)}}}function we(Qe,Y,K){c.push(Qe),c.push(Y),c.push(K)}function Mt(Qe,Y,K){it(Qe),it(Y),it(K);const ve=i.length/3,Ae=C.generateTopUV(r,i,ve-3,ve-2,ve-1);Ke(Ae[0]),Ke(Ae[1]),Ke(Ae[2])}function rt(Qe,Y,K,ve){it(Qe),it(Y),it(ve),it(Y),it(K),it(ve);const Ae=i.length/3,De=C.generateSideWallUV(r,i,Ae-6,Ae-3,Ae-2,Ae-1);Ke(De[0]),Ke(De[1]),Ke(De[3]),Ke(De[1]),Ke(De[2]),Ke(De[3])}function it(Qe){i.push(c[Qe*3+0]),i.push(c[Qe*3+1]),i.push(c[Qe*3+2])}function Ke(Qe){s.push(Qe.x),s.push(Qe.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return Tye(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new Fte[i.type]().fromJSON(i)),new NR(r,e.options)}}const Pye={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],c=e[r*3+1],u=e[i*3],d=e[i*3+1];return[new ot(s,o),new ot(a,c),new ot(u,d)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],u=e[r*3],d=e[r*3+1],p=e[r*3+2],f=e[i*3],v=e[i*3+1],x=e[i*3+2],y=e[s*3],_=e[s*3+1],S=e[s*3+2];return Math.abs(a-d)<Math.abs(o-u)?[new ot(o,1-c),new ot(u,1-p),new ot(f,1-x),new ot(y,1-S)]:[new ot(a,1-c),new ot(d,1-p),new ot(v,1-x),new ot(_,1-S)]}};function Tye(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class s9 extends xL{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new s9(e.radius,e.detail)}}class o9 extends Oi{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const c=Math.min(o+a,Math.PI);let u=0;const d=[],p=new ye,f=new ye,v=[],x=[],y=[],_=[];for(let S=0;S<=r;S++){const C=[],A=S/r;let P=0;S==0&&o==0?P=.5/t:S==r&&c==Math.PI&&(P=-.5/t);for(let D=0;D<=t;D++){const N=D/t;p.x=-e*Math.cos(i+N*s)*Math.sin(o+A*a),p.y=e*Math.cos(o+A*a),p.z=e*Math.sin(i+N*s)*Math.sin(o+A*a),x.push(p.x,p.y,p.z),f.copy(p).normalize(),y.push(f.x,f.y,f.z),_.push(N+P,1-A),C.push(u++)}d.push(C)}for(let S=0;S<r;S++)for(let C=0;C<t;C++){const A=d[S][C+1],P=d[S][C],D=d[S+1][C],N=d[S+1][C+1];(S!==0||o>0)&&v.push(A,P,N),(S!==r-1||c<Math.PI)&&v.push(P,D,N)}this.setIndex(v),this.setAttribute("position",new Hn(x,3)),this.setAttribute("normal",new Hn(y,3)),this.setAttribute("uv",new Hn(_,2))}static fromJSON(e){return new o9(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class a9 extends xL{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new a9(e.radius,e.detail)}}class l9 extends Oi{constructor(e=1,t=.4,r=8,i=6,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],c=[],u=[],d=new ye,p=new ye,f=new ye;for(let v=0;v<=r;v++)for(let x=0;x<=i;x++){const y=x/i*s,_=v/r*Math.PI*2;p.x=(e+t*Math.cos(_))*Math.cos(y),p.y=(e+t*Math.cos(_))*Math.sin(y),p.z=t*Math.sin(_),a.push(p.x,p.y,p.z),d.x=e*Math.cos(y),d.y=e*Math.sin(y),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),u.push(x/i),u.push(v/r)}for(let v=1;v<=r;v++)for(let x=1;x<=i;x++){const y=(i+1)*v+x-1,_=(i+1)*(v-1)+x-1,S=(i+1)*(v-1)+x,C=(i+1)*v+x;o.push(y,_,C),o.push(_,S,C)}this.setIndex(o),this.setAttribute("position",new Hn(a,3)),this.setAttribute("normal",new Hn(c,3)),this.setAttribute("uv",new Hn(u,2))}static fromJSON(e){return new l9(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Wte extends od{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zC,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NQe extends Wte{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ot(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return so(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Xt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Xt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Xt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Rye extends od{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zC,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Oye extends od{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zC,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Nf(n,e,t){return Gte(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function KA(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Gte(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Lye(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function tX(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let c=0;c!==e;++c)i[o++]=n[a+c]}return i}function Xte(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}class wL{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let c=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===c)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Dye extends wL{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gy,endingEnd:gy}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],c=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case _y:s=e,a=2*t-r;break;case LR:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(c===void 0)switch(this.getSettings_().endingEnd){case _y:o=e,c=2*r-t;break;case LR:o=1,c=r+i[1]-i[0];break;default:o=e-1,c=t}const u=(r-t)*.5,d=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(c-r),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,d=this._offsetPrev,p=this._offsetNext,f=this._weightPrev,v=this._weightNext,x=(r-t)/(i-t),y=x*x,_=y*x,S=-f*_+2*f*y-f*x,C=(1+f)*_+(-1.5-2*f)*y+(-.5+f)*x+1,A=(-1-v)*_+(1.5+v)*y+.5*x,P=v*_-v*y;for(let D=0;D!==a;++D)s[D]=S*o[d+D]+C*o[u+D]+A*o[c+D]+P*o[p+D];return s}}class qte extends wL{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,d=(r-t)/(i-t),p=1-d;for(let f=0;f!==a;++f)s[f]=o[u+f]*p+o[c+f]*d;return s}}class Iye extends wL{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ld{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=KA(t,this.TimeBufferType),this.values=KA(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:KA(e.times,Array),values:KA(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Iye(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new qte(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Dye(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case RR:t=this.InterpolantFactoryMethodDiscrete;break;case OR:t=this.InterpolantFactoryMethodLinear;break;case qB:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return RR;case this.InterpolantFactoryMethodLinear:return OR;case this.InterpolantFactoryMethodSmooth:return qB}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Nf(r,s,o),this.values=Nf(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=r[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(i!==void 0&&Gte(i))for(let a=0,c=i.length;a!==c;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=Nf(this.times),t=Nf(this.values),r=this.getValueSize(),i=this.getInterpolation()===qB,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(i)c=!0;else{const p=a*r,f=p-r,v=p+r;for(let x=0;x!==r;++x){const y=t[p+x];if(y!==t[f+x]||y!==t[v+x]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const p=a*r,f=o*r;for(let v=0;v!==r;++v)t[f+v]=t[p+v]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,c=o*r,u=0;u!==r;++u)t[c+u]=t[a+u];++o}return o!==e.length?(this.times=Nf(e,0,o),this.values=Nf(t,0,o*r)):(this.times=e,this.values=t),this}clone(){const e=Nf(this.times,0),t=Nf(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}ld.prototype.TimeBufferType=Float32Array;ld.prototype.ValueBufferType=Float32Array;ld.prototype.DefaultInterpolation=OR;class nb extends ld{}nb.prototype.ValueTypeName="bool";nb.prototype.ValueBufferType=Array;nb.prototype.DefaultInterpolation=RR;nb.prototype.InterpolantFactoryMethodLinear=void 0;nb.prototype.InterpolantFactoryMethodSmooth=void 0;class Yte extends ld{}Yte.prototype.ValueTypeName="color";class QM extends ld{}QM.prototype.ValueTypeName="number";class Nye extends wL{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(r-t)/(i-t);let u=e*a;for(let d=u+a;u!==d;u+=4)hl.slerpFlat(s,0,o,u-a,o,u,c);return s}}class UC extends ld{InterpolantFactoryMethodLinear(e){return new Nye(this.times,this.values,this.getValueSize(),e)}}UC.prototype.ValueTypeName="quaternion";UC.prototype.DefaultInterpolation=OR;UC.prototype.InterpolantFactoryMethodSmooth=void 0;class rb extends ld{}rb.prototype.ValueTypeName="string";rb.prototype.ValueBufferType=Array;rb.prototype.DefaultInterpolation=RR;rb.prototype.InterpolantFactoryMethodLinear=void 0;rb.prototype.InterpolantFactoryMethodSmooth=void 0;class kR extends ld{}kR.prototype.ValueTypeName="vector";class O6{constructor(e,t=-1,r,i=Gj){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=ru(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(zye(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(ld.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],u=[];c.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=Lye(c);c=tX(c,1,d),u=tX(u,1,d),!i&&c[0]===0&&(c.push(s),u.push(u[0])),o.push(new QM(".morphTargetInfluences["+t[a].name+"]",c,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const p=d[1];let f=i[p];f||(i[p]=f=[]),f.push(u)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(d,p,f,v,x){if(f.length!==0){const y=[],_=[];Xte(f,y,_,v),y.length!==0&&x.push(new d(p,y,_))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let d=0;d<u.length;d++){const p=u[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const f={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let x=0;x<p[v].morphTargets.length;x++)f[p[v].morphTargets[x]]=-1;for(const x in f){const y=[],_=[];for(let S=0;S!==p[v].morphTargets.length;++S){const C=p[v];y.push(C.time),_.push(C.morphTarget===x?1:0)}i.push(new QM(".morphTargetInfluence["+x+"]",y,_))}c=f.length*o}else{const f=".bones["+t[d].name+"]";r(kR,f+".position",p,"pos",i),r(UC,f+".quaternion",p,"rot",i),r(kR,f+".scale",p,"scl",i)}}return i.length===0?null:new this(s,c,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function kye(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return QM;case"vector":case"vector2":case"vector3":case"vector4":return kR;case"color":return Yte;case"quaternion":return UC;case"bool":case"boolean":return nb;case"string":return rb}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function zye(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=kye(n.type);if(n.times===void 0){const t=[],r=[];Xte(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ax={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Bye{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(d){a++,s===!1&&i.onStart!==void 0&&i.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,i.onProgress!==void 0&&i.onProgress(d,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,p){return u.push(d,p),this},this.removeHandler=function(d){const p=u.indexOf(d);return p!==-1&&u.splice(p,2),this},this.getHandler=function(d){for(let p=0,f=u.length;p<f;p+=2){const v=u[p],x=u[p+1];if(v.global&&(v.lastIndex=0),v.test(d))return x}return null}}}const Zte=new Bye;class T0{constructor(e){this.manager=e!==void 0?e:Zte,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const lp={};class Vye extends Error{constructor(e,t){super(e),this.response=t}}class Kte extends T0{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ax.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(lp[e]!==void 0){lp[e].push({onLoad:t,onProgress:r,onError:i});return}lp[e]=[],lp[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=lp[e],p=u.body.getReader(),f=u.headers.get("Content-Length"),v=f?parseInt(f):0,x=v!==0;let y=0;const _=new ReadableStream({start(S){C();function C(){p.read().then(({done:A,value:P})=>{if(A)S.close();else{y+=P.byteLength;const D=new ProgressEvent("progress",{lengthComputable:x,loaded:y,total:v});for(let N=0,j=d.length;N<j;N++){const T=d[N];T.onProgress&&T.onProgress(D)}S.enqueue(P),C()}})}}});return new Response(_)}else throw new Vye(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(p);return u.arrayBuffer().then(v=>f.decode(v))}}}).then(u=>{ax.add(e,u);const d=lp[e];delete lp[e];for(let p=0,f=d.length;p<f;p++){const v=d[p];v.onLoad&&v.onLoad(u)}}).catch(u=>{const d=lp[e];if(d===void 0)throw this.manager.itemError(e),u;delete lp[e];for(let p=0,f=d.length;p<f;p++){const v=d[p];v.onError&&v.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Jte extends T0{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ax.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=YM("img");function c(){d(),ax.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(p){d(),i&&i(p),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",c,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Fye extends T0{constructor(e){super(e)}load(e,t,r,i){const s=new Kj,o=new Jte(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(u){o.load(e[u],function(d){s.images[u]=d,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)c(u);return s}}class Uye extends T0{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Nte,a=new Kte(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){const u=s.parse(c);!u||(u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:mc,o.wrapT=u.wrapT!==void 0?u.wrapT:mc,o.magFilter=u.magFilter!==void 0?u.magFilter:Vs,o.minFilter=u.minFilter!==void 0?u.minFilter:Vs,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=kC),u.mipmapCount===1&&(o.minFilter=Vs),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,t&&t(o,u))},r,i),o}}class jye extends T0{constructor(e){super(e)}load(e,t,r,i){const s=new da,o=new Jte(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class ib extends wr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Xt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class Hye extends ib{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(wr.DefaultUp),this.updateMatrix(),this.groundColor=new Xt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const nX=new zn,rX=new ye,iX=new ye;class c9{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ot(512,512),this.map=null,this.mapPass=null,this.matrix=new zn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vL,this._frameExtents=new ot(1,1),this._viewportCount=1,this._viewports=[new Ir(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;rX.setFromMatrixPosition(e.matrixWorld),t.position.copy(rX),iX.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(iX),t.updateMatrixWorld(),nX.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(nX),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Wye extends c9{constructor(){super(new oo(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=qM*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Gye extends ib{constructor(e,t,r=0,i=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(wr.DefaultUp),this.updateMatrix(),this.target=new wr,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Wye}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const sX=new zn,fS=new ye,E5=new ye;class Xye extends c9{constructor(){super(new oo(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ot(4,2),this._viewportCount=6,this._viewports=[new Ir(2,1,1,1),new Ir(0,1,1,1),new Ir(3,1,1,1),new Ir(1,1,1,1),new Ir(3,0,1,1),new Ir(1,0,1,1)],this._cubeDirections=[new ye(1,0,0),new ye(-1,0,0),new ye(0,0,1),new ye(0,0,-1),new ye(0,1,0),new ye(0,-1,0)],this._cubeUps=[new ye(0,1,0),new ye(0,1,0),new ye(0,1,0),new ye(0,1,0),new ye(0,0,1),new ye(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),fS.setFromMatrixPosition(e.matrixWorld),r.position.copy(fS),E5.copy(r.position),E5.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(E5),r.updateMatrixWorld(),i.makeTranslation(-fS.x,-fS.y,-fS.z),sX.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sX)}}class qye extends ib{constructor(e,t,r=0,i=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Xye}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Yye extends c9{constructor(){super(new VC(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zye extends ib{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(wr.DefaultUp),this.updateMatrix(),this.target=new wr,this.shadow=new Yye}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Kye extends ib{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Jye extends ib{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class kQe{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class zQe extends T0{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ax.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){ax.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){i&&i(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let JA;const Qte={getContext:function(){return JA===void 0&&(JA=new(window.AudioContext||window.webkitAudioContext)),JA},setContext:function(n){JA=n}};class Qye extends T0{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Kte(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const c=a.slice(0);Qte.getContext().decodeAudioData(c,function(u){t(u)})}catch(c){i?i(c):console.error(c),s.manager.itemError(e)}},r,i)}}class u9{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=oX(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=oX();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function oX(){return(typeof performance>"u"?Date:performance).now()}const gg=new ye,aX=new hl,$ye=new ye,_g=new ye;class exe extends wr{constructor(){super(),this.type="AudioListener",this.context=Qte.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new u9}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gg,aX,$ye),_g.set(0,0,-1).applyQuaternion(aX),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(gg.x,i),t.positionY.linearRampToValueAtTime(gg.y,i),t.positionZ.linearRampToValueAtTime(gg.z,i),t.forwardX.linearRampToValueAtTime(_g.x,i),t.forwardY.linearRampToValueAtTime(_g.y,i),t.forwardZ.linearRampToValueAtTime(_g.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(gg.x,gg.y,gg.z),t.setOrientation(_g.x,_g.y,_g.z,r.x,r.y,r.z)}}class txe extends wr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const yg=new ye,lX=new hl,nxe=new ye,xg=new ye;class rxe extends txe{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(yg,lX,nxe),xg.set(0,0,1).applyQuaternion(lX);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(yg.x,r),t.positionY.linearRampToValueAtTime(yg.y,r),t.positionZ.linearRampToValueAtTime(yg.z,r),t.orientationX.linearRampToValueAtTime(xg.x,r),t.orientationY.linearRampToValueAtTime(xg.y,r),t.orientationZ.linearRampToValueAtTime(xg.z,r)}else t.setPosition(yg.x,yg.y,yg.z),t.setOrientation(xg.x,xg.y,xg.z)}}class ixe{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(r,i,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let c=t,u=t+t;c!==u;++c)if(r[c]!==r[c+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){hl.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;hl.multiplyQuaternionsFlat(e,o,e,t,e,r),hl.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const h9="\\[\\]\\.:\\/",sxe=new RegExp("["+h9+"]","g"),d9="[^"+h9+"]",oxe="[^"+h9.replace("\\.","")+"]",axe=/((?:WC+[\/:])*)/.source.replace("WC",d9),lxe=/(WCOD+)?/.source.replace("WCOD",oxe),cxe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",d9),uxe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",d9),hxe=new RegExp("^"+axe+lxe+cxe+uxe+"$"),dxe=["material","materials","bones","map"];class pxe{constructor(e,t,r){const i=r||Lr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class Lr{constructor(e,t,r){this.path=t,this.parsedPath=r||Lr.parseTrackName(t),this.node=Lr.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Lr.Composite(e,t,r):new Lr(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sxe,"")}static parseTrackName(e){const t=hxe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);dxe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=r(a.children);if(c)return c}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Lr.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[i];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Lr.Composite=pxe;Lr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Lr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Lr.prototype.GetterByBindingType=[Lr.prototype._getValue_direct,Lr.prototype._getValue_array,Lr.prototype._getValue_arrayElement,Lr.prototype._getValue_toArray];Lr.prototype.SetterByBindingTypeAndVersioning=[[Lr.prototype._setValue_direct,Lr.prototype._setValue_direct_setNeedsUpdate,Lr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lr.prototype._setValue_array,Lr.prototype._setValue_array_setNeedsUpdate,Lr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lr.prototype._setValue_arrayElement,Lr.prototype._setValue_arrayElement_setNeedsUpdate,Lr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lr.prototype._setValue_fromArray,Lr.prototype._setValue_fromArray_setNeedsUpdate,Lr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class fxe{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:gy,endingEnd:gy};for(let u=0;u!==o;++u){const d=s[u].createInterpolant(null);a[u]=d,d.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=w6,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,u=a.sampleValues;return c[0]=s,c[1]=s+r,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*r;c<0||r===0?t=0:(this._startTime=null,t=r*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case zfe:for(let d=0,p=c.length;d!==p;++d)c[d].evaluate(o),u[d].accumulateAdditive(a);break;case Gj:default:for(let d=0,p=c.length;d!==p;++d)c[d].evaluate(o),u[d].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;r!==null&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===kfe;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===b6){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=_y,i.endingEnd=_y):(e?i.endingStart=this.zeroSlopeAtStart?_y:gy:i.endingStart=LR,t?i.endingEnd=this.zeroSlopeAtEnd?_y:gy:i.endingEnd=LR)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=r,this}}const mxe=new Float32Array(1);class vxe extends E0{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,c=r.uuid,u=this._bindingsByRootAndName;let d=u[c];d===void 0&&(d={},u[c]=d);for(let p=0;p!==s;++p){const f=i[p],v=f.name;let x=d[v];if(x!==void 0)++x.referenceCount,o[p]=x;else{if(x=o[p],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,c,v));continue}const y=t&&t._propertyBindings[p].binding.parsedPath;x=new ixe(Lr.create(r,v,y),f.ValueTypeName,f.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,c,v),o[p]=x}a[p].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,u=c[c.length-1],d=e._byClipCacheIndex;u._byClipCacheIndex=d,c[d]=u,c.pop(),e._byClipCacheIndex=null;const p=a.actionByRoot,f=(e._localRoot||this._root).uuid;delete p[f],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],c=t[t.length-1],u=e._cacheIndex;c._cacheIndex=u,t[u]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new qte(new Float32Array(2),new Float32Array(2),1,mxe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?O6.findByName(i,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let u=null;if(r===void 0&&(o!==null?r=o.blendMode:r=Gj),c!==void 0){const p=c.actionByRoot[s];if(p!==void 0&&p.blendMode===r)return p;u=c.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const d=new fxe(this,o,t,r);return this._bindAction(d,u),this._addInactiveAction(d,a,s),d}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?O6.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==r;++u)t[u]._update(i,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let u=0;u!==c;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const u=o[a];this._deactivateAction(u);const d=u._cacheIndex,p=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,p._cacheIndex=d,t[d]=p,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class $te{constructor(e){this.value=e}clone(){return new $te(this.value.clone===void 0?this.value:this.value.clone())}}class gxe{constructor(e,t,r=0,i=1/0){this.ray=new Qx(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new qj,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return L6(e,this,r,t),r.sort(cX),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)L6(e[i],this,r,t);return r.sort(cX),r}}function cX(n,e){return n.distance-e.distance}function L6(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)L6(i[s],e,t,!0)}}const uX=new ot;class BQe{constructor(e=new ot(1/0,1/0),t=new ot(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=uX.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return uX.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hX=new ye,QA=new ye;class ene{constructor(e=new ye,t=new ye){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){hX.subVectors(e,this.start),QA.subVectors(this.end,this.start);const r=QA.dot(QA);let i=QA.dot(hX)/r;return t&&(i=so(i,0,1)),i}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const dX=new ye;class _xe extends wr{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const r=new Oi,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const u=o/c*Math.PI*2,d=a/c*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(d),Math.sin(d),1)}r.setAttribute("position",new Hn(i,3));const s=new P0({fog:!1,toneMapped:!1});this.cone=new FC(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),dX.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dX),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kf=new ye,$A=new zn,A5=new zn;class yxe extends FC{constructor(e){const t=tne(e),r=new Oi,i=[],s=[],o=new Xt(0,0,1),a=new Xt(0,1,0);for(let u=0;u<t.length;u++){const d=t[u];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Hn(i,3)),r.setAttribute("color",new Hn(s,3));const c=new P0({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");A5.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&($A.multiplyMatrices(A5,a.matrixWorld),kf.setFromMatrixPosition($A),i.setXYZ(o,kf.x,kf.y,kf.z),$A.multiplyMatrices(A5,a.parent.matrixWorld),kf.setFromMatrixPosition($A),i.setXYZ(o+1,kf.x,kf.y,kf.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function tne(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,tne(n.children[t]));return e}class xxe extends FC{constructor(e=10,t=10,r=4473924,i=8947848){r=new Xt(r),i=new Xt(i);const s=t/2,o=e/t,a=e/2,c=[],u=[];for(let f=0,v=0,x=-a;f<=t;f++,x+=o){c.push(-a,0,x,a,0,x),c.push(x,0,-a,x,0,a);const y=f===s?r:i;y.toArray(u,v),v+=3,y.toArray(u,v),v+=3,y.toArray(u,v),v+=3,y.toArray(u,v),v+=3}const d=new Oi;d.setAttribute("position",new Hn(c,3)),d.setAttribute("color",new Hn(u,3));const p=new P0({vertexColors:!0,toneMapped:!1});super(d,p),this.type="GridHelper"}}const eP=new ye,rs=new Yj;class bxe extends FC{constructor(e){const t=new Oi,r=new P0({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(x,y){c(x),c(y)}function c(x){i.push(0,0,0),s.push(0,0,0),o[x]===void 0&&(o[x]=[]),o[x].push(i.length/3-1)}t.setAttribute("position",new Hn(i,3)),t.setAttribute("color",new Hn(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new Xt(16755200),d=new Xt(16711680),p=new Xt(43775),f=new Xt(16777215),v=new Xt(3355443);this.setColors(u,d,p,f,v)}setColors(e,t,r,i,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,r.r,r.g,r.b),o.setXYZ(33,r.r,r.g,r.b),o.setXYZ(34,r.r,r.g,r.b),o.setXYZ(35,r.r,r.g,r.b),o.setXYZ(36,r.r,r.g,r.b),o.setXYZ(37,r.r,r.g,r.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;rs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),xs("c",t,e,rs,0,0,-1),xs("t",t,e,rs,0,0,1),xs("n1",t,e,rs,-r,-i,-1),xs("n2",t,e,rs,r,-i,-1),xs("n3",t,e,rs,-r,i,-1),xs("n4",t,e,rs,r,i,-1),xs("f1",t,e,rs,-r,-i,1),xs("f2",t,e,rs,r,-i,1),xs("f3",t,e,rs,-r,i,1),xs("f4",t,e,rs,r,i,1),xs("u1",t,e,rs,r*.7,i*1.1,-1),xs("u2",t,e,rs,-r*.7,i*1.1,-1),xs("u3",t,e,rs,0,i*2,-1),xs("cf1",t,e,rs,-r,0,1),xs("cf2",t,e,rs,r,0,1),xs("cf3",t,e,rs,0,-i,1),xs("cf4",t,e,rs,0,i,1),xs("cn1",t,e,rs,-r,0,-1),xs("cn2",t,e,rs,r,0,-1),xs("cn3",t,e,rs,0,-i,-1),xs("cn4",t,e,rs,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function xs(n,e,t,r,i,s,o){eP.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const c=t.getAttribute("position");for(let u=0,d=a.length;u<d;u++)c.setXYZ(a[u],eP.x,eP.y,eP.z)}}const tP=new sd;class nne extends FC{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Oi;s.setIndex(new bc(r,1)),s.setAttribute("position",new bc(i,3)),super(s,new P0({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&tP.setFromObject(this.object),tP.isEmpty())return;const t=tP.min,r=tP.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class VQe{constructor(){this.type="ShapePath",this.color=new Xt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new P6,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const C=[];for(let A=0,P=S.length;A<P;A++){const D=S[A],N=new g3;N.curves=D.curves,C.push(N)}return C}function r(S,C){const A=C.length;let P=!1;for(let D=A-1,N=0;N<A;D=N++){let j=C[D],T=C[N],k=T.x-j.x,U=T.y-j.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(j=C[N],k=-k,T=C[D],U=-U),S.y<j.y||S.y>T.y)continue;if(S.y===j.y){if(S.x===j.x)return!0}else{const ee=U*(S.x-j.x)-k*(S.y-j.y);if(ee===0)return!0;if(ee<0)continue;P=!P}}else{if(S.y!==j.y)continue;if(T.x<=S.x&&S.x<=j.x||j.x<=S.x&&S.x<=T.x)return!0}}return P}const i=Dy.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,c;const u=[];if(s.length===1)return a=s[0],c=new g3,c.curves=a.curves,u.push(c),u;let d=!i(s[0].getPoints());d=e?!d:d;const p=[],f=[];let v=[],x=0,y;f[x]=void 0,v[x]=[];for(let S=0,C=s.length;S<C;S++)a=s[S],y=a.getPoints(),o=i(y),o=e?!o:o,o?(!d&&f[x]&&x++,f[x]={s:new g3,p:y},f[x].s.curves=a.curves,d&&x++,v[x]=[]):v[x].push({h:a,p:y[0]});if(!f[0])return t(s);if(f.length>1){let S=!1,C=0;for(let A=0,P=f.length;A<P;A++)p[A]=[];for(let A=0,P=f.length;A<P;A++){const D=v[A];for(let N=0;N<D.length;N++){const j=D[N];let T=!0;for(let k=0;k<f.length;k++)r(j.p,f[k].p)&&(A!==k&&C++,T?(T=!1,p[k].push(j)):S=!0);T&&p[A].push(j)}}C>0&&S===!1&&(v=p)}let _;for(let S=0,C=f.length;S<C;S++){c=f[S].s,u.push(c),_=v[S];for(let A=0,P=_.length;A<P;A++)c.holes.push(_[A].h)}return u}}const Ap=wxe();function wxe(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(r[c]=0,r[c|256]=32768,i[c]=24,i[c|256]=24):u<-14?(r[c]=1024>>-u-14,r[c|256]=1024>>-u-14|32768,i[c]=-u-1,i[c|256]=-u-1):u<=15?(r[c]=u+15<<10,r[c|256]=u+15<<10|32768,i[c]=13,i[c|256]=13):u<128?(r[c]=31744,r[c|256]=64512,i[c]=24,i[c|256]=24):(r[c]=31744,r[c|256]=64512,i[c]=13,i[c|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,d=0;for(;(u&8388608)===0;)u<<=1,d-=8388608;u&=-8388609,d+=947912704,s[c]=u|d}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function Sxe(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=so(n,-65504,65504),Ap.floatView[0]=n;const e=Ap.uint32View[0],t=e>>23&511;return Ap.baseTable[t]+((e&8388607)>>Ap.shiftTable[t])}function Mxe(n){const e=n>>10;return Ap.uint32View[0]=Ap.mantissaTable[Ap.offsetTable[e]+(n&1023)]+Ap.exponentTable[e],Ap.floatView[0]}var nP=Object.freeze({__proto__:null,toHalfFloat:Sxe,fromHalfFloat:Mxe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Hj}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Hj);const[P5,Ri]=Bo(),[SL,lh]=yt([]),pX=Zx(SL,lh),Cxe=Kx(SL,lh),p9=Zpe(SL,lh),rne=new WeakSet,[FQe,ine]=yt(!1),[Exe,ps]=yt(void 0),lx=n=>{!ine()&&Exe(n)},Qt=new G_e;_n(()=>{const n=ps();if(!n)return;const e=new nne(n.nativeObject3d),t=requestAnimationFrame(()=>Qt.add(e)),r=Ri(()=>e.update());return()=>{cancelAnimationFrame(t),Qt.remove(e),r.cancel()}},[ps]);_n(()=>{const n=lh();if(!n.length)return;const e=[];for(const r of n){const i=new nne(r.outerObject3d);Qt.add(i),e.push(i)}const t=Ri(()=>{for(const r of e)r.update()});return()=>{for(const r of e)Qt.remove(r);t.cancel()}},[lh]);const sne=100,nr=1/sne,Fs=sne,one=Number.EPSILON,wc=100*nr,zp=wc*.5;class $u{constructor(e,t){this.x=e,this.y=t}}class a0{constructor(e,t,r){this.x=e,this.y=t,this.z=r}}const gm=180/Math.PI,Bs=Math.PI/180,T5=(n,e,t,r)=>Math.sqrt((n-t)**2+(e-r)**2),ane=(n,e,t,r,i,s)=>Math.sqrt((n-r)**2+(e-i)**2+(t-s)**2),Axe=(n,e,t,r)=>{const i=T5(n.x,n.y,e.x,e.y),s=T5(n.x,n.y,t.x,t.y),o=T5(e.x,e.y,t.x,t.y),a=Math.acos((i*i+s*s-o*o)/(2*i*s))*gm;return r?360-a:a},Pxe=(n,e,t)=>{const r=t*Bs,i=n.x-e.x,s=n.y-e.y,o=i*Math.cos(r)-s*Math.sin(r),a=i*Math.sin(r)+s*Math.cos(r);return new $u(o+e.x,a+e.y)},Txe=(n,e,t,r)=>n>=t&&e<=r?1:n<=t&&e<=r?2:n<=t&&e>=r?3:4,Rxe=(n,e,t,r)=>{const i=t*=Bs;return new $u(n+r*Math.cos(i),e+r*Math.sin(i))},lne=new Set,sb=n=>{for(const e of n)lne.add(e)},jm={onLoop:Function,proxy:Object};sb(["proxy"]);const Hm={onLoop:void 0,proxy:void 0},Ep=()=>{};class Ti{constructor(e){le(this,"value"),this.value=e}}const Oxe={...jm,onClick:Function,onMouseDown:Function,onMouseUp:Function,onMouseOver:Function,onMouseOut:Function,onMouseMove:Function,onLookToEnd:Function,lookAt:[Function,Array],lookTo:[Function,Array],name:String,id:String,bloom:Boolean,outline:Boolean,visible:Boolean,frustumCulled:Boolean,castShadow:Boolean,receiveShadow:Boolean,metalnessFactor:Number,roughnessFactor:Number,opacityFactor:Number,envFactor:Number,adjustColor:String,reflection:Boolean,illumination:Boolean,toon:Boolean};sb(["lookAt","lookTo"]);const Lxe={...Hm,onClick:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseOver:void 0,onMouseOut:void 0,onMouseMove:void 0,onLookToEnd:void 0,lookAt:Ep,lookTo:Ep,name:"",id:void 0,bloom:!1,outline:!1,visible:!0,frustumCulled:!0,castShadow:!0,receiveShadow:!0,metalnessFactor:new Ti(0),roughnessFactor:new Ti(1),opacityFactor:new Ti(1),envFactor:new Ti(1),adjustColor:new Ti("#ffffff"),reflection:!1,illumination:!1,toon:!1},Dxe={...Oxe,animations:Object,animation:[String,Number,Array,Boolean,Object],animationPaused:Boolean,animationRepeat:Boolean,onAnimationFinish:Function},Ixe={...Lxe,animations:{},animation:void 0,animationPaused:new Ti(!1),animationRepeat:new Ti(!0),onAnimationFinish:void 0},ML={...jm,x:Number,y:Number,z:Number},CL={...Hm,x:0,y:0,z:0},cne={...Dxe,...ML,onIntersect:Function,onIntersectOut:Function,onMoveToEnd:Function,moveTo:[Function,Array],lerpTo:[Function,Array],placeAt:[Function,Array],translateX:[Function,Array],translateY:[Function,Array],translateZ:[Function,Array],intersectIds:Array,scaleX:Number,scaleY:Number,scaleZ:Number,scale:Number,rotationX:Number,rotationY:Number,rotationZ:Number,rotation:Number};sb(["intersectIds","moveTo","lerpTo"]);const une={...Ixe,...CL,onIntersect:void 0,onIntersectOut:void 0,onMoveToEnd:void 0,moveTo:Ep,lerpTo:Ep,placeAt:Ep,translateX:Ep,translateY:Ep,translateZ:Ep,intersectIds:void 0,scaleX:1,scaleY:1,scaleZ:1,scale:1,rotationX:0,rotationY:0,rotationZ:0,rotation:0},EL={color:String,fog:Boolean,opacity:Number,texture:[String,Object],videoTexture:[String,Object],alphaMap:String,textureRepeat:[Object,Number],textureFlipY:Boolean,textureRotation:Number},AL={color:"#ffffff",fog:!0,opacity:1,texture:void 0,videoTexture:void 0,alphaMap:void 0,textureRepeat:new Ti({x:1,y:1}),textureFlipY:new Ti(!1),textureRotation:new Ti(0)},f9={color:String,wireframe:Boolean,envMap:String,aoMap:String,aoMapIntensity:Number,bumpMap:String,bumpScale:Number,displacementMap:String,displacementScale:Number,displacementBias:Number,emissive:Boolean,emissiveColor:String,emissiveMap:String,emissiveIntensity:Number,lightMap:String,lightMapIntensity:Number,metalnessMap:String,metalness:Number,roughnessMap:String,roughness:Number,normalMap:String,normalScale:[Object,Number],normalMapType:String},m9={color:"#ffffff",wireframe:!1,envMap:void 0,aoMap:void 0,aoMapIntensity:1,bumpMap:void 0,bumpScale:1,displacementMap:void 0,displacementScale:1,displacementBias:0,emissive:!1,emissiveColor:"#000000",emissiveMap:void 0,emissiveIntensity:1,lightMap:void 0,lightMapIntensity:1,metalnessMap:void 0,metalness:0,roughnessMap:void 0,roughness:1,normalMap:void 0,normalScale:{x:1,y:1},normalMapType:void 0},hne={...cne,...EL,...f9},PL={...une,...AL,...m9},fX=[0],mX=new Map,Nxe=new Set,v9=n=>e=>{mX.set(n,e.loaded),fX[0]=[...mX.values()].reduce((t,r)=>t+r,0),Nxe.forEach(t=>{try{t(fX[0])}finally{}})};class kxe extends Uye{constructor(e){super(e),this.type=Op}parse(e){const t=function(p,f){switch(p){case 1:console.error("THREE.RGBELoader Read Error: "+(f||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(f||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(f||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(f||""))}return-1},r=`
`,i=function(p,f,v){f=f||1024;let x=p.pos,y=-1,_=0,S="",C=String.fromCharCode.apply(null,new Uint16Array(p.subarray(x,x+128)));for(;0>(y=C.indexOf(r))&&_<f&&x<p.byteLength;)S+=C,_+=C.length,x+=128,C+=String.fromCharCode.apply(null,new Uint16Array(p.subarray(x,x+128)));return-1<y?(v!==!1&&(p.pos+=_+y+1),S+C.slice(0,y)):!1},s=function(p){const f=/^#\?(\S+)/,v=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,x=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,y=/^\s*FORMAT=(\S+)\s*$/,_=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,S={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let C,A;if(p.pos>=p.byteLength||!(C=i(p)))return t(1,"no header found");if(!(A=C.match(f)))return t(3,"bad initial token");for(S.valid|=1,S.programtype=A[1],S.string+=C+`
`;C=i(p),C!==!1;){if(S.string+=C+`
`,C.charAt(0)==="#"){S.comments+=C+`
`;continue}if((A=C.match(v))&&(S.gamma=parseFloat(A[1])),(A=C.match(x))&&(S.exposure=parseFloat(A[1])),(A=C.match(y))&&(S.valid|=2,S.format=A[1]),(A=C.match(_))&&(S.valid|=4,S.height=parseInt(A[1],10),S.width=parseInt(A[2],10)),S.valid&2&&S.valid&4)break}return S.valid&2?S.valid&4?S:t(3,"missing image size specifier"):t(3,"missing format specifier")},o=function(p,f,v){const x=f;if(x<8||x>32767||p[0]!==2||p[1]!==2||p[2]&128)return new Uint8Array(p);if(x!==(p[2]<<8|p[3]))return t(3,"wrong scanline width");const y=new Uint8Array(4*f*v);if(!y.length)return t(4,"unable to allocate buffer space");let _=0,S=0;const C=4*x,A=new Uint8Array(4),P=new Uint8Array(C);let D=v;for(;D>0&&S<p.byteLength;){if(S+4>p.byteLength)return t(1);if(A[0]=p[S++],A[1]=p[S++],A[2]=p[S++],A[3]=p[S++],A[0]!=2||A[1]!=2||(A[2]<<8|A[3])!=x)return t(3,"bad rgbe scanline format");let N=0,j;for(;N<C&&S<p.byteLength;){j=p[S++];const k=j>128;if(k&&(j-=128),j===0||N+j>C)return t(3,"bad scanline data");if(k){const U=p[S++];for(let ee=0;ee<j;ee++)P[N++]=U}else P.set(p.subarray(S,S+j),N),N+=j,S+=j}const T=x;for(let k=0;k<T;k++){let U=0;y[_]=P[k+U],U+=x,y[_+1]=P[k+U],U+=x,y[_+2]=P[k+U],U+=x,y[_+3]=P[k+U],_+=4}D--}return y},a=function(p,f,v,x){const y=p[f+3],_=Math.pow(2,y-128)/255;v[x+0]=p[f+0]*_,v[x+1]=p[f+1]*_,v[x+2]=p[f+2]*_,v[x+3]=1},c=function(p,f,v,x){const y=p[f+3],_=Math.pow(2,y-128)/255;v[x+0]=nP.toHalfFloat(Math.min(p[f+0]*_,65504)),v[x+1]=nP.toHalfFloat(Math.min(p[f+1]*_,65504)),v[x+2]=nP.toHalfFloat(Math.min(p[f+2]*_,65504)),v[x+3]=nP.toHalfFloat(1)},u=new Uint8Array(e);u.pos=0;const d=s(u);if(d!==-1){const p=d.width,f=d.height,v=o(u.subarray(u.pos),p,f);if(v!==-1){let x,y,_;switch(this.type){case th:_=v.length/4;const S=new Float32Array(_*4);for(let A=0;A<_;A++)a(v,A*4,S,A*4);x=S,y=th;break;case Op:_=v.length/4;const C=new Uint16Array(_*4);for(let A=0;A<_;A++)c(v,A*4,C,A*4);x=C,y=Op;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:p,height:f,data:x,header:d.string,gamma:d.gamma,exposure:d.exposure,type:y}}}return null}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case th:case Op:o.encoding=Am,o.minFilter=Vs,o.magFilter=Vs,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const zxe=new Map,Bxe=new jye,Vxe=new kxe,R5=new ite,Aa=(n,e)=>(e&&R5.once(n,()=>queueMicrotask(e)),hh(zxe,n,()=>(n.toLowerCase().endsWith(".hdr")?Vxe:Bxe).load(n,t=>{t.wrapS=t.wrapT=ix,R5.setState(n)},v9(n),()=>R5.setState(n)))),Fxe=()=>{const n=new Map,e=uu(()=>{for(const t of n.values())t();n.clear()},0,"trailing");return(t,r)=>{n.set(t,r),e()}},R_=["map","alphaMap"],Uxe=Fxe();class jC{constructor(){le(this,"materialCloned"),le(this,"_opacity"),le(this,"videoTextureState"),le(this,"textureState"),le(this,"_alphaMap"),le(this,"_textureRepeat"),le(this,"_textureFlipY"),le(this,"_textureRotation")}tryCloneMaterial(){this.materialCloned||(this.materialCloned=!0,this.material=this.nativeObject3d.material=this.material.clone(),this.then(()=>this.material.dispose()))}get color(){return"#"+this.material.color.getHexString()}set color(e){this.tryCloneMaterial(),this.material.color=new Xt(e)}get fog(){return this.material.fog}set fog(e){this.tryCloneMaterial(),this.material.fog=e}get opacity(){var e;return(e=this._opacity)!=null?e:this._opacity=1}set opacity(e){this.tryCloneMaterial(),this._opacity=e,this.material.opacity=e,this.material.transparent=e<=1,this.nativeObject3d.visible=!!e}applyTexture(e){const t=this._textureRepeat,r=this._textureFlipY,i=this._textureRotation;Uxe(this,()=>{this.tryCloneMaterial();for(const s of e){const o=this.material[s];if(!o)return;t!==void 0&&(o.repeat=t),r!==void 0&&(o.flipY=r),i!==void 0&&(o.rotation=i*Bs),o.needsUpdate=!0}})}initTexture(){if(this.textureState)return;this.tryCloneMaterial();const e=this.videoTextureState=new nn(void 0),t=this.textureState=new nn(void 0);this.createEffect(()=>{const r=t.get(),i=e.get();if(i){let a;typeof i=="string"?(a=document.createElement("video"),a.crossOrigin="anonymous",a.src=i,a.loop=!0,a.autoplay=!0,a.muted=!0,a.playsInline=!0,a.play()):a=i;const c=new J_e(a,void 0,ix,ix),{material:u}=this,{map:d}=u;return u.map=c,u.needsUpdate=!0,this.applyTexture(R_),()=>{a.pause(),c.dispose(),u.map=d,u.needsUpdate=!0}}if(!r)return;const{material:s}=this,{map:o}=s;return s.map=Aa(r),this.applyTexture(R_),()=>{s.map=o,this.material.needsUpdate=!0}},[e.get,t.get])}get videoTexture(){var e;return(e=this.videoTextureState)==null?void 0:e.get()}set videoTexture(e){this.initTexture(),this.videoTextureState.set(e)}get texture(){var e;return(e=this.textureState)==null?void 0:e.get()}set texture(e){this.initTexture(),this.textureState.set(e)}get alphaMap(){return this._alphaMap}set alphaMap(e){this.tryCloneMaterial(),this._alphaMap=e,this.material.alphaMap=e?Aa(e):null,this.applyTexture(R_)}get textureRepeat(){return this._textureRepeat}set textureRepeat(e){typeof e=="number"&&(e=new ot(e,e)),this._textureRepeat=e,this.applyTexture(R_)}get textureFlipY(){return this._textureFlipY}set textureFlipY(e){this._textureFlipY=e,this.applyTexture(R_)}get textureRotation(){return this._textureRotation}set textureRotation(e){this._textureRotation=e,this.applyTexture(R_)}}const cp=["map","alphaMap","envMap","aoMap","bumpMap","displacementMap","emissiveMap","lightMap","metalnessMap","roughnessMap","normalMap"];class g9 extends jC{constructor(){super(...arguments),le(this,"_envMap"),le(this,"_aoMap"),le(this,"_bumpMap"),le(this,"_displacementMap"),le(this,"_emissiveMap"),le(this,"_emissive"),le(this,"_lightMap"),le(this,"_metalnessMap"),le(this,"_roughnessMap"),le(this,"_normalMap"),le(this,"_normalMapType")}get wireframe(){return this.material.wireframe}set wireframe(e){this.tryCloneMaterial(),this.material.wireframe=e}get envMap(){return this._envMap}set envMap(e){this.tryCloneMaterial(),this._envMap=e,this.material.envMap=e?Aa(e):null,this.applyTexture(cp)}get aoMap(){return this._aoMap}set aoMap(e){this.tryCloneMaterial(),this._aoMap=e,this.material.aoMap=e?Aa(e):null,this.applyTexture(cp)}get aoMapIntensity(){return this.material.aoMapIntensity}set aoMapIntensity(e){this.tryCloneMaterial(),this.material.aoMapIntensity=e}get bumpMap(){return this._bumpMap}set bumpMap(e){this.tryCloneMaterial(),this._bumpMap=e,this.material.bumpMap=e?Aa(e):null,this.applyTexture(cp)}get bumpScale(){return this.material.bumpScale}set bumpScale(e){this.tryCloneMaterial(),this.material.bumpScale=e}get displacementMap(){return this._displacementMap}set displacementMap(e){this.tryCloneMaterial(),this._displacementMap=e,this.material.displacementMap=e?Aa(e):null,this.applyTexture(cp)}get displacementScale(){return this.material.displacementScale}set displacementScale(e){this.tryCloneMaterial(),this.material.displacementScale=e}get displacementBias(){return this.material.displacementBias}set displacementBias(e){this.tryCloneMaterial(),this.material.displacementBias=e}get emissiveColor(){return"#"+this.material.emissive.getHexString()}set emissiveColor(e){this.tryCloneMaterial(),this.material.emissive=new Xt(e)}get emissiveMap(){return this._emissiveMap}set emissiveMap(e){this.tryCloneMaterial(),this._emissiveMap=e,this.material.emissiveMap=e?Aa(e):null,this.applyTexture(cp)}get emissiveIntensity(){return this.material.emissiveIntensity}set emissiveIntensity(e){this.tryCloneMaterial(),this.material.emissiveIntensity=e}get emissive(){return!!this._emissive}set emissive(e){this._emissive=e,e&&(this.tryCloneMaterial(),this.material.emissiveMap=this.material.map,this.material.emissive=this.material.color)}get lightMap(){return this._lightMap}set lightMap(e){this.tryCloneMaterial(),this._lightMap=e,this.material.lightMap=e?Aa(e):null,this.applyTexture(cp)}get lightMapIntensity(){return this.material.lightMapIntensity}set lightMapIntensity(e){this.tryCloneMaterial(),this.material.lightMapIntensity=e}get metalnessMap(){return this._metalnessMap}set metalnessMap(e){this.tryCloneMaterial(),this._metalnessMap=e,this.material.metalnessMap=e?Aa(e):null,this.applyTexture(cp)}get metalness(){return this.material.metalness}set metalness(e){this.tryCloneMaterial(),this.material.metalness=e}get roughnessMap(){return this._roughnessMap}set roughnessMap(e){this.tryCloneMaterial(),this._roughnessMap=e,this.material.roughnessMap=e?Aa(e):null,this.applyTexture(cp)}get roughness(){return this.material.roughness}set roughness(e){this.tryCloneMaterial(),this.material.roughness=e}get normalMap(){return this._normalMap}set normalMap(e){this.tryCloneMaterial(),this._normalMap=e,this.material.normalMap=e?Aa(e):null,this.applyTexture(cp)}get normalScale(){return this.material.normalScale}set normalScale(e){this.tryCloneMaterial(),typeof e=="number"?this.material.normalScale=new ot(e,e):this.material.normalScale=e}get normalMapType(){return this._normalMapType}set normalMapType(e){this.tryCloneMaterial(),this._normalMapType=e,this.material.normalMapType=e==="objectSpace"?vte:zC}}const[jxe,ob]=Bo(),_3=uu(jxe,0,"trailing"),Ji=new Set,TL=new WeakSet;class _9 extends nte{constructor(e=new wr){super(),le(this,"outerObject3d"),le(this,"nativeObject3d"),le(this,"parent"),le(this,"children"),this.outerObject3d=e,e.userData.manager=this,this.nativeObject3d=e,Ji.add(this),_3()}get uuid(){return this.outerObject3d.uuid}_append(e){var t,r,i;Ji.delete(e),_3(),(r=(t=e.parent)==null?void 0:t.children)==null||r.delete(e),e.parent=this,((i=this.children)!=null?i:this.children=new Set).add(e)}traverse(e){var t;for(const r of(t=this.children)!=null?t:[])e(r),r.traverse(e)}traverseSome(e){var t;for(const r of(t=this.children)!=null?t:[]){if(e(r))return!0;r.traverseSome(e)}return!1}append(e){this._append(e),this.outerObject3d.add(e.outerObject3d)}attach(e){this._append(e),this.outerObject3d.attach(e.outerObject3d)}dispose(){var e,t,r;if(this.done)return this;if(super.dispose(),Ji.delete(this),_3(),(t=(e=this.parent)==null?void 0:e.children)==null||t.delete(this),this.parent=void 0,(r=this.outerObject3d.parent)==null||r.remove(this.outerObject3d),this.children)for(const i of this.children)i.dispose();return this}}const Pi=new ye,Hxe=new ye,UQe=new ye,Vg=new hl,Wxe=new hl,Gxe=new ye(0,0,0);Object.freeze(Gxe);const D6=new ye(wc,wc,wc);Object.freeze(D6);const dne=new ye(zp,zp,zp);Object.freeze(dne);const Iy=new sd,pne=new Qx,Xi=new $x(0,0,0,"YXZ"),jQe=new ene,fne=new vL,Xxe=new zn,$S=Math.PI*.5,mne=new eb({wireframe:!0}),zR=new Wte,iu=n=>new a0(n.x*Fs,n.y*Fs,n.z*Fs),y9=n=>new ye(n.x*nr,n.y*nr,n.z*nr),[O5,ab]=Bo(),rP=new WeakMap,Kr=n=>{if(n.parent===Qt)return n.position.clone();if(rP.has(n))return rP.get(n).clone();const e=n.getWorldPosition(new ye);return rP.set(n,e.clone()),ab(()=>rP.delete(n),!0),e},iP=new WeakMap,HC=n=>{if(iP.has(n))return iP.get(n).clone();let e;return n instanceof Ite?e=Kr(n):(n.updateWorldMatrix(!0,!1),Iy.setFromObject(n),Iy.isEmpty()?e=Kr(n):e=Iy.getCenter(new ye)),iP.set(n,e.clone()),ab(()=>iP.delete(n),!0),e},qxe=!!window.chrome,Yxe=(()=>{const n=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(n)?!0:!!/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(n)})(),[Zxe,$M]=yt("#000000"),[Kxe,I6]=yt(!1),[Jxe,xi]=yt(void 0);_n(()=>{const n=new Ote({powerPreference:"high-performance",alpha:$M()==="transparent",logarithmicDepthBuffer:qxe&&!Yxe?I6():!1,antialias:!0});return n.shadowMap.enabled=!0,n.shadowMap.type=lte,Jxe(n),()=>{n.dispose()}},[$M,I6]);const[Qxe,N6]=yt(60),[vne,x9]=yt(0),gne=()=>vne(x9()+1),bM=()=>setTimeout(()=>vne(x9()-1)),[$xe,BR]=yt(!1),ebe=x9(uu(n=>{n||(ebe.cancel(),$xe(!0))},100,"trailing")),[tbe,k6]=yt(!1),[nbe,_ne]=Bo(),[rbe,ibe]=Bo(),yne=(n,e,t)=>{let r=0;const i=setInterval(()=>{document.hidden||(t(),e!==-1&&++r>=e&&clearInterval(i))},n);return new br(()=>clearInterval(i))},z6=new Set,sbe=new u9;let mS=0;const Ch=[1],RL=[0];let vX=0,gX=0;_n(()=>{const n=xi();if(!n||k6()&&!BR())return;const e=1/N6()*.9,t=1/60;n.setAnimationLoop(()=>{if(mS+=sbe.getDelta(),!(mS<e)){Ch[0]=mS/t,RL[0]=mS,mS=0;for(const r of z6)r();++vX===2&&(vX=0,nbe()),++gX===10&&(gX=0,rbe())}})},[N6,xi,BR,k6]);const L5=n=>(z6.add(n),new br(()=>z6.delete(n)));class Jp extends _9{constructor(){super(...arguments),le(this,"_proxy"),le(this,"handles"),le(this,"_onLoop")}get proxy(){return this._proxy}set proxy(e){this._proxy&&(this._proxy.__target=void 0),this._proxy=e,e&&(e.__target=this)}timer(e,t,r){return this.watch(yne(e,t,r))}beforeRender(e){return this.watch(Ri(e))}queueMicrotask(e){queueMicrotask(()=>!this.done&&e())}cancellable(e){return this.watch(new br(e))}createEffect(e,t){return this.watch(_n(e,t))}cancelHandle(e,t){var r,i;const s=(r=this.handles)!=null?r:this.handles=new Map;if((i=s.get(e))==null||i.cancel(),!t)return;const o=t();return s.set(e,o),o}dispose(){if(this.done)return this;if(super.dispose(),this.handles)for(const e of this.handles.values())e.cancel();return this}get onLoop(){return this._onLoop}set onLoop(e){this._onLoop=e,this.cancelHandle("onLoop",e&&(()=>Ri(e)))}}class OL extends Jp{get x(){return this.outerObject3d.position.x*Fs}set x(e){this.outerObject3d.position.x=e*nr}get y(){return this.outerObject3d.position.y*Fs}set y(e){this.outerObject3d.position.y=e*nr}get z(){return this.outerObject3d.position.z*Fs}set z(e){this.outerObject3d.position.z=e*nr}getWorldPosition(){return iu(Kr(this.nativeObject3d))}}const v0=n=>n instanceof Jp&&"x"in n,hr={c:null,u:[new ye,new ye,new ye],e:[]},Tr={c:null,u:[new ye,new ye,new ye],e:[]},Hi=[[],[],[]],Pn=[[],[],[]],Mi=[],bg=new ye,wg=new ye,Sg=new ye,eo=new ye,_X=new ye,yX=new ye,Bu=new ca,xX=new sd,sP=new zn,bX=new zn,wX=new Qx;class b9{constructor(e=new ye,t=new ye,r=new ca){this.center=e,this.halfSize=t,this.rotation=r}set(e,t,r){return this.center=e,this.halfSize=t,this.rotation=r,this}copy(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this}clone(){return new this.constructor().copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}clampPoint(e,t){const r=this.halfSize;eo.subVectors(e,this.center),this.rotation.extractBasis(bg,wg,Sg),t.copy(this.center);const i=ZB.clamp(eo.dot(bg),-r.x,r.x);t.add(bg.multiplyScalar(i));const s=ZB.clamp(eo.dot(wg),-r.y,r.y);t.add(wg.multiplyScalar(s));const o=ZB.clamp(eo.dot(Sg),-r.z,r.z);return t.add(Sg.multiplyScalar(o)),t}containsPoint(e){return eo.subVectors(e,this.center),this.rotation.extractBasis(bg,wg,Sg),Math.abs(eo.dot(bg))<=this.halfSize.x&&Math.abs(eo.dot(wg))<=this.halfSize.y&&Math.abs(eo.dot(Sg))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(obe.fromBox3(e))}intersectsSphere(e){return this.clampPoint(e.center,yX),yX.distanceToSquared(e.center)<=e.radius*e.radius}intersectsOBB(e,t=Number.EPSILON){hr.c=this.center,hr.e[0]=this.halfSize.x,hr.e[1]=this.halfSize.y,hr.e[2]=this.halfSize.z,this.rotation.extractBasis(hr.u[0],hr.u[1],hr.u[2]),Tr.c=e.center,Tr.e[0]=e.halfSize.x,Tr.e[1]=e.halfSize.y,Tr.e[2]=e.halfSize.z,e.rotation.extractBasis(Tr.u[0],Tr.u[1],Tr.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)Hi[s][o]=hr.u[s].dot(Tr.u[o]);eo.subVectors(Tr.c,hr.c),Mi[0]=eo.dot(hr.u[0]),Mi[1]=eo.dot(hr.u[1]),Mi[2]=eo.dot(hr.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)Pn[s][o]=Math.abs(Hi[s][o])+t;let r,i;for(let s=0;s<3;s++)if(r=hr.e[s],i=Tr.e[0]*Pn[s][0]+Tr.e[1]*Pn[s][1]+Tr.e[2]*Pn[s][2],Math.abs(Mi[s])>r+i)return!1;for(let s=0;s<3;s++)if(r=hr.e[0]*Pn[0][s]+hr.e[1]*Pn[1][s]+hr.e[2]*Pn[2][s],i=Tr.e[s],Math.abs(Mi[0]*Hi[0][s]+Mi[1]*Hi[1][s]+Mi[2]*Hi[2][s])>r+i)return!1;return r=hr.e[1]*Pn[2][0]+hr.e[2]*Pn[1][0],i=Tr.e[1]*Pn[0][2]+Tr.e[2]*Pn[0][1],!(Math.abs(Mi[2]*Hi[1][0]-Mi[1]*Hi[2][0])>r+i||(r=hr.e[1]*Pn[2][1]+hr.e[2]*Pn[1][1],i=Tr.e[0]*Pn[0][2]+Tr.e[2]*Pn[0][0],Math.abs(Mi[2]*Hi[1][1]-Mi[1]*Hi[2][1])>r+i)||(r=hr.e[1]*Pn[2][2]+hr.e[2]*Pn[1][2],i=Tr.e[0]*Pn[0][1]+Tr.e[1]*Pn[0][0],Math.abs(Mi[2]*Hi[1][2]-Mi[1]*Hi[2][2])>r+i)||(r=hr.e[0]*Pn[2][0]+hr.e[2]*Pn[0][0],i=Tr.e[1]*Pn[1][2]+Tr.e[2]*Pn[1][1],Math.abs(Mi[0]*Hi[2][0]-Mi[2]*Hi[0][0])>r+i)||(r=hr.e[0]*Pn[2][1]+hr.e[2]*Pn[0][1],i=Tr.e[0]*Pn[1][2]+Tr.e[2]*Pn[1][0],Math.abs(Mi[0]*Hi[2][1]-Mi[2]*Hi[0][1])>r+i)||(r=hr.e[0]*Pn[2][2]+hr.e[2]*Pn[0][2],i=Tr.e[0]*Pn[1][1]+Tr.e[1]*Pn[1][0],Math.abs(Mi[0]*Hi[2][2]-Mi[2]*Hi[0][2])>r+i)||(r=hr.e[0]*Pn[1][0]+hr.e[1]*Pn[0][0],i=Tr.e[1]*Pn[2][2]+Tr.e[2]*Pn[2][1],Math.abs(Mi[1]*Hi[0][0]-Mi[0]*Hi[1][0])>r+i)||(r=hr.e[0]*Pn[1][1]+hr.e[1]*Pn[0][1],i=Tr.e[0]*Pn[2][2]+Tr.e[2]*Pn[2][0],Math.abs(Mi[1]*Hi[0][1]-Mi[0]*Hi[1][1])>r+i)||(r=hr.e[0]*Pn[1][2]+hr.e[1]*Pn[0][2],i=Tr.e[0]*Pn[2][1]+Tr.e[1]*Pn[2][0],Math.abs(Mi[1]*Hi[0][2]-Mi[0]*Hi[1][2])>r+i))}intersectsPlane(e){this.rotation.extractBasis(bg,wg,Sg);const t=this.halfSize.x*Math.abs(e.normal.dot(bg))+this.halfSize.y*Math.abs(e.normal.dot(wg))+this.halfSize.z*Math.abs(e.normal.dot(Sg)),r=e.normal.dot(this.center)-e.constant;return Math.abs(r)<=t}intersectRay(e,t){return this.getSize(_X),xX.setFromCenterAndSize(eo.set(0,0,0),_X),sP.setFromMatrix3(this.rotation),sP.setPosition(this.center),bX.copy(sP).invert(),wX.copy(e).applyMatrix4(bX),wX.intersectBox(xX,t)?t.applyMatrix4(sP):null}intersectsRay(e){return this.intersectRay(e,eo)!==null}fromBox3(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const t=e.elements;let r=eo.set(t[0],t[1],t[2]).length();const i=eo.set(t[4],t[5],t[6]).length(),s=eo.set(t[8],t[9],t[10]).length();e.determinant()<0&&(r=-r),Bu.setFromMatrix4(e);const o=1/r,a=1/i,c=1/s;return Bu.elements[0]*=o,Bu.elements[1]*=o,Bu.elements[2]*=o,Bu.elements[3]*=a,Bu.elements[4]*=a,Bu.elements[5]*=a,Bu.elements[6]*=c,Bu.elements[7]*=c,Bu.elements[8]*=c,this.rotation.multiply(Bu),this.halfSize.x*=r,this.halfSize.y*=i,this.halfSize.z*=s,eo.setFromMatrixPosition(e),this.center.add(eo),this}}const obe=new b9,gc={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class cd{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const abe=new VC(-1,1,1,-1,0,1),w9=new Oi;w9.setAttribute("position",new Hn([-1,3,0,-1,-1,0,3,-1,0],3));w9.setAttribute("uv",new Hn([0,2,0,0,2,0],2));class R0{constructor(e){this._mesh=new Io(w9,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,abe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class cx extends cd{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Nr?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=aa.clone(e.uniforms),this.material=new Nr({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new R0(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class SX extends cd{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class lbe extends cd{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class B6{constructor(e,t){if(this.renderer=e,t===void 0){const r=e.getSize(new ot);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,t=new Ei(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],gc===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),cx===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new cx(gc),this.clock=new u9}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,s=this.passes.length;i<s;i++){const o=this.passes[i];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}SX!==void 0&&(o instanceof SX?r=!0:o instanceof lbe&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new ot);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new VC(-1,1,1,-1,0,1);const xne=new Oi;xne.setAttribute("position",new Hn([-1,3,0,-1,-1,0,3,-1,0],3));xne.setAttribute("uv",new Hn([0,2,0,0,2,0],2));const[cbe,g0]=yt(1),S9=375,M9=667,C9=-5e-4,bne=3e3,wne=5,Sne=175,oP=5.7,Wm=.1,eu=1e4,E9="https://unpkg.com/lingo3d-dummy@1.0.4/assets/",by=E9+"ybot.fbx",A9="https://unpkg.com/lingo3d-textures@1.0.3/assets/",Mne=A9+"waternormals.jpg",ube=!1,Cne="1.34.4",[hbe,Il]=yt([S9,M9]),dbe=([n,e])=>hbe([Math.max(n,1),Math.max(e,1)]),[pbe,ux]=yt(void 0);_n(()=>{const n=xi();if(!n)return;const e=new B6(n);e.renderToScreen=!1,pbe(e)},[xi]);_n(()=>{const n=ux();if(!n)return;const[e,t]=Il();n.setSize(e,t),n.setPixelRatio(Math.min(g0(),1))},[ux,Il,g0]);const Ene=[!1],Ane=n=>{n.userData.bloom=!0,Ene[0]=!0},Pne=n=>{n.userData.bloom=!1};let V6;const fbe=new eb({color:0});let F6=[];const Tne=n=>{for(const e of n)e.userData.bloom||!e.visible||(Tne(e.children),e.material&&(F6.push([e.material,e]),e.material=fbe))},mbe=()=>{Tne(Qt.children),Qt.background&&(V6=Qt.background,Qt.background=null)},vbe=()=>{for(const[n,e]of F6)e.material=n;F6=[],V6&&(Qt.background=V6)},gbe=()=>{var n;mbe(),(n=ux())==null||n.render(),vbe()},[_be,U6]=yt(1),[HQe,hx]=yt(!1),[ybe,j6]=yt(!1),[xbe,VR]=yt(void 0),FR={createButton(n,e){e&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.');const t=document.createElement("button");function r(){let c=null;async function u(p){p.addEventListener("end",d),await n.xr.setSession(p),t.textContent="EXIT VR",c=p}function d(){c.removeEventListener("end",d),t.textContent="ENTER VR",c=null}t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",t.textContent="ENTER VR",t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){if(c===null){const p={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",p).then(u)}else c.end()}}function i(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",t.onmouseenter=null,t.onmouseleave=null,t.onclick=null}function s(){i(),t.textContent="VR NOT SUPPORTED"}function o(c){i(),console.warn("Exception when trying to call xr.isSessionSupported",c),t.textContent="VR NOT ALLOWED"}function a(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}if("xr"in navigator)return t.id="VRButton",t.style.display="none",a(t),navigator.xr.isSessionSupported("immersive-vr").then(function(c){c?r():s(),c&&FR.xrSessionIsGranted&&t.click()}).catch(o),t;{const c=document.createElement("a");return window.isSecureContext===!1?(c.href=document.location.href.replace(/^http:/,"https:"),c.innerHTML="WEBXR NEEDS HTTPS"):(c.href="https://immersiveweb.dev/",c.innerHTML="WEBXR NOT AVAILABLE"),c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",a(c),c}},xrSessionIsGranted:!1,registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{FR.xrSessionIsGranted=!0})}}};FR.registerSessionGrantedListener();const[bbe,H6]=yt(!1),[P9,au]=yt(0),LL=()=>P9(au()+1),DL=()=>P9(au()-1),Th=document.createElement("div");Object.assign(Th.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"});const Sr=document.createElement("div");Object.assign(Sr.style,{position:"absolute",left:"0px",top:"0px",width:"100%"});Th.appendChild(Sr);VR(n=>Sr.style.height=n?"50%":"100%");const Rne=[Sr.getBoundingClientRect()],D5=n=>{ex(()=>{const e=()=>{Rne[0]=Sr.getBoundingClientRect(),dbe(n===document.body?[window.innerWidth,window.innerHeight]:[n.clientWidth,n.clientHeight])};e();const t=uu(e,100,"both");window.addEventListener("resize",t);const r=au(t);return()=>{window.removeEventListener("resize",e),r.cancel()}},[n])};_n(()=>{const n=H6();if(n){if(typeof n=="string"){const e=document.querySelector(n);return e?(e.prepend(Th),D5(e),()=>{e.removeChild(Th)}):void 0}return n===!0?(document.body.prepend(Th),D5(document.body),()=>{document.body.removeChild(Th)}):(n.prepend(Th),D5(n),()=>{n.removeChild(Th)})}},[H6]);_n(()=>{const n=xi();if(!n)return;const e=n.domElement;return Th.prepend(e),Object.assign(e.style,{position:"absolute",left:"0px",top:"0px"}),()=>{Th.removeChild(e)}},[xi]);_n(()=>{const n=xi();if(!n)return;const[e,t]=Il();n.setSize(e,t),n.setPixelRatio(Math.min(g0(),devicePixelRatio))},[xi,Il,g0]);_n(()=>{const n=xi();!n||(n.physicallyCorrectLights=j6())},[xi,j6]);_n(()=>{const n=xi();if(!n)return;const e=U6();n.toneMapping=e!==1?fte:qh,n.toneMappingExposure=e},[U6,xi]);_n(()=>{if(!hx())return;const n=xi();if(!n)return;n.xr.enabled=!0;const e=FR.createButton(n);return Sr.appendChild(e),e.ontouchstart=()=>{var t;return(t=e.onclick)==null?void 0:t.call(e,new MouseEvent("click"))},()=>{n.xr.enabled=!1,Sr.removeChild(e)}},[hx,xi]);const Vu=new oo(75,1,Wm,eu),yi=new oo(75,1,Wm,eu),[T9,dx]=yt([yi]),wbe=Zx(T9,dx),MX=Kx(T9,dx),aP=new WeakMap,Tm=n=>{if(n.parent===Qt)return n.quaternion.clone();if(aP.has(n))return aP.get(n).clone();const e=n.getWorldQuaternion(new hl);return aP.set(n,e.clone()),ab(()=>aP.delete(n),!0),e},_0=n=>Math.min(n*Ch[0],1),[y3,Ut]=yt(yi),W6=n=>{const[e,t]=Il(),r=e/t;return n instanceof oo&&!hx()?(n.aspect=r,n.updateProjectionMatrix()):n instanceof VC&&([n.left,n.right,n.top,n.bottom]=[r*oP*-.5,r*oP*.5,oP*.5,oP*-.5],n.updateProjectionMatrix()),[e,t,r]},CX=(n,e,t)=>n+(e-n)*t;let EX;_n(()=>{const n=Ut()===Vu?Vu:EX,e=EX=Yx(dx()),t=e.userData.transition;if(!n||!t||n===e||n===yi||e===yi){y3(e);return}y3(Vu);const r=Kr(n),i=Tm(n);Vu.zoom=n.zoom,Vu.fov=n.fov,W6(Vu);let s=0;const o=typeof t=="number"?t:1/0,a=Ri(()=>{const c=Kr(e),u=Tm(e);Vu.position.lerpVectors(r,c,s),Vu.quaternion.slerpQuaternions(i,u,s),Vu.zoom=CX(n.zoom,e.zoom,s),Vu.fov=CX(n.fov,e.fov,s),Vu.updateProjectionMatrix(),s=Math.min((1-s)*_0(.1),o)+s,!(s<.9999)&&(y3(e),W6(e),a.cancel())});return()=>{a.cancel()}},[dx]);const lP=new WeakMap,AX=n=>{if(lP.has(n))return lP.get(n);const e=HC(n),t=Ut();e.project(t);const r=(e.x*.5+.5)*Sr.clientWidth,i=(e.y*-.5+.5)*Sr.clientHeight,s={x:r,y:i};return lP.set(n,s),ab(()=>lP.delete(n),!0),s};class pm extends cd{constructor(e,t,r,i){super(),this.renderScene=t,this.renderCamera=r,this.selectedObjects=i!==void 0?i:[],this.visibleEdgeColor=new Xt(1,1,1),this.hiddenEdgeColor=new Xt(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=e!==void 0?new ot(e.x,e.y):new ot(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Ei(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new _L,this.depthMaterial.side=zh,this.depthMaterial.depthPacking=mL,this.depthMaterial.blending=ks,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=zh,this.prepareMaskMaterial.fragmentShader=d(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Ei(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Ei(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Ei(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Ei(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Ei(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Ei(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;const a=4,c=4;this.separableBlurMaterial1=this.getSeperableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(c),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=c,this.overlayMaterial=this.getOverlayMaterial(),gc===void 0&&console.error("THREE.OutlinePass relies on CopyShader");const u=gc;this.copyUniforms=aa.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Nr({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:ks,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Xt,this.oldClearAlpha=1,this.fsQuad=new R0(null),this.tempPulseColor1=new Xt,this.tempPulseColor2=new Xt,this.textureMatrix=new zn;function d(p,f){const v=f.isPerspectiveCamera?"perspective":"orthographic";return p.replace(/DEPTH_TO_VIEW_Z/g,v+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let r=Math.round(e/this.downSampleRatio),i=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,i),this.renderTargetBlurBuffer1.setSize(r,i),this.renderTargetEdgeBuffer1.setSize(r,i),this.separableBlurMaterial1.uniforms.texSize.value.set(r,i),r=Math.round(r/2),i=Math.round(i/2),this.renderTargetBlurBuffer2.setSize(r,i),this.renderTargetEdgeBuffer2.setSize(r,i),this.separableBlurMaterial2.uniforms.texSize.value.set(r,i)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function r(i){i.isMesh&&(e===!0?i.visible=t.get(i):(t.set(i,i.visible),i.visible=e))}for(let i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(r)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,r=[];function i(o){o.isMesh&&r.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(i);function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let c=0;c<r.length;c++)if(r[c].id===o.id){a=!0;break}if(a===!1){const c=o.visible;(e===!1||t.get(o)===!0)&&(o.visible=e),t.set(o,c)}}else(o.isPoints||o.isLine)&&(e===!0?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))}this.renderScene.traverse(s)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,r,i,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const c=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(c),this.tempPulseColor2.multiplyScalar(c)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=pm.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=pm.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=pm.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=pm.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new Nr({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new ot(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>
					#include <worldpos_vertex>

					vPosition = mvPosition;
					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new Nr({uniforms:{maskTexture:{value:null},texSize:{value:new ot(.5,.5)},visibleEdgeColor:{value:new ye(1,1,1)},hiddenEdgeColor:{value:new ye(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeperableBlurMaterial(e){return new Nr({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new ot(.5,.5)},direction:{value:new ot(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new Nr({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:TR,depthTest:!1,depthWrite:!1,transparent:!0})}}pm.BlurDirectionX=new ot(1,0);pm.BlurDirectionY=new ot(0,1);const[Sbe,G6]=yt("#ffffff"),[Mbe,X6]=yt(void 0),[Cbe,q6]=yt(void 0),[Ebe,One]=yt(0),[Abe,Lne]=yt(3),[Pbe,Dne]=yt(1),Ine=[!1],R9=[],Nne=n=>{n.userData.outline||(n.userData.outline=!0,R9.push(n),Ine[0]=!0)},kne=n=>{!n.userData.outline||(n.userData.outline=!1,Uj(R9,n))},Yh=new pm(new ot,Qt,Ut(),R9);Ut(n=>Yh.renderCamera=n);One(n=>Yh.pulsePeriod=n*.001);Lne(n=>Yh.edgeStrength=n);Dne(n=>Yh.edgeThickness=n);_n(()=>{var n;const e=G6(),t=(n=X6())!=null?n:e;Yh.visibleEdgeColor=new Xt(e),Yh.hiddenEdgeColor=new Xt(t)},[G6,X6]);_n(()=>{const n=q6();if(n)return Yh.patternTexture=Aa(n),Yh.usePatternTexture=!0,()=>{Yh.usePatternTexture=!1}},[q6]);const Tbe=["name","blending","side","vertexColors","opacity","transparent","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","alphaToCoverage","premultipliedAlpha","visible","toneMapped"],Rbe=(n,e)=>{for(const i of Tbe){const s=n[i];s!=null&&(e[i]=s)}const t=n.clippingPlanes;let r=null;if(t){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}e.clippingPlanes=r},Obe=["map","gradientMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveMap","emissiveIntensity","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","fog"],Lbe=(n,e)=>{Rbe(n,e);for(const t of Obe){const r=n[t];r!=null&&(e[t]=r)}n.color&&e.color.copy(n.color),n.emissive&&e.emissive.copy(n.emissive),n.normalScale&&e.normalScale.copy(n.normalScale)},Dbe=(n,e)=>n.clone().multiply(e.clone().invert()),cP=new WeakMap,zne=n=>{if(cP.has(n))return cP.get(n).clone();const e=n.getWorldDirection(new ye);return cP.set(n,e.clone()),ab(()=>cP.delete(n),!0),e},Bne=new Set,Vne=new Set,Fne=new Set,Une=new Set,jne=new Set,Hne=new Set;class Y6{constructor(e,t,r,i,s,o,a){le(this,"clientX"),le(this,"clientY"),le(this,"xNorm"),le(this,"yNorm"),le(this,"point"),le(this,"distance"),le(this,"target"),this.clientX=e,this.clientY=t,this.xNorm=r,this.yNorm=i,this.point=s,this.distance=o,this.target=a}}const Wne={...jm,onClick:Function,onRightClick:Function,onMouseMove:Function,onMouseDown:Function,onMouseUp:Function,onMousePress:Function},Gne={...Hm,onClick:void 0,onRightClick:void 0,onMouseMove:void 0,onMouseDown:void 0,onMouseUp:void 0,onMousePress:void 0},[WQe,Ibe]=yt(void 0),O9=(n,e)=>{const t=Rne[0];return n-=t.x,e-=t.y,[n/t.width*2-1,-(e/t.height)*2+1,n,e]},Nbe=n=>{const[e,t,r,i]=O9(n.clientX,n.clientY);if(Ibe())return new Y6(r,i,0,0,new a0(0,0,0),500,void 0);const s=Ut();Pi.set(e,t,.5),Pi.unproject(s);const o=Kr(s);Pi.sub(o).normalize();const a=o.add(Pi.multiplyScalar(500*nr));return new Y6(r,i,e,t,iu(a),500,void 0)},[Xg,su]=yt("play");_n(()=>{Xg(Ut()===yi&&au()?"translate":"play")},[Ut,au]);const[kbe,Na]=yt(!1);su(n=>kbe(n!=="play"));const Po=new ite;let Z6=0,K6=0,J6=0,Q6=!1;Sr.addEventListener("contextmenu",n=>{n.preventDefault(),Q6=!0});Sr.addEventListener("touchstart",n=>{n.preventDefault()});Po.on("down",n=>{Z6=Date.now(),K6=n.clientX,J6=n.clientY});Po.on("up",n=>{const e=Date.now(),t=e-Z6,r=Math.abs(n.clientX-K6),i=Math.abs(n.clientY-J6);Z6=e,K6=n.clientX,J6=n.clientY,t<300&&r<5&&i<5&&Po.emit(Q6?"rightClick":"click",n),Q6=!1});const L9=Qee(Nbe,0,"leading");Sr.addEventListener("pointermove",n=>{Po.emit("move",L9(n))});let $6=!1;Sr.addEventListener("pointerdown",n=>{$6=!0;const e=L9(n);Po.emit("down",e),Po.emit("move",e)});const D9=n=>{$6&&Po.emit("up",L9(n)),$6=!1};Sr.addEventListener("pointerup",D9);Sr.addEventListener("pointercancel",D9);Sr.addEventListener("pointerleave",D9);class x3 extends Jp{constructor(){super(),le(this,"onClick"),le(this,"onRightClick"),le(this,"onMouseMove"),le(this,"onMouseDown"),le(this,"onMouseUp"),le(this,"onMousePress");let e={clientX:0,clientY:0};const[t,r]=yt(!1);this.createEffect(()=>{const i=this.onMousePress;if(!r()||!i)return;const s=Ri(()=>i(e));return()=>{s.cancel()}},[r]),this.createEffect(()=>{if(Na()||au()&&Ut()===yi)return;const i=Po.on("move",u=>{var d;(d=this.onMouseMove)==null||d.call(this,u),e=u}),s=Po.on("click",u=>{var d;(d=this.onClick)==null||d.call(this,u),e=u}),o=Po.on("rightClick",u=>{var d;(d=this.onRightClick)==null||d.call(this,u),e=u}),a=Po.on("down",u=>{var d;(d=this.onMouseDown)==null||d.call(this,u),e=u,t(!0)}),c=Po.on("up",u=>{var d;(d=this.onMouseUp)==null||d.call(this,u),e=u,t(!1)});return()=>{i.cancel(),s.cancel(),o.cancel(),a.cancel(),c.cancel()}},[Na,au,Ut])}}le(x3,"componentName","mouse"),le(x3,"defaults",Gne),le(x3,"schema",Wne);const zbe=new x3;Ji.delete(zbe);const eU=new gxe;eU.firstHitOnly=!0;const Xne=(n,e,t)=>(eU.setFromCamera({x:n,y:e},Ut()),eU.intersectObjects([...t])[0]),im=(n,e,t)=>Po.on(n,r=>{if(!e.size)return;const i=Xne(r.xNorm,r.yNorm,e);if(!i)return;const s=iu(i.point),o=i.distance*Fs;t(i.object.userData.manager,new Y6(r.clientX,r.clientY,r.xNorm,r.yNorm,s,o,i.object.userData.manager))}),Bbe=()=>{ex(()=>{if(Na())return;p9(),lx(void 0);const n=im("click",Bne,(u,d)=>{var p;return(p=u.onClick)==null?void 0:p.call(u,d)}),e=im("down",Vne,(u,d)=>{var p;return(p=u.onMouseDown)==null?void 0:p.call(u,d)}),t=im("up",Fne,(u,d)=>{var p;return(p=u.onMouseUp)==null?void 0:p.call(u,d)});let r=new Set,i=new Set;const s=im("move",Une,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),o=im("move",jne,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),a=im("move",Hne,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),c=Po.on("move",()=>{var u,d,p;for(const f of r)i.has(f)||(u=f.onMouseOver)==null||u.call(f,f.outerObject3d.userData.eMove),(d=f.onMouseMove)==null||d.call(f,f.outerObject3d.userData.eMove);for(const f of i)r.has(f)||(p=f.onMouseOut)==null||p.call(f,f.outerObject3d.userData.eMove);i=r,r=new Set});return()=>{n.cancel(),e.cancel(),t.cancel(),s.cancel(),o.cancel(),a.cancel(),c.cancel()}},[Na])},[qne,Yne]=Bo(),[Vbe,Qp]=Bo(),Ki=uu((n,e)=>!ine()&&Vbe({target:n,rightClick:e}),0,"trailing");_n(()=>{const n=ps();if(!n)return;const e=ob(()=>{!n.outerObject3d.parent&&Ki()});return()=>{e.cancel()}},[ps]);const[Fbe,lu]=yt(!1),[I9,IL]=yt([new Set]),Ube=n=>{const[e]=IL();e.add(n),I9([e]),qne()},jbe=()=>{const[n]=IL();n.clear(),I9([n]),qne()},WC=new Set,Zne=new WeakSet,Kne=(n,e)=>{for(const t of n)e.has(t)||("addToRaycastSet"in t&&!Zne.has(t)&&t.addToRaycastSet(WC),t.children&&Kne(t.children,e))},Ny=uu((n=Ji)=>{const[e]=IL();WC.clear(),Kne(n,e)},0,"trailing");let O_=[];const Hbe=()=>{ex(()=>{if(!Na()||lu()||su()!=="path")return;Ny(O_);const n=ob(()=>Ny(O_)),e=Yne(()=>{Ny(O_),Ki()}),t=new br;Promise.all([Promise.resolve().then(()=>a1e),rr(()=>import("./Curve.1cd82574.3727b97e.js"),[])]).then(([{default:o},{default:a}])=>{if(t.done)return;const c=new a;t.then(()=>c.dispose()),t.watch(Po.on("click",u=>{setTimeout(()=>{if(t.done||ps())return;const d=new o;d.scale=.1,d.placeAt(u.point),d.name="point"+O_.length,O_.push(d),Ki(d),c.addPoint(iu(d.outerObject3d.position))})}))});const r=Po.on("click",()=>Ki()),i=im("click",WC,o=>Ki(o)),s=Qp(({target:o})=>{p9(),lx(o)});return()=>{t.cancel(),n.cancel(),e.cancel(),t.cancel(),r.cancel(),i.cancel(),s.cancel(),su()!=="path"&&(O_=[])}},[Na,lu,su])},[I5,N9]=yt(!1),Wbe=()=>{const n=N9(),e=GM(!0);ex(()=>{!n&&(e.current=!0)},[n]),ex(()=>{const t=su();if(!Na()||lu()||t!=="rotate"&&t!=="scale"&&t!=="select"&&t!=="translate")return;Ny();const r=ob(()=>Ny()),i=Yne(()=>{Ny(),Ki()}),s=Po.on("click",()=>Ki());let o=!1;const a=Po.on("rightClick",()=>{o=!0,queueMicrotask(()=>{!o||(o=!1,Ki(void 0,!0))})}),c=im(["click","rightClick"],WC,d=>{Ki(d,o),o=!1}),u=Qp(({target:d,rightClick:p})=>{if(n){if(!v0(d)||p)return;if(e.current){const f=ps();v0(f)&&pX(f)}e.current=!1,lh().includes(d)?Cxe(d):pX(d);return}p9(),lx(p?d:d===ps()?void 0:d)});return()=>{r.cancel(),i.cancel(),s.cancel(),a.cancel(),c.cancel(),u.cancel()}},[Na,lu,su,n])};_n(()=>{Bbe(),Hbe(),Wbe()},[Na,su,lu,N9]);const N5=new b9,vS=new b9,Gbe=Qee(()=>{const n=Ut();fne.setFromProjectionMatrix(Xxe.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse))},200,"leading"),uP=(n,e,t)=>{var r,i;const s=(i=(r=n.userData)[e])!=null?i:r[e]=n[e];n[e]=t===void 0?s:Math.max(s||0,.25)*t},k5=(n,e,t)=>{var r,i;const s=(i=(r=n.userData)[e])!=null?i:r[e]=n[e];n[e]=t===void 0?s:t},_m=new Map,Xbe=()=>new Set;class Jne extends Jp{constructor(){super(...arguments),le(this,"_id"),le(this,"_onClick"),le(this,"_onMouseDown"),le(this,"_onMouseUp"),le(this,"_onMouseOver"),le(this,"_onMouseOut"),le(this,"_onMouseMove"),le(this,"_visible"),le(this,"_castShadow"),le(this,"_receiveShadow"),le(this,"_metalnessFactor"),le(this,"_roughnessFactor"),le(this,"_opacityFactor"),le(this,"_envFactor"),le(this,"_adjustColor"),le(this,"_reflection"),le(this,"_illumination"),le(this,"_toon"),le(this,"onLookToEnd")}dispose(){return this.done?this:(super.dispose(),this._id!==void 0&&_m.get(this._id).delete(this),this)}get id(){return this._id}set id(e){this._id!==void 0&&_m.get(this._id).delete(this),this._id=e,e!==void 0&&hh(_m,e,Xbe).add(this)}addToRaycastSet(e){return e.add(this.nativeObject3d),new br(()=>e.delete(this.nativeObject3d))}get onClick(){return this._onClick}set onClick(e){this._onClick=e,this.cancelHandle("onClick",e&&(()=>this.addToRaycastSet(Bne)))}get onMouseDown(){return this._onMouseDown}set onMouseDown(e){this._onMouseDown=e,this.cancelHandle("onMouseDown",e&&(()=>this.addToRaycastSet(Vne)))}get onMouseUp(){return this._onMouseUp}set onMouseUp(e){this._onMouseUp=e,this.cancelHandle("onMouseUp",e&&(()=>this.addToRaycastSet(Fne)))}get onMouseOver(){return this._onMouseOver}set onMouseOver(e){this._onMouseOver=e,this.cancelHandle("onMouseOver",e&&(()=>this.addToRaycastSet(Une)))}get onMouseOut(){return this._onMouseOut}set onMouseOut(e){this._onMouseOut=e,this.cancelHandle("onMouseOut",e&&(()=>this.addToRaycastSet(jne)))}get onMouseMove(){return this._onMouseMove}set onMouseMove(e){this._onMouseMove=e,this.cancelHandle("onMouseMove",e&&(()=>this.addToRaycastSet(Hne)))}get name(){return this.outerObject3d.name}set name(e){this.outerObject3d.name=Lr.sanitizeNodeName(e)}getRay(){return pne.set(Kr(this.nativeObject3d),zne(this.nativeObject3d))}pointAt(e){return iu(this.getRay().at(e*nr,Pi))}rayIntersectsAt(e,t){if(this.done||e.done||this===e)return;vS.set(Kr(e.nativeObject3d),dne,new ca().setFromMatrix4(e.nativeObject3d.matrixWorld));const r=vS.intersectRay(this.getRay(),Pi);if(r){if(t){const{x:i,y:s,z:o}=Kr(this.nativeObject3d);if(ane(r.x,r.y,r.z,i,s,o)*Fs>t)return}return iu(r)}}rayIntersects(e){return!!this.rayIntersectsAt(e)}intersects(e){return this.done||e.done||this===e?!1:(N5.set(Kr(this.nativeObject3d),D6.clone(),new ca),N5.applyMatrix4(this.nativeObject3d.matrixWorld),vS.set(Kr(e.nativeObject3d),D6.clone(),new ca),vS.applyMatrix4(e.nativeObject3d.matrixWorld),N5.intersectsOBB(vS,0))}get clientX(){return AX(this.nativeObject3d).x}get clientY(){return AX(this.nativeObject3d).y}get bloom(){return!!this.outerObject3d.userData.bloom}set bloom(e){e&&Ane(this.outerObject3d),this.cancelHandle("bloom",e&&(()=>new br(()=>Pne(this.outerObject3d))))}get outline(){return!!this.nativeObject3d.userData.outline}set outline(e){e&&Nne(this.nativeObject3d),this.cancelHandle("outline",e&&(()=>new br(()=>kne(this.nativeObject3d))))}get visible(){return this._visible!==!1}set visible(e){this._visible=e,this.outerObject3d.visible=e}get frustumCulled(){return this.outerObject3d.frustumCulled}set frustumCulled(e){this.outerObject3d.frustumCulled=e,this.outerObject3d.traverse(t=>t.frustumCulled=e)}get castShadow(){var e;return(e=this._castShadow)!=null?e:!0}set castShadow(e){this._castShadow=e,this.outerObject3d.traverse(t=>t.castShadow=e)}get receiveShadow(){var e;return(e=this._receiveShadow)!=null?e:!0}set receiveShadow(e){this._receiveShadow=e,this.outerObject3d.traverse(t=>t.receiveShadow=e)}refreshFactors(){this.cancelHandle("refreshFactors",()=>{const e=new br;return"tryCloneMaterial"in this&&this.tryCloneMaterial(),queueMicrotask(()=>{if(e.done)return;const{_toon:t,_metalnessFactor:r,_roughnessFactor:i,_opacityFactor:s,_envFactor:o,_adjustColor:a,_reflection:c,_illumination:u}=this;let d;if(!t&&(c||u)){const p=new Jj(c?256:16);d=p.texture,e.then(()=>{p.dispose(),d=void 0});const f=new Zj(Wm,c?eu:5,p);e.watch(_n(()=>{const v=xi();if(!v)return;const x=(c?_ne:ibe)(()=>{f.position.copy(Kr(this.outerObject3d)),this.outerObject3d.visible=!1,f.update(v,Qt),this.outerObject3d.visible=!0});return()=>{x.cancel()}},[xi]))}this.outerObject3d.traverse(p=>{let f=p.material;if(f){if(Array.isArray(f)&&(f=f[0]),t){p.material=new Rye,Lbe(f,p.material),e.then(()=>{p.material.dispose(),p.material=f});return}r!==void 0&&uP(f,"metalness",r!==0?r:void 0),i!==void 0&&uP(f,"roughness",i!==1?i:void 0),s!==void 0&&(uP(f,"opacity",s),k5(f,"transparent",s<=1?!0:void 0)),o!==void 0&&uP(f,"envMapIntensity",o!==1?o:void 0),a!==void 0&&k5(f,"color",a!=="#ffffff"?new Xt(a):void 0),(c!==void 0||u!==void 0)&&k5(f,"envMap",d)}})}),e})}get metalnessFactor(){return this._metalnessFactor}set metalnessFactor(e){this._metalnessFactor=e,this.refreshFactors()}get roughnessFactor(){return this._roughnessFactor}set roughnessFactor(e){this._roughnessFactor=e,this.refreshFactors()}get opacityFactor(){return this._opacityFactor}set opacityFactor(e){this._opacityFactor=e,this.refreshFactors()}get envFactor(){return this._envFactor}set envFactor(e){this._envFactor=e,this.refreshFactors()}get adjustColor(){return this._adjustColor}set adjustColor(e){this._adjustColor=e,this.refreshFactors()}get reflection(){var e;return(e=this._reflection)!=null?e:!1}set reflection(e){this._reflection=e,this.refreshFactors()}get illumination(){var e;return(e=this._illumination)!=null?e:!1}set illumination(e){this._illumination=e,this.refreshFactors()}get toon(){var e;return(e=this._toon)!=null?e:!1}set toon(e){this._toon=e,this.refreshFactors()}get frustumVisible(){return Gbe(),fne.containsPoint(HC(this.nativeObject3d))}lookAt(e,t,r){if(typeof e=="number"){this.lookAt(new a0(e,t===void 0?this.outerObject3d.position.y*Fs:t,r));return}"outerObject3d"in e?this.outerObject3d.lookAt(Kr(e.nativeObject3d)):this.outerObject3d.lookAt(y9(e))}lookTo(e,t,r,i){if(typeof e=="number"){this.lookTo(new a0(e,t===void 0?this.outerObject3d.position.y*Fs:t,r),i);return}const{quaternion:s}=this.outerObject3d,o=s.clone();this.lookAt(e);const a=s.clone();s.copy(o),this.cancelHandle("lookTo",()=>Ri(()=>{var c;s.slerp(a,_0(t));const{x:u,y:d,z:p}=Dbe(s,a);Math.abs(u)+Math.abs(d)+Math.abs(p)<.001&&(this.cancelHandle("lookTo",void 0),(c=this.onLookToEnd)==null||c.call(this),s.copy(a))}))}getWorldPosition(){return iu(Kr(this.nativeObject3d))}}const[qbe,Gp]=yt(!1),Ybe=new WeakMap,PX=new WeakMap,z5=new WeakMap;class eC extends nte{constructor(e,t){super(),le(this,"clip"),le(this,"name"),le(this,"mixer"),le(this,"action"),this.mixer=hh(Ybe,t,()=>new vxe(t)),typeof e=="string"?this.name=e:(this.name=e.name,this.loadClip(e))}retarget(e){const t=this.clip.clone(),r=e.name+".";return t.tracks=t.tracks.filter(i=>i.name.startsWith(r)),new eC(t,e)}dispose(){return this.done?this:(super.dispose(),this.stop(),this)}get duration(){var e,t;return(t=(e=this.clip)==null?void 0:e.duration)!=null?t:0}loadClip(e){this.clip=e,this.action=this.mixer.clipAction(e)}setTracks(e){const t=Object.entries(e).map(([r,i])=>new QM("."+r,Object.keys(i).map(s=>Number(s)),Object.values(i)));this.clip&&this.mixer.uncacheClip(this.clip),this.loadClip(new O6(this.name,-1,t))}play({crossFade:e=.25,repeat:t=!0,onFinish:r}={}){var i,s;const[o,a]=(i=PX.get(this.mixer))!=null?i:[];if((o==null?void 0:o.isRunning())&&this.action===o){t!==a&&o.setLoop(t?w6:b6,1/0);return}(s=z5.get(this.mixer))==null||s.cancel();const c=this.watch(Ri(()=>this.mixer.update(RL[0])));z5.set(this.mixer,c);const{action:u}=this;if(!u)return;o&&e?(u.time=0,u.enabled=!0,u.crossFadeFrom(o,e,!0)):this.mixer.stopAllAction(),PX.set(this.mixer,[u,t]),u.setLoop(t?w6:b6,1/0),u.clampWhenFinished=!0;const d=()=>r==null?void 0:r();this.mixer.addEventListener("finished",d),c.then(()=>this.mixer.removeEventListener("finished",d)),u.paused&&u.stop(),u.play()}stop(){var e;this.action&&(this.action.paused=!0),(e=z5.get(this.mixer))==null||e.cancel()}getPaused(){var e;return(e=this.action)==null?void 0:e.paused}setPaused(e){this.action&&(this.action.paused=e)}update(e){this.mixer.time=0,this.action&&(this.action.time=0),this.mixer.update(e)}}const Zbe=uu(n=>{const e=Object.entries(n);let t=0;for(const[,{length:s}]of e)s>t&&(t=s);const r=1e3*.001/t,i={};for(const[s,o]of e)i[s]=Object.fromEntries(o.map((a,c)=>[(c*r).toFixed(2),a]));return i},0,"trailingPromise");class Kbe extends Jne{constructor(){super(...arguments),le(this,"animationManagers"),le(this,"animationManager"),le(this,"_animationPaused"),le(this,"animationRepeat"),le(this,"onAnimationFinish"),le(this,"serializeAnimation"),le(this,"_animation")}get animations(){var e;return(e=this.animationManagers)!=null?e:this.animationManagers={}}set animations(e){this.animationManagers=e}createAnimation(e){if(e in this.animations){const r=this.animations[e];if(typeof r!="string")return r}const t=this.watch(new eC(e,this));return this.animations[e]=t,t}buildAnimation(e){Zbe(e).then(t=>{const r="lingo3d-animation";this.createAnimation(r).setTracks(t),this.playAnimation(r)})}makeAnimationProxy(e){return new Proxy(e,{get:(t,r)=>t[r],set:(t,r,i)=>(t[r]=i,this.buildAnimation(t),!0)})}get animationPaused(){return this._animationPaused}set animationPaused(e){var t;this._animationPaused=e,(t=this.animationManager)==null||t.setPaused(!!e)}playAnimation(e,t){const r=this.animationManager=typeof e=="string"?this.animations[e]:Object.values(this.animations)[e!=null?e:0];!r||(r.play(t),this._animationPaused&&r.setPaused(!0))}stopAnimation(){var e;(e=this.animationManager)==null||e.stop()}setAnimation(e,t){if(this._animation=e,typeof e=="string"||typeof e=="number"){this.serializeAnimation=e,this.playAnimation(e,t);return}if(typeof e=="boolean"){e?this.playAnimation(void 0,t):this.stopAnimation();return}if(!e){this.stopAnimation();return}this._animation=this.makeAnimationProxy(e),this.buildAnimation(e)}get animation(){return this._animation}set animation(e){if(Array.isArray(e)){let t=0;const r={onFinish:()=>{var i;if(++t>=e.length){if(this.animationRepeat===!1){(i=this.onAnimationFinish)==null||i.call(this);return}t=0}this.setAnimation(e[t],r)},repeat:!1};this.setAnimation(e[0],r);return}this.queueMicrotask(()=>this.setAnimation(e,{repeat:this.animationRepeat,onFinish:this.onAnimationFinish}))}}const hP=new WeakMap,$p=n=>{if(hP.has(n))return hP.get(n).clone();const e=n.nativeObject3d.scale.clone().multiply(n.outerObject3d.scale);return hP.set(n,e.clone()),ab(()=>hP.delete(n),!0),e},TX=new WeakMap,RX=(n,e)=>{const t=TX.get(n);if(t)return t;const r=ane(n.x,n.y,n.z,e.x*Fs,e.y*Fs,e.z*Fs);return TX.set(n,r),r};class lb extends Kbe{constructor(){super(...arguments),le(this,"onIntersectState"),le(this,"onIntersectOutState"),le(this,"intersectIdsState"),le(this,"onMoveToEnd")}getRayIntersectionsAt(e,t){var r;const i=[];for(const o of(r=_m.get(e))!=null?r:[]){if(o===this)continue;const a=this.rayIntersectsAt(o,t);a&&i.push([o,a])}const s=Kr(this.nativeObject3d);return i.sort((o,a)=>RX(o[1],s)-RX(a[1],s))}getRayIntersections(e,t){return this.getRayIntersectionsAt(e,t).map(r=>r[0])}listenToRayIntersection(e,t,r){return this.beforeRender(()=>{for(const[i,s]of this.getRayIntersectionsAt(e,r))t(i,s)})}getIntersections(e){var t;const r=[];for(const i of(t=_m.get(e))!=null?t:[])i!==this&&this.intersects(i)&&r.push(i);return r}listenToIntersection(e,t,r){let i=[];return this.beforeRender(()=>{const s=this.getIntersections(e);if(t)for(const o of s)i.includes(o)||t(o);if(r)for(const o of i)s.includes(o)||r(o);i=s})}initIntersect(){this.onIntersectState||(this.onIntersectState=new nn(void 0),this.onIntersectOutState=new nn(void 0),this.intersectIdsState=new nn(void 0),this.createEffect(()=>{const{onIntersect:e,onIntersectOut:t,intersectIds:r}=this;if(!r||!e&&!t)return;const i=[];for(const s of r)i.push(this.listenToIntersection(s,e,t));return()=>{for(const s of i)s.cancel()}},[this.onIntersectState.get,this.onIntersectOutState.get,this.intersectIdsState.get]))}get onIntersect(){var e;return(e=this.onIntersectState)==null?void 0:e.get()}set onIntersect(e){var t;this.initIntersect(),(t=this.onIntersectState)==null||t.set(e)}get onIntersectOut(){var e;return(e=this.onIntersectOutState)==null?void 0:e.get()}set onIntersectOut(e){var t;this.initIntersect(),(t=this.onIntersectOutState)==null||t.set(e)}get intersectIds(){var e;return(e=this.intersectIdsState)==null?void 0:e.get()}set intersectIds(e){var t;this.initIntersect(),(t=this.intersectIdsState)==null||t.set(e)}get scaleX(){return this.outerObject3d.scale.x}set scaleX(e){this.outerObject3d.scale.x=e}get scaleY(){return this.outerObject3d.scale.y}set scaleY(e){this.outerObject3d.scale.y=e}get scaleZ(){return this.outerObject3d.scale.z}set scaleZ(e){this.outerObject3d.scale.z=e}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e,this.scaleZ=e}get rotationX(){return this.outerObject3d.rotation.x*gm}set rotationX(e){this.outerObject3d.rotation.x=e*Bs}get rotationY(){return this.outerObject3d.rotation.y*gm}set rotationY(e){this.outerObject3d.rotation.y=e*Bs}get rotationZ(){return this.outerObject3d.rotation.z*gm}set rotationZ(e){this.outerObject3d.rotation.z=e*Bs}get rotation(){return this.rotationZ}set rotation(e){this.rotationZ=e}translateX(e){this.outerObject3d.translateX(e*nr*Ch[0])}translateY(e){this.outerObject3d.translateY(e*nr*Ch[0])}translateZ(e){this.outerObject3d.translateZ(e*nr*Ch[0])}placeAt(e){var t;if(typeof e=="string"){const[r]=(t=_m.get(e))!=null?t:[void 0];if(!r)return;e=r}if("outerObject3d"in e){"isSpawnPoint"in e&&(e.object3d.position.y=$p(this).y*.5),this.outerObject3d.position.copy(HC(e.nativeObject3d)),this.outerObject3d.quaternion.copy(Tm(e.outerObject3d));return}this.outerObject3d.position.copy(y9(e))}moveForward(e){Gp()?this.translateZ(-e):(Pi.setFromMatrixColumn(this.outerObject3d.matrix,0),Pi.crossVectors(this.outerObject3d.up,Pi),this.outerObject3d.position.addScaledVector(Pi,e*nr*Ch[0]))}moveRight(e){Gp()?this.translateX(e):(Pi.setFromMatrixColumn(this.outerObject3d.matrix,0),this.outerObject3d.position.addScaledVector(Pi,e*nr*Ch[0]))}lerpTo(e,t,r,i,s){const o=new ye(this.x,this.y,this.z),a=new ye(e,t,r);this.cancelHandle("lerpTo",()=>Ri(()=>{var c;const{x:u,y:d,z:p}=o.lerp(a,_0(i));Math.abs(this.x-u)<.1&&Math.abs(this.y-d)<.1&&Math.abs(this.z-p)<.1&&(this.cancelHandle("lerpTo",void 0),(c=this.onMoveToEnd)==null||c.call(this)),this.x=u,this.y=d,this.z=p,s==null||s()}))}moveTo(e,t,r,i,s){e===this.x&&(e+=.01),r===this.z&&(r+=.01);const{x:o,y:a,z:c}=new ye(e-this.x,t===void 0?0:t-this.y,r-this.z).normalize(),u=i*o,d=i*a,p=i*c,f=Txe(e,r,this.x,this.z);this.cancelHandle("lerpTo",()=>Ri(()=>{var v;this.x+=u*Ch[0],t!==void 0&&(this.y+=d*Ch[0]),this.z+=p*Ch[0];const x=Axe(new $u(this.x,this.z),new $u(e,r),new $u(this.x,r)),y=Pxe(new $u(e,r),new $u(this.x,this.z),f===1||f===4?x:-x);r>y.y&&(this.cancelHandle("lerpTo",void 0),(v=this.onMoveToEnd)==null||v.call(this)),s==null||s(t)}))}}NC(lb,[OL]);class Pp extends lb{constructor(e){var t;super(e),le(this,"material"),le(this,"model"),le(this,"managerSet"),this.material=(t=e.material)!=null?t:e.material=zR,Ji.delete(this)}retargetAnimations(){var e;if((e=this.model)!=null&&e.animationManagers){for(const t of Object.values(this.model.animationManagers))this.animations[t.name]=this.watch(t.retarget(this.nativeObject3d));this.model=void 0}}get animation(){return super.animation}set animation(e){this.retargetAnimations(),super.animation=e}addToRaycastSet(e){return this.managerSet||(this.managerSet=!0,this.nativeObject3d.traverse(t=>t.userData.manager=this)),super.addToRaycastSet(e)}}le(Pp,"componentName","find"),le(Pp,"defaults",PL),le(Pp,"schema",hne);NC(Pp,[jC,g9]);const[Jbe,Qne]=yt(20),[Qbe,OX]=yt(void 0),cb=pL(async()=>{const{World:n,GSSolver:e,SplitSolver:t,NaiveBroadphase:r,Material:i,ContactMaterial:s,Body:o,Vec3:a,Box:c,Sphere:u,Cylinder:d}=await rr(()=>import("./cannon-es.9b610247.9dee40ce.js"),[]),p=new n;Qne(y=>p.gravity.set(0,-y,0)),p.quatNormalizeSkip=0,p.quatNormalizeFast=!1;const f=new e;p.defaultContactMaterial.contactEquationStiffness=1e9,p.defaultContactMaterial.contactEquationRelaxation=4,f.iterations=7,f.tolerance=.1,p.solver=new t(f),p.broadphase=new r;const[v]=p.defaultContactMaterial.materials,x=new i("slipperyMaterial");return p.addContactMaterial(new s(x,x,{friction:0,restitution:0})),p.addContactMaterial(new s(x,v,{friction:.001,restitution:0})),Qbe(p),{world:p,defaultMaterial:v,slipperyMaterial:x,Body:o,Vec3:a,Box:c,Sphere:u,Cylinder:d}});async function $ne(){const{Box:n}=await cb();this.cannonBody.addShape(new n($p(this).multiplyScalar(.5)))}const LX=new Map,$be=new Set,UR=new Map,DX=new WeakSet,ewe=()=>new WeakSet;_n(function(){if(Na()||!BR())return;const n=OX();if(!n)return;const e=Ri(()=>{for(const t of $be){const r=t.cannonBody;if("_mAV"in t){const{x:o,y:a,z:c}=t._mAV,{angularVelocity:u}=r;u.x>o?u.x=o:u.x<-o&&(u.x=-o),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>c?u.z=c:u.z<-c&&(u.z=-c)}if("_mV"in t){const{x:o,y:a,z:c}=t._mV,{velocity:u}=r;u.x>o?u.x=o:u.x<-o&&(u.x=-o),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>c?u.z=c:u.z<-c&&(u.z=-c)}const i=t.positionUpdate;i.x&&(r.position.x=t.outerObject3d.position.x,r.velocity.x=0,r.force.x=0),i.y&&(r.position.y=t.outerObject3d.position.y,r.velocity.y=0,r.force.y=0),i.z&&(r.position.z=t.outerObject3d.position.z,r.velocity.z=0,r.force.z=0),i.reset(),t.outerObject3d.position.copy(r.position);const s=t.rotationUpdate;s?(s.x&&(r.angularVelocity.x=0,r.torque.x=0),s.y&&(r.angularVelocity.y=0,r.torque.y=0),s.z&&(r.angularVelocity.z=0,r.torque.z=0),r.quaternion.copy(t.outerObject3d.quaternion)):t.outerObject3d.quaternion.copy(r.quaternion),s.reset}n.step(RL[0]),UR.clear();for(const t of n.contacts)hh(UR,t.bi,ewe).add(t.bj)});return()=>{e.cancel()}},[OX,Na,BR]);const tU=new WeakSet;class k9 extends lb{constructor(){super(...arguments),le(this,"_mAV"),le(this,"_mV"),le(this,"cannonBody"),le(this,"positionUpdate"),le(this,"rotationUpdate"),le(this,"_noTumble"),le(this,"_slippery"),le(this,"_mass"),le(this,"_physicsGroup"),le(this,"_ignorePhysicsGroups"),le(this,"_physicsShape"),le(this,"bvhVelocity"),le(this,"bvhOnGround"),le(this,"bvhRadius"),le(this,"bvhHalfHeight"),le(this,"bvhMap"),le(this,"bvhCharacter"),le(this,"_physics"),le(this,"_gravity")}getMAV(){var e;return(e=this._mAV)!=null?e:this._mAV=new a0(1/0,1/0,1/0)}get maxAngularVelocityX(){var e,t;return(t=(e=this._mAV)==null?void 0:e.x)!=null?t:1/0}set maxAngularVelocityX(e){this.getMAV().x=e}get maxAngularVelocityY(){var e,t;return(t=(e=this._mAV)==null?void 0:e.y)!=null?t:1/0}set maxAngularVelocityY(e){this.getMAV().y=e}get maxAngularVelocityZ(){var e,t;return(t=(e=this._mAV)==null?void 0:e.z)!=null?t:1/0}set maxAngularVelocityZ(e){this.getMAV().z=e}getMV(){var e;return(e=this._mV)!=null?e:this._mV=new a0(1/0,1/0,1/0)}get maxVelocityX(){var e,t;return(t=(e=this._mV)==null?void 0:e.x)!=null?t:1/0}set maxVelocityX(e){this.getMV().x=e}get maxVelocityY(){var e,t;return(t=(e=this._mV)==null?void 0:e.y)!=null?t:1/0}set maxVelocityY(e){this.getMV().y=e}get maxVelocityZ(){var e,t;return(t=(e=this._mV)==null?void 0:e.z)!=null?t:1/0}set maxVelocityZ(e){this.getMV().z=e}applyForce(e,t,r){setTimeout(()=>{var i;return(i=this.cannonBody)==null?void 0:i.applyForce({x:e,y:t,z:r})})}applyImpulse(e,t,r){setTimeout(()=>{var i;return(i=this.cannonBody)==null?void 0:i.applyImpulse({x:e,y:t,z:r})})}applyLocalForce(e,t,r){setTimeout(()=>{var i;return(i=this.cannonBody)==null?void 0:i.applyLocalForce({x:e,y:t,z:r})})}applyLocalImpulse(e,t,r){setTimeout(()=>{var i;return(i=this.cannonBody)==null?void 0:i.applyLocalImpulse({x:e,y:t,z:r})})}applyTorque(e,t,r){setTimeout(()=>{var i;return(i=this.cannonBody)==null?void 0:i.applyTorque({x:e,y:t,z:r})})}get velocity(){return this.bvhVelocity?this.bvhVelocity:this.cannonBody?this.cannonBody.velocity:new a0(0,0,0)}set velocity(e){this.bvhVelocity?Object.assign(this.bvhVelocity,e):this.cannonBody&&Object.assign(this.cannonBody.velocity,e)}refreshCannon(){var e;this.positionUpdate&&(this.physics=(e=this._physics)!=null?e:!1)}get noTumble(){return this._noTumble}set noTumble(e){this._noTumble=e,this.refreshCannon()}get slippery(){return this._slippery}set slippery(e){this._slippery=e,this.refreshCannon()}get mass(){return this._mass}set mass(e){this._mass=e,this.refreshCannon()}get physicsGroup(){return this._physicsGroup}set physicsGroup(e){this._physicsGroup=e,this.refreshCannon()}get ignorePhysicsGroups(){return this._ignorePhysicsGroups}set ignorePhysicsGroups(e){this._ignorePhysicsGroups=e,this.refreshCannon()}get physicsShape(){var e;return(e=this._physicsShape)!=null?e:this._physicsShape=$ne}set physicsShape(e){this._physicsShape=e,this.refreshCannon()}initPhysics(e,t){if(!(!e||t.done))switch(e){case!0:case"2d":rr(()=>import("./enableCannon.42cb1442.6a90a7dc.js"),["assets/enableCannon.42cb1442.6a90a7dc.js","assets/PhysicsUpdate.0a7e4cd0.02fb49e3.js"]).then(r=>r.default.call(this,t));break;case"map":this.bvhMap=!0,rr(()=>import("./enableBVHMap.60be4419.41157d21.js"),["assets/enableBVHMap.60be4419.41157d21.js","assets/useBVHMap.37f7c48f.6f03e93c.js","assets/bvhManagerMap.fa3f08c1.bebd7d59.js"]).then(r=>r.default.call(this,t,!1));break;case"map-debug":this.bvhMap=!0,rr(()=>import("./enableBVHMap.60be4419.41157d21.js"),["assets/enableBVHMap.60be4419.41157d21.js","assets/useBVHMap.37f7c48f.6f03e93c.js","assets/bvhManagerMap.fa3f08c1.bebd7d59.js"]).then(r=>r.default.call(this,t,!0));break;case"character":this.bvhCharacter=!0,rr(()=>import("./enableBVHCharacter.022c9f72.618ba70e.js"),["assets/enableBVHCharacter.022c9f72.618ba70e.js","assets/useBVHMap.37f7c48f.6f03e93c.js","assets/bvhManagerMap.fa3f08c1.bebd7d59.js","assets/PhysicsUpdate.0a7e4cd0.02fb49e3.js"]).then(r=>r.default.call(this,t));break;default:Wpe(e)}}get physics(){var e;return(e=this._physics)!=null?e:!1}set physics(e){this._physics=e,this.initPhysics(e,this.cancelHandle("physics",()=>new br))}get gravity(){var e;return(e=this._gravity)!=null?e:!0}set gravity(e){this._gravity=e}intersects(e){var t,r,i,s;if(this.done||e.done||this===e)return!1;if(e instanceof k9){if(this.bvhMap&&e.bvhCharacter||this.bvhCharacter&&e.bvhMap)return((t=LX.get(this))==null?void 0:t.has(e))||((r=LX.get(e))==null?void 0:r.has(this))||!1;if(this.cannonBody&&e.cannonBody)return DX.add(this.cannonBody),DX.add(e.cannonBody),((i=UR.get(this.cannonBody))==null?void 0:i.has(e.cannonBody))||((s=UR.get(e.cannonBody))==null?void 0:s.has(this.cannonBody))||!1}return super.intersects(e)}get x(){return super.x}set x(e){var t;super.x=e,(t=this.positionUpdate)==null||t.updateX()}get y(){return super.y}set y(e){var t;super.y=e,(t=this.positionUpdate)==null||t.updateY()}get z(){return super.z}set z(e){var t;super.z=e,(t=this.positionUpdate)==null||t.updateZ()}get rotationX(){return super.rotationX}set rotationX(e){var t;super.rotationX=e,(t=this.rotationUpdate)==null||t.updateX()}get rotationY(){return super.rotationY}set rotationY(e){var t;super.rotationY=e,(t=this.rotationUpdate)==null||t.updateY()}get rotationZ(){return super.rotationZ}set rotationZ(e){var t;super.rotationZ=e,(t=this.rotationUpdate)==null||t.updateZ()}lookAt(e,t,r){var i;super.lookAt(e,t,r),(i=this.rotationUpdate)==null||i.updateXYZ()}placeAt(e){var t,r;super.placeAt(e),(t=this.positionUpdate)==null||t.updateXYZ(),(r=this.rotationUpdate)==null||r.updateXYZ(),tU.add(this)}lerpTo(e,t,r,i){super.lerpTo(e,t,r,i,()=>{var s;return(s=this.positionUpdate)==null?void 0:s.updateXYZ()})}moveTo(e,t,r,i){super.moveTo(e,t,r,i,s=>{var o,a;return s===void 0?(o=this.positionUpdate)==null?void 0:o.updateXZ():(a=this.positionUpdate)==null?void 0:a.updateXYZ()})}}class Bl extends k9{constructor(e=new wr,t){super(e),le(this,"object3d"),this.object3d=e,this.nativeObject3d=e;const r=this.outerObject3d=new wr;r.userData.manager=this,!t&&Qt.add(r),r.add(e)}get innerRotationX(){return this.object3d.rotation.x*gm}set innerRotationX(e){this.object3d.rotation.x=e*Bs}get innerRotationY(){return this.object3d.rotation.y*gm}set innerRotationY(e){this.object3d.rotation.y=e*Bs}get innerRotationZ(){return this.object3d.rotation.z*gm}set innerRotationZ(e){this.object3d.rotation.z=e*Bs}get innerRotation(){return this.innerRotationZ}set innerRotation(e){this.innerRotationZ=e}get innerX(){return this.object3d.position.x*Fs}set innerX(e){this.object3d.position.x=e*nr}get innerY(){return this.object3d.position.y*Fs}set innerY(e){this.object3d.position.y=e*nr}get innerZ(){return this.object3d.position.z*Fs}set innerZ(e){this.object3d.position.z=e*nr}get width(){return this.object3d.scale.x*Fs}set width(e){this.object3d.scale.x=e*nr}get height(){return this.object3d.scale.y*Fs}set height(e){this.object3d.scale.y=e*nr}get depth(){return this.object3d.scale.z*Fs}set depth(e){this.object3d.scale.z=e*nr}get innerVisible(){return this.object3d.visible}set innerVisible(e){this.object3d.visible=e}find(e,t){var r,i;const s=this.outerObject3d.getObjectByName(Lr.sanitizeNodeName(e));if(!s)return;const o=(i=(r=s.userData).manager)!=null?i:r.manager=new Pp(s);return!t&&this._append(o),o}findAll(e){const t=[];return e===void 0?this.outerObject3d.traverse(r=>{var i,s;t.push((s=(i=r.userData).manager)!=null?s:i.manager=new Pp(r))}):typeof e=="string"?this.outerObject3d.traverse(r=>{var i,s;r.name===e&&t.push((s=(i=r.userData).manager)!=null?s:i.manager=new Pp(r))}):typeof e=="function"?this.outerObject3d.traverse(r=>{var i,s;e(r.name)&&t.push((s=(i=r.userData).manager)!=null?s:i.manager=new Pp(r))}):this.outerObject3d.traverse(r=>{var i,s;e.test(r.name)&&t.push((s=(i=r.userData).manager)!=null?s:i.manager=new Pp(r))}),t}}const twe={...cne,maxAngularVelocityX:Number,maxAngularVelocityY:Number,maxAngularVelocityZ:Number,maxVelocityX:Number,maxVelocityY:Number,maxVelocityZ:Number,velocity:Object,gravity:Boolean,noTumble:Boolean,slippery:Boolean,mass:Number,physicsGroup:Number,ignorePhysicsGroups:Array,physics:[String,Boolean],physicsShape:Function};sb(["maxAngularVelocityX","maxAngularVelocityY","maxAngularVelocityZ","maxVelocityX","maxVelocityY","maxVelocityZ","velocity","noTumble","slippery","mass","physicsGroup","ignorePhysicsGroups","physicsShape"]);const nwe={...une,maxAngularVelocityX:1/0,maxAngularVelocityY:1/0,maxAngularVelocityZ:1/0,maxVelocityX:1/0,maxVelocityY:1/0,maxVelocityZ:1/0,velocity:{x:0,y:0,z:0},gravity:!0,noTumble:new Ti(!1),slippery:new Ti(!1),mass:new Ti(1),physicsGroup:void 0,ignorePhysicsGroups:void 0,physics:!1,physicsShape:$ne},hu={...twe,innerRotationX:Number,innerRotationY:Number,innerRotationZ:Number,innerRotation:Number,innerX:Number,innerY:Number,innerZ:Number,width:Number,height:Number,depth:Number,innerVisible:Boolean},du={...nwe,innerRotationX:0,innerRotationY:0,innerRotationZ:0,innerRotation:0,innerX:0,innerY:0,innerZ:0,width:100,height:100,depth:100,innerVisible:!0},NL={...hu,...EL,...f9},kL={...du,...AL,...m9};class cu extends Bl{constructor(e){const t=new Io(e,zR);t.castShadow=!0,t.receiveShadow=!0,super(t),le(this,"material",zR)}}le(cu,"defaults",kL),le(cu,"schema",NL);NC(cu,[jC,g9]);const ere=new A0(wc,wc,wc,1,1,1);class tre extends cu{constructor(){super(ere)}}le(tre,"componentName","cube");const b3=new WeakMap,nre=n=>{b3.has(n)&&(b3.get(n)(),b3.delete(n))},IX=(n,e)=>{nre(n);const t=n(e);t&&b3.set(n,t)};class rwe{constructor(){le(this,"done"),le(this,"value"),le(this,"callbacks",[])}then(e){return this.callbacks.push(e),this.done&&IX(e,this.value),new br(()=>{Uj(this.callbacks,e),nre(e)})}resolve(e){for(const t of this.callbacks)IX(t,e);this.done=!0,this.value=e}}const iwe=n=>{const e=new tte;return n.then(t=>{e.resolve(t)}),e};class GC extends Bl{constructor(e){super(new Io(ere,mne),e),le(this,"loadedGroup",new Bh),le(this,"loaded",new rwe),le(this,"_src"),le(this,"_onLoad"),le(this,"widthSet"),le(this,"heightSet"),le(this,"depthSet"),le(this,"_boxVisible"),le(this,"_outline"),le(this,"_bloom"),le(this,"managerSet"),le(this,"materialCloned"),this.outerObject3d.add(this.loadedGroup)}get src(){return this._src}set src(e){this._src=e,this.loaded.done&&this.loadedGroup.clear(),this.cancelHandle("src",e&&(()=>iwe(this.load(e)).then(t=>{const r=this.resolveLoaded(t,e);this.loadedGroup.add(r),this.loaded.resolve(r),this.object3d.visible=!!this._boxVisible})))}get onLoad(){return this._onLoad}set onLoad(e){this._onLoad=e,this.cancelHandle("onLoad",e&&(()=>this.loaded.then(()=>void e())))}get width(){return super.width}set width(e){super.width=e,this.widthSet=!0}get height(){return super.height}set height(e){super.height=e,this.heightSet=!0}get depth(){return super.depth}set depth(e){super.depth=e,this.depthSet=!0}get innerRotationX(){return super.innerRotationX}set innerRotationX(e){super.innerRotationX=e,this.loadedGroup.rotation.x=this.object3d.rotation.x}get innerRotationY(){return super.innerRotationY}set innerRotationY(e){super.innerRotationY=e,this.loadedGroup.rotation.y=this.object3d.rotation.y}get innerRotationZ(){return super.innerRotationZ}set innerRotationZ(e){super.innerRotationZ=e,this.loadedGroup.rotation.z=this.object3d.rotation.z}get innerX(){return super.innerX}set innerX(e){super.innerX=e,this.loadedGroup.position.x=this.object3d.position.x}get innerY(){return super.innerY}set innerY(e){super.innerY=e,this.loadedGroup.position.y=this.object3d.position.y}get innerZ(){return super.innerZ}set innerZ(e){super.innerZ=e,this.loadedGroup.position.z=this.object3d.position.z}get innerVisible(){return this.loadedGroup.visible}set innerVisible(e){this.loadedGroup.visible=e}get frustumCulled(){return super.frustumCulled}set frustumCulled(e){this.outerObject3d.frustumCulled=e,this.cancelHandle("frustumCulled",()=>this.loaded.then(()=>{super.frustumCulled=e}))}get castShadow(){return super.castShadow}set castShadow(e){this._castShadow=e,this.cancelHandle("castShadow",()=>this.loaded.then(()=>{super.castShadow=e}))}get receiveShadow(){return super.receiveShadow}set receiveShadow(e){this._receiveShadow=e,this.cancelHandle("receiveShadow",()=>this.loaded.then(()=>{super.receiveShadow=e}))}get physics(){return super.physics}set physics(e){this._physics=e;const t=this.cancelHandle("physics",()=>this.loaded.then(()=>{this.initPhysics(e,t)}))}get boxVisible(){var e;return(e=this._boxVisible)!=null?e:this.object3d.visible}set boxVisible(e){this._boxVisible=e,this.object3d.visible=e}get outline(){return!!this._outline}set outline(e){this._outline=e,this.cancelHandle("outline",()=>this.loaded.then(t=>{if(e)return Nne(t),()=>{kne(t)}}))}get bloom(){return!!this._bloom}set bloom(e){this._bloom=e,this.cancelHandle("bloom",()=>this.loaded.then(t=>{if(e)return Ane(t),()=>{Pne(t)}}))}addToRaycastSet(e){const t=new br;return queueMicrotask(()=>{t.done||(this._physics==="map"||this._physics==="map-debug"?t.watch(this.loaded.then(r=>(this.managerSet||(this.managerSet=!0,r.traverse(i=>{var s,o;return(o=(s=i.userData).manager)!=null?o:s.manager=this})),e.add(r),()=>{e.delete(r)}))):t.watch(super.addToRaycastSet(e)))}),t}refreshFactors(){this.cancelHandle("refreshFactorsLoaded",()=>this.loaded.then(()=>void super.refreshFactors()))}tryCloneMaterial(){this.materialCloned||(this.materialCloned=!0,this.watch(this.loaded.then(e=>{const t=[];return e.traverse(r=>{!r.material||t.push(r.material=r.material.clone())}),()=>{for(const r of t)r.dispose()}})))}placeAt(e){this.cancelHandle("placeAt",()=>this.loaded.then(()=>void super.placeAt(e)))}}const swe=n=>"loadedGroup"in n?n.loadedGroup:"object3d"in n?n.object3d:n.outerObject3d;function owe(n){const e=new Map,t=new Map,r=n.clone();return rre(n,r,function(i,s){e.set(s,i),t.set(i,s)}),r.traverse(function(i){if(!i.isSkinnedMesh)return;const s=i,o=e.get(i),a=o.skeleton.bones;s.skeleton=o.skeleton.clone(),s.bindMatrix.copy(o.bindMatrix),s.skeleton.bones=a.map(function(c){return t.get(c)}),s.bind(s.skeleton,s.bindMatrix)}),r}function rre(n,e,t){t(n,e);for(let r=0;r<n.children.length;r++)rre(n.children[r],e.children[r],t)}const ire=new WeakSet,GQe=(n,e,t=n.animations)=>{const r=e?n.clone():owe(n);return!e&&ire.add(r),r.animations=t,r};_n(()=>{const n=ps();if(!(n instanceof GC)||Ut()!==yi)return;const e=n.loadedGroup.children[0];if(!ire.has(e))return;const t=new yxe(e);return Qt.add(t),()=>{Qt.remove(t)}},[ps,Ut]);const[NX,tC]=yt(!1),[dP,zL]=yt({}),BL=!1,[sre,nU]=yt(BL);_n(()=>{var n;sre((n=Ut().userData.bokeh)!=null?n:BL)},[Ut,zL]);const VL=.03,[ore,are]=yt(VL);_n(()=>{var n;ore((n=Ut().userData.bokehAperture)!=null?n:VL)},[Ut,zL]);const FL=1,[lre,cre]=yt(FL);_n(()=>{var n;lre((n=Ut().userData.bokehFocus)!=null?n:FL)},[Ut,zL]);const UL=.01,[ure,hre]=yt(UL);_n(()=>{var n;ure((n=Ut().userData.bokehMaxBlur)!=null?n:UL)},[Ut,zL]);const z9={...hu,mouseControl:[Boolean,String],fov:Number,zoom:Number,near:Number,far:Number,active:Boolean,transition:[Boolean,Number],bokeh:Boolean,bokehFocus:Number,bokehMaxBlur:Number,bokehAperture:Number,minPolarAngle:Number,maxPolarAngle:Number,minAzimuthAngle:Number,maxAzimuthAngle:Number,polarAngle:Number,azimuthAngle:Number,enableDamping:Boolean},B9={...du,mouseControl:!1,fov:75,zoom:1,near:Wm,far:eu,active:!1,transition:new Ti(!1),bokeh:BL,bokehFocus:FL,bokehMaxBlur:UL,bokehAperture:VL,minPolarAngle:wne,maxPolarAngle:Sne,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,polarAngle:new Ti(0),azimuthAngle:new Ti(0),enableDamping:!1},dre={...z9,targetId:String,enableZoom:Boolean,enableFly:Boolean,autoRotate:[Boolean,Number]},pre={...B9,innerZ:500,mouseControl:"drag",targetId:void 0,enableZoom:!1,enableFly:!1,autoRotate:!1},[ub,jL]=Bo();window.addEventListener("blur",()=>ub());window.addEventListener("focus",()=>ub());document.addEventListener("visibilitychange",()=>ub());const w3=new Set;jL(()=>w3.clear());let rU=!1;const fre=()=>{!rU||(rU=!1,ub())};document.addEventListener("keydown",n=>{fre(),(n.key==="Shift"||n.key==="Meta")&&w3.add(n.key),w3.has("Meta")&&w3.has("Shift")&&(ub(),rU=!0)});document.addEventListener("keyup",n=>{(n.key==="Shift"||n.key==="Meta")&&ub()});document.addEventListener("mousedown",fre);async function awe(){const{Sphere:n,Cylinder:e,Vec3:t}=await cb(),{x:r,y:i}=$p(this),s=r*.5,o=i*.5,a=new n(s),c=new n(s),u=new e(s,s,Math.abs(i-r));this.cannonBody.addShape(a,new t(0,-o+s,0)),this.cannonBody.addShape(c,new t(0,o-s,0)),this.cannonBody.addShape(u)}const[V9,F9]=yt([]),lwe=Zx(V9,F9),cwe=Kx(V9,F9),mre={...hu,...EL},vre={...du,...AL,scaleZ:0,depth:0},kX=new Lte({transparent:!0});class ym extends Bl{constructor(){super(new q_e(kX)),le(this,"material",kX)}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}le(ym,"componentName","sprite"),le(ym,"defaults",vre),le(ym,"schema",mre);NC(ym,[jC]);const uwe=()=>{const n=new ym;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABnNJREFUaEPtWVmoVlUU/r5zNItModEGQinLMkqbyDLqoR6K0gZMEsxIkh6iEYSEZiR9iDTyoZEkqeylsoFeKmkwKOhGRaE5VIo0kVOIej37i3XY62f7e+//n//e44DcA//DvXuftde3hm+tvQ5xiDzcVzgk5QBMvno4w/8fSPa03rFatQORZDJJMlTRRlJWdW8rebUCSZWSdHUI4SoAx0XPmB5mfTtzW5ZlKwAsNY+Y90gWVYD3tqc2IOYJV0rSGwCmVFCsi+Qkkhv665k6gZQhEkJ4G8ANALoBDG4BZieAIQB+JjmO5C43RgUD7LWlFiAeGpKuk/QegF0ADgNglv4IwKB4sp23yxQHcBGAHQAOJ3kfyYWSBpHcfSCBDCbZHUJ4B8BkV1DSk3meP9KsmKTxkr4FYHlh7Laa5BkxNMsQ7RTMXh6xWAVgPxfWTqglareksZJ+iMlchhXJOSSfkmTesf9Z+BWSxkj6Ke41D5gnHiI5L9K2E0MznpIRTbdmctgDSF/ZQ9JwSR8AuCxa2RTIJb2eZdl0AEdEwxiQ/yTdImkpAKNoV844expJI4q2T6R5e6c0dAOIs4akU41xQgjnkTzWYjihzd4OOBfAMVEx82b6/BVDLfXyCTGHfJ/Tsv1tIbcpRkXz+k5JG7Mse5+kkQqcIEogSbLeFKnTQqHTx6zbDCJVsJ08D+FKBCRpSZ7n0xtAEv4/WtKvAI6KrGNKVRIaAaR7DZT9nK2aQfi6tzHpuq21yktbs5/l4N0kF5Vs55QnaaqkNyvwfzvLlsmbbFoHYCOALQCOB3AKgBHJujNXO7npur/TlWXZ+aUzJJXUKelhSU8AaFak6gFp4q4j+SyAjwGstGLXCHZpGIBxIYSpJO+K3uz0TA/ZP0iONgJpeKQoimesMPURSCM/JM3PsuxRkla5y2SMHrJQtW7XaLh8JI2W9AKAKzs814FsJjmK5OYUyAKS93YosNQn4fYbSb4blTS26+6pGbRwNnp2sEVRvEzyjqRAtouCfQKk9AbJ6SSXxOJnBau0vKRLAFwAYDiAfwF8TdIo1taGOJikR6sSZg5kC8mRdXikPFTSK3mez7R8i1V3d2xDFgGY0IN5l1t+kFzpYCQNlbQagNWYnqg8FVMrEBe2neRZJH83b8Qu1ptHO9yp1hXxFmgnyQkkuyRZ47hD0ixJz1cIsVqBuDcW53l+ewJilKSVsYXvrZX37ng9ybEkt3leRa+c3MYrtQIpuZzkZJLLPESKoniV5IwK9agE4x2ye6UoipdIzmxDOrUBcUE7Yvu9Plp0mKRfYuFr1554HqwhOcY7Wkl3RkpulfS1AXElNpA8k+T2COQcSd8n05NWLY4rY7kyhqS1R8ZkkyQZhbeq+LUDsQpuie7Fb5ykrnZFwOthBGw3xrNJrolArpH04f4C0piGxBbhz6jECEmrYuPZLrR8/W+Sp5PcGmXcJmnx/gLSqOgkLyX5lfdsIYRPK7YcJaPZtSHP82kJWcy1m+X+SnYD4vT7eJ7njyW1wGuIrXvNaI62RsEjOZ7kd96FhxCs6o/fn/Trylh3a7XA7uLloK0oiqdJPhC1L+/qCQHYe+WYiOT9JBck1X2ipM8r3EhrS3a3sA8O/ILT6J0kzZY0r5fLmSX4gySfi8MOm5wUIYTPAFze38relzY+bVMsRFaZdePsykaho0MIs0hOBHAkgK2SlmdZ9iLJ3+LExLxowzkDPr8CiLTjrrWNT2dTF5PcFJtHs3J6odpjXmU5BcBqiAGeIumtJlpuxeItQ2s+ydl9uI80Et8miyRvJflFpFLLDRtkGFjLjfKO7nUn7pkjaW4HIFKP/EPyNKPu9M5+j6SFfQRiwhuV2CYcWZZZqJb3juZHkoXZtZKMZm18mipXpZ460ayNXUG3ASmZRtKFkr6JQHqablQ9oDFwA/CjpBVZltkAYlMI4SQANhq9AsCJUaAZoJOJjb1WDsAlvZbnuRXQQT7XKuM3hLAMwPWR/tqNZVoBc+XaTePt/OZZWBWD2VXZ8stam7XlcDHGqX/bGBpCsPvzzTGeqwg9EHusY55B8kuPqL1GphHYSAA2BjX3G7tUHdTta1D2GWItgE/s80M6q24eYnf0/W9fa92Sf5s+1/Voaa+2B5EnUkxWQ/b6GnywhEy/nTsApN8mrFnAgEdqNmi/xQ14pN8mrFnAgEdqNmi/xR0yHvkfVPFBbg9BWmoAAAAASUVORK5CYII=",Ji.delete(n),n.scale=.5,n},gre=class extends Bl{constructor(n){super(),le(this,"camera"),le(this,"_physicsShape",awe),le(this,"midObject3d",this.outerObject3d),le(this,"orbitMode"),le(this,"gyrateHandle"),le(this,"_minPolarAngle",wne),le(this,"_maxPolarAngle",Sne),le(this,"_minAzimuthAngle",-1/0),le(this,"_maxAzimuthAngle",1/0),le(this,"_polarAngle"),le(this,"_azimuthAngle"),le(this,"enableDamping",!1),le(this,"mouseControlState",new nn(!1)),le(this,"mouseControlInit"),le(this,"_gyroControl"),this.camera=n,this.object3d.add(n),n.userData.manager=this,lwe(n),this.then(()=>{MX(n),cwe(n)}),this.createEffect(()=>{if(Ut()!==yi||Ut()===n)return;const e=new bxe(n);Qt.add(e);const t=uwe();e.add(t.outerObject3d);const r=Qp(({target:i})=>{i===t&&Ki(this)});return()=>{e.dispose(),Qt.remove(e),t.dispose(),r.cancel()}},[Ut])}lookAt(n,e,t){super.lookAt(n,e,t);const r=Xi.setFromQuaternion(this.outerObject3d.quaternion);r.x+=Math.PI,r.z+=Math.PI,this.outerObject3d.setRotationFromEuler(r)}get fov(){return this.camera.fov}set fov(n){var e,t;this.camera.fov=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get zoom(){return this.camera.zoom}set zoom(n){var e,t;this.camera.zoom=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get near(){return this.camera.near}set near(n){var e,t;this.camera.near=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get far(){return this.camera.far}set far(n){var e,t;this.camera.far=n,(t=(e=this.camera).updateProjectionMatrix)==null||t.call(e)}get active(){return Yx(dx())===this.camera}set active(n){MX(this.camera),n&&wbe(this.camera)}get transition(){return this.camera.userData.transition}set transition(n){this.camera.userData.transition=n}get bokeh(){var n;return(n=this.camera.userData.bokeh)!=null?n:BL}set bokeh(n){this.camera.userData.bokeh=n,dP({})}get bokehFocus(){var n;return(n=this.camera.userData.bokehFocus)!=null?n:FL}set bokehFocus(n){this.camera.userData.bokehFocus=n,dP({})}get bokehMaxBlur(){var n;return(n=this.camera.userData.bokehMaxBlur)!=null?n:UL}set bokehMaxBlur(n){this.camera.userData.bokehMaxBlur=n,dP({})}get bokehAperture(){var n;return(n=this.camera.userData.bokehAperture)!=null?n:VL}set bokehAperture(n){this.camera.userData.bokehAperture=n,dP({})}getRay(){return pne.set(Kr(this.camera),zne(this.camera))}append(n){this._append(n),this.camera.add(n.outerObject3d)}attach(n){this._append(n),this.camera.attach(n.outerObject3d)}get width(){return super.width}set width(n){const e=n*nr;this.object3d.scale.x=e,this.camera.scale.x=1/e}get height(){return super.height}set height(n){const e=n*nr;this.object3d.scale.y=e,this.camera.scale.y=1/e}get depth(){return super.depth}set depth(n){const e=n*nr;this.object3d.scale.z=e,this.camera.scale.z=1/e}_gyrate(n,e,t){var r;const i=t?this.object3d:this.midObject3d;Xi.setFromQuaternion(i.quaternion),Xi.y-=n*.002,Xi.y=Math.max($S-this._maxAzimuthAngle*Bs,Math.min($S-this._minAzimuthAngle*Bs,Xi.y)),Xi.x-=e*.002,Xi.x=Math.max($S-this._maxPolarAngle*Bs,Math.min($S-this._minPolarAngle*Bs,Xi.x)),i.setRotationFromEuler(Xi),!t&&((r=this.rotationUpdate)==null||r.updateXYZ())}gyrate(n,e,t){var r;if(this.enableDamping&&(n*=.5,e*=.5),this.orbitMode?this._gyrate(n,e):(this._gyrate(n,0),this._gyrate(0,e,!0)),!this.enableDamping||t||!(n||e))return;(r=this.gyrateHandle)==null||r.cancel();let i=1;const s=this.gyrateHandle=this.beforeRender(()=>{i*=.95,this._gyrate(n*i,e*i),i<=.001&&s.cancel()})}updateAngle(){gre.updateAngle(this,this)}get minPolarAngle(){return this._minPolarAngle}set minPolarAngle(n){this._minPolarAngle=n,this.updateAngle()}get maxPolarAngle(){return this._maxPolarAngle}set maxPolarAngle(n){this._maxPolarAngle=n,this.updateAngle()}get minAzimuthAngle(){return this._minAzimuthAngle}set minAzimuthAngle(n){this._minAzimuthAngle=n,this.updateAngle()}get maxAzimuthAngle(){return this._maxAzimuthAngle}set maxAzimuthAngle(n){this._maxAzimuthAngle=n,this.updateAngle()}setPolarAngle(n){const{_minPolarAngle:e,_maxPolarAngle:t}=this;this.minPolarAngle=this.maxPolarAngle=n,this.queueMicrotask(()=>{this.minPolarAngle=e,this.maxPolarAngle=t})}setAzimuthAngle(n){const{_minAzimuthAngle:e,_maxAzimuthAngle:t}=this;this.minAzimuthAngle=this.maxAzimuthAngle=n,this.queueMicrotask(()=>{this.minAzimuthAngle=e,this.maxAzimuthAngle=t})}get polarAngle(){return this._polarAngle}set polarAngle(n){this._polarAngle=n,n&&this.setPolarAngle(n)}get azimuthAngle(){return this._azimuthAngle}set azimuthAngle(n){this._azimuthAngle=n,n&&this.setAzimuthAngle(n)}get mouseControl(){return this.mouseControlState.get()}set mouseControl(n){this.mouseControlState.set(n),!(!n||this.mouseControlInit)&&(this.mouseControlInit=!0,rr(()=>import("./enableMouseControl.54033b11.b93bc959.js"),[]).then(e=>e.default.call(this)))}get gyroControl(){return!!this._gyroControl}set gyroControl(n){this._gyroControl=n;const e=Xi,t=Vg,r=Wxe,i=new hl(-Math.sqrt(.5),0,0,Math.sqrt(.5)),s=Tm(this.object3d),o=0,a=c=>{var u,d,p;this.object3d.quaternion.copy(s),e.set(((u=c.beta)!=null?u:0)*Bs,((d=c.alpha)!=null?d:0)*Bs,-((p=c.gamma)!=null?p:0)*Bs,"YXZ"),this.object3d.quaternion.multiply(t.setFromEuler(e));const f=-o*.5;r.set(0,Math.sin(f),0,Math.cos(f)),this.object3d.quaternion.multiply(r),this.object3d.quaternion.multiply(i)};n&&window.addEventListener("deviceorientation",a),this.cancelHandle("gyroControl",n&&(()=>new br(()=>window.removeEventListener("deviceorientation",a))))}};let U9=gre;le(U9,"updateAngle",ete(n=>n.gyrate(0,0),0,"trailing"));const _re=n=>!!n&&(v0(n)||n instanceof Jne),jR=new WeakSet,yre=class extends U9{constructor(n){super(n),le(this,"manualTarget"),le(this,"targetState",new nn(void 0)),this.createEffect(()=>{const e=this.targetState.get();if(!e)return;const t=ob(()=>e.parent!==this&&this.retarget());return()=>{t.cancel()}},[this.targetState.get])}retarget(){yre.retaget(this,this)}append(n){this._append(n),jR.delete(n),this.retarget()}attach(n){this._append(n),jR.add(n),this.retarget()}};let j9=yre;le(j9,"retaget",ete(n=>{var e;let t=n.manualTarget;for(const r of(e=n.children)!=null?e:[])if(t)r.outerObject3d.parent!==n.camera&&n.camera[jR.has(r)?"attach":"add"](r.outerObject3d);else if(_re(r)){t=r;const{parent:i}=n.outerObject3d;i&&r.outerObject3d.parent!==i&&i[jR.has(t)?"attach":"add"](t.outerObject3d)}n.targetState.set(t)},0,"trailing"));class wM extends j9{constructor(e=new oo(75,1,Wm,eu)){super(e),le(this,"targetIdState",new nn(void 0)),le(this,"enableZoomState",new nn(!1)),le(this,"enableFlyState",new nn(!1)),le(this,"autoRotateState",new nn(!1)),this.innerZ=500,this.orbitMode=!0,this.mouseControl="drag",this.camera.rotation.y=0,this.createEffect(()=>{const t=this.targetIdState.get();if(!t)return;const r=new br,i=setTimeout(()=>{const s=()=>{var o;const[a]=(o=_m.get(t))!=null?o:[void 0];return a&&(this.manualTarget=a,this.targetState.set(a)),a};s()||r.watch(ob(()=>setTimeout(()=>s()&&r.cancel())))});return()=>{clearTimeout(i),r.cancel()}},[this.targetIdState.get]),this.createEffect(()=>{const t=this.targetState.get();if(!t)return;const r=Ri(()=>{this.placeAt(iu(HC(t.nativeObject3d)))});return()=>{r.cancel()}},[this.targetState.get]),this.createEffect(()=>{const t=this.autoRotateState.get();if(Ut()!==e||!t)return;const r=typeof t=="number"?t:2,i=Ri(()=>{this.gyrate(r,0,!0)});return()=>{i.cancel()}},[Ut,this.autoRotateState.get]),this.createEffect(()=>{if(lu()||Ut()!==e||!this.mouseControlState.get())return;const t=new br;if(this.enableZoomState.get()){const r=i=>{i.preventDefault(),this.innerZ+=i.deltaY,this.innerZ<0&&(this.innerZ=0)};Sr.addEventListener("wheel",r),t.then(()=>Sr.removeEventListener("wheel",r))}if(this.enableFlyState.get()){const r=new Set;t.watch(Ri(()=>{if(r.has("Meta")||r.has("Control"))return;const o=r.has("Shift")?50:10;if(r.has("w")?this.translateZ(-o):r.has("s")&&this.translateZ(o),r.has("a")||r.has("ArrowLeft")?this.moveRight(-o):(r.has("d")||r.has("ArrowRight"))&&this.moveRight(o),r.has("w")||r.has("s")||r.has("a")||r.has("d")){const a=iu(Kr(this.object3d));this.innerZ=0,this.placeAt(a)}r.has("Meta")||r.has("Control")||(r.has("ArrowDown")?this.y-=o:r.has("ArrowUp")&&(this.y+=o))}));const i=o=>{r.add(o.key.length===1?o.key.toLocaleLowerCase():o.key)},s=o=>{r.delete(o.key.length===1?o.key.toLocaleLowerCase():o.key)};document.addEventListener("keydown",i),document.addEventListener("keyup",s),t.watch(jL(()=>r.clear())),t.then(()=>{document.removeEventListener("keydown",i),document.removeEventListener("keyup",s)})}return()=>{t.cancel()}},[Ut,lu,this.enableZoomState.get,this.enableFlyState.get,this.mouseControlState.get])}get targetId(){return this.targetIdState.get()}set targetId(e){this.targetIdState.set(e)}get enableZoom(){return this.enableZoomState.get()}set enableZoom(e){this.enableZoomState.set(e)}get enableFly(){return this.enableFlyState.get()}set enableFly(e){this.enableFlyState.set(e)}get autoRotate(){return this.autoRotateState.get()}set autoRotate(e){this.autoRotateState.set(e)}}le(wM,"componentName","orbitCamera"),le(wM,"defaults",pre),le(wM,"schema",dre);const[hwe,dwe]=Bo(),[zX,pwe]=yt(0),Rl=new wM(yi);Rl.enableZoom=!0;Rl.enableFly=!0;Rl.mouseControl=!1;Ji.delete(Rl);dwe(n=>{const e=n.getWorldPosition();Rl.x=e.x,Rl.y=e.y,Rl.z=e.z;const t=$p(n);Rl.innerZ=Math.max(t.x,t.y,t.z,1)*Fs+50});tC(n=>{n||(Rl.setPolarAngle(90),Rl.setAzimuthAngle(90))});_n(()=>{if(!(!tC()||Ut()!==yi||lu()))return Rl.mouseControl="drag",Sr.style.cursor="grab",()=>{Rl.mouseControl=!1,Sr.style.cursor="auto"}},[tC,lu,Ut]);_n(()=>{if(Ut()!==yi||tC())return;const n=pwe(e=>Rl.innerZ=e);return()=>{n.cancel()}},[Ut,tC]);const[BX,xre]=Bo(),[XQe,VX]=yt(null),[eM,y0]=yt(su());_n(()=>{const n=ps(),e=su();if(!n||e==="select"){eM(e);return}if(!v0(n)){eM("select");return}if(!(n instanceof lb)){eM("translate");return}eM(e)},[su,ps]);const[iU,sU]=yt("world"),[oU,aU]=yt(sU());_n(()=>{su()==="scale"?oU("local"):oU(sU())},[sU,su]);const fwe=pL(async()=>{const{TransformControls:n}=await rr(()=>import("./TransformControls.133f3c87.5f79c7b9.js"),[]),e=new n(Ut(),Sr);Ut(r=>e.camera=r),e.enabled=!1;let t=!1;return e.addEventListener("dragging-changed",({value:r})=>{t=r,Fbe(t),BX(t?"start":"stop")}),e.addEventListener("change",()=>t&&BX("move")),e});_n(()=>{const n=ps();if(!n)return;let e=y0();e==="path"&&(e="translate");const t=aU(),r=VX(),i=new br;return fwe().then(s=>{i.done||!n.outerObject3d.parent||e!=="translate"&&e!=="rotate"&&e!=="scale"||(s.setMode(e),s.setSpace(t),s.setScaleSnap(r),s.setRotationSnap(r),s.setTranslationSnap(r),Qt.add(s),s.attach(n.outerObject3d),s.enabled=!0,i.then(()=>{Qt.remove(s),s.detach(),s.enabled=!1}))}),()=>{i.cancel()}},[ps,y0,aU,VX]);const[mwe,lU]=yt(!1),[vwe,cU]=yt(10);_n(()=>{if(!lU())return;const n=cU(),e=new xxe(n,n);return Qt.add(e),()=>{Qt.remove(e)}},[lU,cU]);const[qQe,HR]=yt(void 0),[YQe,FX]=yt(!1),Mg=new Io(new BC(wc,wc,4,4),mne);_n(()=>{var n;if(!FX()||Ut()!==yi)return;Qt.add(Mg);const[e,t]=(n=HR())!=null?n:Il();Mg.scale.x=e*nr,Mg.scale.y=t*nr;const r=Ri(()=>{Mg.quaternion.copy(yi.quaternion),Mg.position.copy(yi.position),Mg.translateZ(-4.9)});return()=>{r.cancel(),Qt.remove(Mg)}},[FX,HR,Il,Ut]);const[ZQe,gwe]=yt({turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.5,inclination:.49,azimuth:.25});class HL extends Io{constructor(){const e=HL.SkyShader,t=new Nr({name:"SkyShader",fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:aa.clone(e.uniforms),side:Ol,depthWrite:!1});super(new A0(1,1,1),t),this.isSky=!0}}HL.SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new ye},up:{value:new ye(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPos );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <encodings_fragment>

		}`};const[_we,ywe]=yt(!1),UX=pL(()=>{const n=new HL;return n.scale.setScalar(45e4),gwe(e=>{const{uniforms:t}=n.material;t.turbidity.value=e.turbidity,t.rayleigh.value=e.rayleigh,t.mieCoefficient.value=e.mieCoefficient,t.mieDirectionalG.value=e.mieDirectionalG;const r=Math.PI*(e.inclination-.5),i=2*Math.PI*(e.azimuth-.5);Pi.x=Math.cos(i),Pi.y=Math.sin(i)*Math.sin(r),Pi.z=Math.sin(i)*Math.cos(r),t.sunPosition.value.copy(Pi)}),n});let jX=!1;ywe(n=>{jX!==n&&(jX=n,n?Qt.add(UX()):Qt.remove(UX()))});const[xwe,HX]=yt(!1),[bwe,WX]=yt(!1),GX=(n,e)=>Math.abs(n*.5/Math.cos(e.fov*.6*Bs));_n(()=>{var n;const[e,t]=(n=HR())!=null?n:Il(),[r,i,s]=W6(Ut()),o={width:r,height:t-(e-r)*t/e},a={width:e-(t-i)*e/t,height:i},c=Math.min(r-o.width,i-o.height),u=Math.min(r-a.width,i-a.height);c>u?zX(GX(e/s,yi)):zX(GX(t,yi))},[Il,HR,Ut,hx]);const[wwe,uU]=yt(!1),XX={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Xt(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class px extends cd{constructor(e,t,r,i){super(),this.strength=t!==void 0?t:1,this.radius=r,this.threshold=i,this.resolution=e!==void 0?new ot(e.x,e.y):new ot(256,256),this.clearColor=new Xt(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Ei(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let p=0;p<this.nMips;p++){const f=new Ei(s,o);f.texture.name="UnrealBloomPass.h"+p,f.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(f);const v=new Ei(s,o);v.texture.name="UnrealBloomPass.v"+p,v.texture.generateMipmaps=!1,this.renderTargetsVertical.push(v),s=Math.round(s/2),o=Math.round(o/2)}XX===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=XX;this.highPassUniforms=aa.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Nr({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let p=0;p<this.nMips;p++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[p])),this.separableBlurMaterials[p].uniforms.texSize.value=new ot(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const u=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=u,this.bloomTintColors=[new ye(1,1,1),new ye(1,1,1),new ye(1,1,1),new ye(1,1,1),new ye(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,gc===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const d=gc;this.copyUniforms=aa.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Nr({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:TR,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Xt,this.oldClearAlpha=1,this.basic=new eb,this.fsQuad=new R0(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(r,i);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(r,i),this.renderTargetsVertical[s].setSize(r,i),this.separableBlurMaterials[s].uniforms.texSize.value=new ot(r,i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=px.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[c]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=px.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[c]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new Nr({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new ot(.5,.5)},direction:{value:new ot(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Nr({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}px.BlurDirectionX=new ot(1,0);px.BlurDirectionY=new ot(0,1);const[Swe,H9]=yt(0),[Mwe,W9]=yt(.5),[Cwe,G9]=yt(0),fx=new px(new ot,W9(),H9(),G9());H9(n=>fx.radius=n);W9(n=>fx.strength=n);G9(n=>fx.threshold=n);class Ewe extends cd{constructor(e,t,r,i,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s!==void 0?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Xt}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=i}}const WR=new Ewe(Qt,Ut());Ut(n=>WR.camera=n);_n(()=>{const n=ux();if(n)return n.addPass(WR),n.addPass(fx),()=>{n.removePass(WR),n.removePass(fx)}},[ux]);const bre=new cx(new Nr({uniforms:{baseTexture:{value:null},bloomTexture:{value:null}},vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,fragmentShader:`
            uniform sampler2D baseTexture;
            uniform sampler2D bloomTexture;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(baseTexture, vUv) + texture2D(bloomTexture, vUv);
            }
        `,defines:{}}),"baseTexture"),{uniforms:Awe}=bre;ux(n=>n&&(Awe.bloomTexture.value=n.renderTarget2.texture));const[Pwe,wre]=yt(.8),[Twe,Sre]=yt(.01),Mre=new cx(new Nr({defines:{BAND_MODE:2,CHROMA_SAMPLES:1},uniforms:{tDiffuse:{value:null},baseIor:{value:.8},bandOffset:{value:.01},jitterIntensity:{value:1},jitterOffset:{value:0}},vertexShader:`

		varying vec2 vUv;
		varying vec3 viewDir;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			viewDir = normalize( ( modelViewMatrix * vec4( position, 1.0 ) ).xyz );

		}

	`,fragmentShader:`

		varying vec2 vUv;
		varying vec3 viewDir;
		uniform float baseIor;
		uniform float bandOffset;
		uniform float jitterIntensity;
		uniform float jitterOffset;
		uniform sampler2D tDiffuse;

		#include <common>
		void main() {

			vec3 normal = vec3( ( 2.0 * vUv - vec2( 1.0 ) ), 1.0 );
			normal.z = 1.0;
			normal = normalize( normal );

			vec3 color;

			// if NO BANDS
			#if BAND_MODE == 0

			vec3 refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor );
			color = texture2D( tDiffuse, vUv + refracted.xy ).rgb;

			// if RGB or RYGCBV BANDS
			#else

			float index, randValue, offsetValue;
			float r, g, b, r_ior, g_ior, b_ior;
			vec3 r_refracted, g_refracted, b_refracted;
			vec4 r_sample, g_sample, b_sample;

			#if BAND_MODE == 2
			float y, c, v, y_ior, c_ior, v_ior;
			vec3 y_refracted, c_refracted, v_refracted;
			vec4 y_sample, c_sample, v_sample;
			#endif

			for ( int i = 0; i < CHROMA_SAMPLES; i ++ ) {

				index = float( i );
				randValue = rand( sin( index + 1. ) * gl_FragCoord.xy + vec2( jitterOffset, - jitterOffset ) ) - 0.5;
				offsetValue = index / float( CHROMA_SAMPLES ) + randValue * jitterIntensity;
				#if BAND_MODE == 1
				randValue *= 2.0;
				#endif

				// Paper describing functions for creating yellow, cyan, and violet bands and reforming
				// them into RGB:
				// https://web.archive.org/web/20061108181225/http://home.iitk.ac.in/~shankars/reports/dispersionraytrace.pdf
				r_ior = 1.0 + bandOffset * ( 0.0 + offsetValue );
				g_ior = 1.0 + bandOffset * ( 2.0 + offsetValue );
				b_ior = 1.0 + bandOffset * ( 4.0 + offsetValue );

				r_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / r_ior );
				g_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / g_ior );
				b_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / b_ior );

				r_sample = texture2D( tDiffuse, vUv + r_refracted.xy );
				g_sample = texture2D( tDiffuse, vUv + g_refracted.xy );
				b_sample = texture2D( tDiffuse, vUv + b_refracted.xy );

				#if BAND_MODE == 2
				y_ior = 1.0 + bandOffset * ( 1.0 + offsetValue );
				c_ior = 1.0 + bandOffset * ( 3.0 + offsetValue );
				v_ior = 1.0 + bandOffset * ( 5.0 + offsetValue );

				y_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / y_ior );
				c_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / c_ior );
				v_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / v_ior );

				y_sample = texture2D( tDiffuse, vUv + y_refracted.xy );
				c_sample = texture2D( tDiffuse, vUv + c_refracted.xy );
				v_sample = texture2D( tDiffuse, vUv + v_refracted.xy );

				r = r_sample.r / 2.0;
				y = ( 2.0 * y_sample.r + 2.0 * y_sample.g - y_sample.b ) / 6.0;
				g = g_sample.g / 2.0;
				c = ( 2.0 * c_sample.g + 2.0 * c_sample.b - c_sample.r ) / 6.0;
				b = b_sample.b / 2.0;
				v = ( 2.0 * v_sample.b + 2.0 * v_sample.r - v_sample.g ) / 6.0;

				color.r += r + ( 2.0 * v + 2.0 * y - c ) / 3.0;
				color.g += g + ( 2.0 * y + 2.0 * c - v ) / 3.0;
				color.b += b + ( 2.0 * c + 2.0 * v - y ) / 3.0;
				#else
				color.r += r_sample.r;
				color.g += g_sample.g;
				color.b += b_sample.b;
				#endif

			}

			color /= float( CHROMA_SAMPLES );

			#endif

			gl_FragColor = vec4( color, 1.0 );

		}

	`})),{uniforms:Cre}=Mre;wre(n=>Cre.baseIor.value=n);Sre(n=>Cre.bandOffset.value=n);const[Rwe,hU]=yt(!1),[Owe,nC]=yt("MSAA"),[qX,mx]=yt(void 0);_n(()=>{const n=xi();if(!n)return;if(nC()!=="MSAA"||!n.capabilities.isWebGL2){qX(new B6(n));return}const e=new Ei(S9,M9,{samples:4}),t=Il(([r,i])=>e.setSize(r,i));return qX(new B6(n,e)),()=>{e.dispose(),t.cancel()}},[xi,nC]);_n(()=>{const n=mx();if(!n)return;const[e,t]=Il();n.setSize(e,t),n.setPixelRatio(Math.min(g0(),devicePixelRatio))},[mx,Il,g0]);class Lwe extends cd{constructor(e){super(),gc===void 0&&console.error("THREE.SavePass relies on CopyShader");const t=gc;this.textureID="tDiffuse",this.uniforms=aa.clone(t.uniforms),this.material=new Nr({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Ei(window.innerWidth,window.innerHeight),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new R0(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}}const Dwe={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;
		uniform float mixRatio;

		uniform sampler2D tDiffuse1;
		uniform sampler2D tDiffuse2;

		varying vec2 vUv;

		void main() {

			vec4 texel1 = texture2D( tDiffuse1, vUv );
			vec4 texel2 = texture2D( tDiffuse2, vUv );
			gl_FragColor = mix( texel1, texel2, mixRatio );
			gl_FragColor.a *= opacity;

		}`},[Iwe,Ere]=yt(.5),Are=new Lwe,X9=new cx(Dwe,"tDiffuse1");X9.uniforms.tDiffuse2.value=Are.renderTarget.texture;Ere(n=>X9.uniforms.mixRatio.value=n);const Pre=new cx(gc);Pre.renderToScreen=!0;const Nwe=[X9,Are,Pre],[kwe,dU]=yt(!1),[zwe,GR]=yt(!1),gS={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new ot(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new zn},cameraInverseProjectionMatrix:{value:new zn},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		#if DIFFUSE_TEXTURE == 1
		uniform sampler2D tDiffuse;
		#endif

		uniform sampler2D tDepth;

		#if NORMAL_TEXTURE == 1
		uniform sampler2D tNormal;
		#endif

		uniform float cameraNear;
		uniform float cameraFar;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;

		uniform float scale;
		uniform float intensity;
		uniform float bias;
		uniform float kernelRadius;
		uniform float minResolution;
		uniform vec2 size;
		uniform float randomSeed;

		// RGBA depth

		#include <packing>

		vec4 getDefaultColor( const in vec2 screenPosition ) {
			#if DIFFUSE_TEXTURE == 1
			return texture2D( tDiffuse, vUv );
			#else
			return vec4( 1.0 );
			#endif
		}

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {
			float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];
			vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );
			clipPosition *= clipW; // unprojection.

			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;
		}

		vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {
			#if NORMAL_TEXTURE == 1
			return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );
			#else
			return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );
			#endif
		}

		float scaleDividedByCameraFar;
		float minResolutionMultipliedByCameraFar;

		float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {
			vec3 viewDelta = sampleViewPosition - centerViewPosition;
			float viewDistance = length( viewDelta );
			float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;

			return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );
		}

		// moving costly divides into consts
		const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
		const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

		float getAmbientOcclusion( const in vec3 centerViewPosition ) {
			// precompute some variables require in getOcclusion.
			scaleDividedByCameraFar = scale / cameraFar;
			minResolutionMultipliedByCameraFar = minResolution * cameraFar;
			vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );

			// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
			float angle = rand( vUv + randomSeed ) * PI2;
			vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;
			vec2 radiusStep = radius;

			float occlusionSum = 0.0;
			float weightSum = 0.0;

			for( int i = 0; i < NUM_SAMPLES; i ++ ) {
				vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;
				radius += radiusStep;
				angle += ANGLE_STEP;

				float sampleDepth = getDepth( sampleUv );
				if( sampleDepth >= ( 1.0 - EPSILON ) ) {
					continue;
				}

				float sampleViewZ = getViewZ( sampleDepth );
				vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );
				occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );
				weightSum += 1.0;
			}

			if( weightSum == 0.0 ) discard;

			return occlusionSum * ( intensity / weightSum );
		}

		void main() {
			float centerDepth = getDepth( vUv );
			if( centerDepth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = getViewZ( centerDepth );
			vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );

			float ambientOcclusion = getAmbientOcclusion( viewPosition );

			gl_FragColor = getDefaultColor( vUv );
			gl_FragColor.xyz *=  1.0 - ambientOcclusion;
		}`},up={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new ot(512,512)},sampleUvOffsets:{value:[new ot(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:`

		#include <common>

		uniform vec2 size;

		varying vec2 vUv;
		varying vec2 vInvSize;

		void main() {
			vUv = uv;
			vInvSize = 1.0 / size;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>
		#include <packing>

		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform float depthCutoff;

		uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];
		uniform float sampleWeights[ KERNEL_RADIUS + 1 ];

		varying vec2 vUv;
		varying vec2 vInvSize;

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		void main() {
			float depth = getDepth( vUv );
			if( depth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = -getViewZ( depth );
			bool rBreak = false, lBreak = false;

			float weightSum = sampleWeights[0];
			vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;

			for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {

				float sampleWeight = sampleWeights[i];
				vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;

				vec2 sampleUv = vUv + sampleUvOffset;
				float viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;

				if( ! rBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

				sampleUv = vUv - sampleUvOffset;
				viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;

				if( ! lBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

			}

			gl_FragColor = diffuseSum / weightSum;
		}`},XR={createSampleWeights:function(n,e){const t=[];for(let r=0;r<=n;r++)t.push(Bwe(r,e));return t},createSampleOffsets:function(n,e){const t=[];for(let r=0;r<=n;r++)t.push(e.clone().multiplyScalar(r));return t},configure:function(n,e,t,r){n.defines.KERNEL_RADIUS=e,n.uniforms.sampleUvOffsets.value=XR.createSampleOffsets(e,r),n.uniforms.sampleWeights.value=XR.createSampleWeights(e,t),n.needsUpdate=!0}};function Bwe(n,e){return Math.exp(-(n*n)/(2*(e*e)))/(Math.sqrt(2*Math.PI)*e)}const pP={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		#include <packing>

		void main() {

			float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );
			gl_FragColor = vec4( vec3( depth ), opacity );

		}`};class Tre extends cd{constructor(e,t,r=!1,i=!1,s=new ot(256,256)){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=r,this.supportsNormalTexture=i,this.originalClearColor=new Xt,this._oldClearColor=new Xt,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new ot(s.x,s.y),this.saoRenderTarget=new Ei(this.resolution.x,this.resolution.y),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Ei(this.resolution.x,this.resolution.y,{minFilter:us,magFilter:us}),this.depthRenderTarget=this.normalRenderTarget.clone();let o;this.supportsDepthTextureExtension&&(o=new Rte,o.type=Wj,this.beautyRenderTarget.depthTexture=o,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new _L,this.depthMaterial.depthPacking=mL,this.depthMaterial.blending=ks,this.normalMaterial=new Oye,this.normalMaterial.blending=ks,gS===void 0&&console.error("THREE.SAOPass relies on SAOShader"),this.saoMaterial=new Nr({defines:Object.assign({},gS.defines),fragmentShader:gS.fragmentShader,vertexShader:gS.vertexShader,uniforms:aa.clone(gS.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=ks,up===void 0&&console.error("THREE.SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new Nr({uniforms:aa.clone(up.uniforms),defines:Object.assign({},up.defines),vertexShader:up.vertexShader,fragmentShader:up.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=ks,this.hBlurMaterial=new Nr({uniforms:aa.clone(up.uniforms),defines:Object.assign({},up.defines),vertexShader:up.vertexShader,fragmentShader:up.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=ks,gc===void 0&&console.error("THREE.SAOPass relies on CopyShader"),this.materialCopy=new Nr({uniforms:aa.clone(gc.uniforms),vertexShader:gc.vertexShader,fragmentShader:gc.fragmentShader,blending:ks}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=v6,this.materialCopy.blendSrc=dte,this.materialCopy.blendDst=g6,this.materialCopy.blendEquation=cm,this.materialCopy.blendSrcAlpha=hte,this.materialCopy.blendDstAlpha=g6,this.materialCopy.blendEquationAlpha=cm,pP===void 0&&console.error("THREE.SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new Nr({uniforms:aa.clone(pP.uniforms),vertexShader:pP.vertexShader,fragmentShader:pP.fragmentShader,blending:ks}),this.fsQuad=new R0(null)}render(e,t,r){if(this.renderToScreen&&(this.materialCopy.blending=ks,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),this.params.output===1)return;e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const i=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const s=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=s,this.hBlurMaterial.uniforms.depthCutoff.value=s,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(XR.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ot(0,1)),XR.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ot(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let o=this.materialCopy;this.params.output===3?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,o=this.depthCopy):this.params.output===4?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===0?o.blending=v6:o.blending=ks,this.renderPass(e,o,this.renderToScreen?null:r),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=i}renderPass(e,t,r,i,s){e.getClearColor(this.originalClearColor);const o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,i!=null&&(e.setClearColor(i),e.setClearAlpha(s||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)}renderOverride(e,t,r,i,s){e.getClearColor(this.originalClearColor);const o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,i=t.clearColor||i,s=t.clearAlpha||s,i!=null&&(e.setClearColor(i),e.setClearAlpha(s||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)}setSize(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}Tre.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4};const Rh=new Tre(Qt,Ut(),!1,!0);Rh.params.saoKernelRadius=80;Rh.params.saoBlurStdDev=5;GR(n=>Rh.params.saoScale=n==="light"?3e3:2e3);Ut(n=>{Rh.camera=n,Rh.saoMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,Rh.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(n.projectionMatrixInverse),Rh.saoMaterial.uniforms.cameraProjectionMatrix.value=n.projectionMatrix,Rh.vBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,Rh.hBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0});const YX={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		uniform sampler2D tColor;
		uniform sampler2D tDepth;

		uniform float maxblur; // max blur amount
		uniform float aperture; // aperture - bigger values for shallower depth of field

		uniform float nearClip;
		uniform float farClip;

		uniform float focus;
		uniform float aspect;

		#include <packing>

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, nearClip, farClip );
			#else
			return orthographicDepthToViewZ( depth, nearClip, farClip );
			#endif
		}


		void main() {

			vec2 aspectcorrect = vec2( 1.0, aspect );

			float viewZ = getViewZ( getDepth( vUv ) );

			float factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation

			vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );

			vec2 dofblur9 = dofblur * 0.9;
			vec2 dofblur7 = dofblur * 0.7;
			vec2 dofblur4 = dofblur * 0.4;

			vec4 col = vec4( 0.0 );

			col += texture2D( tColor, vUv.xy );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );

			gl_FragColor = col / 41.0;
			gl_FragColor.a = 1.0;

		}`};class Vwe extends cd{constructor(e,t,r){super(),this.scene=e,this.camera=t;const i=r.focus!==void 0?r.focus:1,s=r.aspect!==void 0?r.aspect:t.aspect,o=r.aperture!==void 0?r.aperture:.025,a=r.maxblur!==void 0?r.maxblur:1,c=r.width||window.innerWidth||1,u=r.height||window.innerHeight||1;this.renderTargetDepth=new Ei(c,u,{minFilter:us,magFilter:us}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new _L,this.materialDepth.depthPacking=mL,this.materialDepth.blending=ks,YX===void 0&&console.error("THREE.BokehPass relies on BokehShader");const d=YX,p=aa.clone(d.uniforms);p.tDepth.value=this.renderTargetDepth.texture,p.focus.value=i,p.aspect.value=s,p.aperture.value=o,p.maxblur.value=a,p.nearClip.value=t.near,p.farClip.value=t.far,this.materialBokeh=new Nr({defines:Object.assign({},d.defines),uniforms:p,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}),this.uniforms=p,this.needsSwap=!1,this.fsQuad=new R0(this.materialBokeh),this._oldClearColor=new Xt}render(e,t,r){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const i=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(i),e.autoClear=s}}const q9=new Vwe(Qt,Ut(),{}),ky=q9.uniforms;Ut(n=>{q9.camera=n,ky.aspect.value=n.aspect,ky.nearClip.value=n.near,ky.farClip.value=n.far});cre(n=>ky.focus.value=n);are(n=>ky.aperture.value=n);hre(n=>ky.maxblur.value=n);const _S={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new ot(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		void SMAAEdgeDetectionVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAAEdgeDetectionVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
			vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );

			// Calculate color deltas:
			vec4 delta;
			vec3 C = texture2D( colorTex, texcoord ).rgb;

			vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
			vec3 t = abs( C - Cleft );
			delta.x = max( max( t.r, t.g ), t.b );

			vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
			t = abs( C - Ctop );
			delta.y = max( max( t.r, t.g ), t.b );

			// We do the usual threshold:
			vec2 edges = step( threshold, delta.xy );

			// Then discard if there is no edge:
			if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
				discard;

			// Calculate right and bottom deltas:
			vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
			t = abs( C - Cright );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
			t = abs( C - Cbottom );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the maximum delta in the direct neighborhood:
			float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

			// Calculate left-left and top-top deltas:
			vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
			t = abs( C - Cleftleft );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
			t = abs( C - Ctoptop );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the final maximum delta:
			maxDelta = max( max( maxDelta, delta.z ), delta.w );

			// Local contrast adaptation in action:
			edges.xy *= step( 0.5 * maxDelta, delta.xy );

			return vec4( edges, 0.0, 0.0 );
		}

		void main() {

			gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );

		}`},fP={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new ot(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];
		varying vec2 vPixcoord;

		void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
			vPixcoord = texcoord / resolution;

			// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components

			// And these for the searches, they indicate the ends of the loops:
			vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );

		}

		void main() {

			vUv = uv;

			SMAABlendingWeightCalculationVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )

		uniform sampler2D tDiffuse;
		uniform sampler2D tArea;
		uniform sampler2D tSearch;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[3];
		varying vec2 vPixcoord;

		#if __VERSION__ == 100
		vec2 round( vec2 x ) {
			return sign( x ) * floor( abs( x ) + 0.5 );
		}
		#endif

		float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
			// Not required if searchTex accesses are set to point:
			// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);
			// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +
			//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;
			e.r = bias + e.r * scale;
			return 255.0 * texture2D( searchTex, e, 0.0 ).r;
		}

		float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			/**
				* @PSEUDO_GATHER4
				* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to
				* sample between edge, thus fetching four edges in a row.
				* Sampling with different offsets in each direction allows to disambiguate
				* which edges are active from the four fetched ones.
				*/
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			// We correct the previous (-0.25, -0.125) offset we applied:
			texcoord.x += 0.25 * resolution.x;

			// The searches are bias by 1, so adjust the coords accordingly:
			texcoord.x += resolution.x;

			// Disambiguate the length added by the last step:
			texcoord.x += 2.0 * resolution.x; // Undo last step
			texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);

			return texcoord.x;
		}

		float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			texcoord.x -= 0.25 * resolution.x;
			texcoord.x -= resolution.x;
			texcoord.x -= 2.0 * resolution.x;
			texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );

			return texcoord.x;
		}

		float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y; // WebGL port note: Changed sign
			texcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y; // WebGL port note: Changed sign
			texcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
			// Rounding prevents precision errors of bilinear filtering:
			vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;

			// We do a scale and bias for mapping to texel space:
			texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );

			// Move to proper place, according to the subpixel offset:
			texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;

			return texture2D( areaTex, texcoord, 0.0 ).rg;
		}

		vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
			vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );

			vec2 e = texture2D( edgesTex, texcoord ).rg;

			if ( e.g > 0.0 ) { // Edge at north
				vec2 d;

				// Find the distance to the left:
				vec2 coords;
				coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
				coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)
				d.x = coords.x;

				// Now fetch the left crossing edges, two at a time using bilinear
				// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to
				// discern what value each edge has:
				float e1 = texture2D( edgesTex, coords, 0.0 ).r;

				// Find the distance to the right:
				coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
				d.y = coords.x;

				// We want the distances to be in pixel units (doing this here allow to
				// better interleave arithmetic and memory accesses):
				d = d / resolution.x - pixcoord.x;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the right crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;

				// Ok, we know how this pattern looks like, now it is time for getting
				// the actual area:
				weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
			}

			if ( e.r > 0.0 ) { // Edge at west
				vec2 d;

				// Find the distance to the top:
				vec2 coords;

				coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
				coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;
				d.x = coords.y;

				// Fetch the top crossing edges:
				float e1 = texture2D( edgesTex, coords, 0.0 ).g;

				// Find the distance to the bottom:
				coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
				d.y = coords.y;

				// We want the distances to be in pixel units:
				d = d / resolution.y - pixcoord.y;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the bottom crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;

				// Get the area for this direction:
				weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
			}

			return weights;
		}

		void main() {

			gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );

		}`},B5={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new ot(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAANeighborhoodBlendingVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform sampler2D tColor;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
			// Fetch the blending weights for current pixel:
			vec4 a;
			a.xz = texture2D( blendTex, texcoord ).xz;
			a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
			a.w = texture2D( blendTex, offset[ 1 ].xy ).a;

			// Is there any blending weight with a value greater than 0.0?
			if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
				return texture2D( colorTex, texcoord, 0.0 );
			} else {
				// Up to 4 lines can be crossing a pixel (one through each edge). We
				// favor blending by choosing the line with the maximum weight for each
				// direction:
				vec2 offset;
				offset.x = a.a > a.b ? a.a : -a.b; // left vs. right
				offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs

				// Then we go in the direction that has the maximum weight:
				if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical
					offset.y = 0.0;
				} else {
					offset.x = 0.0;
				}

				// Fetch the opposite color and lerp by hand:
				vec4 C = texture2D( colorTex, texcoord, 0.0 );
				texcoord += sign( offset ) * resolution;
				vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
				float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );

				// WebGL port note: Added gamma correction
				C.xyz = pow(C.xyz, vec3(2.2));
				Cop.xyz = pow(Cop.xyz, vec3(2.2));
				vec4 mixed = mix(C, Cop, s);
				mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));

				return mixed;
			}
		}

		void main() {

			gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );

		}`};class Fwe extends cd{constructor(e,t){super(),this.edgesRT=new Ei(e,t,{depthBuffer:!1}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Ei(e,t,{depthBuffer:!1}),this.weightsRT.texture.name="SMAAPass.weights";const r=this,i=new Image;i.src=this.getAreaTexture(),i.onload=function(){r.areaTexture.needsUpdate=!0},this.areaTexture=new da,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=i,this.areaTexture.minFilter=Vs,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){r.searchTexture.needsUpdate=!0},this.searchTexture=new da,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=us,this.searchTexture.minFilter=us,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,_S===void 0&&console.error("THREE.SMAAPass relies on SMAAShader"),this.uniformsEdges=aa.clone(_S.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new Nr({defines:Object.assign({},_S.defines),uniforms:this.uniformsEdges,vertexShader:_S.vertexShader,fragmentShader:_S.fragmentShader}),this.uniformsWeights=aa.clone(fP.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Nr({defines:Object.assign({},fP.defines),uniforms:this.uniformsWeights,vertexShader:fP.vertexShader,fragmentShader:fP.fragmentShader}),this.uniformsBlend=aa.clone(B5.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Nr({uniforms:this.uniformsBlend,vertexShader:B5.vertexShader,fragmentShader:B5.fragmentShader}),this.needsSwap=!1,this.fsQuad=new R0(null)}render(e,t,r){this.uniformsEdges.tDiffuse.value=r.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=r.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}}const Uwe=new Fwe(S9,M9);_n(()=>{var n;const e=mx();if(!e)return;const t=[WR];if(GR()&&t.push(Rh),uU()&&t.push(fx),WX()&&t.push(bre),nU()&&t.push(q9),HX()&&t.push(Yh),hU()&&t.push(Mre),dU())for(const i of Nwe)t.push(i);const r=nC();(r==="SMAA"||r==="MSAA"&&!((n=xi())!=null&&n.capabilities.isWebGL2))&&t.push(Uwe);for(const i of t)e.addPass(i);return()=>{for(const i of t)e.removePass(i)}},[mx,GR,uU,WX,nU,HX,hU,dU,nC,xi]);const[V5,Rre]=Bo();_n(()=>{const n=xi();if(!n)return;const e=Ut(),t=VR();if(t){const[a,c]=Il(),u=a*1,d=c*.5;t.aspect=e.aspect=u/d,e.updateProjectionMatrix(),t.updateProjectionMatrix();const p=L5(()=>{P5(),V5(),n.setViewport(0,0,u,d),n.setScissor(0,0,u,d),n.setScissorTest(!0),n.render(Qt,t),n.setViewport(0,d,u,d),n.setScissor(0,d,u,d),n.render(Qt,e),O5()});return()=>{p.cancel(),n.setViewport(0,0,a,c),n.setScissor(0,0,a,c),n.setScissorTest(!1),e.aspect=a/c,e.updateProjectionMatrix()}}if(hx()){const a=L5(()=>{P5(),V5(),n.render(Qt,e),O5()});return()=>{a.cancel()}}const r=mx();if(!r)return;let i=!1,s=!1;const o=L5(()=>{P5(),V5(),Ene[0]&&(i||(bwe(!0),i=!0),gbe()),Ine[0]&&!s&&(xwe(!0),s=!0),r.render(),O5()});return()=>{o.cancel()}},[hx,Ut,VR,Il,xi,mx]);const jwe=new Map,Hwe=new Fye,Wwe=n=>hh(jwe,n.join(","),()=>Hwe.load(n,void 0,v9(n.join(",")))),[Gwe,pU]=yt(void 0),[Y9,rC]=yt([]),Xwe=Zx(Y9,rC),qwe=Kx(Y9,rC);_n(()=>{var n;const e=pU(),t=$M(),r=(n=Yx(rC()))==null?void 0:n.texture;if(r)if(Array.isArray(r))Qt.background=Wwe(r);else{let i=!0;const s=Aa(r,()=>i&&(Qt.background=s));return s.mapping=XM,()=>{i=!1}}else e?Qt.background=Aa(e):t?t==="transparent"?Qt.background=null:Qt.background=new Xt(t):Qt.background=new Xt("black")},[$M,pU,rC]);const[Z9,iC]=yt([]),Ywe=Zx(Z9,iC),Zwe=Kx(Z9,iC),Kwe=ste(Z9,iC),Ore={...ML,texture:String,helper:Boolean},Lre={...CL,texture:"studio",helper:!0},Dre=()=>{const n=new ym;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABjVJREFUaEPtWmvLVUUYXWu2VlaGUGGgZUWl3cvILhqlplYWkWVlfsofkHQhyEjRSCK64Q+wT2kkWpGWl7QIpRvZzUKxgi6SRUEX0yz3XvFsZl7G43vOmTnnmEEdEF/Onj3zrFnPZc0zh+jhRxJzpiOpnPGtxmYt3GoiSQXJMsewTt5pNn9PgBgTYXclDQBQAWg2t7HgSO4zo+J3czahcWzXQCSZUZWkWZLuB2CstJvXwBiDj5FcHOY4ZEDCbkoaImkHgCMzjdlNchjJn7tlpt3OtbQrYmOEpM88kGRGABiQs0h+1S0rvQIyXNI2D8Tcpt28YYwBGUny238LkBM9kEEWvxlA9ngg3/wPxDt/OxdoFyN12pVkjGzt0LXOJPn1oWakLoIeyBcABma61l6Sp5D87pAB8XLEakhZluUCkg/5GlIkpmDLbrYRD5B81Kq8FdJOZUtHrhXn/AhEov19w/qSgqQFRVHM66bSdwqkruZlWT5J8u5IkuTOZ2BqySLpqaIo7unUxXIXNm00wHSSpHslPQ7gLwCmr7Ln8twYENNdA0neR/KJsEYOxVmLB7UqabSk9yNDsubpx8A+NyN5EcnNuco4y4AQG1VVbQQw1u+ksdGLj7Fic21yzo3L1V7JQCI2Jklam5mhUoGGTDaZ5LocVrKBlGW5lOTtPWYjAK1ZkfRcURQzeg4kkuuDJW0HMDSx8KUyEcaFWPme5Okkf0t1sSRGIrl+vqQPc63rZDzJC0h+lJqOU4EEKXKNpFcPUnwEvCFOriW5OtW9UoGE2nGHpGf/ISAzSS5JrSn/OSDBtSZIWu8lievE9xPesQ6MSaCJJDf02rVCp2SYPwkedZCz1u/+5Lijp8Eeq9Kqqt4FcPFBipM60AG855wbk5p6zb6kGPFAQsDPlTTfi0U7SPXyYwLUxOM8kgtSAz0XSHCvk/yxNrXRkAo0FENrSIzKPf4mMxKzUpblIyTn9JiVmg1JC4uieDCHjSxG4jiRdJikjwGM7BGYGgSAbSTPI/lnTnx0AsRSrnWsrXNyoSQLfJPewZBUN4rHhXf3kRxD8gPfD7AOjaXipE+ya0V6y2LjWN8dHCtpHQD7Lvek2HcyBGBxMYnkJknDAfxEck9q6k1mJJ6wqqqVAM4hOYHkl5JGSVpm3/mtMyluGxT+xTsazuj2fziQbSE5neRWSadK2gBgi3Pueu/OdZJpR0tbRhpArABwk1/gmaIoZvm/LffPkXQXgOPaLeqf/0hyEYCF4YKoLMvFJO/0z19wzk1LBdMSSDMQANaTnEpyryTL++ZW1pg4BsB0SVMBnAvgBABHeMP+ALATwCckVwFYRvJX/149h6TDJdmziblgmgJpAeIN71YW8EGDjQAwjqQp4/pjAC2WABztv9rlfb8G7cfMBLDRXyuEuSyTmHtdlQOmXyBx6quqajmAmmIA+4GwOLDWUFmW80nOBbCZpJ0jfmjlXpKGSnoFgHVj6uacv7KzjGgt2EYwK5xzN3vwfdd88RoHAGkA8TKAOugaQQS/9jXlUwCn2e46566ImLrUzt/2sp3zSb4dnlVVtQnA5QA+J3m21Q5vaDNmVjrnbmgGpiUjkoKu2uCcq/02MjJoL4uJ572xt5Bcbr7u4+dqn54NiKXX16Jnt0UgbyW5LGr+9d0QV1VlxwbLkEF/pTHSiFiS+fEqf8/Xt0CIoaqq1gCYDGA7SUvLVpUDyPHe3w2IGfN69GyQv647GcBa59yUOC6jDRsCwBJLHX/NKn5y1mpYJAhIa0Zs9gehuSQfbvD1/oBYqg6xFTSbdeFHNzYb+luzWeyl1JED2v1hV8uyfJrkbAC7vJ/XFzbeUAvaZkAsqO1K+wyv2SztLiqKYnajWIyvL1olkLZAGl+OpIqdFrcAsKvpJUVRzIzcIQRsv0B8ZqrHVFX1IoAbAfziNyP5VNgya7VC3RDsl0l6CcDxJK8k+WYnQCRd54vgTpLTSL6Vo7GCvdmMxAEnaTCA8QBWh/TZALa/rLXfb1Yk2Y8MpgBYQ3J3rnzvCkir7NEA5BJJS31qnkHynVZdkU5B1PO3c6U2Fdrer+8R+xsXAtU/a3o/2O39YddAutmEXr/bFSMpxoQfo3V6W5uyho35G4LD428xBkRwAAAAAElFTkSuQmCC",Ji.delete(n),n.scale=.5,n};class SM extends OL{constructor(){super(),le(this,"_texture","studio"),le(this,"helperState",new nn(!0)),Qt.add(this.outerObject3d),Ywe(this),this.createEffect(()=>{if(Ut()!==yi||!this.helperState.get())return;const e=Dre(),t=Qp(({target:r})=>{r===e&&Ki(this)});return this.outerObject3d.add(e.outerObject3d),()=>{t.cancel(),e.dispose()}},[Ut,this.helperState.get])}dispose(){return this.done?this:(super.dispose(),Zwe(this),this)}get texture(){return this._texture}set texture(e){this._texture=e,Kwe()}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}}le(SM,"componentName","environment"),le(SM,"defaults",Lre),le(SM,"schema",Ore);const[Jwe,fU]=yt("default"),zy=new SM;zy.texture=void 0;Ji.delete(zy);zy.helper=!1;const Ire=new Jj(256),F5=new Zj(Wm,eu,Ire);_n(()=>{const n=Yx(iC()),e=xi();if(!(n!=null&&n.texture)||!e)return;if(n.texture==="dynamic"){const i=_ne(()=>{F5.position.copy(n.outerObject3d.position),F5.matrixWorld.copy(n.outerObject3d.matrixWorld),F5.update(e,Qt)});return Qt.environment=Ire.texture,()=>{i.cancel(),Qt.environment=null}}let t=!0;const r=Aa(n.texture==="studio"?A9+"studio.jpg":n.texture,()=>t&&(Qt.environment=r));return r.mapping=XM,()=>{t=!1,Qt.environment=null}},[iC,xi]);_n(()=>{const n=fU();if(!n)return;if(typeof n=="string"&&n!=="default")return n==="dynamic"?zy.texture="dynamic":zy.texture=n,()=>{zy.texture=void 0};const e=new br;return Promise.resolve().then(()=>DLe).then(t=>{const r=t.default,i=new r;Ji.delete(i),i.helper=!1,i.groundColor="#666666",e.then(()=>i.dispose())}),Promise.resolve().then(()=>LLe).then(t=>{const r=t.default,i=new r;if(Ji.delete(i),i.helper=!1,i.y=eu,i.z=eu,i.intensity=.5,e.then(()=>i.dispose()),!Gp())return;const s=new r;Ji.delete(s),s.helper=!1,s.y=-eu,s.z=-eu,s.intensity=.5,e.then(()=>s.dispose())}),()=>{e.cancel()}},[fU,Gp]);const Nre={...jm,texture:[String,Array]},kre={...Hm,texture:void 0};class MM extends Jp{constructor(){super(),le(this,"_texture"),Xwe(this)}dispose(){return this.done?this:(super.dispose(),qwe(this),this)}get texture(){return this._texture}set texture(e){this._texture=e,Y9([...rC()])}}le(MM,"componentName","skybox"),le(MM,"defaults",kre),le(MM,"schema",Nre);const[Qwe,$we]=yt(0),[e1e,mU]=yt(void 0),[t1e,vU]=yt(void 0),[n1e,gU]=yt(void 0),_U=new MM;Ji.delete(_U);const K9={get defaultLight(){return fU()},set defaultLight(n){Jwe(n)},get shadowResolution(){return gU()},set shadowResolution(n){n1e(n)},get shadowBias(){return mU()},set shadowBias(n){e1e(n)},get shadowDistance(){return vU()},set shadowDistance(n){t1e(n)},get skybox(){return _U.texture},set skybox(n){_U.texture=n},get gridHelper(){return lU()},set gridHelper(n){mwe(n)},get gridHelperSize(){return cU()},set gridHelperSize(n){vwe(n)},get gravity(){return Qne()},set gravity(n){Jbe(n)},get repulsion(){return $we()},set repulsion(n){Qwe(n)},get centripetal(){return Gp()},set centripetal(n){qbe(n)},get antiAlias(){return nC()},set antiAlias(n){Owe(n)},get pixelRatio(){return g0()},set pixelRatio(n){cbe(n)},get fps(){return N6()},set fps(n){Qxe(n)},get logarithmicDepth(){return I6()},set logarithmicDepth(n){Kxe(n)},get exposure(){return U6()},set exposure(n){_be(n)},get pbr(){return j6()},set pbr(n){ybe(n)},get bloom(){return uU()},set bloom(n){wwe(n)},get bloomStrength(){return W9()},set bloomStrength(n){Mwe(n)},get bloomRadius(){return H9()},set bloomRadius(n){Swe(n)},get bloomThreshold(){return G9()},set bloomThreshold(n){Cwe(n)},get ambientOcclusion(){return GR()},set ambientOcclusion(n){zwe(n)},get outlineColor(){return G6()},set outlineColor(n){Sbe(n)},get outlineHiddenColor(){return X6()},set outlineHiddenColor(n){Mbe(n)},get outlinePattern(){return q6()},set outlinePattern(n){Cbe(n)},get outlinePulse(){return One()},set outlinePulse(n){Ebe(n)},get outlineStrength(){return Lne()},set outlineStrength(n){Abe(n)},get outlineThickness(){return Dne()},set outlineThickness(n){Pbe(n)},get bokeh(){return nU()},set bokeh(n){sre(n)},get bokehAperture(){return are()},set bokehAperture(n){ore(n)},get bokehFocus(){return cre()},set bokehFocus(n){lre(n)},get bokehMaxBlur(){return hre()},set bokehMaxBlur(n){ure(n)},get lensDistortion(){return hU()},set lensDistortion(n){Rwe(n)},get lensIor(){return wre()},set lensIor(n){Pwe(n)},get lensBand(){return Sre()},set lensBand(n){Twe(n)},get motionBlur(){return dU()},set motionBlur(n){kwe(n)},get motionBlurStrength(){return Ere()},set motionBlurStrength(n){Iwe(n)},get texture(){return pU()},set texture(n){Gwe(n)},get color(){return $M()},set color(n){Zxe(n)}},XC={skybox:[String,Array],defaultLight:[String,Boolean],shadowDistance:Number,shadowResolution:Number,shadowBias:Number,gridHelper:Boolean,gridHelperSize:Number,gravity:Number,repulsion:Number,centripetal:Boolean,antiAlias:[Boolean,String],logarithmicDepth:Boolean,pixelRatio:Number,fps:Number,exposure:Number,pbr:Boolean,bloom:Boolean,bloomStrength:Number,bloomRadius:Number,bloomThreshold:Number,ambientOcclusion:[Boolean,String],outlineColor:String,outlineHiddenColor:String,outlinePattern:String,outlinePulse:Number,outlineStrength:Number,outlineThickness:Number,bokeh:Boolean,bokehAperture:Number,bokehFocus:Number,bokehMaxBlur:Number,lensDistortion:Boolean,lensIor:Number,lensBand:Number,motionBlur:Boolean,motionBlurStrength:Number,texture:String,color:String},Yu={...K9,shadowDistance:new Ti(bne),shadowResolution:new Ti(1024),shadowBias:new Ti(C9)},[J9,sC]=yt([]),r1e=Zx(J9,sC),i1e=Kx(J9,sC),zre=uu(ste(J9,sC),0,"trailing"),ra={get autoMount(){return H6()},set autoMount(n){bbe(n)},get firstLoadBeforeRender(){return k6()},set firstLoadBeforeRender(n){tbe(n)}},Bre={};for(const n of Object.keys(XC))Object.defineProperty(ra,n,{get(){return K9[n]},set(e){Bre[n]=e,zre()},enumerable:!0});const s1e=Object.fromEntries(Object.entries(Yu).map(([n,e])=>[n,e instanceof Ti?void 0:e]));_n(function(){const n={};for(const e of[s1e,...sC(),Bre])for(const[t,r]of Object.entries(e))r!==void 0&&(n[t]=r);Object.assign(K9,n)},[sC]);const qR=window;"__THREE__"in qR&&(qR.__THREE__+=" - Lingo3D Beta "+Cne);"__LINGO3D__"in qR&&console.warn("multiple versions of Lingo3D detected");qR.__LINGO3D__=!0;async function o1e(){const{Sphere:n}=await cb(),e=new n($p(this).x*.5);this.cannonBody.addShape(e)}const Q9=new o9(zp,32,32);class qC extends cu{constructor(){super(Q9),le(this,"_physicsShape",o1e)}}le(qC,"componentName","sphere");const a1e=Object.freeze(Object.defineProperty({__proto__:null,sphereGeometry:Q9,default:qC},Symbol.toStringTag,{value:"Module"})),l1e=new i9(zp,wc,16);class Vre extends cu{constructor(){super(l1e)}}le(Vre,"componentName","cone");async function c1e(){const{Cylinder:n}=await cb(),{x:e,y:t}=$p(this),r=e*.5,i=new n(r,r,t);this.cannonBody.addShape(i)}const u1e=new yL(zp,zp,wc,16);class WL extends cu{constructor(){super(u1e),le(this,"_physicsShape",c1e)}}le(WL,"componentName","cylinder");const h1e=new s9(zp);class Fre extends cu{constructor(){super(h1e)}}le(Fre,"componentName","octahedron");const GL=new a9(61*nr);GL.rotateY(45*Bs);GL.rotateX(125*Bs);GL.translate(0,-.2,.2);class Ure extends cu{constructor(){super(GL)}}le(Ure,"componentName","tetrahedron");async function d1e(){const{Box:n,Vec3:e}=await cb(),t=$p(this),r=t.clone().multiply(Pi.set(.15,.5,.1)),i=t.clone().multiply(Hxe.set(.5,.15,.1)),s=new n(r),o=new n(i);this.cannonBody.addShape(s,new e(-i.x,0,0)),this.cannonBody.addShape(s,new e(i.x,0,0)),this.cannonBody.addShape(o,new e(0,-r.y,0)),this.cannonBody.addShape(o,new e(0,r.y,0))}const p1e=new l9(40*nr,1*nr,8,32);class jre extends cu{constructor(){super(p1e),le(this,"_physicsShape",d1e)}}le(jre,"componentName","torus");const f1e={...NL},m1e={...kL,scaleZ:0,depth:0},$9=new BC(wc,wc,1,1);class S3 extends cu{constructor(){super($9),this.object3d.scale.z=one}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}le(S3,"componentName","plane"),le(S3,"defaults",m1e),le(S3,"schema",f1e);async function v1e(){const{Sphere:n}=await cb();this.cannonBody.addShape(new n($p(this).x*.5))}const g1e={...NL},_1e={...kL,scaleZ:0,depth:0},y1e=new r9(zp,32);class M3 extends cu{constructor(){super(y1e),le(this,"_physicsShape",v1e),this.object3d.scale.z=one}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}le(M3,"componentName","circle"),le(M3,"defaults",_1e),le(M3,"schema",g1e);const U5=new Map,eH=(n,e)=>{if(U5.has(e))return U5.get(e);const t=new ye;return Iy.setFromObject(n).getSize(t),Object.freeze(t),U5.set(e,t),t},j5=new Map,Hre=(n,e)=>{if(j5.has(e)){const[s,o,a]=j5.get(e);return n.scale.multiplyScalar(s),n.position.copy(o).multiplyScalar(-1),a}const t=eH(n,e).clone(),r=1/t.y;n.scale.multiplyScalar(r);const i=HC(n);return n.position.copy(i).multiplyScalar(-1),t.multiplyScalar(r),Object.freeze(t),j5.set(e,[r,i,t]),t},Wre={...hu,src:String,onLoad:Function,boxVisible:Boolean},Gre={...du,src:void 0,onLoad:void 0,boxVisible:!1},XL={...Wre,resize:Boolean},qL={...Gre,resize:!0},Xre=n=>{var e;const t=n.split("/");return(e=Yx(t))!=null&&e.includes(".")?(t.pop(),t.join("/")):n},qre=n=>n.startsWith("./")||n.startsWith("../"),x1e=(n,e)=>{for(var t="",r=0,i=-1,s=0,o,a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var c=t.lastIndexOf("/");if(c!==t.length-1){c===-1?(t="",r=0):(t=t.slice(0,c),r=t.length-1-t.lastIndexOf("/")),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return t},b1e=n=>{if(n.length===0)return".";var e=n.charCodeAt(0)===47,t=n.charCodeAt(n.length-1)===47;return n=x1e(n,!e),n.length===0&&!e&&(n="."),n.length>0&&t&&(n+="/"),e?"/"+n:n},w1e=(...n)=>{if(n.length===0)return".";for(var e,t=0;t<n.length;++t){var r=n[t];r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":b1e(e)},[tH,YR]=yt(void 0),[Yre,yU]=yt(void 0),ZX=n=>{Zte.setURLModifier(n)},nH=new Map,xU=new Map,rH=new Map,S1e=n=>{var e,t;return(t=nH.get(n))!=null?t:(e=dL(n)[1])==null?void 0:e.toLowerCase()},Zre=(n,e=(t=>(t=dL(n.webkitRelativePath)[1])==null?void 0:t.toLowerCase())())=>hh(xU,n,()=>{const t=URL.createObjectURL(n);return e&&nH.set(t,e),rH.set(t,n),t}),bU=new Map;_n(()=>{const n=yU();if(n){for(const e of n)bU.set(e.webkitRelativePath,e);return()=>{for(const e of xU.values())URL.revokeObjectURL(e);bU.clear(),nH.clear(),xU.clear(),rH.clear()}}},[yU]);_n(()=>{var n;const e=(n=YR())==null?void 0:n.webkitRelativePath;if(e)return ZX(t=>{if(qre(t)){const r=bU.get(w1e(Xre(e),t));if(r)return Zre(r)}return t}),()=>{ZX(void 0)}},[YR]);class ih extends GC{constructor(e){super(e),le(this,"unmounted"),le(this,"loadingState",new nn(0)),le(this,"serializeAnimations"),le(this,"_resize"),this.unmounted=e}playAnimation(e,t){setTimeout(()=>this.cancelHandle("playAnimation",()=>this.loadingState.get((r,i)=>{r||(i.cancel(),super.playAnimation(e,t))})))}stopAnimation(){setTimeout(()=>this.cancelHandle("stopAnimation",()=>this.loadingState.get((e,t)=>{e||(t.cancel(),super.stopAnimation())})))}async loadAnimation(e,t=e){var r;((r=this.serializeAnimations)!=null?r:this.serializeAnimations={})[t]=e;const i=(await this.load(e)).animations[0];!i||(this.animations[t]=this.watch(new eC(i,await this.loaded)))}get animations(){return super.animations}set animations(e){for(const[t,r]of Object.entries(e))typeof r=="string"?this.loadAnimation(r,t):this.animations[t]=r}async load(e){gne();const t=new tte;this.loadingState.set(this.loadingState.get()+1);const r=S1e(e);if(!r||!["fbx","glb","gltf"].includes(r))throw t.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),bM(),new Error("Unsupported file extension "+r);const i=r==="fbx"?await rr(()=>import("./loadFBX.6c372e39.40d6fa73.js"),[]):await rr(()=>import("./loadGLTF.f72a683d.f0692ae9.js"),[]);let s;try{s=await i.default(e,!this.unmounted)}catch{throw t.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),bM(),new Error("Failed to load model, check if src is correct")}return t.resolve(),setTimeout(()=>this.loadingState.set(this.loadingState.get()-1)),bM(),s}get resize(){var e;return(e=this._resize)!=null?e:!0}set resize(e){this._resize=e,this.loaded.done&&(this.src=this._src)}resolveLoaded(e,t){if(this.unmounted)return e;for(const i of e.animations)this.animations[i.name]=this.watch(new eC(i,e));const r=this._resize===!1?eH(e,t):Hre(e,t);return!this.widthSet&&(this.object3d.scale.x=r.x),!this.heightSet&&(this.object3d.scale.y=r.y),!this.depthSet&&(this.object3d.scale.z=r.z),e}find(e,t){const r=super.find(e,t);return r&&(r.model=this),r}findAll(e){const t=super.findAll(e);for(const r of t)r.model=this;return t}}le(ih,"componentName","model"),le(ih,"defaults",qL),le(ih,"schema",XL);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var zt=function(){return zt=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},zt.apply(this,arguments)};function iH(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function cr(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lr(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function ai(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var $r;(function(n){n.Start="xstate.start",n.Stop="xstate.stop",n.Raise="xstate.raise",n.Send="xstate.send",n.Cancel="xstate.cancel",n.NullEvent="",n.Assign="xstate.assign",n.After="xstate.after",n.DoneState="done.state",n.DoneInvoke="done.invoke",n.Log="xstate.log",n.Init="xstate.init",n.Invoke="xstate.invoke",n.ErrorExecution="error.execution",n.ErrorCommunication="error.communication",n.ErrorPlatform="error.platform",n.ErrorCustom="xstate.error",n.Update="xstate.update",n.Pure="xstate.pure",n.Choose="xstate.choose"})($r||($r={}));var Rm;(function(n){n.Parent="#_parent",n.Internal="#_internal"})(Rm||(Rm={}));var wU=$r.Start,sH=$r.Stop,vx=$r.Raise,gx=$r.Send,Kre=$r.Cancel,M1e=$r.NullEvent,Jre=$r.Assign;$r.After;$r.DoneState;var Qre=$r.Log,C1e=$r.Init,SU=$r.Invoke;$r.ErrorExecution;var KX=$r.ErrorPlatform,E1e=$r.ErrorCustom,$re=$r.Update,A1e=$r.Choose,P1e=$r.Pure,eie=".",JX={},MU="xstate.guard",T1e="",H5;function oH(n,e,t){t===void 0&&(t=eie);var r=CM(n,t),i=CM(e,t);return Br(i)?Br(r)?i===r:!1:Br(r)?r in i:Object.keys(r).every(function(s){return s in i?oH(r[s],i[s]):!1})}function tie(n){try{return Br(n)||typeof n=="number"?"".concat(n):n.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function CU(n,e){try{return hb(n)?n:n.toString().split(e)}catch{throw new Error("'".concat(n,"' is not a valid state path."))}}function R1e(n){return typeof n=="object"&&"value"in n&&"context"in n&&"event"in n&&"_event"in n}function CM(n,e){if(R1e(n))return n.value;if(hb(n))return ZR(n);if(typeof n!="string")return n;var t=CU(n,e);return ZR(t)}function ZR(n){if(n.length===1)return n[0];for(var e={},t=e,r=0;r<n.length-1;r++)r===n.length-2?t[n[r]]=n[r+1]:(t[n[r]]={},t=t[n[r]]);return e}function tM(n,e){for(var t={},r=Object.keys(n),i=0;i<r.length;i++){var s=r[i];t[s]=e(n[s],s,n,i)}return t}function QX(n,e,t){var r,i,s={};try{for(var o=cr(Object.keys(n)),a=o.next();!a.done;a=o.next()){var c=a.value,u=n[c];!t(u)||(s[c]=e(u,c,n))}}catch(d){r={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}var O1e=function(n){return function(e){var t,r,i=e;try{for(var s=cr(n),o=s.next();!o.done;o=s.next()){var a=o.value;i=i[a]}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i}};function L1e(n,e){return function(t){var r,i,s=t;try{for(var o=cr(n),a=o.next();!a.done;a=o.next()){var c=a.value;s=s[e][c]}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}}function C3(n){if(!n)return[[]];if(Br(n))return[[n]];var e=Gi(Object.keys(n).map(function(t){var r=n[t];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[t]]:C3(n[t]).map(function(i){return[t].concat(i)})}));return e}function Gi(n){var e;return(e=[]).concat.apply(e,ai([],lr(n),!1))}function nie(n){return hb(n)?n:[n]}function Zu(n){return n===void 0?[]:nie(n)}function KR(n,e,t){var r,i;if(Jr(n))return n(e,t.data);var s={};try{for(var o=cr(Object.keys(n)),a=o.next();!a.done;a=o.next()){var c=a.value,u=n[c];Jr(u)?s[c]=u(e,t.data):s[c]=u}}catch(d){r={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function D1e(n){return/^(done|error)\./.test(n)}function $X(n){return!!(n instanceof Promise||n!==null&&(Jr(n)||typeof n=="object")&&Jr(n.then))}function I1e(n){return n!==null&&typeof n=="object"&&"transition"in n&&typeof n.transition=="function"}function N1e(n,e){var t,r,i=lr([[],[]],2),s=i[0],o=i[1];try{for(var a=cr(n),c=a.next();!c.done;c=a.next()){var u=c.value;e(u)?s.push(u):o.push(u)}}catch(d){t={error:d}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return[s,o]}function rie(n,e){return tM(n.states,function(t,r){if(t){var i=(Br(e)?void 0:e[r])||(t?t.current:void 0);if(i)return{current:i,states:rie(t,i)}}})}function k1e(n,e){return{current:e,states:rie(n,e)}}function eq(n,e,t,r){var i=n&&t.reduce(function(s,o){var a,c,u=o.assignment,d={state:r,action:o,_event:e},p={};if(Jr(u))p=u(s,e.data,d);else try{for(var f=cr(Object.keys(u)),v=f.next();!v.done;v=f.next()){var x=v.value,y=u[x];p[x]=Jr(y)?y(s,e.data,d):y}}catch(_){a={error:_}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}return Object.assign({},s,p)},n);return i}var z1e=function(){};function hb(n){return Array.isArray(n)}function Jr(n){return typeof n=="function"}function Br(n){return typeof n=="string"}function iie(n,e){if(n)return Br(n)?{type:MU,name:n,predicate:e?e[n]:void 0}:Jr(n)?{type:MU,name:n.name,predicate:n}:n}function B1e(n){try{return"subscribe"in n&&Jr(n.subscribe)}catch{return!1}}var um=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();H5={},H5[um]=function(){return this},H5[Symbol.observable]=function(){return this};function _x(n){return!!n&&"__xstatenode"in n}function V1e(n){return!!n&&typeof n.send=="function"}function aH(n,e){return Br(n)||typeof n=="number"?zt({type:n},e):n}function na(n,e){if(!Br(n)&&"$$type"in n&&n.$$type==="scxml")return n;var t=aH(n);return zt({name:t.type,data:t,$$type:"scxml",type:"external"},e)}function L_(n,e){var t=nie(e).map(function(r){return typeof r>"u"||typeof r=="string"||_x(r)?{target:r,event:n}:zt(zt({},r),{event:n})});return t}function F1e(n){if(!(n===void 0||n===T1e))return Zu(n)}function sie(n,e,t,r,i){var s=n.options.guards,o={state:i,cond:e,_event:r};if(e.type===MU)return((s==null?void 0:s[e.name])||e.predicate)(t,r.data,o);var a=s==null?void 0:s[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(n.id,"'."));return a(t,r.data,o)}function oie(n){return typeof n=="string"?{type:n}:n}function E3(n,e,t){var r=function(){},i=typeof n=="object",s=i?n:null;return{next:((i?n.next:n)||r).bind(s),error:((i?n.error:e)||r).bind(s),complete:((i?n.complete:t)||r).bind(s)}}function mP(n,e){return"".concat(n,":invocation[").concat(e,"]")}var By=na({type:C1e});function EU(n,e){return e&&e[n]||void 0}function oC(n,e){var t;if(Br(n)||typeof n=="number"){var r=EU(n,e);Jr(r)?t={type:n,exec:r}:r?t=r:t={type:n,exec:void 0}}else if(Jr(n))t={type:n.name||n.toString(),exec:n};else{var r=EU(n.type,e);if(Jr(r))t=zt(zt({},n),{exec:r});else if(r){var i=r.type||n.type;t=zt(zt(zt({},r),n),{type:i})}else t=n}return t}var hm=function(n,e){if(!n)return[];var t=hb(n)?n:[n];return t.map(function(r){return oC(r,e)})};function lH(n){var e=oC(n);return zt(zt({id:Br(n)?n:e.id},e),{type:e.type})}function U1e(n){return Br(n)?{type:vx,event:n}:aie(n,{to:Rm.Internal})}function j1e(n){return{type:vx,_event:na(n.event)}}function aie(n,e){return{to:e?e.to:void 0,type:gx,event:Jr(n)?n:aH(n),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:Jr(n)?n.name:tie(n)}}function H1e(n,e,t,r){var i={_event:t},s=na(Jr(n.event)?n.event(e,t.data,i):n.event),o;if(Br(n.delay)){var a=r&&r[n.delay];o=Jr(a)?a(e,t.data,i):a}else o=Jr(n.delay)?n.delay(e,t.data,i):n.delay;var c=Jr(n.to)?n.to(e,t.data,i):n.to;return zt(zt({},n),{to:c,_event:s,event:s.data,delay:o})}var W1e=function(n,e,t){return zt(zt({},n),{value:Br(n.expr)?n.expr:n.expr(e,t.data,{_event:t})})},G1e=function(n){return{type:Kre,sendId:n}};function X1e(n){var e=lH(n);return{type:$r.Start,activity:e,exec:void 0}}function q1e(n){var e=Jr(n)?n:lH(n);return{type:$r.Stop,activity:e,exec:void 0}}function Y1e(n,e,t){var r=Jr(n.activity)?n.activity(e,t.data):n.activity,i=typeof r=="string"?{id:r}:r,s={type:$r.Stop,activity:i};return s}function Z1e(n,e){var t=e?"#".concat(e):"";return"".concat($r.After,"(").concat(n,")").concat(t)}function vP(n,e){var t="".concat($r.DoneState,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}function A3(n,e){var t="".concat($r.DoneInvoke,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}function nM(n,e){var t="".concat($r.ErrorPlatform,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}var K1e=function(n){var e,t,r=[];try{for(var i=cr(n),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.length;){if(o[a].type===Jre){r.push(o[a]),o.splice(a,1);continue}a++}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r};function JR(n,e,t,r,i,s,o){o===void 0&&(o=!1);var a=o?[]:K1e(i),c=a.length?eq(t,r,a,e):t,u=o?[t]:void 0,d=[];function p(x){var y;switch(x.type){case vx:return j1e(x);case gx:var _=H1e(x,c,r,n.options.delays);return s&&_.to!==Rm.Internal&&d.push(_),_;case Qre:{var S=W1e(x,c,r);return s==null||s(S,c,r),S}case A1e:{var C=x,A=(y=C.conds.find(function(ce){var te=iie(ce.cond,n.options.guards);return!te||sie(n,te,c,r,s?void 0:e)}))===null||y===void 0?void 0:y.actions;if(!A)return[];var P=lr(JR(n,e,c,r,[hm(Zu(A),n.options.actions)],s,o),2),D=P[0],N=P[1];return c=N,u==null||u.push(c),D}case P1e:{var A=x.get(c,r.data);if(!A)return[];var j=lr(JR(n,e,c,r,[hm(Zu(A),n.options.actions)],s,o),2),T=j[0],k=j[1];return c=k,u==null||u.push(c),T}case sH:{var S=Y1e(x,c,r);return s==null||s(S,t,r),S}case Jre:{c=eq(c,r,[x],s?void 0:e),u==null||u.push(c);break}default:var U=oC(x,n.options.actions),ee=U.exec;if(s)s(U,c,r);else if(ee&&u){var xe=u.length-1;U=zt(zt({},U),{exec:function(ce){for(var te=[],fe=1;fe<arguments.length;fe++)te[fe-1]=arguments[fe];ee.apply(void 0,ai([u[xe]],lr(te),!1))}})}return U}}function f(x){var y,_,S=[];try{for(var C=cr(x),A=C.next();!A.done;A=C.next()){var P=A.value,D=p(P);D&&(S=S.concat(D))}}catch(N){y={error:N}}finally{try{A&&!A.done&&(_=C.return)&&_.call(C)}finally{if(y)throw y.error}}return d.forEach(function(N){s(N,c,r)}),d.length=0,S}var v=Gi(i.map(f));return[v,c]}var dy=function(n,e){var t=e(n);return t};function lie(n){var e;return e={id:n,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:n}}},e[um]=function(){return this},e}function J1e(n,e,t,r){var i,s=oie(n.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],a=n.data?KR(n.data,t,r):void 0,c=o?cie(o,n.id,a):lie(n.id);return c.meta=n,c}function cie(n,e,t){var r=lie(e);if(r.deferred=!0,_x(n)){var i=r.state=dy(void 0,function(){return(t?n.withContext(t):n).initialState});r.getSnapshot=function(){return i}}return r}function Q1e(n){try{return typeof n.send=="function"}catch{return!1}}function $1e(n){return Q1e(n)&&"id"in n}function eSe(n){var e;return zt((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[um]=function(){return this},e),n)}var QR=function(n){return n.type==="atomic"||n.type==="final"};function uie(n){return Object.keys(n.states).map(function(e){return n.states[e]})}function aC(n){return uie(n).filter(function(e){return e.type!=="history"})}function hie(n){var e=[n];return QR(n)?e:e.concat(Gi(aC(n).map(hie)))}function rM(n,e){var t,r,i,s,o,a,c,u,d=new Set(n),p=AU(d),f=new Set(e);try{for(var v=cr(f),x=v.next();!x.done;x=v.next())for(var y=x.value,_=y.parent;_&&!f.has(_);)f.add(_),_=_.parent}catch(k){t={error:k}}finally{try{x&&!x.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}var S=AU(f);try{for(var C=cr(f),A=C.next();!A.done;A=C.next()){var y=A.value;if(y.type==="compound"&&(!S.get(y)||!S.get(y).length))p.get(y)?p.get(y).forEach(function(U){return f.add(U)}):y.initialStateNodes.forEach(function(U){return f.add(U)});else if(y.type==="parallel")try{for(var P=(o=void 0,cr(aC(y))),D=P.next();!D.done;D=P.next()){var N=D.value;f.has(N)||(f.add(N),p.get(N)?p.get(N).forEach(function(U){return f.add(U)}):N.initialStateNodes.forEach(function(U){return f.add(U)}))}}catch(U){o={error:U}}finally{try{D&&!D.done&&(a=P.return)&&a.call(P)}finally{if(o)throw o.error}}}}catch(k){i={error:k}}finally{try{A&&!A.done&&(s=C.return)&&s.call(C)}finally{if(i)throw i.error}}try{for(var j=cr(f),T=j.next();!T.done;T=j.next())for(var y=T.value,_=y.parent;_&&!f.has(_);)f.add(_),_=_.parent}catch(k){c={error:k}}finally{try{T&&!T.done&&(u=j.return)&&u.call(j)}finally{if(c)throw c.error}}return f}function die(n,e){var t=e.get(n);if(!t)return{};if(n.type==="compound"){var r=t[0];if(r){if(QR(r))return r.key}else return{}}var i={};return t.forEach(function(s){i[s.key]=die(s,e)}),i}function AU(n){var e,t,r=new Map;try{for(var i=cr(n),s=i.next();!s.done;s=i.next()){var o=s.value;r.has(o)||r.set(o,[]),o.parent&&(r.has(o.parent)||r.set(o.parent,[]),r.get(o.parent).push(o))}}catch(a){e={error:a}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}function tSe(n,e){var t=rM([n],e);return die(n,AU(t))}function iM(n,e){return Array.isArray(n)?n.some(function(t){return t===e}):n instanceof Set?n.has(e):!1}function nSe(n){return ai([],lr(new Set(Gi(ai([],lr(n.map(function(e){return e.ownEvents})),!1)))),!1)}function P3(n,e){return e.type==="compound"?aC(e).some(function(t){return t.type==="final"&&iM(n,t)}):e.type==="parallel"?aC(e).every(function(t){return P3(n,t)}):!1}function rSe(n){return n===void 0&&(n=[]),n.reduce(function(e,t){return t.meta!==void 0&&(e[t.id]=t.meta),e},{})}function tq(n){return new Set(Gi(n.map(function(e){return e.tags})))}function pie(n,e){if(n===e)return!0;if(n===void 0||e===void 0)return!1;if(Br(n)||Br(e))return n===e;var t=Object.keys(n),r=Object.keys(e);return t.length===r.length&&t.every(function(i){return pie(n[i],e[i])})}function iSe(n){return typeof n!="object"||n===null?!1:"value"in n&&"_event"in n}function sSe(n,e){var t=n.exec,r=zt(zt({},n),{exec:t!==void 0?function(){return t(e.context,e.event,{action:n,state:e,_event:e._event})}:void 0});return r}var Eh=function(){function n(e){var t=this,r;this.actions=[],this.activities=JX,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||JX,this.meta=rSe(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return nSe(t.configuration)}})}return n.from=function(e,t){if(e instanceof n)return e.context!==t?new n({value:e.value,context:t,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=By;return new n({value:e,context:t,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},n.create=function(e){return new n(e)},n.inert=function(e,t){if(e instanceof n){if(!e.actions.length)return e;var r=By;return new n({value:e.value,context:t,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return n.from(e,t)},n.prototype.toStrings=function(e,t){var r=this;if(e===void 0&&(e=this.value),t===void 0&&(t="."),Br(e))return[e];var i=Object.keys(e);return i.concat.apply(i,ai([],lr(i.map(function(s){return r.toStrings(e[s],t).map(function(o){return s+t+o})})),!1))},n.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var r=iH(e,["configuration","transitions","tags","machine"]);return zt(zt({},r),{tags:Array.from(t)})},n.prototype.matches=function(e){return oH(e,this.value)},n.prototype.hasTag=function(e){return this.tags.has(e)},n.prototype.can=function(e){var t;z1e(!!this.machine);var r=(t=this.machine)===null||t===void 0?void 0:t.getTransitionData(this,e);return!!(r!=null&&r.transitions.length)&&r.transitions.some(function(i){return i.target!==void 0||i.actions.length})},n}(),oSe={deferEvents:!1},nq=function(){function n(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=zt(zt({},oSe),e)}return n.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},n.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},n.prototype.clear=function(){this.queue=[]},n.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},n.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},n}(),W5=new Map,aSe=0,gP={bookId:function(){return"x:".concat(aSe++)},register:function(n,e){return W5.set(n,e),n},get:function(n){return W5.get(n)},free:function(n){W5.delete(n)}};function cH(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function lSe(){var n=cH();if(n&&"__xstate__"in n)return n.__xstate__}function cSe(n){if(cH()){var e=lSe();e&&e.register(n)}}function uSe(n,e){e===void 0&&(e={});var t=n.initialState,r=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var u=i.shift();t=n.transition(t,u,c),r.forEach(function(d){return d.next(t)})}s=!1}},a=eSe({id:e.id,send:function(u){i.push(u),o()},getSnapshot:function(){return t},subscribe:function(u,d,p){var f=E3(u,d,p);return r.add(f),f.next(t),{unsubscribe:function(){r.delete(f)}}}}),c={parent:e.parent,self:a,id:e.id||"anonymous",observers:r};return t=n.start?n.start(c):t,a}var hSe={sync:!1,autoForward:!1},ta;(function(n){n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped"})(ta||(ta={}));var dSe=function(){function n(e,t){t===void 0&&(t=n.defaultOptions);var r=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=ta.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(d,p){if(hb(d))return r.batch(d),r.state;var f=na(aH(d,p));if(r.status===ta.Stopped)return r.state;if(r.status!==ta.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(f.name,'" was sent to uninitialized service "').concat(r.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(f.data)));return r.scheduler.schedule(function(){r.forward(f);var v=r._nextState(f);r.update(v,f)}),r._state},this.sendTo=function(d,p,f){var v=r.parent&&(p===Rm.Parent||r.parent.id===p),x=v?r.parent:Br(p)?r.children.get(p)||gP.get(p):V1e(p)?p:void 0;if(!x){if(!v)throw new Error("Unable to send event to child '".concat(p,"' from service '").concat(r.id,"'."));return}if("machine"in x){if(r.status!==ta.Stopped||r.parent!==x||r.state.done){var y=zt(zt({},d),{name:d.name===E1e?"".concat(nM(r.id)):d.name,origin:r.sessionId});!f&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([x,y]):x.send(y)}}else!f&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([x,d.data]):x.send(d.data)},this._exec=function(d,p,f,v){v===void 0&&(v=r.machine.options.actions);var x=d.exec||EU(d.type,v),y=Jr(x)?x:x?x.exec:d.exec;if(y)try{return y(p,f.data,r.machine.config.predictableActionArguments?{action:d,_event:f}:{action:d,state:r.state,_event:f})}catch(xe){throw r.parent&&r.parent.send({type:"xstate.error",data:xe}),xe}switch(d.type){case gx:var _=d;if(typeof _.delay=="number"){r.defer(_);return}else _.to?r.sendTo(_._event,_.to,f===By):r.send(_._event);break;case Kre:r.cancel(d.sendId);break;case wU:{if(r.status!==ta.Running)return;var S=d.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[S.id||S.type])break;if(S.type===$r.Invoke){var C=oie(S.src),A=r.machine.options.services?r.machine.options.services[C.type]:void 0,P=S.id,D=S.data,N="autoForward"in S?S.autoForward:!!S.forward;if(!A)return;var j=D?KR(D,p,f):void 0;if(typeof A=="string")return;var T=Jr(A)?A(p,f.data,{data:j,src:C,meta:S.meta}):A;if(!T)return;var k=void 0;_x(T)&&(T=j?T.withContext(j):T,k={autoForward:N}),r.spawn(T,P,k)}else r.spawnActivity(S);break}case sH:{r.stopChild(d.activity.id);break}case Qre:var U=d.label,ee=d.value;U?r.logger(U,ee):r.logger(ee);break}};var i=zt(zt({},n.defaultOptions),t),s=i.clock,o=i.logger,a=i.parent,c=i.id,u=c!==void 0?c:e.id;this.id=u,this.logger=o,this.clock=s,this.parent=a,this.options=i,this.scheduler=new nq({deferEvents:this.options.deferEvents}),this.sessionId=gP.bookId()}return Object.defineProperty(n.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:dy(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),n.prototype.execute=function(e,t){var r,i;try{for(var s=cr(e.actions),o=s.next();!o.done;o=s.next()){var a=o.value;this.exec(a,e,t)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},n.prototype.update=function(e,t){var r,i,s,o,a,c,u,d,p=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||t===By)&&this.options.execute)this.execute(this.state);else for(var f=void 0;f=this._outgoingQueue.shift();)f[0].send(f[1]);if(this.children.forEach(function(k){p.state.children[k.id]=k}),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var v=cr(this.eventListeners),x=v.next();!x.done;x=v.next()){var y=x.value;y(e.event)}}catch(k){r={error:k}}finally{try{x&&!x.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}try{for(var _=cr(this.listeners),S=_.next();!S.done;S=_.next()){var y=S.value;y(e,e.event)}}catch(k){s={error:k}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(s)throw s.error}}try{for(var C=cr(this.contextListeners),A=C.next();!A.done;A=C.next()){var P=A.value;P(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(k){a={error:k}}finally{try{A&&!A.done&&(c=C.return)&&c.call(C)}finally{if(a)throw a.error}}if(this.state.done){var D=e.configuration.find(function(k){return k.type==="final"&&k.parent===p.machine}),N=D&&D.doneData?KR(D.doneData,e.context,t):void 0;try{for(var j=cr(this.doneListeners),T=j.next();!T.done;T=j.next()){var y=T.value;y(A3(this.id,N))}}catch(k){u={error:k}}finally{try{T&&!T.done&&(d=j.return)&&d.call(j)}finally{if(u)throw u.error}}this._stop(),this._stopChildren()}},n.prototype.onTransition=function(e){return this.listeners.add(e),this.status===ta.Running&&e(this.state,this.state.event),this},n.prototype.subscribe=function(e,t,r){var i=this,s=E3(e,t,r);this.listeners.add(s.next),this.status!==ta.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===ta.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},n.prototype.onEvent=function(e){return this.eventListeners.add(e),this},n.prototype.onSend=function(e){return this.sendListeners.add(e),this},n.prototype.onChange=function(e){return this.contextListeners.add(e),this},n.prototype.onStop=function(e){return this.stopListeners.add(e),this},n.prototype.onDone=function(e){return this.doneListeners.add(e),this},n.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},n.prototype.start=function(e){var t=this;if(this.status===ta.Running)return this;this.machine._init(),gP.register(this.sessionId,this),this.initialized=!0,this.status=ta.Running;var r=e===void 0?this.initialState:dy(this,function(){return iSe(e)?t.machine.resolveState(e):t.machine.resolveState(Eh.from(e,t.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){t.update(r,By)}),this},n.prototype._stopChildren=function(){this.children.forEach(function(e){Jr(e.stop)&&e.stop()}),this.children.clear()},n.prototype._stop=function(){var e,t,r,i,s,o,a,c,u,d;try{for(var p=cr(this.listeners),f=p.next();!f.done;f=p.next()){var v=f.value;this.listeners.delete(v)}}catch(j){e={error:j}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}try{for(var x=cr(this.stopListeners),y=x.next();!y.done;y=x.next()){var v=y.value;v(),this.stopListeners.delete(v)}}catch(j){r={error:j}}finally{try{y&&!y.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}try{for(var _=cr(this.contextListeners),S=_.next();!S.done;S=_.next()){var v=S.value;this.contextListeners.delete(v)}}catch(j){s={error:j}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(s)throw s.error}}try{for(var C=cr(this.doneListeners),A=C.next();!A.done;A=C.next()){var v=A.value;this.doneListeners.delete(v)}}catch(j){a={error:j}}finally{try{A&&!A.done&&(c=C.return)&&c.call(C)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.initialized=!1,this.status=ta.Stopped,this._initialState=void 0;try{for(var P=cr(Object.keys(this.delayedEventsMap)),D=P.next();!D.done;D=P.next()){var N=D.value;this.clock.clearTimeout(this.delayedEventsMap[N])}}catch(j){u={error:j}}finally{try{D&&!D.done&&(d=P.return)&&d.call(P)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new nq({deferEvents:this.options.deferEvents})},n.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule(function(){var r=na({type:"xstate.stop"}),i=dy(e,function(){var s=Gi(ai([],lr(e.state.configuration),!1).sort(function(d,p){return p.order-d.order}).map(function(d){return hm(d.onExit,e.machine.options.actions)})),o=lr(JR(e.machine,e.state,e.state.context,r,[s],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),a=o[0],c=o[1],u=new Eh({value:e.state.value,context:c,_event:r,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:a.filter(function(d){return d.type!==vx&&(d.type!==gx||!!d.to&&d.to!==Rm.Internal)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return u.changed=!0,u});e.update(i,r),e._stopChildren(),gP.free(e.sessionId)}),this},n.prototype.batch=function(e){var t=this;if(!(this.status===ta.NotStarted&&this.options.deferEvents)){if(this.status!==ta.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}if(e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=t.state,a=!1,c=[],u=function(v){var x=na(v);t.forward(x),o=dy(t,function(){return t.machine.transition(o,x,void 0,r||void 0)}),c.push.apply(c,ai([],lr(t.machine.config.predictableActionArguments?o.actions:o.actions.map(function(y){return sSe(y,o)})),!1)),a=a||!!o.changed};try{for(var d=cr(e),p=d.next();!p.done;p=d.next()){var f=p.value;u(f)}}catch(v){i={error:v}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}o.changed=a,o.actions=c,t.update(o,na(e[e.length-1]))})}},n.prototype.sender=function(e){return this.send.bind(this,e)},n.prototype._nextState=function(e,t){var r=this;t===void 0&&(t=!!this.machine.config.predictableActionArguments&&this._exec);var i=na(e);if(i.name.indexOf(KX)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(KX)===0}))throw i.data.data;var s=dy(this,function(){return r.machine.transition(r.state,i,void 0,t||void 0)});return s},n.prototype.nextState=function(e){return this._nextState(e,!1)},n.prototype.forward=function(e){var t,r;try{for(var i=cr(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},n.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?t.sendTo(e._event,e.to,!0):t.send(e._event)},e.delay)},n.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},n.prototype.exec=function(e,t,r){r===void 0&&(r=this.machine.options.actions),this._exec(e,t.context,t._event,r)},n.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),(t=this.state)===null||t===void 0||delete t.children[e]},n.prototype.stopChild=function(e){var t=this.children.get(e);!t||(this.removeChild(e),Jr(t.stop)&&t.stop())},n.prototype.spawn=function(e,t,r){if(this.status!==ta.Running)return cie(e,t);if($X(e))return this.spawnPromise(Promise.resolve(e),t);if(Jr(e))return this.spawnCallback(e,t);if($1e(e))return this.spawnActor(e,t);if(B1e(e))return this.spawnObservable(e,t);if(_x(e))return this.spawnMachine(e,zt(zt({},r),{id:t}));if(I1e(e))return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'))},n.prototype.spawnMachine=function(e,t){var r=this;t===void 0&&(t={});var i=new n(e,zt(zt({},this.options),{parent:this,id:t.id||e.id})),s=zt(zt({},hSe),t);s.sync&&i.onTransition(function(a){r.send($re,{state:a,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(a){r.removeChild(i.id),r.send(na(a,{origin:i.id}))}).start(),o},n.prototype.spawnBehavior=function(e,t){var r=uSe(e,{id:t,parent:this});return this.children.set(t,r),r},n.prototype.spawnPromise=function(e,t){var r,i=this,s=!1,o;e.then(function(c){s||(o=c,i.removeChild(t),i.send(na(A3(t,c),{origin:t})))},function(c){if(!s){i.removeChild(t);var u=nM(t,c);try{i.send(na(u,{origin:t}))}catch{i.devTools&&i.devTools.send(u,i.state),i.machine.strict&&i.stop()}}});var a=(r={id:t,send:function(){},subscribe:function(c,u,d){var p=E3(c,u,d),f=!1;return e.then(function(v){f||(p.next(v),!f&&p.complete())},function(v){f||p.error(v)}),{unsubscribe:function(){return f=!0}}},stop:function(){s=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return o}},r[um]=function(){return this},r);return this.children.set(t,a),a},n.prototype.spawnCallback=function(e,t){var r,i=this,s=!1,o=new Set,a=new Set,c,u=function(f){c=f,a.forEach(function(v){return v(f)}),!s&&i.send(na(f,{origin:t}))},d;try{d=e(u,function(f){o.add(f)})}catch(f){this.send(nM(t,f))}if($X(d))return this.spawnPromise(d,t);var p=(r={id:t,send:function(f){return o.forEach(function(v){return v(f)})},subscribe:function(f){var v=E3(f);return a.add(v.next),{unsubscribe:function(){a.delete(v.next)}}},stop:function(){s=!0,Jr(d)&&d()},toJSON:function(){return{id:t}},getSnapshot:function(){return c}},r[um]=function(){return this},r);return this.children.set(t,p),p},n.prototype.spawnObservable=function(e,t){var r,i=this,s,o=e.subscribe(function(c){s=c,i.send(na(c,{origin:t}))},function(c){i.removeChild(t),i.send(na(nM(t,c),{origin:t}))},function(){i.removeChild(t),i.send(na(A3(t),{origin:t}))}),a=(r={id:t,send:function(){},subscribe:function(c,u,d){return e.subscribe(c,u,d)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:t}}},r[um]=function(){return this},r);return this.children.set(t,a),a},n.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},n.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!!t){var r=t(this.state.context,e);this.spawnEffect(e.id,r)}},n.prototype.spawnEffect=function(e,t){var r;this.children.set(e,(r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},r[um]=function(){return this},r))},n.prototype.attachDev=function(){var e=cH();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(zt(zt({name:this.id,autoPause:!0,stateSanitizer:function(r){return{value:r.value,context:r.context,actions:r.actions}}},t),{features:zt({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}cSe(this)}},n.prototype.toJSON=function(){return{id:this.id}},n.prototype[um]=function(){return this},n.prototype.getSnapshot=function(){return this.status===ta.NotStarted?this.initialState:this._state},n.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},n.interpret=fie,n}();function fie(n,e){var t=new dSe(n,e);return t}function pSe(n){if(typeof n=="string"){var e={type:n};return e.toString=function(){return n},e}return n}function _P(n){return zt(zt({type:SU},n),{toJSON:function(){n.onDone,n.onError;var e=iH(n,["onDone","onError"]);return zt(zt({},e),{type:SU,src:pSe(n.src)})}})}var yP="",PU="#",G5="*",D_={},I_=function(n){return n[0]===PU},fSe=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},mSe=function(){function n(e,t,r,i){r===void 0&&(r="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(fSe(),t),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:eie),this.id=this.config.id||ai([this.machine.key],lr(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?tM(this.config.states,function(u,d){var p,f=new n(u,{},void 0,{parent:s,key:d});return Object.assign(s.idMap,zt((p={},p[f.id]=f,p),f.idMap)),f}):D_;var a=0;function c(u){var d,p;u.order=a++;try{for(var f=cr(uie(u)),v=f.next();!v.done;v=f.next()){var x=v.value;c(x)}}catch(y){d={error:y}}finally{try{v&&!v.done&&(p=f.return)&&p.call(f)}finally{if(d)throw d.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var d=u.event;return d===yP}):yP in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=Zu(this.config.entry||this.config.onEntry).map(function(u){return oC(u)}),this.onExit=Zu(this.config.exit||this.config.onExit).map(function(u){return oC(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=Zu(this.config.invoke).map(function(u,d){var p,f;if(_x(u)){var v=mP(s.id,d);return s.machine.options.services=zt((p={},p[v]=u,p),s.machine.options.services),_P({src:v,id:v})}else if(Br(u.src)){var v=u.id||mP(s.id,d);return _P(zt(zt({},u),{id:v,src:u.src}))}else if(_x(u.src)||Jr(u.src)){var v=u.id||mP(s.id,d);return s.machine.options.services=zt((f={},f[v]=u.src,f),s.machine.options.services),_P(zt(zt({id:v},u),{src:v}))}else{var x=u.src;return _P(zt(zt({id:mP(s.id,d)},u),{src:x}))}}),this.activities=Zu(this.config.activities).concat(this.invoke).map(function(u){return lH(u)}),this.transition=this.transition.bind(this),this.tags=Zu(this.config.tags)}return n.prototype._init=function(){this.__cache.transitions||hie(this).forEach(function(e){return e.on})},n.prototype.withConfig=function(e,t){var r=this.options,i=r.actions,s=r.activities,o=r.guards,a=r.services,c=r.delays;return new n(this.config,{actions:zt(zt({},i),e.actions),activities:zt(zt({},s),e.activities),guards:zt(zt({},o),e.guards),services:zt(zt({},a),e.services),delays:zt(zt({},c),e.delays)},t!=null?t:this.context)},n.prototype.withContext=function(e){return new n(this.config,this.options,e)},Object.defineProperty(n.prototype,"context",{get:function(){return Jr(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:tM(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return this.definition},Object.defineProperty(n.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(t,r){return t[r.eventType]=t[r.eventType]||[],t[r.eventType].push(r),t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),n.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===yP,r=this.transitions.filter(function(i){var s=i.eventType===e;return t?s:s||i.eventType===G5});return this.__cache.candidates[e]=r,r},n.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var r=function(s,o){var a=Jr(s)?"".concat(e.id,":delay[").concat(o,"]"):s,c=Z1e(a,e.id);return e.onEntry.push(aie(c,{delay:s})),e.onExit.push(G1e(c)),c},i=hb(t)?t.map(function(s,o){var a=r(s.delay,o);return zt(zt({},s),{event:a})}):Gi(Object.keys(t).map(function(s,o){var a=t[s],c=Br(a)?{target:a}:a,u=isNaN(+s)?s:+s,d=r(u,o);return Zu(c).map(function(p){return zt(zt({},p),{event:d,delay:u})})}));return i.map(function(s){var o=s.delay;return zt(zt({},e.formatTransition(s)),{delay:o})})},n.prototype.getStateNodes=function(e){var t,r=this;if(!e)return[];var i=e instanceof Eh?e.value:CM(e,this.delimiter);if(Br(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((t={},t[i]=s,t)):[this,this.states[i]]}var o=Object.keys(i),a=[this];return a.push.apply(a,ai([],lr(Gi(o.map(function(c){return r.getStateNode(c).getStateNodes(i[c])}))),!1)),a},n.prototype.handles=function(e){var t=tie(e);return this.events.includes(t)},n.prototype.resolveState=function(e){var t=e instanceof Eh?e:Eh.create(e),r=Array.from(rM([],this.getStateNodes(t.value)));return new Eh(zt(zt({},t),{value:this.resolve(t.value),configuration:r,done:P3(r,this),tags:tq(r),machine:this.machine}))},n.prototype.transitionLeafNode=function(e,t,r){var i=this.getStateNode(e),s=i.next(t,r);return!s||!s.transitions.length?this.next(t,r):s},n.prototype.transitionCompoundNode=function(e,t,r){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],t,r);return!o||!o.transitions.length?this.next(t,r):o},n.prototype.transitionParallelNode=function(e,t,r){var i,s,o={};try{for(var a=cr(Object.keys(e)),c=a.next();!c.done;c=a.next()){var u=c.value,d=e[u];if(d){var p=this.getStateNode(u),f=p._transition(d,t,r);f&&(o[u]=f)}}}catch(C){i={error:C}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}var v=Object.keys(o).map(function(C){return o[C]}),x=Gi(v.map(function(C){return C.transitions})),y=v.some(function(C){return C.transitions.length>0});if(!y)return this.next(t,r);var _=Gi(v.map(function(C){return C.entrySet})),S=Gi(Object.keys(o).map(function(C){return o[C].configuration}));return{transitions:x,entrySet:_,exitSet:Gi(v.map(function(C){return C.exitSet})),configuration:S,source:t,actions:Gi(Object.keys(o).map(function(C){return o[C].actions}))}},n.prototype._transition=function(e,t,r){return Br(e)?this.transitionLeafNode(e,t,r):Object.keys(e).length===1?this.transitionCompoundNode(e,t,r):this.transitionParallelNode(e,t,r)},n.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,na(t))},n.prototype.next=function(e,t){var r,i,s=this,o=t.name,a=[],c=[],u;try{for(var d=cr(this.getCandidates(o)),p=d.next();!p.done;p=d.next()){var f=p.value,v=f.cond,x=f.in,y=e.context,_=x?Br(x)&&I_(x)?e.matches(CM(this.getStateNodeById(x).path,this.delimiter)):oH(CM(x,this.delimiter),O1e(this.path.slice(0,-2))(e.value)):!0,S=!1;try{S=!v||sie(this.machine,v,y,t,e)}catch(D){throw new Error("Unable to evaluate guard '".concat(v.name||v.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(D.message))}if(S&&_){f.target!==void 0&&(c=f.target),a.push.apply(a,ai([],lr(f.actions),!1)),u=f;break}}}catch(D){r={error:D}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(u){if(!c.length)return{transitions:[u],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var C=Gi(c.map(function(D){return s.getRelativeStateNodes(D,e.historyValue)})),A=!!u.internal,P=[];return A||c.forEach(function(D){P.push.apply(P,ai([],lr(s.getExternalReentryNodes(D)),!1))}),{transitions:[u],entrySet:P,exitSet:A?[]:[this],configuration:C,source:e,actions:a}}},n.prototype.getExternalReentryNodes=function(e){for(var t=[],r=lr(e.order>this.order?[e,this]:[this,e],2),i=r[0],s=r[1];i&&i!==s;)t.push(i),i=i.parent;return i!==s?[]:(t.push(s),t)},n.prototype.getActions=function(e,t,r,i,s,o,a){var c,u,d,p,f=this,v=rM([],o?this.getStateNodes(o.value):[this]);try{for(var x=cr(e),y=x.next();!y.done;y=x.next()){var _=y.value;(!iM(v,_)||iM(r.entrySet,_.parent))&&r.entrySet.push(_)}}catch(U){c={error:U}}finally{try{y&&!y.done&&(u=x.return)&&u.call(x)}finally{if(c)throw c.error}}try{for(var S=cr(v),C=S.next();!C.done;C=S.next()){var _=C.value;(!iM(e,_)||iM(r.exitSet,_.parent))&&r.exitSet.push(_)}}catch(U){d={error:U}}finally{try{C&&!C.done&&(p=S.return)&&p.call(S)}finally{if(d)throw d.error}}var A=Gi(r.entrySet.map(function(U){var ee=[];if(U.type!=="final")return ee;var xe=U.parent;if(!xe.parent)return ee;ee.push(vP(U.id,U.doneData),vP(xe.id,U.doneData?KR(U.doneData,i,s):void 0));var ce=xe.parent;return ce.type==="parallel"&&aC(ce).every(function(te){return P3(r.configuration,te)})&&ee.push(vP(ce.id)),ee}));r.exitSet.sort(function(U,ee){return ee.order-U.order}),r.entrySet.sort(function(U,ee){return U.order-ee.order});var P=new Set(r.entrySet),D=new Set(r.exitSet),N=Array.from(P).map(function(U){var ee=U.onEntry,xe=U.activities.map(function(ce){return X1e(ce)});return hm(a?ai(ai([],lr(ee),!1),lr(xe),!1):ai(ai([],lr(xe),!1),lr(ee),!1),f.machine.options.actions)}).concat([A.map(U1e)]),j=Array.from(D).map(function(U){return hm(ai(ai([],lr(U.onExit),!1),lr(U.activities.map(function(ee){return q1e(ee)})),!1),f.machine.options.actions)}),T=j.concat([hm(r.actions,this.machine.options.actions)]).concat(N);if(t){var k=hm(Gi(ai([],lr(e),!1).sort(function(U,ee){return ee.order-U.order}).map(function(U){return U.onExit})),this.machine.options.actions).filter(function(U){return U.type!==vx&&(U.type!==gx||!!U.to&&U.to!==Rm.Internal)});return T.concat([k])}return T},n.prototype.transition=function(e,t,r,i){e===void 0&&(e=this.initialState);var s=na(t),o;if(e instanceof Eh)o=r===void 0?e:this.resolveState(Eh.from(e,r));else{var a=Br(e)?this.resolve(ZR(this.getResolvedPath(e))):this.resolve(e),c=r!=null?r:this.machine.context;o=this.resolveState(Eh.from(a,c))}if(this.strict&&!this.events.includes(s.name)&&!D1e(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(o.value,o,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},d=rM([],this.getStateNodes(o.value)),p=u.configuration.length?rM(d,u.configuration):d;return u.configuration=ai([],lr(p),!1),this.resolveTransition(u,o,o.context,i,s)},n.prototype.resolveRaisedTransition=function(e,t,r,i){var s,o=e.actions;return e=this.transition(e,t,void 0,i),e._event=r,e.event=r.data,(s=e.actions).unshift.apply(s,ai([],lr(o),!1)),e},n.prototype.resolveTransition=function(e,t,r,i,s){var o,a,c,u,d=this;s===void 0&&(s=By);var p=e.configuration,f=!t||e.transitions.length>0,v=f?e.configuration:t?t.configuration:[],x=P3(v,this),y=f?tSe(this.machine,p):void 0,_=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,S=this.getActions(new Set(v),x,e,r,s,t,i),C=t?zt({},t.activities):{};try{for(var A=cr(S),P=A.next();!P.done;P=A.next()){var D=P.value;try{for(var N=(c=void 0,cr(D)),j=N.next();!j.done;j=N.next()){var T=j.value;T.type===wU?C[T.activity.id||T.activity.type]=T:T.type===sH&&(C[T.activity.id||T.activity.type]=!1)}}catch(Ze){c={error:Ze}}finally{try{j&&!j.done&&(u=N.return)&&u.call(N)}finally{if(c)throw c.error}}}}catch(Ze){o={error:Ze}}finally{try{P&&!P.done&&(a=A.return)&&a.call(A)}finally{if(o)throw o.error}}var k=lr(JR(this,t,r,s,S,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),U=k[0],ee=k[1],xe=lr(N1e(U,function(Ze){return Ze.type===vx||Ze.type===gx&&Ze.to===Rm.Internal}),2),ce=xe[0],te=xe[1],fe=U.filter(function(Ze){var st;return Ze.type===wU&&((st=Ze.activity)===null||st===void 0?void 0:st.type)===SU}),ge=fe.reduce(function(Ze,st){return Ze[st.activity.id]=J1e(st.activity,d.machine,ee,s),Ze},t?zt({},t.children):{}),Se=new Eh({value:y||t.value,context:ee,_event:s,_sessionid:t?t._sessionid:null,historyValue:y?_?k1e(_,y):void 0:t?t.historyValue:void 0,history:!y||e.source?t:void 0,actions:y?te:[],activities:y?C:t?t.activities:{},events:[],configuration:v,transitions:e.transitions,children:ge,done:x,tags:tq(v),machine:this}),pe=r!==ee;Se.changed=s.name===$re||pe;var se=Se.history;se&&delete se.history;var ae=!x&&(this._transient||p.some(function(Ze){return Ze._transient}));if(!f&&(!ae||s.name===yP))return Se;var Le=Se;if(!x)for(ae&&(Le=this.resolveRaisedTransition(Le,{type:M1e},s,i));ce.length;){var Re=ce.shift();Le=this.resolveRaisedTransition(Le,Re._event,s,i)}var Ue=Le.changed||(se?!!Le.actions.length||pe||typeof se.value!=typeof Le.value||!pie(Le.value,se.value):void 0);return Le.changed=Ue,Le.history=se,Le},n.prototype.getStateNode=function(e){if(I_(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},n.prototype.getStateNodeById=function(e){var t=I_(e)?e.slice(PU.length):e;if(t===this.id)return this;var r=this.machine.idMap[t];if(!r)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return r},n.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&I_(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var t=CU(e,this.delimiter).slice(),r=this;t.length;){var i=t.shift();if(!i.length)break;r=r.getStateNode(i)}return r},n.prototype.resolve=function(e){var t,r=this;if(!e)return this.initialStateValue||D_;switch(this.type){case"parallel":return tM(this.initialStateValue,function(s,o){return s?r.getStateNode(o).resolve(e[o]||s):D_});case"compound":if(Br(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(t={},t[e]=i.initialStateValue,t):e}return Object.keys(e).length?tM(e,function(s,o){return s?r.getStateNode(o).resolve(s):D_}):this.initialStateValue||{};default:return e||D_}},n.prototype.getResolvedPath=function(e){if(I_(e)){var t=this.machine.idMap[e.slice(PU.length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return CU(e,this.delimiter)},Object.defineProperty(n.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var t;if(this.type==="parallel")t=QX(this.states,function(r){return r.initialStateValue||D_},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=QR(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),n.prototype.getInitialState=function(e,t){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,entrySet:ai([],lr(r),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,t!=null?t:this.machine.context,void 0)},Object.defineProperty(n.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){var e;if(this.type==="history"){var t=this.config;Br(t.target)?e=I_(t.target)?ZR(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target:e=t.target}return e},enumerable:!1,configurable:!0}),n.prototype.getRelativeStateNodes=function(e,t,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(n.prototype,"initialStateNodes",{get:function(){var e=this;if(QR(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var t=C3(this.initialStateValue);return Gi(t.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),n.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=lr(e),r=t[0],i=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var s=this.getStateNode(r);if(s.type==="history")return s.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(i)},n.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:QX(this.states,function(t,r){if(!e)return t.historyValue();var i=Br(e)?void 0:e[r];return t.historyValue(i||t.initialStateValue)},function(t){return!t.history})}},n.prototype.resolveHistory=function(e){var t=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var i=this.target;return i?Gi(C3(i).map(function(o){return r.getFromRelativePath(o)})):r.initialStateNodes}var s=L1e(r.path,"states")(e).current;return Br(s)?[r.getStateNode(s)]:Gi(C3(s).map(function(o){return t.history==="deep"?r.getFromRelativePath(o):[r.states[o[0]]]}))},Object.defineProperty(n.prototype,"stateIds",{get:function(){var e=this,t=Gi(Object.keys(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"events",{get:function(){var e,t,r,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var a=cr(Object.keys(s)),c=a.next();!c.done;c=a.next()){var u=c.value,d=s[u];if(d.states)try{for(var p=(r=void 0,cr(d.events)),f=p.next();!f.done;f=p.next()){var v=f.value;o.add("".concat(v))}}catch(x){r={error:x}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}}}catch(x){e={error:x}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(t){return!(!t.target&&!t.actions.length&&t.internal)}).map(function(t){return t.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),n.prototype.resolveTarget=function(e){var t=this;if(e!==void 0)return e.map(function(r){if(!Br(r))return r;var i=r[0]===t.delimiter;if(i&&!t.parent)return t.getStateNodeByPath(r.slice(1));var s=i?t.key+r:r;if(t.parent)try{var o=t.parent.getStateNodeByPath(s);return o}catch(a){throw new Error("Invalid transition definition for state node '".concat(t.id,`':
`).concat(a.message))}else return t.getStateNodeByPath(s)})},n.prototype.formatTransition=function(e){var t=this,r=F1e(e.target),i="internal"in e?e.internal:r?r.some(function(c){return Br(c)&&c[0]===t.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(r),a=zt(zt({},e),{actions:hm(Zu(e.actions)),cond:iie(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return zt(zt({},a),{target:a.target?a.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(t.id)})}});return a},n.prototype.formatTransitions=function(){var e,t,r=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=G5,a=s[o],c=a===void 0?[]:a,u=iH(s,[typeof o=="symbol"?o:o+""]);i=Gi(Object.keys(u).map(function(C){var A=L_(C,u[C]);return A}).concat(L_(G5,c)))}var d=this.config.always?L_("",this.config.always):[],p=this.config.onDone?L_(String(vP(this.id)),this.config.onDone):[],f=Gi(this.invoke.map(function(C){var A=[];return C.onDone&&A.push.apply(A,ai([],lr(L_(String(A3(C.id)),C.onDone)),!1)),C.onError&&A.push.apply(A,ai([],lr(L_(String(nM(C.id)),C.onError)),!1)),A})),v=this.after,x=Gi(ai(ai(ai(ai([],lr(p),!1),lr(f),!1),lr(i),!1),lr(d),!1).map(function(C){return Zu(C).map(function(A){return r.formatTransition(A)})}));try{for(var y=cr(v),_=y.next();!_.done;_=y.next()){var S=_.value;x.push(S)}}catch(C){e={error:C}}finally{try{_&&!_.done&&(t=y.return)&&t.call(y)}finally{if(e)throw e.error}}return x},n}();function vSe(n,e){return new mSe(n,e)}const mie={...XL,spineName:String,preset:String,strideForward:Number,strideRight:Number,strideMove:Boolean,strideMode:String},uH={...qL,spineName:void 0,preset:"default",strideForward:0,strideRight:0,strideMove:!1,strideMode:"aim",scale:1.7,scaleX:1.7,scaleY:1.7,scaleZ:1.7,width:20,depth:20,animation:"idle",src:by},gSe=vSe({predictableActionArguments:!0,states:{idle:{on:{RUN_START:"running",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},running:{on:{RUN_STOP:"idle",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},runningBackwards:{on:{RUN_STOP:"idle",RUN_START:"running",JUMP_START:"jumping"}},jumping:{on:{JUMP_STOP:"idle"}}},initial:"idle"}),qg=new WeakMap;class Vy extends ih{constructor(){super(),le(this,"poseService",fie(gSe)),le(this,"spineNameState",new nn(void 0)),le(this,"srcState",new nn(by)),le(this,"animationsState",new nn({})),le(this,"presetState",new nn("default")),le(this,"strideForwardState",new nn(0)),le(this,"strideRightState",new nn(0)),le(this,"strideMoveState",new nn(!1)),le(this,"strideModeState",new nn("aim")),le(this,"jumpHeight",10),this.width=20,this.depth=20,this.scale=1.7;const[e,t]=yt(void 0),[r,i]=yt(void 0);this.createEffect(()=>{const c=this.spineNameState.get(),u=super.src=this.srcState.get();r(void 0),e(void 0),qg.delete(this);const d=this.loaded.then(p=>{if(e("other"),c){r(this.find(c,!0)),c==="mixamorigSpine"?(e("mixamo"),u===by&&qg.set(this,"dummy")):c==="Spine"&&(p.getObjectByName("Wolf3D_Body")||p.getObjectByName("Wolf3D_Avatar"))&&(e("readyplayerme"),qg.set(this,"readyplayerme"));return}if(p.getObjectByName("Wolf3D_Body")||p.getObjectByName("Wolf3D_Avatar")){r(this.find("Spine",!0)),e("readyplayerme"),qg.set(this,"readyplayerme");return}const f=this.find("mixamorigSpine",!0);r(f),f&&(e("mixamo"),u===by&&qg.set(this,"dummy"))});return()=>{d.cancel()}},[this.srcState.get,this.spineNameState.get]);const[s,o]=yt("idle");this.createEffect(()=>{const c=t();if(!c)return;const u=this.presetState.get()==="rifle"?"rifle-":"",d=this.srcState.get(),p=d.split("/");p.pop();let f=p.join("/")+"/";if(c==="readyplayerme")f=E9+"readyplayerme/";else if(d!==by)return super.animations=this.animationsState.get(),this.animation=o(),()=>{this.animation=void 0};return super.animations={idle:f+u+"idle.fbx",running:f+u+"running.fbx",runningBackwards:f+u+"running-backwards.fbx",jumping:f+u+"falling.fbx",death:f+"death.fbx",...this.animationsState.get()},this.animation=o(),()=>{this.animation=void 0,super.animations={}}},[this.presetState.get,this.srcState.get,t,this.animationsState.get]);const{poseService:a}=this;this.createEffect(()=>{if((this.animation=o())!=="jumping")return;Gp()?(Pi.set(this.velocity.x,this.jumpHeight,this.velocity.z),Pi.applyMatrix4(this.outerObject3d.matrixWorld),Object.assign(this.velocity,Pi.multiplyScalar(.2))):this.velocity.y=this.jumpHeight;const c=Ri(()=>{this.velocity.y===0&&a.send("JUMP_STOP")});return()=>{c.cancel()}},[o]),a.onTransition(c=>c.changed&&s(c.value)).start(),this.then(()=>a.stop()),this.createEffect(()=>{const c=this.loadedGroup.children[0];if(!c)return;const{strideForward:u,strideRight:d,strideMove:p}=this;if(!u&&!d){a.send("RUN_STOP");return}let f=this.strideModeState.get();f==="aim"&&!("runningBackwards"in this.animations)&&(f="free");const v=f==="aim"?u>0:!1,x=v?-u:u,y=v?d:-d,_=90-Math.atan2(-x,-y)*gm,S=i(),C=S==null?void 0:S.outerObject3d.quaternion.clone(),A=c.quaternion.clone(),P=Rre(()=>{a.send(v?"RUN_BACKWARDS_START":"RUN_START");const D=c.quaternion.clone();let N;f==="aim"&&S&&C&&(c.quaternion.copy(A),S.outerObject3d.quaternion.copy(C),N=S.pointAt(1e3)),c.quaternion.setFromEuler(Xi.set(0,_*Bs,0));const j=c.quaternion.clone();if(c.quaternion.copy(D).slerp(j,_0(.2)),N&&(S==null||S.lookAt(N)),!p)return;const{x:T,y:k}=Rxe(0,0,_+90,Math.max(Math.abs(u),Math.abs(d)));this.moveForward(v?k:-k),this.moveRight(v?T:-T)});return()=>{f==="aim"&&!this.strideForward&&!this.strideRight&&c.quaternion.set(0,0,0,0),P.cancel()}},[this.animationsState.get,this.strideModeState.get,this.strideMoveState.get,this.strideForwardState.get,this.strideRightState.get,i])}get spineName(){return this.spineNameState.get()}set spineName(e){this.spineNameState.set(e)}get resize(){return super.resize}set resize(e){}get src(){return this.srcState.get()}set src(e){this.srcState.set(e)}get animations(){return super.animations}set animations(e){this.animationsState.set(e)}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get strideForward(){return this.strideForwardState.get()}set strideForward(e){this.strideForwardState.set(e)}get strideRight(){return this.strideRightState.get()}set strideRight(e){this.strideRightState.set(e)}get strideMove(){return this.strideMoveState.get()}set strideMove(e){this.strideMoveState.set(e)}get strideMode(){return this.strideModeState.get()}set strideMode(e){this.strideModeState.set(e)}jump(e=10){this.jumpHeight=e,this.poseService.send("JUMP_START")}}le(Vy,"componentName","dummy"),le(Vy,"defaults",uH),le(Vy,"schema",mie);const _Se={...hu,preset:String,repeatX:Number,repeatZ:Number},ySe={...du,preset:"industrial0",repeatX:1,repeatZ:1},xSe={..._Se,repeatY:Number},bSe={...ySe,repeatY:1},wSe="https://unpkg.com/lingo3d-facade@1.0.0/assets/",xP=(n,e,t)=>{const r=new ih;return r.src=n,r.rotationY=t,e.append(r),r},bP=(n,e,t,r,i,s)=>{const o=t*n.length*.5-e;let a=0;if(s){for(const c of n)c.z+=e*r,c.x+=a++*t-o;return}for(const c of n)c.x+=e*i,c.z+=a++*t-o};class SSe extends Bl{constructor(e){super(),le(this,"presetState",new nn("industrial0")),le(this,"repeatXState",new nn(1)),le(this,"repeatZState",new nn(1)),e.append(this),TL.add(this),this.createEffect(()=>{const t=Math.max(Math.floor(this.repeatXState.get()),1),r=Math.max(Math.floor(this.repeatZState.get()),1),i=wSe+this.presetState.get()+".glb",s=la.exports.range(t).map(()=>xP(i,this,0)),o=la.exports.range(t).map(()=>xP(i,this,180)),a=la.exports.range(r).map(()=>xP(i,this,90)),c=la.exports.range(r).map(()=>xP(i,this,270)),u=s[0].loaded.then(()=>{const d=s[0].depth,p=d*.5;bP(s,p,d,t,r,!1),bP(o,-p,-d,t,r,!1),bP(a,-p,-d,t,r,!0),bP(c,p,d,t,r,!0)});return()=>{u.cancel();for(const d of s)d.dispose();for(const d of o)d.dispose();for(const d of a)d.dispose();for(const d of c)d.dispose()}},[this.presetState.get,this.repeatXState.get,this.repeatZState.get])}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get repeatX(){return this.repeatXState.get()}set repeatX(e){this.repeatXState.set(e)}get repeatZ(){return this.repeatZState.get()}set repeatZ(e){this.repeatZState.set(e)}}class T3 extends Bl{constructor(){super(),le(this,"presetState",new nn("industrial0")),le(this,"repeatXState",new nn(1)),le(this,"repeatZState",new nn(1)),le(this,"repeatYState",new nn(1)),this.scale=10,this.createEffect(()=>{const e=this.presetState.get(),t=this.repeatXState.get(),r=this.repeatZState.get(),i=Math.max(Math.floor(this.repeatYState.get()),1),s=la.exports.range(i).map(o=>{const a=new SSe(this);return a.preset=e,a.repeatX=t,a.repeatZ=r,a.y=o*100,a});return()=>{for(const o of s)o.dispose()}},[this.presetState.get,this.repeatXState.get,this.repeatZState.get,this.repeatYState.get])}get preset(){return this.presetState.get()}set preset(e){this.presetState.set(e)}get repeatX(){return this.repeatXState.get()}set repeatX(e){this.repeatXState.set(e)}get repeatZ(){return this.repeatZState.get()}set repeatZ(e){this.repeatZState.set(e)}get repeatY(){return this.repeatYState.get()}set repeatY(e){this.repeatYState.set(e)}}le(T3,"componentName","building"),le(T3,"defaults",bSe),le(T3,"schema",xSe);const MSe={...XL,preset:String},CSe={...qL,preset:"tree1",scale:4},ESe="https://unpkg.com/lingo3d-forest@1.0.0/assets/";class R3 extends ih{constructor(){super(),le(this,"_preset",""),this.scale=4,this.preset="tree1"}get preset(){return this._preset}set preset(e){this.src=ESe+e+".glb"}}le(R3,"componentName","tree"),le(R3,"defaults",CSe),le(R3,"schema",MSe);const vie={...Wre,...EL,...f9},gie={...Gre,...AL,...m9},ASe=new WeakMap;class EM extends GC{constructor(){super(...arguments),le(this,"material",zR)}async load(e){gne();const t=await rr(()=>import("./loadSVG.d4a4db0f.aa3ee79f.js"),[]);let r;try{r=await t.default(e)}catch{throw bM(),new Error("Failed to load svg, check if src is correct")}return bM(),r}resolveLoaded(e,t){const r=new Bh;r.scale.y*=-1;const i=hh(ASe,e,()=>{const o=[];for(const d of e.paths)for(const p of d.toShapes(!0))o.push(p);if(!o.length)return[];const a=new Bh;for(const d of o){const p=new NR(d,{depth:0,bevelEnabled:!1});p.dispose(),a.add(new Io(p))}const c=eH(a,t),u=[];for(const d of o)u.push(new NR(d,{depth:c.y,bevelEnabled:!1}));return u});for(const o of i){const a=new Io(o,this.material);a.castShadow=!0,a.receiveShadow=!0,r.add(a)}const s=Hre(r,t);return!this.widthSet&&(this.object3d.scale.x=s.x),!this.heightSet&&(this.object3d.scale.y=s.y),!this.depthSet&&(this.object3d.scale.z=s.z),r}}le(EM,"componentName","svgMesh"),le(EM,"defaults",gie),le(EM,"schema",vie);NC(EM,[jC,g9]);const PSe={...hu,element:Object,innerHTML:String,cssColor:String,sprite:Boolean};sb(["element"]);const TSe={...du,element:void 0,innerHTML:void 0,cssColor:"#ffffff",sprite:!1},db=n=>{const e=document.createElement("div");return e.innerHTML=n,e.children[0]},RSe=db(`
    <div style="position: absolute; visibility: hidden; pointer-events: none;"></div>
`);class O3 extends Bl{constructor(){super(),le(this,"elementState",new nn(void 0)),le(this,"innerHTMLState",new nn(void 0)),le(this,"spriteState",new nn(!1)),le(this,"cssColorState",new nn("#ffffff")),this.createEffect(()=>{let e=this.elementState.get();const t=this.innerHTMLState.get();if(!e&&t&&(e=db(t.startsWith("<")?t:`<div>${t}</div>`)),!e)return;const r=RSe.cloneNode();document.body.appendChild(r),r.appendChild(e);const i=new br;return rr(()=>import("./HTMLMesh.614ccc95.36bc7a06.js"),[]).then(({HTMLMesh:s,HTMLSprite:o})=>{if(i.done)return;const a=this.spriteState.get()?new o(e):new s(e);this.object3d.add(a),i.watch(this.cssColorState.get(c=>{r.style.color=c,a.update()})),i.then(()=>{this.object3d.remove(a),a.dispose()})}),()=>{document.body.removeChild(r),i.cancel()}},[this.elementState.get,this.spriteState.get,this.innerHTMLState.get])}get element(){return this.elementState.get()}set element(e){this.elementState.set(e)}get innerHTML(){return this.innerHTMLState.get()}set innerHTML(e){this.innerHTMLState.set(e)}get sprite(){return this.spriteState.get()}set sprite(e){this.spriteState.set(e)}get cssColor(){return this.cssColorState.get()}set cssColor(e){this.cssColorState.set(e)}}le(O3,"componentName","htmlMesh"),le(O3,"defaults",TSe),le(O3,"schema",PSe);const _ie={...hu,resolution:Number,blur:Number,contrast:Number,mirror:Number},yie={...du,resolution:256,blur:512,contrast:1.5,mirror:1,rotationX:-90};class L3 extends Bl{constructor(){const e=new Io($9);e.castShadow=!0,e.receiveShadow=!0,super(e),le(this,"resolutionState",new nn(256)),le(this,"blurState",new nn(512)),le(this,"contrastState",new nn(1.5)),le(this,"mirrorState",new nn(1)),this.rotationX=-90,rr(()=>import("./MeshReflectorMaterial.12e7c651.f8fedfed.js"),[]).then(({default:t})=>{this.createEffect(()=>{const r=xi();if(!r||this.done)return;const i=Ut(),s=e.material=new t(r,i,Qt,this.object3d,{resolution:this.resolutionState.get(),blur:[this.blurState.get(),this.blurState.get()],mixBlur:2.5,mixContrast:this.contrastState.get(),mirror:this.mirrorState.get(),distortionMap:void 0}),o=Rre(()=>{i.updateWorldMatrix(!0,!1),s.update()});return()=>{s.dispose(),o.cancel()}},[xi,Ut,this.resolutionState.get,this.blurState.get,this.contrastState.get,this.mirrorState.get])})}get resolution(){return this.resolutionState.get()}set resolution(e){this.resolutionState.set(e)}get blur(){return this.blurState.get()}set blur(e){this.blurState.set(e)}get contrast(){return this.contrastState.get()}set contrast(e){this.contrastState.set(e)}get mirror(){return this.mirrorState.get()}set mirror(e){this.mirrorState.set(e)}}le(L3,"componentName","reflector"),le(L3,"defaults",yie),le(L3,"schema",_ie);const xie={...hu,shape:String,normalMap:String,resolution:Number,speed:Number},bie={...du,shape:"plane",normalMap:Mne,resolution:512,speed:1,rotationX:-90};class D3 extends Bl{constructor(){super(),le(this,"shapeState",new nn("plane")),le(this,"normalMapState",new nn(Mne)),le(this,"resolutionState",new nn(512)),le(this,"speedState",new nn(1)),this.rotationX=-90,rr(()=>import("./Water.2ed78261.344b5c43.js"),[]).then(({Water:e})=>{this.createEffect(()=>{const t=this.normalMapState.get();if(!t)return;const r=this.shapeState.get()==="plane"?$9:Q9,i=this.resolutionState.get(),s=new e(r,{textureWidth:i,textureHeight:i,waterNormals:Aa(t),sunColor:16777215,waterColor:7695,distortionScale:3.7}),o=this.speedState.get();this.object3d.add(s);const a=Ri(()=>{s.material.uniforms.time.value+=RL[0]*o});return()=>{this.object3d.remove(s),a.cancel()}},[this.shapeState.get,this.normalMapState.get,this.resolutionState.get,this.speedState.get])})}get shape(){return this.shapeState.get()}set shape(e){this.shapeState.set(e)}get normalMap(){return this.normalMapState.get()}set normalMap(e){this.normalMapState.set(e)}get resolution(){return this.resolutionState.get()}set resolution(e){this.resolutionState.set(e)}get speed(){return this.speedState.get()}set speed(e){this.speedState.set(e)}}le(D3,"componentName","water"),le(D3,"defaults",bie),le(D3,"schema",xie);new sd;new ye;Lt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ot(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Ju.line={uniforms:aa.merge([Lt.common,Lt.fog,Lt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new ye;new ye;new Ir;new Ir;new Ir;new ye;new zn;new ene;new ye;new sd;new Jx;new Ir;const wie={...ML,onEnter:Function,onExit:Function,targetIds:[String,Array],pad:Boolean,radius:Number,interval:Number,helper:Boolean},Sie={...CL,onEnter:void 0,onExit:void 0,targetIds:void 0,pad:!1,radius:50,interval:300,helper:!0},rq=n=>{var e;return(e=_m.get(n))!=null?e:[]};class I3 extends OL{constructor(){const e=new wr;super(e),le(this,"refresh",new nn({})),le(this,"onEnter"),le(this,"onExit"),le(this,"_pad",!1),le(this,"_radius",50),le(this,"_interval",300),le(this,"_helper",!0),le(this,"_targetIds"),Qt.add(e);let t;this.createEffect(()=>{const{_radius:r,_interval:i,_targetIds:s,_pad:o}=this;if(!s)return;const a=r*nr,c=a*.2;let u=!1;const d=yne(i,-1,()=>{var p,f;const{x:v,y:x,z:y}=Kr(e),_=typeof s=="string"?rq(s):s.map(A=>[...rq(A)]).flat();let S=!1,C;for(const A of _){const{x:P,y:D,z:N}=Kr(A.nativeObject3d);if(o){const{y:j}=$p(A);S=Math.abs(v-P)<a&&Math.abs(x-(D-j*.5))<c&&Math.abs(y-N)<a}else S=Math.abs(v-P)<a&&Math.abs(x-D)<a&&Math.abs(y-N)<a;if(S){C=A;break}}u!==S&&(S&&C?((p=this.onEnter)==null||p.call(this,C),t&&(t.color="blue")):((f=this.onExit)==null||f.call(this),t&&(t.color="white"))),u=S});return()=>{d.cancel()}},[this.refresh.get]),this.createEffect(()=>{const{_radius:r,_helper:i,_pad:s}=this;if(!i||Ut()!==yi)return;const o=t=s?new WL:new qC;Ji.delete(o),e.add(o.outerObject3d),o.scale=r*nr*2,o.opacity=.5,o.height=s?10:100;const a=Qp(({target:c})=>c===o&&Ki(this));return()=>{o.dispose(),t=void 0,a.cancel()}},[this.refresh.get,Ut])}get pad(){return this._pad}set pad(e){this._pad=e,this.refresh.set({})}get radius(){return this._radius}set radius(e){this._radius=e,this.refresh.set({})}get interval(){return this._interval}set interval(e){this._interval=e,this.refresh.set({})}get helper(){return this._helper}set helper(e){this._helper=e,this.refresh.set({})}get targetIds(){return this._targetIds}set targetIds(e){this._targetIds=e,this.refresh.set({})}}le(I3,"componentName","trigger"),le(I3,"defaults",Sie),le(I3,"schema",wie);const Mie={...hu,helper:Boolean},Cie={...du,helper:!0};class N3 extends Bl{constructor(){super(),le(this,"helperState",new nn(!0)),le(this,"isSpawnPoint",!0),this.createEffect(()=>{if(!this.helperState.get()||Ut()!==yi)return;const e=new WL;Ji.delete(e),this.outerObject3d.add(e.outerObject3d),e.opacity=.5,e.height=10;const t=Qp(({target:r})=>r===e&&Ki(this));return()=>{e.dispose(),t.cancel()}},[this.helperState.get,Ut])}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}append(e){this._append(e),Qt.add(e.outerObject3d),e.placeAt(this)}}le(N3,"componentName","spawnPoint"),le(N3,"defaults",Cie),le(N3,"schema",Mie);const Eie={...ML,src:String,autoplay:Boolean,paused:Boolean,stopped:Boolean,loop:Boolean,volume:Number,playbackRate:Number,distance:Number,distanceModel:String,maxDistance:Number,rolloffFactor:Number},Aie={...CL,src:void 0,autoplay:!1,paused:!1,stopped:!1,loop:!1,volume:1,playbackRate:1,distance:1,maxDistance:1e4,distanceModel:"inverse",rolloffFactor:1},OSe=()=>{const n=new ym;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABINJREFUaEPtWkuIXEUUPad7Jkr8Jiq6iBJFkmACUdGFohFMXCioqBhJVBCJTBR1oSDGhYofJH5QF2KMuBMjKvhbGhcK7gVDEI0LUXEluIqS2HXkvtxqipea7pqelrwKPmhmmKmuV6fuuZ86t4hj+EiaIfmPLUHSpZJ2kLyP5J+SSFKly2PpwGmOk9QDYAsdSFoSQniC5FMA/iC5guTfnQZiiwNgVjjsVrhJ0qsALvCN+pnkRSQPdhZIi0bnS3oFwC0O4BCAJQB+Ibma5F+dA+I06pkvuEUel/QkgBMBDIxiyad7QHzR/cSZN0l6DcBat4I5+Yz/HgCY33QLiCQDYLtt0eicEMJLJO9KAPTdCjGGdAtISiMH8ZCk5wCcCsAWa+HUQLSfLBC3UigJw1MLvy1nvlLS6wAuy9AoF8mPApIOSi08XxpYNBB7ie00ySBpWQjhBZJzI2g0DsgaD78nA7ie5Idu3WHyzE0wMZCMM98raSeAM51Ctss5GpUCWSrpdwA/kdxM8kBq9fYkEwFp0ehip9GGQhqVAjlJ0j4AKwEcJnkHyY/nA3MUEN/p+ahoITLSaGkI4VmSjyQA7P/2WeiT+kik1gmSfgRwrlvYSpoHSL6ZAzME4hHHCiCbdOQjabNn5hU+0EJtKY2KLOJ+sUrS2wDM2k3eIbmN5DttMA0QAxEBSDrFE5WFygjUflp9dJ6kFwHc4Kuxv1lSm4iiCaJc+B2uaTAYvEvyzgTMVSS/SaMZIwhJF0raDWBdknHju2yhtuvLfdGxtJiERuMsMqy1zMqxMgghfAFgk395f6/XayqEWJNFi8xI+g7AmnG0ckCLoVExEEuEcdetQpD0PYDTbIK2v0QgN0v6BIBVobNjwCyWRgsC4rs+a6W/pDlJu3wCK/ktMBw5u/jAhz2EpoVcgXGmNmRkrRXpI2lW0g8eks0qt5P8qHH8GoD4GpvMPhgMdpJ8zP/2fr/f31IbkKailrRB0lfOhd9IrrKSpiaLNGKEpOVOrzPc6deS3F8NkNQbQwjfAljvQK4jubcqIDHnhRC+BHCtA9lKck9tQBo/CSF8BuBGB3I/yV3/A5laBjkyUdGZ/bihVty8qp09ye7LPPzaSdSye13hNyker5b0tVvnV1cmq0qIuRJlT7/f31pNibKQotFU8U+PhzK+/oNVRUfdvQA2jjvqdl18eI/klpHiQ0wyE8hBL7vmZFP8V3LQaklvuCWiHDRHcndWDkrLjQUKdM+QfNS/by+atkB3AIBpZ400RXI7ybdyovZEQkJLMl3v5/1rEkCxgVNakuWUxrZkehvJz4sl09I3Z0Tse1y8O6saEbtFxbStcLq3FbYn1ml3p8bJQVH7NcXT2gofpOLDfBs9EbVyk7XodoXT7fJCuh37Rk8mUKQN0AclPV9V6y1Dt6b3J+lsb4bePYJuRQerUf47NWoV0G2jt6dNJLen++3plnWa3JL02+3CgN07qePCQNtCrWCw0htFt/q47l/hyASDui/VZOg2vOYEYIekp6u55jSGbpdIsntbE108+xeZO79vduBVJgAAAABJRU5ErkJggg==",Ji.delete(n),n.scale=.5,n},LSe=new Map,DSe=new Qye,ISe=n=>hh(LSe,n,()=>new Promise((e,t)=>{DSe.load(n,r=>e(Object.freeze(r)),v9(n),t)})),[NSe,$R]=yt(void 0);_n(()=>{const n=$R();if(!n)return;const e=Ut();return e.add(n),()=>{e.remove(n)}},[Ut,$R]);class k3 extends OL{constructor(){!$R()&&NSe(new exe);const e=new rxe($R());super(e),le(this,"srcState",new nn(void 0)),le(this,"autoplayState",new nn(!1)),le(this,"pausedState",new nn(!1)),le(this,"stoppedState",new nn(!1)),Qt.add(e),this.createEffect(()=>{if(Ut()!==yi)return;const i=OSe();this.outerObject3d.add(i.outerObject3d);const s=Qp(({target:o})=>{o===i&&Ki(this)});return()=>{i.dispose(),s.cancel()}},[Ut]);const[t,r]=yt(!1);this.createEffect(()=>{const i=this.srcState.get();if(!i)return;let s=!0;return ISe(i).then(o=>{!s||(e.setBuffer(o),t(!0))}),()=>{s=!1,t(!1)}},[this.srcState.get]),this.createEffect(()=>{if(!(!r()||!this.autoplayState.get()||this.pausedState.get()||this.stoppedState.get()))return e.play(),()=>{this.stoppedState.get()?e.stop():e.pause()}},[r,this.autoplayState.get,this.pausedState.get,this.stoppedState.get])}dispose(){return this.done?this:(super.dispose(),this.outerObject3d.buffer&&this.outerObject3d.disconnect(),this)}play(){this.autoplay=!0,this.paused=!1,this.stopped=!1}pause(){this.paused=!0}stop(){this.stopped=!0}get src(){return this.srcState.get()}set src(e){this.srcState.set(e)}get autoplay(){return this.autoplayState.get()}set autoplay(e){this.autoplayState.set(e)}get paused(){return this.pausedState.get()}set paused(e){this.pausedState.set(e)}get stopped(){return this.stoppedState.get()}set stopped(e){this.stoppedState.set(e)}get loop(){return this.outerObject3d.loop}set loop(e){this.outerObject3d.loop=e}get volume(){return this.outerObject3d.getVolume()}set volume(e){this.outerObject3d.setVolume(e)}get playbackRate(){return this.outerObject3d.playbackRate}set playbackRate(e){this.outerObject3d.playbackRate=e}get distance(){return this.outerObject3d.getRefDistance()}set distance(e){this.outerObject3d.setRefDistance(e)}get distanceModel(){return this.outerObject3d.getDistanceModel()}set distanceModel(e){this.outerObject3d.setDistanceModel(e)}get maxDistance(){return this.outerObject3d.getMaxDistance()}set maxDistance(e){this.outerObject3d.setMaxDistance(e)}get rolloffFactor(){return this.outerObject3d.getRolloffFactor()}set rolloffFactor(e){this.outerObject3d.setRolloffFactor(e)}}le(k3,"componentName","audio"),le(k3,"defaults",Aie),le(k3,"schema",Eie);const[kSe,zSe]=Bo(),Pie={...hu},Tie={...du};class AM extends Bl{constructor(){super(new Bh)}}le(AM,"componentName","group"),le(AM,"defaults",Tie),le(AM,"schema",Pie);_n(()=>{const n=lh();if(!n.length)return;const e=new Bh;Qt.add(e);const t=new lb(e);rne.add(t),lx(t);const r=[];for(const{outerObject3d:o}of n)!o.parent||(r.push([o,o.parent]),e.attach(o));Iy.setFromObject(e);for(const[o,a]of r)a.attach(o);e.position.copy(Iy.getCenter(Pi));for(const[o]of r)e.attach(o);let i=!1;const s=zSe(()=>{if(!n.length||i)return;i=!0;const o=new AM;o.outerObject3d.position.copy(e.position);for(const a of n)o.attach(a);Ki(o)});return()=>{if(Ki(),!t.done&&!i)for(const[o,a]of r)a.attach(o);lx(void 0),t.dispose(),Qt.remove(e),s.cancel()}},[lh]);class xm extends _9{constructor(e){super(),le(this,"noEffect"),le(this,"data",{}),this.noEffect=e,!e&&(r1e(this.data),this.then(()=>i1e(this.data)))}}le(xm,"componentName","setup"),le(xm,"defaults",Yu),le(xm,"schema",XC);for(const n of Object.keys(XC))Object.defineProperty(xm.prototype,n,{get(){return this.data[n]},set(e){this.data[n]=e,!this.noEffect&&zre()}});const BSe={...jm},VSe={...Hm};class X5 extends Jp{constructor(){super(),_we(!0)}}le(X5,"componentName","sky"),le(X5,"defaults",VSe),le(X5,"schema",BSe);const Rie={...z9},Oie={...B9};class z3 extends U9{constructor(){super(new oo(75,1,Wm,eu))}}le(z3,"componentName","camera"),le(z3,"defaults",Oie),le(z3,"schema",Rie);const[KQe,FSe]=Bo(),hH={...z9,lockTargetRotation:[Boolean,String]},dH={...B9,lockTargetRotation:!0},Lie={...hH},Die={...dH,innerZ:300};class USe{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const r=t.slice(0);for(let i=0,s=r.length;i<s;i++)r[i].call(this,e);e.target=null}}}const ba=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function jSe(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ba[n&255]+ba[n>>8&255]+ba[n>>16&255]+ba[n>>24&255]+"-"+ba[e&255]+ba[e>>8&255]+"-"+ba[e>>16&15|64]+ba[e>>24&255]+"-"+ba[t&63|128]+ba[t>>8&255]+"-"+ba[t>>16&255]+ba[t>>24&255]+ba[r&255]+ba[r>>8&255]+ba[r>>16&255]+ba[r>>24&255]).toLowerCase()}function sm(n,e,t){return Math.max(e,Math.min(t,n))}class pH{constructor(){pH.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,s,o,a,c,u){const d=this.elements;return d[0]=e,d[1]=i,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=r,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],c=r[6],u=r[1],d=r[4],p=r[7],f=r[2],v=r[5],x=r[8],y=i[0],_=i[3],S=i[6],C=i[1],A=i[4],P=i[7],D=i[2],N=i[5],j=i[8];return s[0]=o*y+a*C+c*D,s[3]=o*_+a*A+c*N,s[6]=o*S+a*P+c*j,s[1]=u*y+d*C+p*D,s[4]=u*_+d*A+p*N,s[7]=u*S+d*P+p*j,s[2]=f*y+v*C+x*D,s[5]=f*_+v*A+x*N,s[8]=f*S+v*P+x*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-r*s*d+r*a*c+i*s*u-i*o*c}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=d*o-a*u,f=a*c-d*s,v=u*s-o*c,x=t*p+r*f+i*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return e[0]=p*y,e[1]=(i*u-d*r)*y,e[2]=(a*r-i*o)*y,e[3]=f*y,e[4]=(d*t-i*c)*y,e[5]=(i*s-a*t)*y,e[6]=v*y,e[7]=(r*c-u*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const c=Math.cos(s),u=Math.sin(s);return this.set(r*c,r*u,-r*(c*o+u*a)+o+e,-i*u,i*c,-i*(-u*o+c*a)+a+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],u=i[4],d=i[7];return i[0]=t*s+r*c,i[3]=t*o+r*u,i[6]=t*a+r*d,i[1]=-r*s+t*c,i[4]=-r*o+t*u,i[7]=-r*a+t*d,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}class YC{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let c=r[i+0],u=r[i+1],d=r[i+2],p=r[i+3];const f=s[o+0],v=s[o+1],x=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p;return}if(a===1){e[t+0]=f,e[t+1]=v,e[t+2]=x,e[t+3]=y;return}if(p!==y||c!==f||u!==v||d!==x){let _=1-a;const S=c*f+u*v+d*x+p*y,C=S>=0?1:-1,A=1-S*S;if(A>Number.EPSILON){const D=Math.sqrt(A),N=Math.atan2(D,S*C);_=Math.sin(_*N)/D,a=Math.sin(a*N)/D}const P=a*C;if(c=c*_+f*P,u=u*_+v*P,d=d*_+x*P,p=p*_+y*P,_===1-a){const D=1/Math.sqrt(c*c+u*u+d*d+p*p);c*=D,u*=D,d*=D,p*=D}}e[t]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],c=r[i+1],u=r[i+2],d=r[i+3],p=s[o],f=s[o+1],v=s[o+2],x=s[o+3];return e[t]=a*x+d*p+c*v-u*f,e[t+1]=c*x+d*f+u*p-a*v,e[t+2]=u*x+d*v+a*f-c*p,e[t+3]=d*x-a*p-c*f-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,u=a(r/2),d=a(i/2),p=a(s/2),f=c(r/2),v=c(i/2),x=c(s/2);switch(o){case"XYZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"YXZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"ZXY":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"ZYX":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"YZX":this._x=f*d*p+u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p-f*v*x;break;case"XZY":this._x=f*d*p-u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p+f*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],c=t[9],u=t[2],d=t[6],p=t[10],f=r+a+p;if(f>0){const v=.5/Math.sqrt(f+1);this._w=.25/v,this._x=(d-c)*v,this._y=(s-u)*v,this._z=(o-i)*v}else if(r>a&&r>p){const v=2*Math.sqrt(1+r-a-p);this._w=(d-c)/v,this._x=.25*v,this._y=(i+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-r-p);this._w=(s-u)/v,this._x=(i+o)/v,this._y=.25*v,this._z=(c+d)/v}else{const v=2*Math.sqrt(1+p-r-a);this._w=(o-i)/v,this._x=(s+u)/v,this._y=(c+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(sm(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,c=t._y,u=t._z,d=t._w;return this._x=r*d+o*a+i*u-s*c,this._y=i*d+o*c+s*a-r*u,this._z=s*d+o*u+r*c-i*a,this._w=o*d-r*a-i*c-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*r+t*this._x,this._y=v*i+t*this._y,this._z=v*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(c),d=Math.atan2(u,a),p=Math.sin((1-t)*d)/u,f=Math.sin(t*d)/u;return this._w=o*p+this._w*f,this._x=r*p+this._x*f,this._y=i*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class po{constructor(e=0,t=0,r=0){po.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(iq.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(iq.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,c=e.w,u=c*t+o*i-a*r,d=c*r+a*t-s*i,p=c*i+s*r-o*t,f=-s*t-o*r-a*i;return this.x=u*c+f*-s+d*-a-p*-o,this.y=d*c+f*-o+p*-s-u*-a,this.z=p*c+f*-a+u*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=i*c-s*a,this.y=s*o-r*c,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return q5.copy(this).projectOnVector(e),this.sub(q5)}reflect(e){return this.sub(q5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(sm(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const q5=new po,iq=new YC;class Bp{constructor(){Bp.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,s,o,a,c,u,d,p,f,v,x,y,_){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=i,S[1]=s,S[5]=o,S[9]=a,S[13]=c,S[2]=u,S[6]=d,S[10]=p,S[14]=f,S[3]=v,S[7]=x,S[11]=y,S[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bp().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/N_.setFromMatrixColumn(e,0).length(),s=1/N_.setFromMatrixColumn(e,1).length(),o=1/N_.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),c=Math.cos(i),u=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=-c*p,t[8]=u,t[1]=v+x*u,t[5]=f-y*u,t[9]=-a*c,t[2]=y-f*u,t[6]=x+v*u,t[10]=o*c}else if(e.order==="YXZ"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f+y*a,t[4]=x*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*d,t[9]=-a,t[2]=v*a-x,t[6]=y+f*a,t[10]=o*c}else if(e.order==="ZXY"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f-y*a,t[4]=-o*p,t[8]=x+v*a,t[1]=v+x*a,t[5]=o*d,t[9]=y-f*a,t[2]=-o*u,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=x*u-v,t[8]=f*u+y,t[1]=c*p,t[5]=y*u+f,t[9]=v*u-x,t[2]=-u,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=y-f*p,t[8]=x*p+v,t[1]=p,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=v*p+x,t[10]=f-y*p}else if(e.order==="XZY"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=-p,t[8]=u*d,t[1]=f*p+y,t[5]=o*d,t[9]=v*p-x,t[2]=x*p-v,t[6]=a*d,t[10]=y*p+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(HSe,e,WSe)}lookAt(e,t,r){const i=this.elements;return ac.subVectors(e,t),ac.lengthSq()===0&&(ac.z=1),ac.normalize(),zf.crossVectors(r,ac),zf.lengthSq()===0&&(Math.abs(r.z)===1?ac.x+=1e-4:ac.z+=1e-4,ac.normalize(),zf.crossVectors(r,ac)),zf.normalize(),wP.crossVectors(ac,zf),i[0]=zf.x,i[4]=wP.x,i[8]=ac.x,i[1]=zf.y,i[5]=wP.y,i[9]=ac.y,i[2]=zf.z,i[6]=wP.z,i[10]=ac.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],c=r[8],u=r[12],d=r[1],p=r[5],f=r[9],v=r[13],x=r[2],y=r[6],_=r[10],S=r[14],C=r[3],A=r[7],P=r[11],D=r[15],N=i[0],j=i[4],T=i[8],k=i[12],U=i[1],ee=i[5],xe=i[9],ce=i[13],te=i[2],fe=i[6],ge=i[10],Se=i[14],pe=i[3],se=i[7],ae=i[11],Le=i[15];return s[0]=o*N+a*U+c*te+u*pe,s[4]=o*j+a*ee+c*fe+u*se,s[8]=o*T+a*xe+c*ge+u*ae,s[12]=o*k+a*ce+c*Se+u*Le,s[1]=d*N+p*U+f*te+v*pe,s[5]=d*j+p*ee+f*fe+v*se,s[9]=d*T+p*xe+f*ge+v*ae,s[13]=d*k+p*ce+f*Se+v*Le,s[2]=x*N+y*U+_*te+S*pe,s[6]=x*j+y*ee+_*fe+S*se,s[10]=x*T+y*xe+_*ge+S*ae,s[14]=x*k+y*ce+_*Se+S*Le,s[3]=C*N+A*U+P*te+D*pe,s[7]=C*j+A*ee+P*fe+D*se,s[11]=C*T+A*xe+P*ge+D*ae,s[15]=C*k+A*ce+P*Se+D*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],c=e[9],u=e[13],d=e[2],p=e[6],f=e[10],v=e[14],x=e[3],y=e[7],_=e[11],S=e[15];return x*(+s*c*p-i*u*p-s*a*f+r*u*f+i*a*v-r*c*v)+y*(+t*c*v-t*u*f+s*o*f-i*o*v+i*u*d-s*c*d)+_*(+t*u*p-t*a*v-s*o*p+r*o*v+s*a*d-r*u*d)+S*(-i*a*d-t*c*p+t*a*f+i*o*p-r*o*f+r*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=e[9],f=e[10],v=e[11],x=e[12],y=e[13],_=e[14],S=e[15],C=p*_*u-y*f*u+y*c*v-a*_*v-p*c*S+a*f*S,A=x*f*u-d*_*u-x*c*v+o*_*v+d*c*S-o*f*S,P=d*y*u-x*p*u+x*a*v-o*y*v-d*a*S+o*p*S,D=x*p*c-d*y*c-x*a*f+o*y*f+d*a*_-o*p*_,N=t*C+r*A+i*P+s*D;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const j=1/N;return e[0]=C*j,e[1]=(y*f*s-p*_*s-y*i*v+r*_*v+p*i*S-r*f*S)*j,e[2]=(a*_*s-y*c*s+y*i*u-r*_*u-a*i*S+r*c*S)*j,e[3]=(p*c*s-a*f*s-p*i*u+r*f*u+a*i*v-r*c*v)*j,e[4]=A*j,e[5]=(d*_*s-x*f*s+x*i*v-t*_*v-d*i*S+t*f*S)*j,e[6]=(x*c*s-o*_*s-x*i*u+t*_*u+o*i*S-t*c*S)*j,e[7]=(o*f*s-d*c*s+d*i*u-t*f*u-o*i*v+t*c*v)*j,e[8]=P*j,e[9]=(x*p*s-d*y*s-x*r*v+t*y*v+d*r*S-t*p*S)*j,e[10]=(o*y*s-x*a*s+x*r*u-t*y*u-o*r*S+t*a*S)*j,e[11]=(d*a*s-o*p*s-d*r*u+t*p*u+o*r*v-t*a*v)*j,e[12]=D*j,e[13]=(d*y*i-x*p*i+x*r*f-t*y*f-d*r*_+t*p*_)*j,e[14]=(x*a*i-o*y*i-x*r*c+t*y*c+o*r*_-t*a*_)*j,e[15]=(o*p*i-d*a*i+d*r*c-t*p*c-o*r*f+t*a*f)*j,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,c=e.z,u=s*o,d=s*a;return this.set(u*o+r,u*a-i*c,u*c+i*a,0,u*a+i*c,d*a+r,d*c-i*o,0,u*c-i*a,d*c+i*o,s*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,u=s+s,d=o+o,p=a+a,f=s*u,v=s*d,x=s*p,y=o*d,_=o*p,S=a*p,C=c*u,A=c*d,P=c*p,D=r.x,N=r.y,j=r.z;return i[0]=(1-(y+S))*D,i[1]=(v+P)*D,i[2]=(x-A)*D,i[3]=0,i[4]=(v-P)*N,i[5]=(1-(f+S))*N,i[6]=(_+C)*N,i[7]=0,i[8]=(x+A)*j,i[9]=(_-C)*j,i[10]=(1-(f+y))*j,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=N_.set(i[0],i[1],i[2]).length();const o=N_.set(i[4],i[5],i[6]).length(),a=N_.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Fu.copy(this);const c=1/s,u=1/o,d=1/a;return Fu.elements[0]*=c,Fu.elements[1]*=c,Fu.elements[2]*=c,Fu.elements[4]*=u,Fu.elements[5]*=u,Fu.elements[6]*=u,Fu.elements[8]*=d,Fu.elements[9]*=d,Fu.elements[10]*=d,t.setFromRotationMatrix(Fu),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o){const a=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),p=(r+i)/(r-i),f=-(o+s)/(o-s),v=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=u,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=v,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,s,o){const a=this.elements,c=1/(t-e),u=1/(r-i),d=1/(o-s),p=(t+e)*c,f=(r+i)*u,v=(o+s)*d;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-v,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const N_=new po,Fu=new Bp,HSe=new po(0,0,0),WSe=new po(1,1,1),zf=new po,wP=new po,ac=new po,sq=new Bp,oq=new YC;class ZC{constructor(e=0,t=0,r=0,i=ZC.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],c=i[1],u=i[5],d=i[9],p=i[2],f=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(sm(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-sm(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(sm(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-sm(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(f,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(sm(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-sm(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return sq.makeRotationFromQuaternion(e),this.setFromRotationMatrix(sq,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return oq.setFromEuler(this),this.setFromQuaternion(oq,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}ZC.DefaultOrder="XYZ";ZC.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class GSe{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let XSe=0;const aq=new po,k_=new YC,hp=new Bp,SP=new po,yS=new po,qSe=new po,YSe=new YC,lq=new po(1,0,0),cq=new po(0,1,0),uq=new po(0,0,1),ZSe={type:"added"},hq={type:"removed"};class bm extends USe{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:XSe++}),this.uuid=jSe(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=bm.DefaultUp.clone();const e=new po,t=new ZC,r=new YC,i=new po(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Bp},normalMatrix:{value:new pH}}),this.matrix=new Bp,this.matrixWorld=new Bp,this.matrixAutoUpdate=bm.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=bm.DefaultMatrixWorldAutoUpdate,this.layers=new GSe,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return k_.setFromAxisAngle(e,t),this.quaternion.multiply(k_),this}rotateOnWorldAxis(e,t){return k_.setFromAxisAngle(e,t),this.quaternion.premultiply(k_),this}rotateX(e){return this.rotateOnAxis(lq,e)}rotateY(e){return this.rotateOnAxis(cq,e)}rotateZ(e){return this.rotateOnAxis(uq,e)}translateOnAxis(e,t){return aq.copy(e).applyQuaternion(this.quaternion),this.position.add(aq.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(lq,e)}translateY(e){return this.translateOnAxis(cq,e)}translateZ(e){return this.translateOnAxis(uq,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(hp.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?SP.copy(e):SP.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),yS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hp.lookAt(yS,SP,this.up):hp.lookAt(SP,yS,this.up),this.quaternion.setFromRotationMatrix(hp),i&&(hp.extractRotation(i.matrixWorld),k_.setFromRotationMatrix(hp),this.quaternion.premultiply(k_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ZSe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(hq)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(hq)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),hp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),hp.multiply(e.parent.matrixWorld)),e.applyMatrix4(hp),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r].getObjectByProperty(e,t);if(s!==void 0)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yS,e,qSe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yS,YSe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const p=c[u];s(e.shapes,p)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,u=this.material.length;c<u;c++)a.push(s(e.materials,this.material[c]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];i.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),u=o(e.textures),d=o(e.images),p=o(e.shapes),f=o(e.skeletons),v=o(e.animations),x=o(e.nodes);a.length>0&&(r.geometries=a),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),f.length>0&&(r.skeletons=f),v.length>0&&(r.animations=v),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(a){const c=[];for(const u in a){const d=a[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}bm.DefaultUp=new po(0,1,0);bm.DefaultMatrixAutoUpdate=!0;bm.DefaultMatrixWorldAutoUpdate=!0;const Y5=new bm,Iie=n=>{const e=Kr(n.outerObject3d).normalize();return Y5.lookAt(e),Y5.rotateX($S),n.outerObject3d.quaternion.copy(Y5.quaternion)};class eO extends j9{constructor(){super(new oo(75,1,Wm,eu)),le(this,"lockTargetRotation",!0);const e=this.midObject3d=new wr;this.outerObject3d.add(e),e.add(this.object3d);const t=this.camera;Qt.attach(t),this.then(()=>Qt.remove(t)),this.createEffect(()=>{const o=this.targetState.get();!o||"frustumCulled"in o&&(o.frustumCulled=!1)},[this.targetState.get]);const r=(o,a)=>{Xi.setFromQuaternion(o.outerObject3d.quaternion),Xi.y+=Math.PI,a?(Vg.setFromEuler(Xi),e.quaternion.slerp(Vg,_0(.1))):e.setRotationFromEuler(Xi),this.updateAngle()},i=(o,a,c)=>{if(Xi.setFromQuaternion(this.midObject3d.quaternion),Xi.x=0,Xi.z=0,Xi.y+=Math.PI,c){const d=swe(o);Vg.copy(o.outerObject3d.quaternion);const p=d.rotation.y;o.outerObject3d.quaternion.copy(c),d.rotation.y=Xi.y,Xi.setFromQuaternion(Tm(d)),d.rotation.y=p,o.outerObject3d.quaternion.copy(Vg)}const u=tU.has(o);if(a&&!u){Vg.setFromEuler(Xi),o.outerObject3d.quaternion.slerp(Vg,_0(.1));return}o.outerObject3d.setRotationFromEuler(Xi),c&&u&&tU.delete(o)};let s=!1;this.createEffect(()=>{const o=this.targetState.get();if(!o)return;r(o,!1);let[a,c,u]=[0,0,0];const d=()=>{const{x:v,y:x,z:y}=o.outerObject3d.position,_=v!==a||x!==c||y!==u;return[a,c,u]=[v,x,y],_},p=Gp(),f=Ri(()=>{this.outerObject3d.position.copy(o.outerObject3d.position);const v=p?Iie(this):void 0;if(this.lockTargetRotation){if(this.lockTargetRotation==="follow"||s){r(o,!1);return}if(this.lockTargetRotation==="dynamic-lock"){d()&&i(o,!0,v);return}if(this.lockTargetRotation==="dynamic-follow"){d()&&r(o,!0);return}i(o,!1,v)}});return()=>{f.cancel()}},[this.targetState.get,Gp]),this.createEffect(()=>{const o=this.targetState.get(),a=ps(),c=lu(),u=y0();if(o&&o===a&&c&&u==="rotate")return s=!0,()=>{s=!1}},[this.targetState.get,ps,lu,y0])}}le(eO,"defaults",dH),le(eO,"schema",hH);const dq=new Set,pq=(n,e)=>{"visible"in n&&(n.visible=e)};let Nie=!1;_n(()=>{Nie=Na()||!!au()&&Ut()===yi},[Na,au,Ut]);class PM extends eO{constructor(){super(),this.innerZ=300,this.orbitMode=!0;const e=this.camera;rr(()=>import("./bvhCameraLoop.b29aafb2.30bec4c8.js"),["assets/bvhCameraLoop.b29aafb2.30bec4c8.js","assets/useBVHMap.37f7c48f.6f03e93c.js"]).then(()=>{this.createEffect(()=>{const t=this.targetState.get();if(!t){const o=Ri(()=>{e.position.copy(Kr(this.object3d)),e.quaternion.copy(Tm(this.object3d))});return()=>{o.cancel()}}dq.add(e);let r=!0;pq(t,!r);let i=!0;const s=FSe(()=>{const o=Kr(this.outerObject3d),a=Kr(this.object3d),c=a.distanceTo(o);e.position.lerp(a,i?1:_0(.1));const u=i?1:e.position.distanceTo(o)/c;e.position.lerpVectors(o,a,u),e.quaternion.copy(Tm(this.object3d));const d=Nie?!1:u<.35;d!==r&&pq(t,!d),r=d,i=!1});return()=>{s.cancel(),dq.delete(e)}},[this.targetState.get])})}}le(PM,"componentName","thirdPersonCamera"),le(PM,"defaults",Die),le(PM,"schema",Lie);class kie extends eO{constructor(){super(),le(this,"innerYSetState",new nn(!1));const e=this.camera;this.watch(Ri(()=>{e.position.copy(Kr(this.object3d)),e.quaternion.copy(Tm(this.object3d))})),this.createEffect(()=>{const t=this.targetState.get(),r=this.innerYSetState.get();if(!(!t||!("height"in t)||r))return super.innerY=t.height*.4,()=>{super.innerY=0}},[this.targetState.get,this.innerYSetState.get])}get innerY(){return super.innerY}set innerY(e){super.innerY=e,this.innerYSetState.set(!0)}}le(kie,"componentName","firstPersonCamera");class KC extends Bl{constructor(e,t){const r=new Bh;super(r),le(this,"lightState",new nn(void 0)),le(this,"defaultShadowResolution",256),le(this,"defaultShadowBias",C9),le(this,"shadowResolutionComputedState",new nn(void 0)),le(this,"shadowBiasComputedState",new nn(void 0)),le(this,"helperState",new nn(!0)),le(this,"castShadowState",new nn(!0)),le(this,"shadowResolutionState",new nn(void 0)),le(this,"shadowBiasState",new nn(void 0)),this.createEffect(()=>{var i,s,o,a;const c=new e;if(this.lightState.set(c),r.add(c),c.shadow&&this.castShadowState.get()){const u=(s=(i=this.shadowResolutionState.get())!=null?i:gU())!=null?s:this.defaultShadowResolution,d=(a=(o=this.shadowBiasState.get())!=null?o:mU())!=null?a:this.defaultShadowBias;this.shadowBiasComputedState.set(d),this.shadowResolutionComputedState.set(u),c.castShadow=!0,c.shadow.bias=d,c.shadow.mapSize.width=u,c.shadow.mapSize.height=u}return()=>{r.remove(c),c.dispose()}},[this.castShadowState.get,this.shadowResolutionState.get,this.shadowBiasState.get,gU,mU]),this.createEffect(()=>{const i=this.lightState.get();if(Ut()!==yi||!this.helperState.get()||!i)return;const s=new br,o=Dre();if(s.watch(Qp(({target:a})=>{a===o&&Ki(this)})),t){const a=new t(i);Qt.add(a),a.add(o.outerObject3d),"update"in a&&s.watch(Ri(()=>a.update())),s.then(()=>{a.dispose(),Qt.remove(a)})}else this.outerObject3d.add(o.outerObject3d);return()=>{o.dispose(),s.cancel()}},[Ut,this.helperState.get,this.lightState.get])}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}get castShadow(){return this.castShadowState.get()}set castShadow(e){this.castShadowState.set(e)}get shadowResolution(){return this.shadowResolutionState.get()}set shadowResolution(e){this.shadowResolutionState.set(e)}get shadowBias(){return this.shadowBiasState.get()}set shadowBias(e){this.shadowBiasState.set(e)}get color(){const e=this.lightState.get();return e?"#"+e.color.getHexString():"#ffffff"}set color(e){this.cancelHandle("color",()=>this.lightState.get(t=>t&&(t.color=new Xt(e))))}get intensity(){const e=this.lightState.get();return e?e.intensity:1}set intensity(e){this.cancelHandle("intensity",()=>this.lightState.get(t=>t&&(t.intensity=e)))}}const JC={...hu,color:String,intensity:Number,shadowResolution:Number,shadowBias:Number,helper:Boolean},QC={...du,color:"#ffffff",intensity:1,shadowResolution:new Ti(256),shadowBias:new Ti(C9),helper:!0},zie={...JC},Bie={...QC},Vie={...zie},Fie={...Bie,castShadow:!1};class B3 extends KC{constructor(){super(Kye)}get castShadow(){return!1}set castShadow(e){}}le(B3,"componentName","ambientLight"),le(B3,"defaults",Fie),le(B3,"schema",Vie);class KSe extends $j{constructor(e,t){const r=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],i=new Oi;i.setAttribute("position",new Hn(r,3)),i.computeBoundingSphere();const s=new P0({fog:!1});super(i,s),this.light=e,this.color=t,this.type="RectAreaLightHelper";const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new Oi;a.setAttribute("position",new Hn(o,3)),a.computeBoundingSphere(),this.add(new Io(a,new eb({side:Ol,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Uie={...JC},jie={...QC,depth:0,scaleZ:0,castShadow:!1},JSe=pL(async()=>{const{RectAreaLightUniformsLib:n}=await rr(()=>import("./RectAreaLightUniformsLib.cab8d379.e8c1ae72.js"),[]);n.init()});class V3 extends Bl{constructor(){super(),le(this,"light"),le(this,"shadowResolution"),le(this,"shadowBias"),le(this,"helperState",new nn(!0)),le(this,"_color"),le(this,"_intensity"),le(this,"_width"),le(this,"_height"),le(this,"_scaleX"),le(this,"_scaleY"),JSe().then(()=>{if(this.done)return;const e=this.light=new Jye(this._color,this._intensity,this.width*this.scaleX*nr,this.height*this.scaleY*nr);this.object3d.add(e),this.then(()=>e.dispose()),this.createEffect(()=>{if(y0()!=="scale"||ps()!==this)return;const t=xre(()=>{const{x:r,y:i}=this.outerObject3d.scale;this.scaleX=r,this.scaleY=i});return()=>{t.cancel()}},[y0,ps]),this.createEffect(()=>{if(Ut()!==yi||!this.helperState.get())return;const t=new KSe(e);return Qt.add(t),()=>{t.dispose(),Qt.remove(t)}},[Ut,this.helperState.get])})}get castShadow(){return!1}set castShadow(e){}get helper(){return this.helperState.get()}set helper(e){this.helperState.set(e)}get color(){var e;return(e=this._color)!=null?e:"#ffffff"}set color(e){this._color=e,this.light&&(this.light.color=new Xt(e))}get intensity(){var e;return(e=this._intensity)!=null?e:1}set intensity(e){this._intensity=e,this.light&&(this.light.intensity=e)}get width(){var e;return(e=this._width)!=null?e:100}set width(e){this._width=e,this.light&&(this.light.width=e*this.scaleX*nr)}get height(){var e;return(e=this._height)!=null?e:100}set height(e){this._height=e,this.light&&(this.light.height=e*this.scaleY*nr)}get scaleX(){var e;return(e=this._scaleX)!=null?e:1}set scaleX(e){this._scaleX=e,this.light&&(this.light.width=e*this.width*nr)}get scaleY(){var e;return(e=this._scaleY)!=null?e:1}set scaleY(e){this._scaleY=e,this.light&&(this.light.height=e*this.height*nr)}get depth(){return 0}set depth(e){}get scaleZ(){return 0}set scaleZ(e){}}le(V3,"componentName","areaLight"),le(V3,"defaults",jie),le(V3,"schema",Uie);var Hie={},ud={};Object.defineProperty(ud,"__esModule",{value:!0});ud.BladeApi=void 0;var QSe=function(){function n(e){this.controller_=e}return Object.defineProperty(n.prototype,"element",{get:function(){return this.controller_.view.element},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this.controller_.viewProps.get("disabled")},set:function(e){this.controller_.viewProps.set("disabled",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this.controller_.viewProps.get("hidden")},set:function(e){this.controller_.viewProps.set("hidden",e)},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.controller_.viewProps.set("disposed",!0)},n}();ud.BladeApi=QSe;var Wie={};Object.defineProperty(Wie,"__esModule",{value:!0});var Gie={};Object.defineProperty(Gie,"__esModule",{value:!0});var To={},YL=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(To,"__esModule",{value:!0});To.TpTabSelectEvent=To.TpFoldEvent=To.TpUpdateEvent=To.TpChangeEvent=To.TpEvent=void 0;var $C=function(){function n(e){this.target=e}return n}();To.TpEvent=$C;var $Se=function(n){YL(e,n);function e(t,r,i,s){var o=n.call(this,t)||this;return o.value=r,o.presetKey=i,o.last=s!=null?s:!0,o}return e}($C);To.TpChangeEvent=$Se;var eMe=function(n){YL(e,n);function e(t,r,i){var s=n.call(this,t)||this;return s.value=r,s.presetKey=i,s}return e}($C);To.TpUpdateEvent=eMe;var tMe=function(n){YL(e,n);function e(t,r){var i=n.call(this,t)||this;return i.expanded=r,i}return e}($C);To.TpFoldEvent=tMe;var nMe=function(n){YL(e,n);function e(t,r){var i=n.call(this,t)||this;return i.index=r,i}return e}($C);To.TpTabSelectEvent=nMe;var e2={},Vl={},Wn={};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.deepEqualsArray=Wn.isEmpty=Wn.forceCast=void 0;function rMe(n){return n}Wn.forceCast=rMe;function iMe(n){return n==null}Wn.isEmpty=iMe;function sMe(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}Wn.deepEqualsArray=sMe;Object.defineProperty(Vl,"__esModule",{value:!0});Vl.TpError=void 0;var oMe=Wn,aMe={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(n){return"Invalid parameters for '"+n.name+"'"},nomatchingcontroller:function(n){return"No matching controller for '"+n.key+"'"},nomatchingview:function(n){return"No matching view for '"+JSON.stringify(n.params)+"'"},notbindable:function(){return"Value is not bindable"},propertynotfound:function(n){return"Property '"+n.name+"' not found"},shouldneverhappen:function(){return"This error should never happen"}},lMe=function(){function n(e){var t;this.message=(t=aMe[e.type]((0,oMe.forceCast)(e.context)))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return n.alreadyDisposed=function(){return new n({type:"alreadydisposed"})},n.notBindable=function(){return new n({type:"notbindable"})},n.propertyNotFound=function(e){return new n({type:"propertynotfound",context:{name:e}})},n.shouldNeverHappen=function(){return new n({type:"shouldneverhappen"})},n}();Vl.TpError=lMe;Object.defineProperty(e2,"__esModule",{value:!0});e2.BindingTarget=void 0;var fq=Vl,cMe=function(){function n(e,t,r){this.obj_=e,this.key_=t,this.presetKey_=r!=null?r:t}return n.isBindable=function(e){return!(e===null||typeof e!="object")},Object.defineProperty(n.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!1,configurable:!0}),n.prototype.read=function(){return this.obj_[this.key_]},n.prototype.write=function(e){this.obj_[this.key_]=e},n.prototype.writeProperty=function(e,t){var r=this.read();if(!n.isBindable(r))throw fq.TpError.notBindable();if(!(e in r))throw fq.TpError.propertyNotFound(e);r[e]=t},n}();e2.BindingTarget=cMe;var t2={},uMe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(t2,"__esModule",{value:!0});t2.ButtonApi=void 0;var hMe=ud,dMe=To,pMe=function(n){uMe(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var t;return(t=this.controller_.valueController.props.get("title"))!==null&&t!==void 0?t:""},set:function(t){this.controller_.valueController.props.set("title",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=this,s=r.bind(this),o=this.controller_.valueController.emitter;return o.on(t,function(){s(new dMe.TpEvent(i))}),this},e}(hMe.BladeApi);t2.ButtonApi=pMe;var n2={},Es={};Object.defineProperty(Es,"__esModule",{value:!0});Es.Emitter=void 0;var fMe=function(){function n(){this.observers_={}}return n.prototype.on=function(e,t){var r=this.observers_[e];return r||(r=this.observers_[e]=[]),r.push({handler:t}),this},n.prototype.off=function(e,t){var r=this.observers_[e];return r&&(this.observers_[e]=r.filter(function(i){return i.handler!==t})),this},n.prototype.emit=function(e,t){var r=this.observers_[e];!r||r.forEach(function(i){i.handler(t)})},n}();Es.Emitter=fMe;var r2={},pr={};Object.defineProperty(pr,"__esModule",{value:!0});pr.ClassName=void 0;var mMe="tp";function vMe(n){var e=function(t,r){return[mMe,"-",n,"v",t?"_"+t:"",r?"-"+r:""].join("")};return e}pr.ClassName=vMe;var Nl={},fo={};Object.defineProperty(fo,"__esModule",{value:!0});fo.bindValueMap=fo.bindValue=void 0;function gMe(n,e){return function(t){return e(n(t))}}function _Me(n){return n.rawValue}function Xie(n,e){n.emitter.on("change",gMe(_Me,e)),e(n.rawValue)}fo.bindValue=Xie;function yMe(n,e,t){Xie(n.value(e),t)}fo.bindValueMap=yMe;Object.defineProperty(Nl,"__esModule",{value:!0});Nl.bindValueToTextContent=Nl.valueToClassName=void 0;var xMe=fo;function bMe(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function wMe(n,e){return function(t){bMe(n,e,t)}}Nl.valueToClassName=wMe;function SMe(n,e){(0,xMe.bindValue)(n,function(t){e.textContent=t!=null?t:""})}Nl.bindValueToTextContent=SMe;Object.defineProperty(r2,"__esModule",{value:!0});r2.ButtonView=void 0;var MMe=pr,CMe=Nl,Z5=(0,MMe.ClassName)("btn"),EMe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Z5()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("button");r.classList.add(Z5("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var i=e.createElement("div");i.classList.add(Z5("t")),(0,CMe.bindValueToTextContent)(t.props.value("title"),i),this.buttonElement.appendChild(i)}return n}();r2.ButtonView=EMe;Object.defineProperty(n2,"__esModule",{value:!0});n2.ButtonController=void 0;var AMe=Es,PMe=r2,TMe=function(){function n(e,t){this.emitter=new AMe.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new PMe.ButtonView(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();n2.ButtonController=TMe;var i2={},$i={},_l={},ZL={};Object.defineProperty(ZL,"__esModule",{value:!0});ZL.BoundValue=void 0;var RMe=Es,OMe=function(){function n(e,t){var r;this.constraint_=t==null?void 0:t.constraint,this.equals_=(r=t==null?void 0:t.equals)!==null&&r!==void 0?r:function(i,s){return i===s},this.emitter=new RMe.Emitter,this.rawValue_=e}return Object.defineProperty(n.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var r=t!=null?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=!this.equals_(this.rawValue_,i);!s&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:r,rawValue:i,sender:this}))},n}();ZL.BoundValue=OMe;var KL={};Object.defineProperty(KL,"__esModule",{value:!0});KL.PrimitiveValue=void 0;var LMe=Es,DMe=function(){function n(e){this.emitter=new LMe.Emitter,this.value_=e}return Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.value_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var r=t!=null?t:{forceEmit:!1,last:!0};this.value_===e&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:r,rawValue:this.value_,sender:this}))},n}();KL.PrimitiveValue=DMe;Object.defineProperty(_l,"__esModule",{value:!0});_l.createValue=void 0;var IMe=ZL,NMe=KL;function kMe(n,e){var t=e==null?void 0:e.constraint,r=e==null?void 0:e.equals;return!t&&!r?new NMe.PrimitiveValue(n):new IMe.BoundValue(n,e)}_l.createValue=kMe;Object.defineProperty($i,"__esModule",{value:!0});$i.ValueMap=void 0;var zMe=Es,BMe=_l,VMe=function(){function n(e){var t=this;this.emitter=new zMe.Emitter,this.valMap_=e;var r=function(o){var a=i.valMap_[o];a.emitter.on("change",function(){t.emitter.emit("change",{key:o,sender:t})})},i=this;for(var s in this.valMap_)r(s)}return n.createCore=function(e){var t=Object.keys(e);return t.reduce(function(r,i){var s;return Object.assign(r,(s={},s[i]=(0,BMe.createValue)(e[i]),s))},{})},n.fromObject=function(e){var t=this.createCore(e);return new n(t)},n.prototype.get=function(e){return this.valMap_[e].rawValue},n.prototype.set=function(e,t){this.valMap_[e].rawValue=t},n.prototype.value=function(e){return this.valMap_[e]},n}();$i.ValueMap=VMe;var Hs={};(function(n){var e=At&&At.__assign||function(){return e=Object.assign||function(d){for(var p,f=1,v=arguments.length;f<v;f++){p=arguments[f];for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(d[x]=p[x])}return d},e.apply(this,arguments)},t=At&&At.__spreadArray||function(d,p,f){if(f||arguments.length===2)for(var v=0,x=p.length,y;v<x;v++)(y||!(v in p))&&(y||(y=Array.prototype.slice.call(p,0,v)),y[v]=p[v]);return d.concat(y||Array.prototype.slice.call(p))};Object.defineProperty(n,"__esModule",{value:!0}),n.parseParams=n.ParamsParsers=void 0;var r=Wn;function i(d,p){var f=Object.keys(p),v=f.reduce(function(x,y){var _;if(x!==void 0){var S=p[y],C=S(d[y]);return C.succeeded?e(e({},x),(_={},_[y]=C.value,_)):void 0}},{});return(0,r.forceCast)(v)}function s(d,p){return d.reduce(function(f,v){if(f!==void 0){var x=p(v);if(!(!x.succeeded||x.value===void 0))return t(t([],f,!0),[x.value],!1)}},[])}function o(d){return d===null?!1:typeof d=="object"}function a(d){return function(p){return function(f){if(!p&&f===void 0)return{succeeded:!1,value:void 0};if(p&&f===void 0)return{succeeded:!0,value:void 0};var v=d(f);return v!==void 0?{succeeded:!0,value:v}:{succeeded:!1,value:void 0}}}}function c(d){return{custom:function(p){return a(p)(d)},boolean:a(function(p){return typeof p=="boolean"?p:void 0})(d),number:a(function(p){return typeof p=="number"?p:void 0})(d),string:a(function(p){return typeof p=="string"?p:void 0})(d),function:a(function(p){return typeof p=="function"?p:void 0})(d),constant:function(p){return a(function(f){return f===p?p:void 0})(d)},raw:a(function(p){return p})(d),object:function(p){return a(function(f){if(o(f))return i(f,p)})(d)},array:function(p){return a(function(f){if(Array.isArray(f))return s(f,p)})(d)}}}n.ParamsParsers={optional:c(!0),required:c(!1)};function u(d,p){var f=n.ParamsParsers.required.object(p)(d);return f.succeeded?f.value:void 0}n.parseParams=u})(Hs);var O0={},ef={},JL={};Object.defineProperty(JL,"__esModule",{value:!0});JL.disposeElement=void 0;function FMe(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}JL.disposeElement=FMe;var s2={};Object.defineProperty(s2,"__esModule",{value:!0});s2.getAllBladePositions=void 0;function UMe(){return["veryfirst","first","last","verylast"]}s2.getAllBladePositions=UMe;Object.defineProperty(ef,"__esModule",{value:!0});ef.BladeController=void 0;var jMe=JL,HMe=pr,WMe=s2,mq=(0,HMe.ClassName)(""),vq={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},GMe=function(){function n(e){var t=this;this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var r=this.view.element;this.blade.value("positions").emitter.on("change",function(){(0,WMe.getAllBladePositions)().forEach(function(i){r.classList.remove(mq(void 0,vq[i]))}),t.blade.get("positions").forEach(function(i){r.classList.add(mq(void 0,vq[i]))})}),this.viewProps.handleDispose(function(){(0,jMe.disposeElement)(r)})}return Object.defineProperty(n.prototype,"parent",{get:function(){return this.parent_},enumerable:!1,configurable:!0}),n}();ef.BladeController=GMe;var pb={},pa={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.findNextTarget=n.indexOfChildElement=n.removeChildNodes=n.removeChildElements=n.removeElement=n.insertElementAt=n.createSvgIconElement=n.getCanvasContext=n.getWindowDocument=n.supportsTouch=n.disableTransitionTemporarily=n.forceReflow=n.SVG_NS=void 0;var e=Wn;n.SVG_NS="http://www.w3.org/2000/svg";function t(_){_.offsetHeight}n.forceReflow=t;function r(_,S){var C=_.style.transition;_.style.transition="none",S(),_.style.transition=C}n.disableTransitionTemporarily=r;function i(_){return _.ontouchstart!==void 0}n.supportsTouch=i;function s(){return new Function("return this")()}function o(){var _=(0,e.forceCast)(s());return _.document}n.getWindowDocument=o;function a(_){var S=_.ownerDocument.defaultView;if(!S)return null;var C="document"in S;return C?_.getContext("2d"):null}n.getCanvasContext=a;var c={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function u(_,S){var C=_.createElementNS(n.SVG_NS,"svg");return C.innerHTML=c[S],C}n.createSvgIconElement=u;function d(_,S,C){_.insertBefore(S,_.children[C])}n.insertElementAt=d;function p(_){_.parentElement&&_.parentElement.removeChild(_)}n.removeElement=p;function f(_){for(;_.children.length>0;)_.removeChild(_.children[0])}n.removeChildElements=f;function v(_){for(;_.childNodes.length>0;)_.removeChild(_.childNodes[0])}n.removeChildNodes=v;function x(_){var S=_.parentElement;if(!S)return-1;var C=Array.prototype.slice.call(S.children);return C.indexOf(_)}n.indexOfChildElement=x;function y(_){return _.relatedTarget?(0,e.forceCast)(_.relatedTarget):"explicitOriginalTarget"in _?_.explicitOriginalTarget:null}n.findNextTarget=y})(pa);Object.defineProperty(pb,"__esModule",{value:!0});pb.LabelView=void 0;var XMe=pa,qMe=fo,YMe=pr,ZMe=Wn,xS=(0,YMe.ClassName)("lbl");function KMe(n,e){var t=n.createDocumentFragment(),r=e.split(`
`).map(function(i){return n.createTextNode(i)});return r.forEach(function(i,s){s>0&&t.appendChild(n.createElement("br")),t.appendChild(i)}),t}var JMe=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(xS()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(xS("l")),(0,qMe.bindValueMap)(t.props,"label",function(o){(0,ZMe.isEmpty)(o)?r.element.classList.add(xS(void 0,"nol")):(r.element.classList.remove(xS(void 0,"nol")),(0,XMe.removeChildNodes)(i),i.appendChild(KMe(e,o)))}),this.element.appendChild(i),this.labelElement=i;var s=e.createElement("div");s.classList.add(xS("v")),this.element.appendChild(s),this.valueElement=s}return n}();pb.LabelView=JMe;var QMe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),tO=At&&At.__assign||function(){return tO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},tO.apply(this,arguments)};Object.defineProperty(O0,"__esModule",{value:!0});O0.LabelController=void 0;var $Me=ef,eCe=pb,tCe=function(n){QMe(e,n);function e(t,r){var i=this,s=r.valueController.viewProps;return i=n.call(this,tO(tO({},r),{view:new eCe.LabelView(t,{props:r.props,viewProps:s}),viewProps:s}))||this,i.props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return e}($Me.BladeController);O0.LabelController=tCe;Object.defineProperty(i2,"__esModule",{value:!0});i2.ButtonBladePlugin=void 0;var gq=$i,_q=Hs,yq=O0,nCe=t2,xq=n2;i2.ButtonBladePlugin={id:"button",type:"blade",accept:function(n){var e=_q.ParamsParsers,t=(0,_q.parseParams)(n,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return t?{params:t}:null},controller:function(n){return new yq.LabelController(n.document,{blade:n.blade,props:gq.ValueMap.fromObject({label:n.params.label}),valueController:new xq.ButtonController(n.document,{props:gq.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api:function(n){return!(n.controller instanceof yq.LabelController)||!(n.controller.valueController instanceof xq.ButtonController)?null:new nCe.ButtonApi(n.controller)}};var L0={},rCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(L0,"__esModule",{value:!0});L0.ValueBladeController=void 0;var iCe=ef,sCe=function(n){rCe(e,n);function e(t){var r=n.call(this,t)||this;return r.value=t.value,r}return e}(iCe.BladeController);L0.ValueBladeController=sCe;var Gm={};Object.defineProperty(Gm,"__esModule",{value:!0});Gm.createBlade=void 0;var oCe=$i,aCe=_l,lCe=Wn;function cCe(){return new oCe.ValueMap({positions:(0,aCe.createValue)([],{equals:lCe.deepEqualsArray})})}Gm.createBlade=cCe;var ll={},uCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(ll,"__esModule",{value:!0});ll.bindFoldable=ll.getFoldableStyleHeight=ll.getFoldableStyleExpanded=ll.createFoldable=ll.Foldable=void 0;var F3=pa,bq=fo,wq=$i,qie=Wn,Yie=function(n){uCe(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var r={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=wq.ValueMap.createCore(r);return new e(i)},Object.defineProperty(e.prototype,"styleExpanded",{get:function(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"styleHeight",{get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!(0,qie.isEmpty)(t)?t+"px":"auto"},enumerable:!1,configurable:!0}),e.prototype.bindExpandedClass=function(t,r){var i=this,s=function(){var o=i.styleExpanded;o?t.classList.add(r):t.classList.remove(r)};(0,bq.bindValueMap)(this,"expanded",s),(0,bq.bindValueMap)(this,"temporaryExpanded",s)},e.prototype.cleanUpTransition=function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)},e}(wq.ValueMap);ll.Foldable=Yie;function hCe(n){return Yie.create(n)}ll.createFoldable=hCe;function dCe(n,e){var t=0;return(0,F3.disableTransitionTemporarily)(e,function(){n.set("expandedHeight",null),n.set("temporaryExpanded",!0),(0,F3.forceReflow)(e),t=e.clientHeight,n.set("temporaryExpanded",null),(0,F3.forceReflow)(e)}),t}function pCe(n){return n.styleExpanded}ll.getFoldableStyleExpanded=pCe;function fCe(n){return n.styleHeight}ll.getFoldableStyleHeight=fCe;function Sq(n,e){e.style.height=n.styleHeight}function mCe(n,e){n.value("expanded").emitter.on("beforechange",function(){n.set("completed",!1),(0,qie.isEmpty)(n.get("expandedHeight"))&&n.set("expandedHeight",dCe(n,e)),n.set("shouldFixHeight",!0),(0,F3.forceReflow)(e)}),n.emitter.on("change",function(){Sq(n,e)}),Sq(n,e),e.addEventListener("transitionend",function(t){t.propertyName==="height"&&n.cleanUpTransition()})}ll.bindFoldable=mCe;var o2={},fb={},vCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(fb,"__esModule",{value:!0});fb.RackLikeApi=void 0;var gCe=ud,_Ce=function(n){vCe(e,n);function e(t,r){var i=n.call(this,t)||this;return i.rackApi_=r,i}return e}(gCe.BladeApi);fb.RackLikeApi=_Ce;var Om={},Vh={},rd=At&&At.__assign||function(){return rd=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},rd.apply(this,arguments)};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.addTabAsBlade=Vh.addSeparatorAsBlade=Vh.addFolderAsBlade=Vh.addButtonAsBlade=void 0;function yCe(n,e){return n.addBlade(rd(rd({},e),{view:"button"}))}Vh.addButtonAsBlade=yCe;function xCe(n,e){return n.addBlade(rd(rd({},e),{view:"folder"}))}Vh.addFolderAsBlade=xCe;function bCe(n,e){var t=e!=null?e:{};return n.addBlade(rd(rd({},t),{view:"separator"}))}Vh.addSeparatorAsBlade=bCe;function wCe(n,e){return n.addBlade(rd(rd({},e),{view:"tab"}))}Vh.addTabAsBlade=wCe;var mb={};Object.defineProperty(mb,"__esModule",{value:!0});mb.NestedOrderedSet=void 0;var SCe=Es,MCe=Vl,CCe=function(){function n(e){this.emitter=new SCe.Emitter,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return Object.defineProperty(n.prototype,"items",{get:function(){return this.items_},enumerable:!1,configurable:!0}),n.prototype.allItems=function(){return Array.from(this.cache_)},n.prototype.find=function(e){for(var t=0,r=this.allItems();t<r.length;t++){var i=r[t];if(e(i))return i}return null},n.prototype.includes=function(e){return this.cache_.has(e)},n.prototype.add=function(e,t){var r=this;if(this.includes(e))throw MCe.TpError.shouldNeverHappen();var i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);var s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(function(o){r.cache_.add(o)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})},n.prototype.remove=function(e){var t=this.items_.indexOf(e);if(!(t<0)){this.items_.splice(t,1),this.cache_.delete(e);var r=this.extract_(e);r&&(r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}},n.prototype.onSubListAdd_=function(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})},n.prototype.onSubListRemove_=function(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})},n}();mb.NestedOrderedSet=CCe;var vb={},ECe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(vb,"__esModule",{value:!0});vb.InputBindingApi=void 0;var ACe=Es,PCe=Wn,TCe=ud,RCe=To,OCe=function(n){ECe(e,n);function e(t){var r=n.call(this,t)||this;return r.onBindingChange_=r.onBindingChange_.bind(r),r.emitter_=new ACe.Emitter,r.controller_.binding.emitter.on("change",r.onBindingChange_),r}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingChange_=function(t){var r=t.sender.target.read();this.emitter_.emit("change",{event:new RCe.TpChangeEvent(this,(0,PCe.forceCast)(r),this.controller_.binding.target.presetKey,t.options.last)})},e}(TCe.BladeApi);vb.InputBindingApi=OCe;var Xm={},LCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Xm,"__esModule",{value:!0});Xm.InputBindingController=void 0;var DCe=O0,ICe=function(n){LCe(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.binding=r.binding,i}return e}(DCe.LabelController);Xm.InputBindingController=ICe;var gb={},NCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(gb,"__esModule",{value:!0});gb.MonitorBindingApi=void 0;var kCe=Es,zCe=Wn,BCe=ud,VCe=To,FCe=function(n){NCe(e,n);function e(t){var r=n.call(this,t)||this;return r.onBindingUpdate_=r.onBindingUpdate_.bind(r),r.emitter_=new kCe.Emitter,r.controller_.binding.emitter.on("update",r.onBindingUpdate_),r}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingUpdate_=function(t){var r=t.sender.target.read();this.emitter_.emit("update",{event:new VCe.TpUpdateEvent(this,(0,zCe.forceCast)(r),this.controller_.binding.target.presetKey)})},e}(BCe.BladeApi);gb.MonitorBindingApi=FCe;var qm={},UCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(qm,"__esModule",{value:!0});qm.MonitorBindingController=void 0;var jCe=O0,HCe=function(n){UCe(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.binding=r.binding,i.viewProps.bindDisabled(i.binding.ticker),i.viewProps.handleDispose(function(){i.binding.dispose()}),i}return e}(jCe.LabelController);qm.MonitorBindingController=HCe;var WCe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Om,"__esModule",{value:!0});Om.RackApi=Om.findSubBladeApiSet=void 0;var Mq=e2,GCe=Es,fH=Vl,K5=Wn,XCe=ud,MP=Vh,qCe=fb,J5=To,YCe=L0,ZCe=mb,KCe=vb,JCe=Xm,QCe=gb,$Ce=qm;function Zie(n){return n instanceof Kie?n.apiSet_:n instanceof qCe.RackLikeApi?n.rackApi_.apiSet_:null}Om.findSubBladeApiSet=Zie;function bS(n,e){var t=n.find(function(r){return r.controller_===e});if(!t)throw fH.TpError.shouldNeverHappen();return t}function Cq(n,e,t){if(!Mq.BindingTarget.isBindable(n))throw fH.TpError.notBindable();return new Mq.BindingTarget(n,e,t)}var Kie=function(n){WCe(e,n);function e(t,r){var i=n.call(this,t)||this;i.onRackAdd_=i.onRackAdd_.bind(i),i.onRackRemove_=i.onRackRemove_.bind(i),i.onRackInputChange_=i.onRackInputChange_.bind(i),i.onRackMonitorUpdate_=i.onRackMonitorUpdate_.bind(i),i.emitter_=new GCe.Emitter,i.apiSet_=new ZCe.NestedOrderedSet(Zie),i.pool_=r;var s=i.controller_.rack;return s.emitter.on("add",i.onRackAdd_),s.emitter.on("remove",i.onRackRemove_),s.emitter.on("inputchange",i.onRackInputChange_),s.emitter.on("monitorupdate",i.onRackMonitorUpdate_),s.children.forEach(function(o){i.setUpApi_(o)}),i}return Object.defineProperty(e.prototype,"children",{get:function(){var t=this;return this.controller_.rack.children.map(function(r){return bS(t.apiSet_,r)})},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,r,i){var s=i!=null?i:{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(o,Cq(t,r,s.presetKey),s),c=new KCe.InputBindingApi(a);return this.add(c,s.index)},e.prototype.addMonitor=function(t,r,i){var s=i!=null?i:{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(o,Cq(t,r),s),c=new QCe.MonitorBindingApi(a);return(0,K5.forceCast)(this.add(c,s.index))},e.prototype.addFolder=function(t){return(0,MP.addFolderAsBlade)(this,t)},e.prototype.addButton=function(t){return(0,MP.addButtonAsBlade)(this,t)},e.prototype.addSeparator=function(t){return(0,MP.addSeparatorAsBlade)(this,t)},e.prototype.addTab=function(t){return(0,MP.addTabAsBlade)(this,t)},e.prototype.add=function(t,r){this.controller_.rack.add(t.controller_,r);var i=this.apiSet_.find(function(s){return s.controller_===t.controller_});return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t},e.prototype.remove=function(t){this.controller_.rack.remove(t.controller_)},e.prototype.addBlade=function(t){var r=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(r,t),s=this.pool_.createBladeApi(i);return this.add(s,t.index)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.setUpApi_=function(t){var r=this.apiSet_.find(function(i){return i.controller_===t});r||this.apiSet_.add(this.pool_.createBladeApi(t))},e.prototype.onRackAdd_=function(t){this.setUpApi_(t.bladeController)},e.prototype.onRackRemove_=function(t){if(t.isRoot){var r=bS(this.apiSet_,t.bladeController);this.apiSet_.remove(r)}},e.prototype.onRackInputChange_=function(t){var r=t.bladeController;if(r instanceof JCe.InputBindingController){var i=bS(this.apiSet_,r),s=r.binding;this.emitter_.emit("change",{event:new J5.TpChangeEvent(i,(0,K5.forceCast)(s.target.read()),s.target.presetKey,t.options.last)})}else if(r instanceof YCe.ValueBladeController){var i=bS(this.apiSet_,r);this.emitter_.emit("change",{event:new J5.TpChangeEvent(i,r.value.rawValue,void 0,t.options.last)})}},e.prototype.onRackMonitorUpdate_=function(t){if(!(t.bladeController instanceof $Ce.MonitorBindingController))throw fH.TpError.shouldNeverHappen();var r=bS(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new J5.TpUpdateEvent(r,(0,K5.forceCast)(i.target.read()),i.target.presetKey)})},e}(XCe.BladeApi);Om.RackApi=Kie;var e2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(o2,"__esModule",{value:!0});o2.FolderApi=void 0;var t2e=Es,n2e=fb,r2e=To,i2e=Om,s2e=function(n){e2e(e,n);function e(t,r){var i=n.call(this,t,new i2e.RackApi(t.rackController,r))||this;return i.emitter_=new t2e.Emitter,i.controller_.foldable.value("expanded").emitter.on("change",function(s){i.emitter_.emit("fold",{event:new r2e.TpFoldEvent(i,s.sender.rawValue)})}),i.rackApi_.on("change",function(s){i.emitter_.emit("change",{event:s})}),i.rackApi_.on("update",function(s){i.emitter_.emit("update",{event:s})}),i}return Object.defineProperty(e.prototype,"expanded",{get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,r,i){return this.rackApi_.addInput(t,r,i)},e.prototype.addMonitor=function(t,r,i){return this.rackApi_.addMonitor(t,r,i)},e.prototype.addFolder=function(t){return this.rackApi_.addFolder(t)},e.prototype.addButton=function(t){return this.rackApi_.addButton(t)},e.prototype.addSeparator=function(t){return this.rackApi_.addSeparator(t)},e.prototype.addTab=function(t){return this.rackApi_.addTab(t)},e.prototype.add=function(t,r){return this.rackApi_.add(t,r)},e.prototype.remove=function(t){this.rackApi_.remove(t)},e.prototype.addBlade=function(t){return this.rackApi_.addBlade(t)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e}(n2e.RackLikeApi);o2.FolderApi=s2e;var a2={},_b={},o2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(_b,"__esModule",{value:!0});_b.RackLikeController=void 0;var a2e=ef,l2e=function(n){o2e(e,n);function e(t){var r=n.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})||this;return r.rackController=t.rackController,r}return e}(a2e.BladeController);_b.RackLikeController=l2e;var wS={},l2={};Object.defineProperty(l2,"__esModule",{value:!0});l2.PlainView=void 0;var c2e=pr,u2e=function(){function n(e,t){var r=(0,c2e.ClassName)(t.viewName);this.element=e.createElement("div"),this.element.classList.add(r()),t.viewProps.bindClassModifiers(this.element)}return n}();l2.PlainView=u2e;var SS={},Eq;function h2e(){if(Eq)return SS;Eq=1,Object.defineProperty(SS,"__esModule",{value:!0}),SS.BladeRack=void 0;var n=Es,e=Vl,t=Wn,r=Xm,i=qm,s=c2(),o=_b,a=L0,c=mb;function u(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof r.InputBindingController&&C.binding===_)return C}return null}function d(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof i.MonitorBindingController&&C.binding===_)return C}return null}function p(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof a.ValueBladeController&&C.value===_)return C}return null}function f(y){return y instanceof s.RackController?y.rack:y instanceof o.RackLikeController?y.rackController.rack:null}function v(y){var _=f(y);return _?_.bcSet_:null}var x=function(){function y(_){var S;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new n.Emitter,this.blade_=_!=null?_:null,(S=this.blade_)===null||S===void 0||S.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new c.NestedOrderedSet(v),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return Object.defineProperty(y.prototype,"children",{get:function(){return this.bcSet_.items},enumerable:!1,configurable:!0}),y.prototype.add=function(_,S){_.parent&&_.parent.remove(_),_.parent_=this,this.bcSet_.add(_,S)},y.prototype.remove=function(_){_.parent_=null,this.bcSet_.remove(_)},y.prototype.find=function(_){return(0,t.forceCast)(this.bcSet_.allItems().filter(function(S){return S instanceof _}))},y.prototype.onSetAdd_=function(_){this.updatePositions_();var S=_.target===_.root;if(this.emitter.emit("add",{bladeController:_.item,index:_.index,isRoot:S,sender:this}),!!S){var C=_.item;if(C.viewProps.emitter.on("change",this.onChildViewPropsChange_),C.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),C.viewProps.handleDispose(this.onChildDispose_),C instanceof r.InputBindingController)C.binding.emitter.on("change",this.onChildInputChange_);else if(C instanceof i.MonitorBindingController)C.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(C instanceof a.ValueBladeController)C.value.emitter.on("change",this.onChildValueChange_);else{var A=f(C);if(A){var P=A.emitter;P.on("layout",this.onDescendantLayout_),P.on("inputchange",this.onDescendantInputChange_),P.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}},y.prototype.onSetRemove_=function(_){this.updatePositions_();var S=_.target===_.root;if(this.emitter.emit("remove",{bladeController:_.item,isRoot:S,sender:this}),!!S){var C=_.item;if(C instanceof r.InputBindingController)C.binding.emitter.off("change",this.onChildInputChange_);else if(C instanceof i.MonitorBindingController)C.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(C instanceof a.ValueBladeController)C.value.emitter.off("change",this.onChildValueChange_);else{var A=f(C);if(A){var P=A.emitter;P.off("layout",this.onDescendantLayout_),P.off("inputchange",this.onDescendantInputChange_),P.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}},y.prototype.updatePositions_=function(){var _=this,S=this.bcSet_.items.filter(function(P){return!P.viewProps.get("hidden")}),C=S[0],A=S[S.length-1];this.bcSet_.items.forEach(function(P){var D=[];P===C&&(D.push("first"),(!_.blade_||_.blade_.get("positions").includes("veryfirst"))&&D.push("veryfirst")),P===A&&(D.push("last"),(!_.blade_||_.blade_.get("positions").includes("verylast"))&&D.push("verylast")),P.blade.set("positions",D)})},y.prototype.onChildPositionsChange_=function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onChildViewPropsChange_=function(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onChildDispose_=function(){var _=this,S=this.bcSet_.items.filter(function(C){return C.viewProps.get("disposed")});S.forEach(function(C){_.bcSet_.remove(C)})},y.prototype.onChildInputChange_=function(_){var S=u(this.find(r.InputBindingController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:S,options:_.options,sender:this})},y.prototype.onChildMonitorUpdate_=function(_){var S=d(this.find(i.MonitorBindingController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:S,sender:this})},y.prototype.onChildValueChange_=function(_){var S=p(this.find(a.ValueBladeController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:S,options:_.options,sender:this})},y.prototype.onDescendantLayout_=function(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onDescendantInputChange_=function(_){this.emitter.emit("inputchange",{bladeController:_.bladeController,options:_.options,sender:this})},y.prototype.onDescendantMonitorUpdate_=function(_){this.emitter.emit("monitorupdate",{bladeController:_.bladeController,sender:this})},y.prototype.onBladePositionsChange_=function(){this.updatePositions_()},y}();return SS.BladeRack=x,SS}var Aq;function c2(){if(Aq)return wS;Aq=1;var n=At&&At.__extends||function(){var a=function(c,u){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,p){d.__proto__=p}||function(d,p){for(var f in p)Object.prototype.hasOwnProperty.call(p,f)&&(d[f]=p[f])},a(c,u)};return function(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");a(c,u);function d(){this.constructor=c}c.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)}}(),e=At&&At.__assign||function(){return e=Object.assign||function(a){for(var c,u=1,d=arguments.length;u<d;u++){c=arguments[u];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(a[p]=c[p])}return a},e.apply(this,arguments)};Object.defineProperty(wS,"__esModule",{value:!0}),wS.RackController=void 0;var t=pa,r=l2,i=ef,s=h2e(),o=function(a){n(c,a);function c(u,d){var p=a.call(this,e(e({},d),{view:new r.PlainView(u,{viewName:"brk",viewProps:d.viewProps})}))||this;p.onRackAdd_=p.onRackAdd_.bind(p),p.onRackRemove_=p.onRackRemove_.bind(p);var f=new s.BladeRack(d.root?void 0:d.blade);return f.emitter.on("add",p.onRackAdd_),f.emitter.on("remove",p.onRackRemove_),p.rack=f,p.viewProps.handleDispose(function(){for(var v=p.rack.children.length-1;v>=0;v--){var x=p.rack.children[v];x.viewProps.set("disposed",!0)}}),p}return c.prototype.onRackAdd_=function(u){!u.isRoot||(0,t.insertElementAt)(this.view.element,u.bladeController.view.element,u.index)},c.prototype.onRackRemove_=function(u){!u.isRoot||(0,t.removeElement)(u.bladeController.view.element)},c}(i.BladeController);return wS.RackController=o,wS}var u2={},h2={};Object.defineProperty(h2,"__esModule",{value:!0});h2.bladeContainerClassName=void 0;var d2e=pr;h2.bladeContainerClassName=(0,d2e.ClassName)("cnt");Object.defineProperty(u2,"__esModule",{value:!0});u2.FolderView=void 0;var Pq=fo,p2e=pr,Tq=Nl,f2e=Wn,m2e=h2,v2e=function(){function n(e,t){var r=this,i;this.className_=(0,p2e.ClassName)((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),(0,m2e.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),(0,Pq.bindValueMap)(this.foldable_,"completed",(0,Tq.valueToClassName)(this.element,this.className_(void 0,"cpl")));var s=e.createElement("button");s.classList.add(this.className_("b")),(0,Pq.bindValueMap)(t.props,"title",function(u){(0,f2e.isEmpty)(u)?r.element.classList.add(r.className_(void 0,"not")):r.element.classList.remove(r.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;var o=e.createElement("div");o.classList.add(this.className_("t")),(0,Tq.bindValueToTextContent)(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;var a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);var c=t.containerElement;c.classList.add(this.className_("c")),this.element.appendChild(c),this.containerElement=c}return n}();u2.FolderView=v2e;var g2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),nO=At&&At.__assign||function(){return nO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},nO.apply(this,arguments)};Object.defineProperty(a2,"__esModule",{value:!0});a2.FolderController=void 0;var _2e=_b,Rq=ll,y2e=c2(),x2e=u2,b2e=function(n){g2e(e,n);function e(t,r){var i,s=this,o=Rq.Foldable.create((i=r.expanded)!==null&&i!==void 0?i:!0),a=new y2e.RackController(t,{blade:r.blade,root:r.root,viewProps:r.viewProps});return s=n.call(this,nO(nO({},r),{rackController:a,view:new x2e.FolderView(t,{containerElement:a.view.element,foldable:o,props:r.props,viewName:r.root?"rot":void 0,viewProps:r.viewProps})}))||this,s.onTitleClick_=s.onTitleClick_.bind(s),s.props=r.props,s.foldable=o,(0,Rq.bindFoldable)(s.foldable,s.view.containerElement),s.rackController.rack.emitter.on("add",function(){s.foldable.cleanUpTransition()}),s.rackController.rack.emitter.on("remove",function(){s.foldable.cleanUpTransition()}),s.view.buttonElement.addEventListener("click",s.onTitleClick_),s}return Object.defineProperty(e.prototype,"document",{get:function(){return this.view.element.ownerDocument},enumerable:!1,configurable:!0}),e.prototype.onTitleClick_=function(){this.foldable.set("expanded",!this.foldable.get("expanded"))},e}(_2e.RackLikeController);a2.FolderController=b2e;var d2={};Object.defineProperty(d2,"__esModule",{value:!0});d2.FolderBladePlugin=void 0;var w2e=$i,Oq=Hs,S2e=o2,Lq=a2;d2.FolderBladePlugin={id:"folder",type:"blade",accept:function(n){var e=Oq.ParamsParsers,t=(0,Oq.parseParams)(n,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return t?{params:t}:null},controller:function(n){return new Lq.FolderController(n.document,{blade:n.blade,expanded:n.params.expanded,props:w2e.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})},api:function(n){return n.controller instanceof Lq.FolderController?new S2e.FolderApi(n.controller,n.pool):null}};var QL={},M2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),rO=At&&At.__assign||function(){return rO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},rO.apply(this,arguments)};Object.defineProperty(QL,"__esModule",{value:!0});QL.LabeledValueController=void 0;var C2e=L0,E2e=pb,A2e=function(n){M2e(e,n);function e(t,r){var i=this,s=r.valueController.viewProps;return i=n.call(this,rO(rO({},r),{value:r.valueController.value,view:new E2e.LabelView(t,{props:r.props,viewProps:s}),viewProps:s}))||this,i.props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return e}(C2e.ValueBladeController);QL.LabeledValueController=A2e;var p2={},P2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(p2,"__esModule",{value:!0});p2.SeparatorApi=void 0;var T2e=ud,R2e=function(n){P2e(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(T2e.BladeApi);p2.SeparatorApi=R2e;var f2={},$L={};Object.defineProperty($L,"__esModule",{value:!0});$L.SeparatorView=void 0;var O2e=pr,Dq=(0,O2e.ClassName)("spr"),L2e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Dq()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("hr");r.classList.add(Dq("r")),this.element.appendChild(r)}return n}();$L.SeparatorView=L2e;var D2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),iO=At&&At.__assign||function(){return iO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},iO.apply(this,arguments)};Object.defineProperty(f2,"__esModule",{value:!0});f2.SeparatorController=void 0;var I2e=ef,N2e=$L,k2e=function(n){D2e(e,n);function e(t,r){return n.call(this,iO(iO({},r),{view:new N2e.SeparatorView(t,{viewProps:r.viewProps})}))||this}return e}(I2e.BladeController);f2.SeparatorController=k2e;var m2={};Object.defineProperty(m2,"__esModule",{value:!0});m2.SeparatorBladePlugin=void 0;var Iq=Hs,z2e=p2,Nq=f2;m2.SeparatorBladePlugin={id:"separator",type:"blade",accept:function(n){var e=Iq.ParamsParsers,t=(0,Iq.parseParams)(n,{view:e.required.constant("separator")});return t?{params:t}:null},controller:function(n){return new Nq.SeparatorController(n.document,{blade:n.blade,viewProps:n.viewProps})},api:function(n){return n.controller instanceof Nq.SeparatorController?new z2e.SeparatorApi(n.controller):null}};var v2={},yb={},Ym={},B2e=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Ym,"__esModule",{value:!0});Ym.ViewProps=void 0;var V2e=pr,F2e=Nl,CP=fo,kq=$i,U2e=(0,V2e.ClassName)("");function zq(n,e){return(0,F2e.valueToClassName)(n,U2e(void 0,e))}var j2e=function(n){B2e(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var r,i,s=t!=null?t:{},o={disabled:(r=s.disabled)!==null&&r!==void 0?r:!1,disposed:!1,hidden:(i=s.hidden)!==null&&i!==void 0?i:!1},a=kq.ValueMap.createCore(o);return new e(a)},e.prototype.bindClassModifiers=function(t){(0,CP.bindValueMap)(this,"disabled",zq(t,"disabled")),(0,CP.bindValueMap)(this,"hidden",zq(t,"hidden"))},e.prototype.bindDisabled=function(t){(0,CP.bindValueMap)(this,"disabled",function(r){t.disabled=r})},e.prototype.bindTabIndex=function(t){(0,CP.bindValueMap)(this,"disabled",function(r){t.tabIndex=r?-1:0})},e.prototype.handleDispose=function(t){this.value("disposed").emitter.on("change",function(r){r&&t()})},e}(kq.ValueMap);Ym.ViewProps=j2e;var eD={},tD={};Object.defineProperty(tD,"__esModule",{value:!0});tD.TabItemView=void 0;var H2e=fo,W2e=pr,G2e=Nl,MS=(0,W2e.ClassName)("tbi"),X2e=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(MS()),t.viewProps.bindClassModifiers(this.element),(0,H2e.bindValueMap)(t.props,"selected",function(o){o?r.element.classList.add(MS(void 0,"sel")):r.element.classList.remove(MS(void 0,"sel"))});var i=e.createElement("button");i.classList.add(MS("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var s=e.createElement("div");s.classList.add(MS("t")),(0,G2e.bindValueToTextContent)(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}return n}();tD.TabItemView=X2e;Object.defineProperty(eD,"__esModule",{value:!0});eD.TabItemController=void 0;var q2e=Es,Y2e=tD,Z2e=function(){function n(e,t){this.emitter=new q2e.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Y2e.TabItemView(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();eD.TabItemController=Z2e;Object.defineProperty(yb,"__esModule",{value:!0});yb.TabPageController=void 0;var K2e=fo,Bq=Ym,J2e=Gm,Q2e=c2(),$2e=eD,eEe=function(){function n(e,t){var r=this;this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new $2e.TabItemController(e,{props:t.itemProps,viewProps:Bq.ViewProps.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Q2e.RackController(e,{blade:(0,J2e.createBlade)(),viewProps:Bq.ViewProps.create()}),this.props=t.props,(0,K2e.bindValueMap)(this.props,"selected",function(i){r.itemController.props.set("selected",i),r.contentController.viewProps.set("hidden",!i)})}return Object.defineProperty(n.prototype,"itemController",{get:function(){return this.ic_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentController",{get:function(){return this.cc_},enumerable:!1,configurable:!0}),n.prototype.onItemClick_=function(){this.props.set("selected",!0)},n}();yb.TabPageController=eEe;var g2={};Object.defineProperty(g2,"__esModule",{value:!0});g2.TabPageApi=void 0;var tEe=function(){function n(e,t){this.controller_=e,this.rackApi_=t}return Object.defineProperty(n.prototype,"title",{get:function(){var e;return(e=this.controller_.itemController.props.get("title"))!==null&&e!==void 0?e:""},set:function(e){this.controller_.itemController.props.set("title",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.controller_.props.get("selected")},set:function(e){this.controller_.props.set("selected",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),n.prototype.addButton=function(e){return this.rackApi_.addButton(e)},n.prototype.addFolder=function(e){return this.rackApi_.addFolder(e)},n.prototype.addSeparator=function(e){return this.rackApi_.addSeparator(e)},n.prototype.addTab=function(e){return this.rackApi_.addTab(e)},n.prototype.add=function(e,t){this.rackApi_.add(e,t)},n.prototype.remove=function(e){this.rackApi_.remove(e)},n.prototype.addInput=function(e,t,r){return this.rackApi_.addInput(e,t,r)},n.prototype.addMonitor=function(e,t,r){return this.rackApi_.addMonitor(e,t,r)},n.prototype.addBlade=function(e){return this.rackApi_.addBlade(e)},n}();g2.TabPageApi=tEe;var nEe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(v2,"__esModule",{value:!0});v2.TabApi=void 0;var rEe=Es,Vq=$i,EP=Vl,iEe=fb,sEe=To,oEe=Om,aEe=yb,lEe=g2,cEe=function(n){nEe(e,n);function e(t,r){var i=n.call(this,t,new oEe.RackApi(t.rackController,r))||this;return i.onPageAdd_=i.onPageAdd_.bind(i),i.onPageRemove_=i.onPageRemove_.bind(i),i.onSelect_=i.onSelect_.bind(i),i.emitter_=new rEe.Emitter,i.pageApiMap_=new Map,i.rackApi_.on("change",function(s){i.emitter_.emit("change",{event:s})}),i.rackApi_.on("update",function(s){i.emitter_.emit("update",{event:s})}),i.controller_.tab.selectedIndex.emitter.on("change",i.onSelect_),i.controller_.pageSet.emitter.on("add",i.onPageAdd_),i.controller_.pageSet.emitter.on("remove",i.onPageRemove_),i.controller_.pageSet.items.forEach(function(s){i.setUpPageApi_(s)}),i}return Object.defineProperty(e.prototype,"pages",{get:function(){var t=this;return this.controller_.pageSet.items.map(function(r){var i=t.pageApiMap_.get(r);if(!i)throw EP.TpError.shouldNeverHappen();return i})},enumerable:!1,configurable:!0}),e.prototype.addPage=function(t){var r=this.controller_.view.element.ownerDocument,i=new aEe.TabPageController(r,{itemProps:Vq.ValueMap.fromObject({selected:!1,title:t.title}),props:Vq.ValueMap.fromObject({selected:!1})});this.controller_.add(i,t.index);var s=this.pageApiMap_.get(i);if(!s)throw EP.TpError.shouldNeverHappen();return s},e.prototype.removePage=function(t){this.controller_.remove(t)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.setUpPageApi_=function(t){var r=this.rackApi_.apiSet_.find(function(s){return s.controller_===t.contentController});if(!r)throw EP.TpError.shouldNeverHappen();var i=new lEe.TabPageApi(t,r);this.pageApiMap_.set(t,i)},e.prototype.onPageAdd_=function(t){this.setUpPageApi_(t.item)},e.prototype.onPageRemove_=function(t){var r=this.pageApiMap_.get(t.item);if(!r)throw EP.TpError.shouldNeverHappen();this.pageApiMap_.delete(t.item)},e.prototype.onSelect_=function(t){this.emitter_.emit("select",{event:new sEe.TpTabSelectEvent(this,t.rawValue)})},e}(iEe.RackLikeApi);v2.TabApi=cEe;var _2={},nD={};Object.defineProperty(nD,"__esModule",{value:!0});nD.Tab=void 0;var Fq=_l,Uq=-1,uEe=function(){function n(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=(0,Fq.createValue)(!0),this.selectedIndex=(0,Fq.createValue)(Uq),this.items_=[]}return n.prototype.add=function(e,t){var r=t!=null?t:this.items_.length;this.items_.splice(r,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()},n.prototype.remove=function(e){var t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())},n.prototype.keepSelection_=function(){if(this.items_.length===0){this.selectedIndex.rawValue=Uq,this.empty.rawValue=!0;return}var e=this.items_.findIndex(function(t){return t.rawValue});e<0?(this.items_.forEach(function(t,r){t.rawValue=r===0}),this.selectedIndex.rawValue=0):(this.items_.forEach(function(t,r){t.rawValue=r===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1},n.prototype.onItemSelectedChange_=function(e){if(e.rawValue){var t=this.items_.findIndex(function(r){return r===e.sender});this.items_.forEach(function(r,i){r.rawValue=i===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()},n}();nD.Tab=uEe;var rD={};Object.defineProperty(rD,"__esModule",{value:!0});rD.TabView=void 0;var hEe=fo,dEe=pr,pEe=Nl,fEe=h2,AP=(0,dEe.ClassName)("tab"),mEe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(AP(),(0,fEe.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),(0,hEe.bindValue)(t.empty,(0,pEe.valueToClassName)(this.element,AP(void 0,"nop")));var r=e.createElement("div");r.classList.add(AP("i")),this.element.appendChild(r),this.itemsElement=r;var i=t.contentsElement;i.classList.add(AP("c")),this.element.appendChild(i),this.contentsElement=i}return n}();rD.TabView=mEe;var vEe=At&&At.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(_2,"__esModule",{value:!0});_2.TabController=void 0;var jq=pa,gEe=_b,_Ee=mb,yEe=c2(),xEe=nD,bEe=rD,wEe=function(n){vEe(e,n);function e(t,r){var i=this,s=new yEe.RackController(t,{blade:r.blade,viewProps:r.viewProps}),o=new xEe.Tab;return i=n.call(this,{blade:r.blade,rackController:s,view:new bEe.TabView(t,{contentsElement:s.view.element,empty:o.empty,viewProps:r.viewProps})})||this,i.onPageAdd_=i.onPageAdd_.bind(i),i.onPageRemove_=i.onPageRemove_.bind(i),i.pageSet_=new _Ee.NestedOrderedSet(function(){return null}),i.pageSet_.emitter.on("add",i.onPageAdd_),i.pageSet_.emitter.on("remove",i.onPageRemove_),i.tab=o,i}return Object.defineProperty(e.prototype,"pageSet",{get:function(){return this.pageSet_},enumerable:!1,configurable:!0}),e.prototype.add=function(t,r){this.pageSet_.add(t,r)},e.prototype.remove=function(t){this.pageSet_.remove(this.pageSet_.items[t])},e.prototype.onPageAdd_=function(t){var r=t.item;(0,jq.insertElementAt)(this.view.itemsElement,r.itemController.view.element,t.index),this.rackController.rack.add(r.contentController,t.index),this.tab.add(r.props.value("selected"))},e.prototype.onPageRemove_=function(t){var r=t.item;(0,jq.removeElement)(r.itemController.view.element),this.rackController.rack.remove(r.contentController),this.tab.remove(r.props.value("selected"))},e}(gEe.RackLikeController);_2.TabController=wEe;var y2={};Object.defineProperty(y2,"__esModule",{value:!0});y2.TabBladePlugin=void 0;var Hq=$i,Wq=Hs,SEe=v2,Gq=_2,MEe=yb;y2.TabBladePlugin={id:"tab",type:"blade",accept:function(n){var e=Wq.ParamsParsers,t=(0,Wq.parseParams)(n,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return!t||t.pages.length===0?null:{params:t}},controller:function(n){var e=new Gq.TabController(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(function(t){var r=new MEe.TabPageController(n.document,{itemProps:Hq.ValueMap.fromObject({selected:!1,title:t.title}),props:Hq.ValueMap.fromObject({selected:!1})});e.add(r)}),e},api:function(n){return n.controller instanceof Gq.TabController?new SEe.TabApi(n.controller,n.pool):null}};var x2={},sO=At&&At.__assign||function(){return sO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},sO.apply(this,arguments)};Object.defineProperty(x2,"__esModule",{value:!0});x2.createBladeController=void 0;var CEe=Ym,Xq=Hs,EEe=Wn,AEe=Gm;function PEe(n,e){var t=n.accept(e.params);if(!t)return null;var r=Xq.ParamsParsers.optional.boolean(e.params.disabled).value,i=Xq.ParamsParsers.optional.boolean(e.params.hidden).value;return n.controller({blade:(0,AEe.createBlade)(),document:e.document,params:(0,EEe.forceCast)(sO(sO({},t.params),{disabled:r,hidden:i})),viewProps:CEe.ViewProps.create({disabled:r,hidden:i})})}x2.createBladeController=PEe;var b2={};Object.defineProperty(b2,"__esModule",{value:!0});b2.ManualTicker=void 0;var TEe=Es,REe=function(){function n(){this.disabled=!1,this.emitter=new TEe.Emitter}return n.prototype.dispose=function(){},n.prototype.tick=function(){this.disabled||this.emitter.emit("tick",{sender:this})},n}();b2.ManualTicker=REe;var w2={};Object.defineProperty(w2,"__esModule",{value:!0});w2.IntervalTicker=void 0;var OEe=Es,LEe=function(){function n(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new OEe.Emitter,this.interval_=t,this.setTimer_()}return Object.defineProperty(n.prototype,"disabled",{get:function(){return this.disabled_},set:function(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.clearTimer_()},n.prototype.clearTimer_=function(){if(this.timerId_!==null){var e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}},n.prototype.setTimer_=function(){if(this.clearTimer_(),!(this.interval_<=0)){var e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}},n.prototype.onTick_=function(){this.disabled_||this.emitter.emit("tick",{sender:this})},n}();w2.IntervalTicker=LEe;var Jie={};Object.defineProperty(Jie,"__esModule",{value:!0});var ch={};Object.defineProperty(ch,"__esModule",{value:!0});ch.findConstraint=ch.CompositeConstraint=void 0;var Qie=function(){function n(e){this.constraints=e}return n.prototype.constrain=function(e){return this.constraints.reduce(function(t,r){return r.constrain(t)},e)},n}();ch.CompositeConstraint=Qie;function DEe(n,e){if(n instanceof e)return n;if(n instanceof Qie){var t=n.constraints.reduce(function(r,i){return r||(i instanceof e?i:null)},null);if(t)return t}return null}ch.findConstraint=DEe;var $ie={};Object.defineProperty($ie,"__esModule",{value:!0});var Zm={};Object.defineProperty(Zm,"__esModule",{value:!0});Zm.ListConstraint=void 0;var IEe=function(){function n(e){this.options=e}return n.prototype.constrain=function(e){var t=this.options;if(t.length===0)return e;var r=t.filter(function(i){return i.value===e}).length>0;return r?e:t[0].value},n}();Zm.ListConstraint=IEe;var Km={};Object.defineProperty(Km,"__esModule",{value:!0});Km.RangeConstraint=void 0;var qq=Wn,NEe=function(){function n(e){this.maxValue=e.max,this.minValue=e.min}return n.prototype.constrain=function(e){var t=e;return(0,qq.isEmpty)(this.minValue)||(t=Math.max(t,this.minValue)),(0,qq.isEmpty)(this.maxValue)||(t=Math.min(t,this.maxValue)),t},n}();Km.RangeConstraint=NEe;var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.StepConstraint=void 0;var kEe=function(){function n(e,t){t===void 0&&(t=0),this.step=e,this.origin=t}return n.prototype.constrain=function(e){var t=this.origin%this.step,r=Math.round((e-t)/this.step);return t+r*this.step},n}();xb.StepConstraint=kEe;var ese={};Object.defineProperty(ese,"__esModule",{value:!0});var D0={},S2={};Object.defineProperty(S2,"__esModule",{value:!0});S2.ListView=void 0;var Yq=pa,zEe=fo,BEe=pr,Q5=(0,BEe.ClassName)("lst"),VEe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Q5()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("select");r.classList.add(Q5("s")),(0,zEe.bindValueMap)(this.props_,"options",function(s){(0,Yq.removeChildElements)(r),s.forEach(function(o,a){var c=e.createElement("option");c.dataset.index=String(a),c.textContent=o.text,c.value=String(o.value),r.appendChild(c)})}),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;var i=e.createElement("div");i.classList.add(Q5("m")),i.appendChild((0,Yq.createSvgIconElement)(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,this.update_()}return n.prototype.update_=function(){this.selectElement.value=String(this.value_.rawValue)},n.prototype.onValueChange_=function(){this.update_()},n}();S2.ListView=VEe;Object.defineProperty(D0,"__esModule",{value:!0});D0.ListController=void 0;var FEe=Wn,UEe=S2,jEe=function(){function n(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new UEe.ListView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return n.prototype.onSelectChange_=function(e){var t=(0,FEe.forceCast)(e.currentTarget),r=t.selectedOptions.item(0);if(r){var i=Number(r.dataset.index);this.value.rawValue=this.props.get("options")[i].value}},n}();D0.ListController=jEe;var bb={},M2={};Object.defineProperty(M2,"__esModule",{value:!0});M2.PopupView=void 0;var HEe=fo,WEe=pr,GEe=Nl,Zq=(0,WEe.ClassName)("pop"),XEe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Zq()),t.viewProps.bindClassModifiers(this.element),(0,HEe.bindValue)(t.shows,(0,GEe.valueToClassName)(this.element,Zq(void 0,"v")))}return n}();M2.PopupView=XEe;Object.defineProperty(bb,"__esModule",{value:!0});bb.PopupController=void 0;var qEe=_l,YEe=M2,ZEe=function(){function n(e,t){this.shows=(0,qEe.createValue)(!1),this.viewProps=t.viewProps,this.view=new YEe.PopupView(e,{shows:this.shows,viewProps:this.viewProps})}return n}();bb.PopupController=ZEe;var wb={},C2={};Object.defineProperty(C2,"__esModule",{value:!0});C2.TextView=void 0;var KEe=pr,Kq=(0,KEe.ClassName)("txt"),JEe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Kq()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);var r=e.createElement("input");r.classList.add(Kq("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}return n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();C2.TextView=JEe;Object.defineProperty(wb,"__esModule",{value:!0});wb.TextController=void 0;var Jq=Wn,QEe=C2,$Ee=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new QEe.TextView(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,Jq.forceCast)(e.currentTarget),r=t.value,i=this.parser_(r);(0,Jq.isEmpty)(i)||(this.value.rawValue=i),this.view.refresh()},n}();wb.TextController=$Ee;var tse={};Object.defineProperty(tse,"__esModule",{value:!0});var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.BooleanFormatter=Zh.boolFromUnknown=Zh.boolToString=void 0;function nse(n){return String(n)}Zh.boolToString=nse;function eAe(n){return n==="false"?!1:!!n}Zh.boolFromUnknown=eAe;function tAe(n){return nse(n)}Zh.BooleanFormatter=tAe;var rse={};Object.defineProperty(rse,"__esModule",{value:!0});var ao={},iD={},wm={};Object.defineProperty(wm,"__esModule",{value:!0});wm.UnaryOperationNode=wm.BinaryOperationNode=wm.NumberLiteralNode=void 0;var nAe=function(){function n(e){this.text=e}return n.prototype.evaluate=function(){return Number(this.text)},n.prototype.toString=function(){return this.text},n}();wm.NumberLiteralNode=nAe;var rAe={"**":function(n,e){return Math.pow(n,e)},"*":function(n,e){return n*e},"/":function(n,e){return n/e},"%":function(n,e){return n%e},"+":function(n,e){return n+e},"-":function(n,e){return n-e},"<<":function(n,e){return n<<e},">>":function(n,e){return n>>e},">>>":function(n,e){return n>>>e},"&":function(n,e){return n&e},"^":function(n,e){return n^e},"|":function(n,e){return n|e}},iAe=function(){function n(e,t,r){this.left=t,this.operator=e,this.right=r}return n.prototype.evaluate=function(){var e=rAe[this.operator];if(!e)throw new Error("unexpected binary operator: '"+this.operator);return e(this.left.evaluate(),this.right.evaluate())},n.prototype.toString=function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")},n}();wm.BinaryOperationNode=iAe;var sAe={"+":function(n){return n},"-":function(n){return-n},"~":function(n){return~n}},oAe=function(){function n(e,t){this.operator=e,this.expression=t}return n.prototype.evaluate=function(){var e=sAe[this.operator];if(!e)throw new Error("unexpected unary operator: '"+this.operator);return e(this.expression.evaluate())},n.prototype.toString=function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")},n}();wm.UnaryOperationNode=oAe;var yx={};Object.defineProperty(yx,"__esModule",{value:!0});yx.readNumericLiteral=yx.readWhitespace=void 0;function mH(n){return function(e,t){for(var r=0;r<n.length;r++){var i=n[r](e,t);if(i!=="")return i}return""}}function aAe(n,e){var t,r=n.substr(e).match(/^\s+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}yx.readWhitespace=aAe;function lAe(n,e){var t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function lC(n,e){var t,r=n.substr(e).match(/^[0-9]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function cAe(n,e){var t=lC(n,e);if(t!=="")return t;var r=n.substr(e,1);if(e+=1,r!=="-"&&r!=="+")return"";var i=lC(n,e);return i===""?"":r+i}function vH(n,e){var t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";var r=cAe(n,e);return r===""?"":t+r}function ise(n,e){var t=n.substr(e,1);if(t==="0")return t;var r=lAe(n,e);return e+=r.length,r===""?"":r+lC(n,e)}function uAe(n,e){var t=ise(n,e);if(e+=t.length,t==="")return"";var r=n.substr(e,1);if(e+=r.length,r!==".")return"";var i=lC(n,e);return e+=i.length,t+r+i+vH(n,e)}function hAe(n,e){var t=n.substr(e,1);if(e+=t.length,t!==".")return"";var r=lC(n,e);return e+=r.length,r===""?"":t+r+vH(n,e)}function dAe(n,e){var t=ise(n,e);return e+=t.length,t===""?"":t+vH(n,e)}var pAe=mH([uAe,hAe,dAe]);function fAe(n,e){var t,r=n.substr(e).match(/^[01]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function mAe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";var r=fAe(n,e);return r===""?"":t+r}function vAe(n,e){var t,r=n.substr(e).match(/^[0-7]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function gAe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";var r=vAe(n,e);return r===""?"":t+r}function _Ae(n,e){var t,r=n.substr(e).match(/^[0-9a-f]+/i);return(t=r&&r[0])!==null&&t!==void 0?t:""}function yAe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";var r=_Ae(n,e);return r===""?"":t+r}var xAe=mH([mAe,gAe,yAe]);yx.readNumericLiteral=mH([xAe,pAe]);Object.defineProperty(iD,"__esModule",{value:!0});iD.parseEcmaNumberExpression=void 0;var gH=wm,xx=yx;function bAe(n,e){var t=(0,xx.readNumericLiteral)(n,e);return e+=t.length,t===""?null:{evaluable:new gH.NumberLiteralNode(t),cursor:e}}function wAe(n,e){var t=n.substr(e,1);if(e+=t.length,t!=="(")return null;var r=ose(n,e);if(!r)return null;e=r.cursor,e+=(0,xx.readWhitespace)(n,e).length;var i=n.substr(e,1);return e+=i.length,i!==")"?null:{evaluable:r.evaluable,cursor:e}}function SAe(n,e){var t;return(t=bAe(n,e))!==null&&t!==void 0?t:wAe(n,e)}function sse(n,e){var t=SAe(n,e);if(t)return t;var r=n.substr(e,1);if(e+=r.length,r!=="+"&&r!=="-"&&r!=="~")return null;var i=sse(n,e);return i?(e=i.cursor,{cursor:e,evaluable:new gH.UnaryOperationNode(r,i.evaluable)}):null}function MAe(n,e,t){t+=(0,xx.readWhitespace)(e,t).length;var r=n.filter(function(i){return e.startsWith(i,t)})[0];return r?(t+=r.length,t+=(0,xx.readWhitespace)(e,t).length,{cursor:t,operator:r}):null}function CAe(n,e){return function(t,r){var i=n(t,r);if(!i)return null;r=i.cursor;for(var s=i.evaluable;;){var o=MAe(e,t,r);if(!o)break;r=o.cursor;var a=n(t,r);if(!a)return null;r=a.cursor,s=new gH.BinaryOperationNode(o.operator,s,a.evaluable)}return s?{cursor:r,evaluable:s}:null}}var EAe=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(function(n,e){return CAe(n,e)},sse);function ose(n,e){return e+=(0,xx.readWhitespace)(n,e).length,EAe(n,e)}function AAe(n){var e=ose(n,0);if(!e)return null;var t=e.cursor+(0,xx.readWhitespace)(n,e.cursor).length;return t!==n.length?null:e.evaluable}iD.parseEcmaNumberExpression=AAe;Object.defineProperty(ao,"__esModule",{value:!0});ao.createNumberFormatter=ao.numberToString=ao.numberFromUnknown=ao.parseNumber=void 0;var PAe=Wn,TAe=iD;function ase(n){var e,t=(0,TAe.parseEcmaNumberExpression)(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}ao.parseNumber=ase;function RAe(n){if(typeof n=="number")return n;if(typeof n=="string"){var e=ase(n);if(!(0,PAe.isEmpty)(e))return e}return 0}ao.numberFromUnknown=RAe;function OAe(n){return String(n)}ao.numberToString=OAe;function LAe(n){return function(e){return e.toFixed(Math.max(Math.min(n,20),0))}}ao.createNumberFormatter=LAe;var lse={};Object.defineProperty(lse,"__esModule",{value:!0});var E2={};Object.defineProperty(E2,"__esModule",{value:!0});E2.formatPercentage=void 0;var DAe=ao,IAe=(0,DAe.createNumberFormatter)(0);function NAe(n){return IAe(n)+"%"}E2.formatPercentage=NAe;var Lm={};Object.defineProperty(Lm,"__esModule",{value:!0});Lm.formatString=Lm.stringFromUnknown=void 0;function kAe(n){return String(n)}Lm.stringFromUnknown=kAe;function zAe(n){return n}Lm.formatString=zAe;var Dm={},Qq=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Dm,"__esModule",{value:!0});Dm.createPushedBuffer=Dm.initializeBuffer=void 0;var BAe=Wn,VAe=_l;function cse(n,e){for(;n.length<e;)n.push(void 0)}function FAe(n){var e=[];return cse(e,n),(0,VAe.createValue)(e)}Dm.initializeBuffer=FAe;function UAe(n){var e=n.indexOf(void 0);return(0,BAe.forceCast)(e<0?n:n.slice(0,e))}function jAe(n,e){var t=Qq(Qq([],UAe(n),!0),[e],!1);return t.length>n.length?t.splice(0,t.length-n.length):cse(t,n.length),t}Dm.createPushedBuffer=jAe;var use={};Object.defineProperty(use,"__esModule",{value:!0});var tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.connectValues=void 0;function HAe(n){var e=n.primary,t=n.secondary,r=n.forward,i=n.backward,s=!1;function o(a){s||(s=!0,a(),s=!1)}e.emitter.on("change",function(a){o(function(){t.setRawValue(r(e,t),a.options)})}),t.emitter.on("change",function(a){o(function(){e.setRawValue(i(e,t),a.options)}),o(function(){t.setRawValue(r(e,t),a.options)})}),o(function(){t.setRawValue(r(e,t),{forceEmit:!1,last:!0})})}tf.connectValues=HAe;var nf={},Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.isArrowKey=Ro.isVerticalArrowKey=Ro.getHorizontalStepKeys=Ro.getVerticalStepKeys=Ro.getStepForKey=void 0;function WAe(n,e){var t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}Ro.getStepForKey=WAe;function GAe(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}Ro.getVerticalStepKeys=GAe;function XAe(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}Ro.getHorizontalStepKeys=XAe;function hse(n){return n==="ArrowUp"||n==="ArrowDown"}Ro.isVerticalArrowKey=hse;function qAe(n){return hse(n)||n==="ArrowLeft"||n==="ArrowRight"}Ro.isArrowKey=qAe;var dh={};Object.defineProperty(dh,"__esModule",{value:!0});dh.PointerHandler=void 0;var YAe=Es;function $5(n,e){var t,r,i=e.ownerDocument.defaultView,s=e.getBoundingClientRect();return{x:n.pageX-(((t=i&&i.scrollX)!==null&&t!==void 0?t:0)+s.left),y:n.pageY-(((r=i&&i.scrollY)!==null&&r!==void 0?r:0)+s.top)}}var ZAe=function(){function n(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new YAe.Emitter,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return n.prototype.computePosition_=function(e){var t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}},n.prototype.onMouseDown_=function(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();var r=this.elem_.ownerDocument;r.addEventListener("mousemove",this.onDocumentMouseMove_),r.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_($5(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseMove_=function(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_($5(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseUp_=function(e){var t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_($5(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onTouchStart_=function(e){e.preventDefault();var t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchMove_=function(e){var t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchEnd_=function(e){var t,r=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(r?{x:r.clientX-i.left,y:r.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})},n}();dh.PointerHandler=ZAe;var A2={},gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.loopRange=gi.constrainRange=gi.getDecimalDigits=gi.mapRange=void 0;function KAe(n,e,t,r,i){var s=(n-e)/(t-e);return r+s*(i-r)}gi.mapRange=KAe;function JAe(n){var e=String(n.toFixed(10)),t=e.split(".")[1];return t.replace(/0+$/,"").length}gi.getDecimalDigits=JAe;function QAe(n,e,t){return Math.min(Math.max(n,e),t)}gi.constrainRange=QAe;function $Ae(n,e){return(n%e+e)%e}gi.loopRange=$Ae;Object.defineProperty(A2,"__esModule",{value:!0});A2.NumberTextView=void 0;var eV=pa,ePe=gi,dse=pr,Jc=(0,dse.ClassName)("txt"),tPe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Jc(),Jc(void 0,"num")),t.arrayPosition&&this.element.classList.add(Jc(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add(Jc("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Jc()),this.inputElement.classList.add(Jc("i"));var i=e.createElement("div");i.classList.add(Jc("k")),this.element.appendChild(i),this.knobElement=i;var s=e.createElementNS(eV.SVG_NS,"svg");s.classList.add(Jc("g")),this.knobElement.appendChild(s);var o=e.createElementNS(eV.SVG_NS,"path");o.classList.add(Jc("gb")),s.appendChild(o),this.guideBodyElem_=o;var a=e.createElementNS(eV.SVG_NS,"path");a.classList.add(Jc("gh")),s.appendChild(a),this.guideHeadElem_=a;var c=e.createElement("div");c.classList.add((0,dse.ClassName)("tt")()),this.knobElement.appendChild(c),this.tooltipElem_=c,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}return n.prototype.onDraggingChange_=function(e){if(e.rawValue===null){this.element.classList.remove(Jc(void 0,"drg"));return}this.element.classList.add(Jc(void 0,"drg"));var t=e.rawValue/this.props_.get("draggingScale"),r=t+(t>0?-1:t<0?1:0),i=(0,ePe.constrainRange)(-r,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M "+(r+i)+",0 L"+r+",4 L"+(r+i)+",8","M "+t+",-1 L"+t+",9"].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L"+t+",4");var s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=t+"px"},n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();A2.NumberTextView=tPe;Object.defineProperty(nf,"__esModule",{value:!0});nf.NumberTextController=void 0;var $q=Wn,nPe=_l,PP=Ro,rPe=dh,iPe=A2,sPe=function(){function n(e,t){var r;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=(r=t.sliderProps)!==null&&r!==void 0?r:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=(0,nPe.createValue)(null),this.view=new iPe.NumberTextView(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new rPe.PointerHandler(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return n.prototype.constrainValue_=function(e){var t,r,i=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("minValue"),s=(r=this.sliderProps_)===null||r===void 0?void 0:r.get("maxValue"),o=e;return i!==void 0&&(o=Math.max(o,i)),s!==void 0&&(o=Math.min(o,s)),o},n.prototype.onInputChange_=function(e){var t=(0,$q.forceCast)(e.currentTarget),r=t.value,i=this.parser_(r);(0,$q.isEmpty)(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()},n.prototype.onInputKeyDown_=function(e){var t=(0,PP.getStepForKey)(this.baseStep_,(0,PP.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})},n.prototype.onInputKeyUp_=function(e){var t=(0,PP.getStepForKey)(this.baseStep_,(0,PP.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n.prototype.onPointerDown_=function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0},n.prototype.computeDraggingValue_=function(e){if(!e.point)return null;var t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))},n.prototype.onPointerMove_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)},n.prototype.onPointerUp_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)},n}();nf.NumberTextController=sPe;var P2={},T2={};Object.defineProperty(T2,"__esModule",{value:!0});T2.SliderView=void 0;var eY=gi,oPe=pr,tV=(0,oPe.ClassName)("sld"),aPe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(tV()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(tV("t")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;var i=e.createElement("div");i.classList.add(tV("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=(0,eY.constrainRange)((0,eY.mapRange)(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=e+"%"},n.prototype.onChange_=function(){this.update_()},n}();T2.SliderView=aPe;Object.defineProperty(P2,"__esModule",{value:!0});P2.SliderController=void 0;var tY=gi,TP=Ro,lPe=dh,cPe=T2,uPe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new cPe.SliderView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new lPe.PointerHandler(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){!e.point||this.value.setRawValue((0,tY.mapRange)((0,tY.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)},n.prototype.onPointerDownOrMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,TP.getStepForKey)(this.baseStep_,(0,TP.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,TP.getStepForKey)(this.baseStep_,(0,TP.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();P2.SliderController=uPe;var R2={},O2={};Object.defineProperty(O2,"__esModule",{value:!0});O2.SliderTextView=void 0;var hPe=pr,nV=(0,hPe.ClassName)("sldtxt"),dPe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(nV());var r=e.createElement("div");r.classList.add(nV("s")),this.sliderView_=t.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(nV("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}return n}();O2.SliderTextView=dPe;Object.defineProperty(R2,"__esModule",{value:!0});R2.SliderTextController=void 0;var pPe=O2,fPe=nf,mPe=P2,vPe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new mPe.SliderController(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new fPe.NumberTextController(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new pPe.SliderTextView(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"sliderController",{get:function(){return this.sliderC_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();R2.SliderTextController=vPe;var pse={};Object.defineProperty(pse,"__esModule",{value:!0});var sD={};Object.defineProperty(sD,"__esModule",{value:!0});sD.warnDeprecation=void 0;function gPe(n){var e;console.warn([n.name+" is deprecated.",n.alternative?"use "+n.alternative+" instead.":"",(e=n.postscript)!==null&&e!==void 0?e:""].join(" "))}sD.warnDeprecation=gPe;var fse={};Object.defineProperty(fse,"__esModule",{value:!0});var Jm={};Object.defineProperty(Jm,"__esModule",{value:!0});Jm.writePrimitive=void 0;function _Pe(n,e){n.write(e)}Jm.writePrimitive=_Pe;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.getSuitableDraggingScale=ui.getBaseStep=ui.getSuitableDecimalDigits=ui.findListItems=ui.createListConstraint=ui.normalizeListOptions=ui.parsePointDimensionParams=ui.parsePickerLayout=ui.parseListOptions=void 0;var nY=Wn,oD=ch,mse=Zm,_H=xb,rY=gi,vse=Hs;function yPe(n){var e=vse.ParamsParsers;if(Array.isArray(n))return e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(n).value;if(typeof n=="object")return e.required.raw(n).value}ui.parseListOptions=yPe;function xPe(n){if(n==="inline"||n==="popup")return n}ui.parsePickerLayout=xPe;function bPe(n){var e=vse.ParamsParsers;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(n).value}ui.parsePointDimensionParams=bPe;function gse(n){if(Array.isArray(n))return n;var e=[];return Object.keys(n).forEach(function(t){e.push({text:t,value:n[t]})}),e}ui.normalizeListOptions=gse;function wPe(n){return(0,nY.isEmpty)(n)?null:new mse.ListConstraint(gse((0,nY.forceCast)(n)))}ui.createListConstraint=wPe;function SPe(n){var e=n?(0,oD.findConstraint)(n,mse.ListConstraint):null;return e?e.options:null}ui.findListItems=SPe;function MPe(n){var e=n?(0,oD.findConstraint)(n,_H.StepConstraint):null;return e?e.step:null}function CPe(n,e){var t=n&&(0,oD.findConstraint)(n,_H.StepConstraint);return t?(0,rY.getDecimalDigits)(t.step):Math.max((0,rY.getDecimalDigits)(e),2)}ui.getSuitableDecimalDigits=CPe;function EPe(n){var e=MPe(n);return e!=null?e:1}ui.getBaseStep=EPe;function APe(n,e){var t,r=n&&(0,oD.findConstraint)(n,_H.StepConstraint),i=Math.abs((t=r==null?void 0:r.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}ui.getSuitableDraggingScale=APe;var L2={},aD={};Object.defineProperty(aD,"__esModule",{value:!0});aD.CheckboxView=void 0;var PPe=pa,TPe=pr,RP=(0,TPe.ClassName)("ckb"),RPe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(RP()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("label");r.classList.add(RP("l")),this.element.appendChild(r);var i=e.createElement("input");i.classList.add(RP("i")),i.type="checkbox",r.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);var s=e.createElement("div");s.classList.add(RP("w")),r.appendChild(s);var o=(0,PPe.createSvgIconElement)(e,"check");s.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){this.inputElement.checked=this.value.rawValue},n.prototype.onValueChange_=function(){this.update_()},n}();aD.CheckboxView=RPe;Object.defineProperty(L2,"__esModule",{value:!0});L2.CheckboxController=void 0;var OPe=Wn,LPe=aD,DPe=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new LPe.CheckboxView(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,OPe.forceCast)(e.currentTarget);this.value.rawValue=t.checked},n}();L2.CheckboxController=DPe;var D2={};Object.defineProperty(D2,"__esModule",{value:!0});D2.BooleanInputPlugin=void 0;var _se=ch,IPe=Zm,NPe=D0,kPe=Zh,zPe=$i,iY=Hs,BPe=Jm,TU=ui,VPe=L2;function FPe(n){var e=[],t=(0,TU.createListConstraint)(n.options);return t&&e.push(t),new _se.CompositeConstraint(e)}D2.BooleanInputPlugin={id:"input-bool",type:"input",accept:function(n,e){if(typeof n!="boolean")return null;var t=iY.ParamsParsers,r=(0,iY.parseParams)(e,{options:t.optional.custom(TU.parseListOptions)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return kPe.boolFromUnknown},constraint:function(n){return FPe(n.params)},writer:function(n){return BPe.writePrimitive}},controller:function(n){var e,t=n.document,r=n.value,i=n.constraint;return i&&(0,_se.findConstraint)(i,IPe.ListConstraint)?new NPe.ListController(t,{props:zPe.ValueMap.fromObject({options:(e=(0,TU.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps}):new VPe.CheckboxController(t,{value:r,viewProps:n.viewProps})}};var I0={},lD={};Object.defineProperty(lD,"__esModule",{value:!0});lD.ColorView=void 0;var UPe=fo,jPe=pr,HPe=Nl,Cg=(0,jPe.ClassName)("col"),WPe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Cg()),t.foldable.bindExpandedClass(this.element,Cg(void 0,"expanded")),(0,UPe.bindValueMap)(t.foldable,"completed",(0,HPe.valueToClassName)(this.element,Cg(void 0,"cpl")));var r=e.createElement("div");r.classList.add(Cg("h")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(Cg("s")),r.appendChild(i),this.swatchElement=i;var s=e.createElement("div");if(s.classList.add(Cg("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){var o=e.createElement("div");o.classList.add(Cg("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return n}();lD.ColorView=WPe;var cD={},za={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.convertColor=ls.constrainColorComponents=ls.getColorMaxComponents=ls.appendAlphaComponent=ls.removeAlphaComponent=ls.hsvToHslInt=ls.hslToHsvInt=ls.hsvToRgbInt=void 0;var Ta=gi;function GPe(n,e,t){var r=(0,Ta.constrainRange)(n/255,0,1),i=(0,Ta.constrainRange)(e/255,0,1),s=(0,Ta.constrainRange)(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),c=o-a,u=0,d=0,p=(a+o)/2;return c!==0&&(d=c/(1-Math.abs(o+a-1)),r===o?u=(i-s)/c:i===o?u=2+(s-r)/c:u=4+(r-i)/c,u=u/6+(u<0?1:0)),[u*360,d*100,p*100]}function XPe(n,e,t){var r,i,s,o,a,c,u=(n%360+360)%360,d=(0,Ta.constrainRange)(e/100,0,1),p=(0,Ta.constrainRange)(t/100,0,1),f=(1-Math.abs(2*p-1))*d,v=f*(1-Math.abs(u/60%2-1)),x=p-f/2,y,_,S;return u>=0&&u<60?(r=[f,v,0],y=r[0],_=r[1],S=r[2]):u>=60&&u<120?(i=[v,f,0],y=i[0],_=i[1],S=i[2]):u>=120&&u<180?(s=[0,f,v],y=s[0],_=s[1],S=s[2]):u>=180&&u<240?(o=[0,v,f],y=o[0],_=o[1],S=o[2]):u>=240&&u<300?(a=[v,0,f],y=a[0],_=a[1],S=a[2]):(c=[f,0,v],y=c[0],_=c[1],S=c[2]),[(y+x)*255,(_+x)*255,(S+x)*255]}function qPe(n,e,t){var r=(0,Ta.constrainRange)(n/255,0,1),i=(0,Ta.constrainRange)(e/255,0,1),s=(0,Ta.constrainRange)(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),c=o-a,u;c===0?u=0:o===r?u=60*(((i-s)/c%6+6)%6):o===i?u=60*((s-r)/c+2):u=60*((r-i)/c+4);var d=o===0?0:c/o,p=o;return[u,d*100,p*100]}function yse(n,e,t){var r,i,s,o,a,c,u=(0,Ta.loopRange)(n,360),d=(0,Ta.constrainRange)(e/100,0,1),p=(0,Ta.constrainRange)(t/100,0,1),f=p*d,v=f*(1-Math.abs(u/60%2-1)),x=p-f,y,_,S;return u>=0&&u<60?(r=[f,v,0],y=r[0],_=r[1],S=r[2]):u>=60&&u<120?(i=[v,f,0],y=i[0],_=i[1],S=i[2]):u>=120&&u<180?(s=[0,f,v],y=s[0],_=s[1],S=s[2]):u>=180&&u<240?(o=[0,v,f],y=o[0],_=o[1],S=o[2]):u>=240&&u<300?(a=[v,0,f],y=a[0],_=a[1],S=a[2]):(c=[f,0,v],y=c[0],_=c[1],S=c[2]),[(y+x)*255,(_+x)*255,(S+x)*255]}ls.hsvToRgbInt=yse;function xse(n,e,t){var r=t+e*(100-Math.abs(2*t-100))/200;return[n,r!==0?e*(100-Math.abs(2*t-100))/r:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}ls.hslToHsvInt=xse;function bse(n,e,t){var r=100-Math.abs(t*(200-e)/100-100);return[n,r!==0?e*t/r:0,t*(200-e)/(2*100)]}ls.hsvToHslInt=bse;function YPe(n){return[n[0],n[1],n[2]]}ls.removeAlphaComponent=YPe;function ZPe(n,e){return[n[0],n[1],n[2],e]}ls.appendAlphaComponent=ZPe;var KPe={hsl:{hsl:function(n,e,t){return[n,e,t]},hsv:xse,rgb:XPe},hsv:{hsl:bse,hsv:function(n,e,t){return[n,e,t]},rgb:yse},rgb:{hsl:GPe,hsv:qPe,rgb:function(n,e,t){return[n,e,t]}}};function oO(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}ls.getColorMaxComponents=oO;function JPe(n,e,t){var r,i=oO(e,t);return[e==="rgb"?(0,Ta.constrainRange)(n[0],0,i[0]):(0,Ta.loopRange)(n[0],i[0]),(0,Ta.constrainRange)(n[1],0,i[1]),(0,Ta.constrainRange)(n[2],0,i[2]),(0,Ta.constrainRange)((r=n[3])!==null&&r!==void 0?r:1,0,1)]}ls.constrainColorComponents=JPe;function sY(n,e,t,r){var i=oO(e,t),s=oO(e,r);return n.map(function(o,a){return o/i[a]*s[a]})}function QPe(n,e,t){var r,i=sY(n,e.mode,e.type,"int"),s=(r=KPe[e.mode])[t.mode].apply(r,i);return sY(s,t.mode,"int",t.type)}ls.convertColor=QPe;Object.defineProperty(za,"__esModule",{value:!0});za.Color=void 0;var $Pe=Wn,OP=ls;function LP(n,e){return typeof n!="object"||(0,$Pe.isEmpty)(n)?!1:e in n&&typeof n[e]=="number"}var eTe=function(){function n(e,t,r){r===void 0&&(r="int"),this.mode=t,this.type=r,this.comps_=(0,OP.constrainColorComponents)(e,t,r)}return n.black=function(e){return e===void 0&&(e="int"),new n([0,0,0],"rgb",e)},n.fromObject=function(e,t){t===void 0&&(t="int");var r="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new n(r,"rgb",t)},n.toRgbaObject=function(e,t){return t===void 0&&(t="int"),e.toRgbaObject(t)},n.isRgbColorObject=function(e){return LP(e,"r")&&LP(e,"g")&&LP(e,"b")},n.isRgbaColorObject=function(e){return this.isRgbColorObject(e)&&LP(e,"a")},n.isColorObject=function(e){return this.isRgbColorObject(e)},n.equals=function(e,t){if(e.mode!==t.mode)return!1;for(var r=e.comps_,i=t.comps_,s=0;s<r.length;s++)if(r[s]!==i[s])return!1;return!0},n.prototype.getComponents=function(e,t){return t===void 0&&(t="int"),(0,OP.appendAlphaComponent)((0,OP.convertColor)((0,OP.removeAlphaComponent)(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:t}),this.comps_[3])},n.prototype.toRgbaObject=function(e){e===void 0&&(e="int");var t=this.getComponents("rgb",e);return{r:t[0],g:t[1],b:t[2],a:t[3]}},n}();za.Color=eTe;var uD={},tTe=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(uD,"__esModule",{value:!0});uD.ColorPickerView=void 0;var nTe=pr,Bf=(0,nTe.ClassName)("colp"),rTe=function(){function n(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Bf());var r=e.createElement("div");r.classList.add(Bf("hsv"));var i=e.createElement("div");i.classList.add(Bf("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),r.appendChild(i);var s=e.createElement("div");s.classList.add(Bf("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),r.appendChild(s),this.element.appendChild(r);var o=e.createElement("div");if(o.classList.add(Bf("rgb")),this.textView_=t.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};var a=e.createElement("div");a.classList.add(Bf("a"));var c=e.createElement("div");c.classList.add(Bf("ap")),c.appendChild(this.alphaViews_.palette.element),a.appendChild(c);var u=e.createElement("div");u.classList.add(Bf("at")),u.appendChild(this.alphaViews_.text.element),a.appendChild(u),this.element.appendChild(a)}}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){var e=tTe([this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement],this.textView_.textViews.map(function(t){return t.inputElement}),!0);return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e},enumerable:!1,configurable:!0}),n}();uD.ColorPickerView=rTe;var hD={},Ll={};Object.defineProperty(Ll,"__esModule",{value:!0});Ll.extractColorType=Ll.getBaseStepForColor=Ll.parseColorInputParams=void 0;var oY=Hs,iTe=ui;function sTe(n){return n==="int"?"int":n==="float"?"float":void 0}function oTe(n){var e=oY.ParamsParsers;return(0,oY.parseParams)(n,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(sTe)}),expanded:e.optional.boolean,picker:e.optional.custom(iTe.parsePickerLayout)})}Ll.parseColorInputParams=oTe;function aTe(n){return n?.1:1}Ll.getBaseStepForColor=aTe;function lTe(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}Ll.extractColorType=lTe;var dD={},rf={};(function(n){var e=At&&At.__assign||function(){return e=Object.assign||function(ne){for(var W,O=1,E=arguments.length;O<E;O++){W=arguments[O];for(var F in W)Object.prototype.hasOwnProperty.call(W,F)&&(ne[F]=W[F])}return ne},e.apply(this,arguments)},t=At&&At.__spreadArray||function(ne,W,O){if(O||arguments.length===2)for(var E=0,F=W.length,z;E<F;E++)(z||!(E in W))&&(z||(z=Array.prototype.slice.call(W,0,E)),z[E]=W[E]);return ne.concat(z||Array.prototype.slice.call(W))};Object.defineProperty(n,"__esModule",{value:!0}),n.findColorStringifier=n.getColorStringifier=n.colorToObjectRgbaString=n.colorToObjectRgbString=n.colorToFunctionalHslaString=n.colorToFunctionalHslString=n.colorToFunctionalRgbaString=n.colorToFunctionalRgbString=n.colorToHexRgbaString=n.colorToHexRgbString=n.colorFromString=n.hasAlphaComponent=n.createColorStringParser=n.createColorStringBindingReader=n.CompositeColorParser=n.detectStringColorFormat=n.getColorNotation=void 0;var r=ao,i=E2,s=gi,o=za,a=ls;function c(ne,W){return ne.alpha===W.alpha&&ne.mode===W.mode&&ne.notation===W.notation&&ne.type===W.type}function u(ne,W){var O=ne.match(/^(.+)%$/);return Math.min(O?parseFloat(O[1])*.01*W:parseFloat(ne),W)}var d={deg:function(ne){return ne},grad:function(ne){return ne*360/400},rad:function(ne){return ne*360/(2*Math.PI)},turn:function(ne){return ne*360}};function p(ne){var W=ne.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!W)return parseFloat(ne);var O=parseFloat(W[1]),E=W[2];return d[E](O)}function f(ne){var W=ne.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[u(W[1],255),u(W[2],255),u(W[3],255)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function v(ne){return function(W){var O=f(W);return O?new o.Color(O,"rgb",ne):null}}function x(ne){var W=ne.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[u(W[1],255),u(W[2],255),u(W[3],255),u(W[4],1)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function y(ne){return function(W){var O=x(W);return O?new o.Color(O,"rgb",ne):null}}function _(ne){var W=ne.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[p(W[1]),u(W[2],100),u(W[3],100)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function S(ne){return function(W){var O=_(W);return O?new o.Color(O,"hsl",ne):null}}function C(ne){var W=ne.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[p(W[1]),u(W[2],100),u(W[3],100),u(W[4],1)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function A(ne){return function(W){var O=C(W);return O?new o.Color(O,"hsl",ne):null}}function P(ne){var W=ne.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(W)return[parseInt(W[1]+W[1],16),parseInt(W[2]+W[2],16),parseInt(W[3]+W[3],16)];var O=ne.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return O?[parseInt(O[1],16),parseInt(O[2],16),parseInt(O[3],16)]:null}function D(ne){var W=P(ne);return W?new o.Color(W,"rgb","int"):null}function N(ne){var W=ne.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(W)return[parseInt(W[1]+W[1],16),parseInt(W[2]+W[2],16),parseInt(W[3]+W[3],16),(0,s.mapRange)(parseInt(W[4]+W[4],16),0,255,0,1)];var O=ne.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return O?[parseInt(O[1],16),parseInt(O[2],16),parseInt(O[3],16),(0,s.mapRange)(parseInt(O[4],16),0,255,0,1)]:null}function j(ne){var W=N(ne);return W?new o.Color(W,"rgb","int"):null}function T(ne){var W=ne.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!W)return null;var O=[parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3])];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function k(ne){return function(W){var O=T(W);return O?new o.Color(O,"rgb",ne):null}}function U(ne){var W=ne.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!W)return null;var O=[parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3]),parseFloat(W[4])];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function ee(ne){return function(W){var O=U(W);return O?new o.Color(O,"rgb",ne):null}}var xe={"func.rgb":v("int"),"func.rgba":y("int"),"func.hsl":S("int"),"func.hsla":A("int"),"hex.rgb":D,"hex.rgba":j};function ce(ne){var W=Object.keys(xe);return W.reduce(function(O,E){if(O)return O;var F=xe[E];return F(ne)?E:null},null)}n.getColorNotation=ce;var te=[{parser:P,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:N,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:f,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:x,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:_,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:C,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:T,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:U,result:{alpha:!0,mode:"rgb",notation:"object"}}];function fe(ne){return te.reduce(function(W,O){var E=O.parser,F=O.result;return W||(E(ne)?F:null)},null)}function ge(ne,W){W===void 0&&(W="int");var O=fe(ne);return O?O.notation==="hex"&&W!=="float"?e(e({},O),{type:"int"}):O.notation==="func"?e(e({},O),{type:W}):null:null}n.detectStringColorFormat=ge;var Se=function(ne){var W=ce(ne);return W?xe[W](ne):null};n.CompositeColorParser=Se;var pe={int:[D,j,v("int"),y("int"),S("int"),A("int"),k("int"),ee("int")],float:[v("float"),y("float"),S("float"),A("float"),k("float"),ee("float")]};function se(ne){var W=pe[ne];return function(O){if(typeof O!="string")return o.Color.black(ne);var E=W.reduce(function(F,z){return F||z(O)},null);return E!=null?E:o.Color.black(ne)}}n.createColorStringBindingReader=se;function ae(ne){var W=pe[ne];return function(O){return W.reduce(function(E,F){return E||F(O)},null)}}n.createColorStringParser=ae;function Le(ne){return ne==="func.hsla"||ne==="func.rgba"||ne==="hex.rgba"}n.hasAlphaComponent=Le;function Re(ne){if(typeof ne=="string"){var W=(0,n.CompositeColorParser)(ne);if(W)return W}return o.Color.black()}n.colorFromString=Re;function Ue(ne){var W=(0,s.constrainRange)(Math.floor(ne),0,255).toString(16);return W.length===1?"0"+W:W}function Ze(ne,W){W===void 0&&(W="#");var O=(0,a.removeAlphaComponent)(ne.getComponents("rgb")).map(Ue).join("");return""+W+O}n.colorToHexRgbString=Ze;function st(ne,W){W===void 0&&(W="#");var O=ne.getComponents("rgb"),E=[O[0],O[1],O[2],O[3]*255].map(Ue).join("");return""+W+E}n.colorToHexRgbaString=st;function we(ne,W){var O=(0,r.createNumberFormatter)(W==="float"?2:0),E=(0,a.removeAlphaComponent)(ne.getComponents("rgb",W)).map(function(F){return O(F)});return"rgb("+E.join(", ")+")"}n.colorToFunctionalRgbString=we;function Mt(ne){return function(W){return we(W,ne)}}function rt(ne,W){var O=(0,r.createNumberFormatter)(2),E=(0,r.createNumberFormatter)(W==="float"?2:0),F=ne.getComponents("rgb",W).map(function(z,Z){var de=Z===3?O:E;return de(z)});return"rgba("+F.join(", ")+")"}n.colorToFunctionalRgbaString=rt;function it(ne){return function(W){return rt(W,ne)}}function Ke(ne){var W=[(0,r.createNumberFormatter)(0),i.formatPercentage,i.formatPercentage],O=(0,a.removeAlphaComponent)(ne.getComponents("hsl")).map(function(E,F){return W[F](E)});return"hsl("+O.join(", ")+")"}n.colorToFunctionalHslString=Ke;function Qe(ne){var W=[(0,r.createNumberFormatter)(0),i.formatPercentage,i.formatPercentage,(0,r.createNumberFormatter)(2)],O=ne.getComponents("hsl").map(function(E,F){return W[F](E)});return"hsla("+O.join(", ")+")"}n.colorToFunctionalHslaString=Qe;function Y(ne,W){var O=(0,r.createNumberFormatter)(W==="float"?2:0),E=["r","g","b"],F=(0,a.removeAlphaComponent)(ne.getComponents("rgb",W)).map(function(z,Z){return E[Z]+": "+O(z)});return"{"+F.join(", ")+"}"}n.colorToObjectRgbString=Y;function K(ne){return function(W){return Y(W,ne)}}function ve(ne,W){var O=(0,r.createNumberFormatter)(2),E=(0,r.createNumberFormatter)(W==="float"?2:0),F=["r","g","b","a"],z=ne.getComponents("rgb",W).map(function(Z,de){var be=de===3?O:E;return F[de]+": "+be(Z)});return"{"+z.join(", ")+"}"}n.colorToObjectRgbaString=ve;function Ae(ne){return function(W){return ve(W,ne)}}var De={"func.hsl":Ke,"func.hsla":Qe,"func.rgb":we,"func.rgba":rt,"hex.rgb":Ze,"hex.rgba":st};function je(ne){return De[ne]}n.getColorStringifier=je;var Xe=t([{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Ze},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:st},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Ke},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Qe}],["int","float"].reduce(function(ne,W){return t(t([],ne,!0),[{format:{alpha:!1,mode:"rgb",notation:"func",type:W},stringifier:Mt(W)},{format:{alpha:!0,mode:"rgb",notation:"func",type:W},stringifier:it(W)},{format:{alpha:!1,mode:"rgb",notation:"object",type:W},stringifier:K(W)},{format:{alpha:!0,mode:"rgb",notation:"object",type:W},stringifier:Ae(W)}],!1)},[]),!0);function He(ne){return Xe.reduce(function(W,O){return W||(c(O.format,ne)?O.stringifier:null)},null)}n.findColorStringifier=He})(rf);Object.defineProperty(dD,"__esModule",{value:!0});dD.APaletteView=void 0;var cTe=gi,uTe=pr,rV=rf,aY=za,CS=(0,uTe.ClassName)("apl"),hTe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(CS()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(CS("b")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(CS("c")),r.appendChild(i),this.colorElem_=i;var s=e.createElement("div");s.classList.add(CS("m")),this.element.appendChild(s),this.markerElem_=s;var o=e.createElement("div");o.classList.add(CS("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("rgb"),r=new aY.Color([t[0],t[1],t[2],0],"rgb"),i=new aY.Color([t[0],t[1],t[2],255],"rgb"),s=["to right",(0,rV.colorToFunctionalRgbaString)(r),(0,rV.colorToFunctionalRgbaString)(i)];this.colorElem_.style.background="linear-gradient("+s.join(",")+")",this.previewElem_.style.backgroundColor=(0,rV.colorToFunctionalRgbaString)(e);var o=(0,cTe.mapRange)(t[3],0,1,0,100);this.markerElem_.style.left=o+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();dD.APaletteView=hTe;Object.defineProperty(hD,"__esModule",{value:!0});hD.APaletteController=void 0;var DP=Ro,dTe=dh,lY=za,cY=Ll,pTe=dD,fTe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new pTe.APaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new dTe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var r=e.point.x/e.bounds.width,i=this.value.rawValue,s=i.getComponents("hsv"),o=s[0],a=s[1],c=s[2];this.value.setRawValue(new lY.Color([o,a,c,r],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,DP.getStepForKey)((0,cY.getBaseStepForColor)(!0),(0,DP.getHorizontalStepKeys)(e));if(t!==0){var r=this.value.rawValue,i=r.getComponents("hsv"),s=i[0],o=i[1],a=i[2],c=i[3];this.value.setRawValue(new lY.Color([s,o,a,c+t],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,DP.getStepForKey)((0,cY.getBaseStepForColor)(!0),(0,DP.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();hD.APaletteController=fTe;var pD={},fD={};Object.defineProperty(fD,"__esModule",{value:!0});fD.ColorTextView=void 0;var uY=pa,mTe=fo,vTe=pr,z_=(0,vTe.ClassName)("coltxt");function gTe(n){var e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(t.reduce(function(r,i){var s=n.createElement("option");return s.textContent=i.text,s.value=i.value,r.appendChild(s),r},n.createDocumentFragment())),e}var _Te=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(z_());var i=e.createElement("div");i.classList.add(z_("m")),this.modeElem_=gTe(e),this.modeElem_.classList.add(z_("ms")),i.appendChild(this.modeSelectElement);var s=e.createElement("div");s.classList.add(z_("mm")),s.appendChild((0,uY.createSvgIconElement)(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);var o=e.createElement("div");o.classList.add(z_("w")),this.element.appendChild(o),this.textsElem_=o,this.textViews_=t.textViews,this.applyTextViews_(),(0,mTe.bindValue)(t.colorMode,function(a){r.modeElem_.value=a})}return Object.defineProperty(n.prototype,"modeSelectElement",{get:function(){return this.modeElem_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textViews",{get:function(){return this.textViews_},set:function(e){this.textViews_=e,this.applyTextViews_()},enumerable:!1,configurable:!0}),n.prototype.applyTextViews_=function(){var e=this;(0,uY.removeChildElements)(this.textsElem_);var t=this.element.ownerDocument;this.textViews_.forEach(function(r){var i=t.createElement("div");i.classList.add(z_("c")),i.appendChild(r.element),e.textsElem_.appendChild(i)})},n}();fD.ColorTextView=_Te;Object.defineProperty(pD,"__esModule",{value:!0});pD.ColorTextController=void 0;var yTe=Km,xTe=ao,bTe=$i,wTe=tf,wse=_l,STe=nf,MTe=za,RU=ls,CTe=Ll,ETe=fD;function ATe(n){return(0,xTe.createNumberFormatter)(n==="float"?2:0)}function PTe(n,e,t){var r=(0,RU.getColorMaxComponents)(n,e)[t];return new yTe.RangeConstraint({min:0,max:r})}function iV(n,e,t){return new STe.NumberTextController(n,{arrayPosition:t===0?"fst":t===3-1?"lst":"mid",baseStep:(0,CTe.getBaseStepForColor)(!1),parser:e.parser,props:bTe.ValueMap.fromObject({draggingScale:e.colorType==="float"?.01:1,formatter:ATe(e.colorType)}),value:(0,wse.createValue)(0,{constraint:PTe(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}var TTe=function(){function n(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=(0,wse.createValue)(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new ETe.ColorTextView(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return n.prototype.createComponentControllers_=function(e){var t=this,r={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[iV(e,r,0),iV(e,r,1),iV(e,r,2)];return i.forEach(function(s,o){(0,wTe.connectValues)({primary:t.value,secondary:s.value,forward:function(a){return a.rawValue.getComponents(t.colorMode.rawValue,t.colorType_)[o]},backward:function(a,c){var u=t.colorMode.rawValue,d=a.rawValue.getComponents(u,t.colorType_);return d[o]=c.rawValue,new MTe.Color((0,RU.appendAlphaComponent)((0,RU.removeAlphaComponent)(d),d[3]),u,t.colorType_)}})}),i},n.prototype.onModeSelectChange_=function(e){var t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]},n}();pD.ColorTextController=TTe;var mD={},vD={};Object.defineProperty(vD,"__esModule",{value:!0});vD.HPaletteView=void 0;var RTe=gi,OTe=pr,LTe=rf,DTe=za,sV=(0,OTe.ClassName)("hpl"),ITe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(sV()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(sV("c")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(sV("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("hsv")[0];this.markerElem_.style.backgroundColor=(0,LTe.colorToFunctionalRgbString)(new DTe.Color([t,100,100],"hsv"));var r=(0,RTe.mapRange)(t,0,360,0,100);this.markerElem_.style.left=r+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();vD.HPaletteView=ITe;Object.defineProperty(mD,"__esModule",{value:!0});mD.HPaletteController=void 0;var hY=gi,IP=Ro,NTe=dh,dY=za,pY=Ll,kTe=vD,zTe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new kTe.HPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new NTe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var r=(0,hY.mapRange)((0,hY.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,0,359),i=this.value.rawValue,s=i.getComponents("hsv"),o=s[1],a=s[2],c=s[3];this.value.setRawValue(new dY.Color([r,o,a,c],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,IP.getStepForKey)((0,pY.getBaseStepForColor)(!1),(0,IP.getHorizontalStepKeys)(e));if(t!==0){var r=this.value.rawValue,i=r.getComponents("hsv"),s=i[0],o=i[1],a=i[2],c=i[3];this.value.setRawValue(new dY.Color([s+t,o,a,c],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,IP.getStepForKey)((0,pY.getBaseStepForColor)(!1),(0,IP.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();mD.HPaletteController=zTe;var gD={},_D={};Object.defineProperty(_D,"__esModule",{value:!0});_D.SvPaletteView=void 0;var BTe=pa,NP=gi,VTe=pr,FTe=ls,oV=(0,VTe.ClassName)("svp"),fY=64,UTe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(oV()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("canvas");r.height=fY,r.width=fY,r.classList.add(oV("c")),this.element.appendChild(r),this.canvasElement=r;var i=e.createElement("div");i.classList.add(oV("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return n.prototype.update_=function(){var e=(0,BTe.getCanvasContext)(this.canvasElement);if(e){for(var t=this.value.rawValue,r=t.getComponents("hsv"),i=this.canvasElement.width,s=this.canvasElement.height,o=e.getImageData(0,0,i,s),a=o.data,c=0;c<s;c++)for(var u=0;u<i;u++){var d=(0,NP.mapRange)(u,0,i,0,100),p=(0,NP.mapRange)(c,0,s,100,0),f=(0,FTe.hsvToRgbInt)(r[0],d,p),v=(c*i+u)*4;a[v]=f[0],a[v+1]=f[1],a[v+2]=f[2],a[v+3]=255}e.putImageData(o,0,0);var x=(0,NP.mapRange)(r[1],0,100,0,100);this.markerElem_.style.left=x+"%";var y=(0,NP.mapRange)(r[2],0,100,100,0);this.markerElem_.style.top=y+"%"}},n.prototype.onValueChange_=function(){this.update_()},n}();_D.SvPaletteView=UTe;Object.defineProperty(gD,"__esModule",{value:!0});gD.SvPaletteController=void 0;var mY=gi,dp=Ro,jTe=dh,vY=za,gY=Ll,HTe=_D,WTe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new HTe.SvPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new jTe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var r=(0,mY.mapRange)(e.point.x,0,e.bounds.width,0,100),i=(0,mY.mapRange)(e.point.y,0,e.bounds.height,100,0),s=this.value.rawValue.getComponents("hsv"),o=s[0],a=s[3];this.value.setRawValue(new vY.Color([o,r,i,a],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){(0,dp.isArrowKey)(e.key)&&e.preventDefault();var t=this.value.rawValue.getComponents("hsv"),r=t[0],i=t[1],s=t[2],o=t[3],a=(0,gY.getBaseStepForColor)(!1),c=(0,dp.getStepForKey)(a,(0,dp.getHorizontalStepKeys)(e)),u=(0,dp.getStepForKey)(a,(0,dp.getVerticalStepKeys)(e));c===0&&u===0||this.value.setRawValue(new vY.Color([r,i+c,s+u,o],"hsv"),{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,gY.getBaseStepForColor)(!1),r=(0,dp.getStepForKey)(t,(0,dp.getHorizontalStepKeys)(e)),i=(0,dp.getStepForKey)(t,(0,dp.getVerticalStepKeys)(e));r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();gD.SvPaletteController=WTe;Object.defineProperty(cD,"__esModule",{value:!0});cD.ColorPickerController=void 0;var GTe=Km,aV=ao,XTe=$i,qTe=tf,YTe=_l,ZTe=nf,KTe=za,JTe=uD,QTe=hD,$Te=pD,e3e=mD,t3e=gD,n3e=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new e3e.HPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new t3e.SvPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new QTe.APaletteController(e,{value:this.value,viewProps:this.viewProps}),text:new ZTe.NumberTextController(e,{parser:aV.parseNumber,baseStep:.1,props:XTe.ValueMap.fromObject({draggingScale:.01,formatter:(0,aV.createNumberFormatter)(2)}),value:(0,YTe.createValue)(0,{constraint:new GTe.RangeConstraint({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&(0,qTe.connectValues)({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(r){return r.rawValue.getComponents()[3]},backward:function(r,i){var s=r.rawValue.getComponents();return s[3]=i.rawValue,new KTe.Color(s,r.rawValue.mode)}}),this.textC_=new $Te.ColorTextController(e,{colorType:t.colorType,parser:aV.parseNumber,value:this.value,viewProps:this.viewProps}),this.view=new JTe.ColorPickerView(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();cD.ColorPickerController=n3e;var yD={},xD={};Object.defineProperty(xD,"__esModule",{value:!0});xD.ColorSwatchView=void 0;var r3e=pr,i3e=rf,lV=(0,r3e.ClassName)("colsw"),s3e=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(lV()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(lV("sw")),this.element.appendChild(r),this.swatchElem_=r;var i=e.createElement("button");i.classList.add(lV("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue;this.swatchElem_.style.backgroundColor=(0,i3e.colorToHexRgbaString)(e)},n.prototype.onValueChange_=function(){this.update_()},n}();xD.ColorSwatchView=s3e;Object.defineProperty(yD,"__esModule",{value:!0});yD.ColorSwatchController=void 0;var o3e=xD,a3e=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new o3e.ColorSwatchView(e,{value:this.value,viewProps:this.viewProps})}return n}();yD.ColorSwatchController=a3e;Object.defineProperty(I0,"__esModule",{value:!0});I0.ColorController=void 0;var _Y=ll,l3e=bb,c3e=wb,yY=pa,u3e=$i,h3e=tf,d3e=Wn,p3e=lD,f3e=cD,m3e=yD,v3e=function(){function n(e,t){var r=this;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=_Y.Foldable.create(t.expanded),this.swatchC_=new m3e.ColorSwatchController(e,{value:this.value,viewProps:this.viewProps});var i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new c3e.TextController(e,{parser:t.parser,props:u3e.ValueMap.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new p3e.ColorView(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new l3e.PopupController(e,{viewProps:this.viewProps}):null;var s=new f3e.ColorPickerController(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(function(o){o.addEventListener("blur",r.onPopupChildBlur_),o.addEventListener("keydown",r.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),(0,h3e.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(o){return o.rawValue},backward:function(o,a){return a.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,_Y.bindFoldable)(this.foldable_,this.view.pickerElement))}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n.prototype.onButtonBlur_=function(e){if(this.popC_){var t=this.view.element,r=(0,d3e.forceCast)(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(this.popC_){var t=this.popC_.view.element,r=(0,yY.findNextTarget)(e);r&&t.contains(r)||r&&r===this.swatchC_.view.buttonElement&&!(0,yY.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()},n}();I0.ColorController=v3e;var ro={};Object.defineProperty(ro,"__esModule",{value:!0});ro.colorFromRgbaNumber=ro.colorFromRgbNumber=ro.numberToRgbaColor=ro.numberToRgbColor=ro.colorToRgbaNumber=ro.colorToRgbNumber=ro.colorFromObject=void 0;var g3e=gi,l0=za,_3e=ls;function y3e(n,e){return l0.Color.isColorObject(n)?l0.Color.fromObject(n,e):l0.Color.black(e)}ro.colorFromObject=y3e;function x3e(n){return(0,_3e.removeAlphaComponent)(n.getComponents("rgb")).reduce(function(e,t){return e<<8|Math.floor(t)&255},0)}ro.colorToRgbNumber=x3e;function b3e(n){return n.getComponents("rgb").reduce(function(e,t,r){var i=Math.floor(r===3?t*255:t)&255;return e<<8|i},0)>>>0}ro.colorToRgbaNumber=b3e;function Sse(n){return new l0.Color([n>>16&255,n>>8&255,n&255],"rgb")}ro.numberToRgbColor=Sse;function Mse(n){return new l0.Color([n>>24&255,n>>16&255,n>>8&255,(0,g3e.mapRange)(n&255,0,255,0,1)],"rgb")}ro.numberToRgbaColor=Mse;function w3e(n){return typeof n!="number"?l0.Color.black():Sse(n)}ro.colorFromRgbNumber=w3e;function S3e(n){return typeof n!="number"?l0.Color.black():Mse(n)}ro.colorFromRgbaNumber=S3e;var I2={},Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.createColorObjectWriter=Pl.writeRgbColorObject=Pl.writeRgbaColorObject=Pl.createColorNumberWriter=Pl.createColorStringWriter=void 0;var Cse=Jm,xY=ro,M3e=rf;function C3e(n){var e=(0,M3e.findColorStringifier)(n);return e?function(t,r){(0,Cse.writePrimitive)(t,e(r))}:null}Pl.createColorStringWriter=C3e;function E3e(n){var e=n?xY.colorToRgbaNumber:xY.colorToRgbNumber;return function(t,r){(0,Cse.writePrimitive)(t,e(r))}}Pl.createColorNumberWriter=E3e;function Ese(n,e,t){var r=e.toRgbaObject(t);n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b),n.writeProperty("a",r.a)}Pl.writeRgbaColorObject=Ese;function Ase(n,e,t){var r=e.toRgbaObject(t);n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b)}Pl.writeRgbColorObject=Ase;function A3e(n,e){return function(t,r){n?Ese(t,r,e):Ase(t,r,e)}}Pl.createColorObjectWriter=A3e;Object.defineProperty(I2,"__esModule",{value:!0});I2.NumberColorInputPlugin=void 0;var P3e=I0,bY=ro,OU=rf,T3e=Pl,R3e=za,O3e=Ll;function cV(n){var e;return!!((n==null?void 0:n.alpha)||((e=n==null?void 0:n.color)===null||e===void 0?void 0:e.alpha))}function L3e(n){return n?function(e){return(0,OU.colorToHexRgbaString)(e,"0x")}:function(e){return(0,OU.colorToHexRgbString)(e,"0x")}}function D3e(n){return"color"in n||"view"in n&&n.view==="color"}I2.NumberColorInputPlugin={id:"input-color-number",type:"input",accept:function(n,e){if(typeof n!="number"||!D3e(e))return null;var t=(0,O3e.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return cV(n.params)?bY.colorFromRgbaNumber:bY.colorFromRgbNumber},equals:R3e.Color.equals,writer:function(n){return(0,T3e.createColorNumberWriter)(cV(n.params))}},controller:function(n){var e=cV(n.params),t="expanded"in n.params?n.params.expanded:void 0,r="picker"in n.params?n.params.picker:void 0;return new P3e.ColorController(n.document,{colorType:"int",expanded:t!=null?t:!1,formatter:L3e(e),parser:(0,OU.createColorStringParser)("int"),pickerLayout:r!=null?r:"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}};var N2={};Object.defineProperty(N2,"__esModule",{value:!0});N2.ObjectColorInputPlugin=void 0;var I3e=I0,N3e=ro,LU=rf,k3e=Pl,U3=za,kP=Ll;function z3e(n){return U3.Color.isRgbaColorObject(n)}function B3e(n){return function(e){return(0,N3e.colorFromObject)(e,n)}}function V3e(n,e){return function(t){return n?(0,LU.colorToObjectRgbaString)(t,e):(0,LU.colorToObjectRgbString)(t,e)}}N2.ObjectColorInputPlugin={id:"input-color-object",type:"input",accept:function(n,e){if(!U3.Color.isColorObject(n))return null;var t=(0,kP.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return B3e((0,kP.extractColorType)(n.params))},equals:U3.Color.equals,writer:function(n){return(0,k3e.createColorObjectWriter)(z3e(n.initialValue),(0,kP.extractColorType)(n.params))}},controller:function(n){var e,t=U3.Color.isRgbaColorObject(n.initialValue),r="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0,s=(e=(0,kP.extractColorType)(n.params))!==null&&e!==void 0?e:"int";return new I3e.ColorController(n.document,{colorType:s,expanded:r!=null?r:!1,formatter:V3e(t,s),parser:(0,LU.createColorStringParser)(s),pickerLayout:i!=null?i:"popup",supportsAlpha:t,value:n.value,viewProps:n.viewProps})}};var k2={};Object.defineProperty(k2,"__esModule",{value:!0});k2.StringColorInputPlugin=void 0;var zP=Vl,F3e=I0,Eg=rf,U3e=Pl,j3e=za,ES=Ll;k2.StringColorInputPlugin={id:"input-color-string",type:"input",accept:function(n,e){if(typeof n!="string"||"view"in e&&e.view==="text")return null;var t=(0,Eg.detectStringColorFormat)(n,(0,ES.extractColorType)(e));if(!t)return null;var r=(0,Eg.findColorStringifier)(t);if(!r)return null;var i=(0,ES.parseColorInputParams)(e);return i?{initialValue:n,params:i}:null},binding:{reader:function(n){var e;return(0,Eg.createColorStringBindingReader)((e=(0,ES.extractColorType)(n.params))!==null&&e!==void 0?e:"int")},equals:j3e.Color.equals,writer:function(n){var e=(0,Eg.detectStringColorFormat)(n.initialValue,(0,ES.extractColorType)(n.params));if(!e)throw zP.TpError.shouldNeverHappen();var t=(0,U3e.createColorStringWriter)(e);if(!t)throw zP.TpError.notBindable();return t}},controller:function(n){var e=(0,Eg.detectStringColorFormat)(n.initialValue,(0,ES.extractColorType)(n.params));if(!e)throw zP.TpError.shouldNeverHappen();var t=(0,Eg.findColorStringifier)(e);if(!t)throw zP.TpError.shouldNeverHappen();var r="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0;return new F3e.ColorController(n.document,{colorType:e.type,expanded:r!=null?r:!1,formatter:t,parser:(0,Eg.createColorStringParser)(e.type),pickerLayout:i!=null?i:"popup",supportsAlpha:e.alpha,value:n.value,viewProps:n.viewProps})}};var N0={};Object.defineProperty(N0,"__esModule",{value:!0});N0.PointNdConstraint=void 0;var H3e=function(){function n(e){this.components=e.components,this.asm_=e.assembly}return n.prototype.constrain=function(e){var t=this,r=this.asm_.toComponents(e).map(function(i,s){var o,a;return(a=(o=t.components[s])===null||o===void 0?void 0:o.constrain(i))!==null&&a!==void 0?a:i});return this.asm_.fromComponents(r)},n}();N0.PointNdConstraint=H3e;var k0={},bD={};Object.defineProperty(bD,"__esModule",{value:!0});bD.PointNdTextView=void 0;var W3e=pr,wY=(0,W3e.ClassName)("pndtxt"),G3e=function(){function n(e,t){var r=this;this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(wY()),this.textViews.forEach(function(i){var s=e.createElement("div");s.classList.add(wY("a")),s.appendChild(i.element),r.element.appendChild(s)})}return n}();bD.PointNdTextView=G3e;Object.defineProperty(k0,"__esModule",{value:!0});k0.PointNdTextController=void 0;var X3e=tf,q3e=_l,Y3e=nf,Z3e=bD;function K3e(n,e,t){return new Y3e.NumberTextController(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",baseStep:e.axes[t].baseStep,parser:e.parser,props:e.axes[t].textProps,value:(0,q3e.createValue)(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}var J3e=function(){function n(e,t){var r=this;this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(function(i,s){return K3e(e,t,s)}),this.acs_.forEach(function(i,s){(0,X3e.connectValues)({primary:r.value,secondary:i.value,forward:function(o){return t.assembly.toComponents(o.rawValue)[s]},backward:function(o,a){var c=t.assembly.toComponents(o.rawValue);return c[s]=a.rawValue,t.assembly.fromComponents(c)}})}),this.view=new Z3e.PointNdTextView(e,{textViews:this.acs_.map(function(i){return i.view})})}return n}();k0.PointNdTextController=J3e;var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.NumberInputPlugin=Kh.createRangeConstraint=Kh.createStepConstraint=void 0;var aO=ch,Q3e=Zm,yH=Km,$3e=xb,eRe=D0,BP=ao,VP=$i,tRe=nf,nRe=R2,SY=Hs,rRe=Jm,tm=ui,DU=Wn;function Pse(n,e){return"step"in n&&!(0,DU.isEmpty)(n.step)?new $3e.StepConstraint(n.step,e):null}Kh.createStepConstraint=Pse;function Tse(n){return"max"in n&&!(0,DU.isEmpty)(n.max)||"min"in n&&!(0,DU.isEmpty)(n.min)?new yH.RangeConstraint({max:n.max,min:n.min}):null}Kh.createRangeConstraint=Tse;function iRe(n,e){var t=[],r=Pse(n,e);r&&t.push(r);var i=Tse(n);i&&t.push(i);var s=(0,tm.createListConstraint)(n.options);return s&&t.push(s),new aO.CompositeConstraint(t)}function sRe(n){var e=n?(0,aO.findConstraint)(n,yH.RangeConstraint):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function oRe(n){var e=sRe(n),t=e[0],r=e[1];return[t!=null?t:0,r!=null?r:100]}Kh.NumberInputPlugin={id:"input-number",type:"input",accept:function(n,e){if(typeof n!="number")return null;var t=SY.ParamsParsers,r=(0,SY.parseParams)(e,{format:t.optional.function,max:t.optional.number,min:t.optional.number,options:t.optional.custom(tm.parseListOptions),step:t.optional.number});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return BP.numberFromUnknown},constraint:function(n){return iRe(n.params,n.initialValue)},writer:function(n){return rRe.writePrimitive}},controller:function(n){var e,t,r=n.value,i=n.constraint;if(i&&(0,aO.findConstraint)(i,Q3e.ListConstraint))return new eRe.ListController(n.document,{props:VP.ValueMap.fromObject({options:(e=(0,tm.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps});var s=(t="format"in n.params?n.params.format:void 0)!==null&&t!==void 0?t:(0,BP.createNumberFormatter)((0,tm.getSuitableDecimalDigits)(i,r.rawValue));if(i&&(0,aO.findConstraint)(i,yH.RangeConstraint)){var o=oRe(i),a=o[0],c=o[1];return new nRe.SliderTextController(n.document,{baseStep:(0,tm.getBaseStep)(i),parser:BP.parseNumber,sliderProps:VP.ValueMap.fromObject({maxValue:c,minValue:a}),textProps:VP.ValueMap.fromObject({draggingScale:(0,tm.getSuitableDraggingScale)(i,r.rawValue),formatter:s}),value:r,viewProps:n.viewProps})}return new tRe.NumberTextController(n.document,{baseStep:(0,tm.getBaseStep)(i),parser:BP.parseNumber,props:VP.ValueMap.fromObject({draggingScale:(0,tm.getSuitableDraggingScale)(i,r.rawValue),formatter:s}),value:r,viewProps:n.viewProps})}};var z2={},Xp={},aRe=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Xp,"__esModule",{value:!0});Xp.Point2dAssembly=Xp.Point2d=void 0;var lRe=Wn,IU=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return n.prototype.getComponents=function(){return[this.x,this.y]},n.isObject=function(e){if((0,lRe.isEmpty)(e))return!1;var t=e.x,r=e.y;return!(typeof t!="number"||typeof r!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y},n.prototype.toObject=function(){return{x:this.x,y:this.y}},n}();Xp.Point2d=IU;Xp.Point2dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(IU.bind.apply(IU,aRe([void 0],n,!1)))}};var wD={};Object.defineProperty(wD,"__esModule",{value:!0});wD.Point2dView=void 0;var cRe=pa,uRe=fo,hRe=pr,dRe=Nl,B_=(0,hRe.ClassName)("p2d"),pRe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(B_()),t.viewProps.bindClassModifiers(this.element),(0,uRe.bindValue)(t.expanded,(0,dRe.valueToClassName)(this.element,B_(void 0,"expanded")));var r=e.createElement("div");r.classList.add(B_("h")),this.element.appendChild(r);var i=e.createElement("button");i.classList.add(B_("b")),i.appendChild((0,cRe.createSvgIconElement)(e,"p2dpad")),t.viewProps.bindDisabled(i),r.appendChild(i),this.buttonElement=i;var s=e.createElement("div");if(s.classList.add(B_("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){var o=e.createElement("div");o.classList.add(B_("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return n}();wD.Point2dView=pRe;var SD={},MD={};Object.defineProperty(MD,"__esModule",{value:!0});MD.Point2dPickerView=void 0;var FP=pa,MY=gi,fRe=pr,Vf=(0,fRe.ClassName)("p2dp"),mRe=function(){function n(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add(Vf()),t.layout==="popup"&&this.element.classList.add(Vf(void 0,"p"));var r=e.createElement("div");r.classList.add(Vf("p")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;var i=e.createElementNS(FP.SVG_NS,"svg");i.classList.add(Vf("g")),this.padElement.appendChild(i),this.svgElem_=i;var s=e.createElementNS(FP.SVG_NS,"line");s.classList.add(Vf("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);var o=e.createElementNS(FP.SVG_NS,"line");o.classList.add(Vf("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var a=e.createElementNS(FP.SVG_NS,"line");a.classList.add(Vf("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;var c=e.createElement("div");c.classList.add(Vf("m")),this.padElement.appendChild(c),this.markerElem_=c,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){return[this.padElement]},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.value.rawValue.getComponents(),t=e[0],r=e[1],i=this.maxValue_,s=(0,MY.mapRange)(t,-i,+i,0,100),o=(0,MY.mapRange)(r,-i,+i,0,100),a=this.invertsY_?100-o:o;this.lineElem_.setAttributeNS(null,"x2",s+"%"),this.lineElem_.setAttributeNS(null,"y2",a+"%"),this.markerElem_.style.left=s+"%",this.markerElem_.style.top=a+"%"},n.prototype.onValueChange_=function(){this.update_()},n.prototype.onFoldableChange_=function(){this.update_()},n}();MD.Point2dPickerView=mRe;Object.defineProperty(SD,"__esModule",{value:!0});SD.Point2dPickerController=void 0;var CY=gi,sM=Ro,vRe=dh,EY=Xp,gRe=MD;function AY(n,e,t){return[(0,sM.getStepForKey)(e[0],(0,sM.getHorizontalStepKeys)(n)),(0,sM.getStepForKey)(e[1],(0,sM.getVerticalStepKeys)(n))*(t?1:-1)]}var _Re=function(){function n(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new gRe.Point2dPickerView(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new vRe.PointerHandler(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(e.point){var r=this.maxValue_,i=(0,CY.mapRange)(e.point.x,0,e.bounds.width,-r,+r),s=(0,CY.mapRange)(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-r,+r);this.value.setRawValue(new EY.Point2d(i,s),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onPadKeyDown_=function(e){(0,sM.isArrowKey)(e.key)&&e.preventDefault();var t=AY(e,this.baseSteps_,this.invertsY_),r=t[0],i=t[1];r===0&&i===0||this.value.setRawValue(new EY.Point2d(this.value.rawValue.x+r,this.value.rawValue.y+i),{forceEmit:!1,last:!1})},n.prototype.onPadKeyUp_=function(e){var t=AY(e,this.baseSteps_,this.invertsY_),r=t[0],i=t[1];r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();SD.Point2dPickerController=_Re;Object.defineProperty(z2,"__esModule",{value:!0});z2.Point2dController=void 0;var PY=ll,yRe=bb,TY=pa,xRe=tf,bRe=Wn,wRe=k0,SRe=Xp,MRe=wD,CRe=SD,ERe=function(){function n(e,t){var r=this,i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=PY.Foldable.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new yRe.PopupController(e,{viewProps:this.viewProps}):null;var o=new CRe.Point2dPickerController(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(function(a){a.addEventListener("blur",r.onPopupChildBlur_),a.addEventListener("keydown",r.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new wRe.PointNdTextController(e,{assembly:SRe.Point2dAssembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new MRe.Point2dView(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),(0,xRe.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(a){return a.rawValue},backward:function(a,c){return c.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,PY.bindFoldable)(this.foldable_,this.view.pickerElement))}return n.prototype.onPadButtonBlur_=function(e){if(this.popC_){var t=this.view.element,r=(0,bRe.forceCast)(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onPadButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(this.popC_){var t=this.popC_.view.element,r=(0,TY.findNextTarget)(e);r&&t.contains(r)||r&&r===this.view.buttonElement&&!(0,TY.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()},n}();z2.Point2dController=ERe;var sh={},bx={};Object.defineProperty(bx,"__esModule",{value:!0});bx.writePoint2d=bx.point2dFromUnknown=void 0;var uV=Xp;function ARe(n){return uV.Point2d.isObject(n)?new uV.Point2d(n.x,n.y):new uV.Point2d}bx.point2dFromUnknown=ARe;function PRe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}bx.writePoint2d=PRe;Object.defineProperty(sh,"__esModule",{value:!0});sh.Point2dInputPlugin=sh.getSuitableMaxValue=sh.createDimensionConstraint=void 0;var Rse=ch,TRe=Km,Ose=ao,RRe=$i,RY=Hs,ORe=Vl,Fy=ui,lO=N0,OY=Kh,LRe=z2,LY=bx,NU=Xp;function kU(n,e){if(n){var t=[],r=(0,OY.createStepConstraint)(n,e);r&&t.push(r);var i=(0,OY.createRangeConstraint)(n);return i&&t.push(i),new Rse.CompositeConstraint(t)}}sh.createDimensionConstraint=kU;function DRe(n,e){return new lO.PointNdConstraint({assembly:NU.Point2dAssembly,components:[kU("x"in n?n.x:void 0,e.x),kU("y"in n?n.y:void 0,e.y)]})}function DY(n,e){var t,r,i=n&&(0,Rse.findConstraint)(n,TRe.RangeConstraint);if(i)return Math.max(Math.abs((t=i.minValue)!==null&&t!==void 0?t:0),Math.abs((r=i.maxValue)!==null&&r!==void 0?r:0));var s=(0,Fy.getBaseStep)(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Lse(n,e){var t=e instanceof lO.PointNdConstraint?e.components[0]:void 0,r=e instanceof lO.PointNdConstraint?e.components[1]:void 0,i=DY(t,n.x),s=DY(r,n.y);return Math.max(i,s)}sh.getSuitableMaxValue=Lse;function IY(n,e){return{baseStep:(0,Fy.getBaseStep)(e),constraint:e,textProps:RRe.ValueMap.fromObject({draggingScale:(0,Fy.getSuitableDraggingScale)(e,n),formatter:(0,Ose.createNumberFormatter)((0,Fy.getSuitableDecimalDigits)(e,n))})}}function IRe(n){if(!("y"in n))return!1;var e=n.y;return e&&"inverted"in e?!!e.inverted:!1}sh.Point2dInputPlugin={id:"input-point2d",type:"input",accept:function(n,e){if(!NU.Point2d.isObject(n))return null;var t=RY.ParamsParsers,r=(0,RY.parseParams)(e,{expanded:t.optional.boolean,picker:t.optional.custom(Fy.parsePickerLayout),x:t.optional.custom(Fy.parsePointDimensionParams),y:t.optional.object({inverted:t.optional.boolean,max:t.optional.number,min:t.optional.number,step:t.optional.number})});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return LY.point2dFromUnknown},constraint:function(n){return DRe(n.params,n.initialValue)},equals:NU.Point2d.equals,writer:function(n){return LY.writePoint2d}},controller:function(n){var e=n.document,t=n.value,r=n.constraint;if(!(r instanceof lO.PointNdConstraint))throw ORe.TpError.shouldNeverHappen();var i="expanded"in n.params?n.params.expanded:void 0,s="picker"in n.params?n.params.picker:void 0;return new LRe.Point2dController(e,{axes:[IY(t.rawValue.x,r.components[0]),IY(t.rawValue.y,r.components[1])],expanded:i!=null?i:!1,invertsY:IRe(n.params),maxValue:Lse(t.rawValue,r),parser:Ose.parseNumber,pickerLayout:s!=null?s:"popup",value:t,viewProps:n.viewProps})}};var B2={},wx={},x0={},NRe=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(x0,"__esModule",{value:!0});x0.Point3dAssembly=x0.Point3d=void 0;var kRe=Wn,zU=function(){function n(e,t,r){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),this.x=e,this.y=t,this.z=r}return n.prototype.getComponents=function(){return[this.x,this.y,this.z]},n.isObject=function(e){if((0,kRe.isEmpty)(e))return!1;var t=e.x,r=e.y,i=e.z;return!(typeof t!="number"||typeof r!="number"||typeof i!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z}},n}();x0.Point3d=zU;x0.Point3dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(zU.bind.apply(zU,NRe([void 0],n,!1)))}};Object.defineProperty(wx,"__esModule",{value:!0});wx.writePoint3d=wx.point3dFromUnknown=void 0;var hV=x0;function zRe(n){return hV.Point3d.isObject(n)?new hV.Point3d(n.x,n.y,n.z):new hV.Point3d}wx.point3dFromUnknown=zRe;function BRe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}wx.writePoint3d=BRe;Object.defineProperty(B2,"__esModule",{value:!0});B2.Point3dInputPlugin=void 0;var Dse=ao,VRe=$i,NY=Hs,FRe=Vl,Uy=ui,Ise=N0,URe=k0,dV=sh,kY=wx,j3=x0;function jRe(n,e){return new Ise.PointNdConstraint({assembly:j3.Point3dAssembly,components:[(0,dV.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,dV.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,dV.createDimensionConstraint)("z"in n?n.z:void 0,e.z)]})}function pV(n,e){return{baseStep:(0,Uy.getBaseStep)(e),constraint:e,textProps:VRe.ValueMap.fromObject({draggingScale:(0,Uy.getSuitableDraggingScale)(e,n),formatter:(0,Dse.createNumberFormatter)((0,Uy.getSuitableDecimalDigits)(e,n))})}}B2.Point3dInputPlugin={id:"input-point3d",type:"input",accept:function(n,e){if(!j3.Point3d.isObject(n))return null;var t=NY.ParamsParsers,r=(0,NY.parseParams)(e,{x:t.optional.custom(Uy.parsePointDimensionParams),y:t.optional.custom(Uy.parsePointDimensionParams),z:t.optional.custom(Uy.parsePointDimensionParams)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return kY.point3dFromUnknown},constraint:function(n){return jRe(n.params,n.initialValue)},equals:j3.Point3d.equals,writer:function(n){return kY.writePoint3d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof Ise.PointNdConstraint))throw FRe.TpError.shouldNeverHappen();return new URe.PointNdTextController(n.document,{assembly:j3.Point3dAssembly,axes:[pV(e.rawValue.x,t.components[0]),pV(e.rawValue.y,t.components[1]),pV(e.rawValue.z,t.components[2])],parser:Dse.parseNumber,value:e,viewProps:n.viewProps})}};var V2={},Sx={},b0={},HRe=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(b0,"__esModule",{value:!0});b0.Point4dAssembly=b0.Point4d=void 0;var WRe=Wn,BU=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=r,this.w=i}return n.prototype.getComponents=function(){return[this.x,this.y,this.z,this.w]},n.isObject=function(e){if((0,WRe.isEmpty)(e))return!1;var t=e.x,r=e.y,i=e.z,s=e.w;return!(typeof t!="number"||typeof r!="number"||typeof i!="number"||typeof s!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},n}();b0.Point4d=BU;b0.Point4dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(BU.bind.apply(BU,HRe([void 0],n,!1)))}};Object.defineProperty(Sx,"__esModule",{value:!0});Sx.writePoint4d=Sx.point4dFromUnknown=void 0;var fV=b0;function GRe(n){return fV.Point4d.isObject(n)?new fV.Point4d(n.x,n.y,n.z,n.w):new fV.Point4d}Sx.point4dFromUnknown=GRe;function XRe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}Sx.writePoint4d=XRe;Object.defineProperty(V2,"__esModule",{value:!0});V2.Point4dInputPlugin=void 0;var Nse=ao,qRe=$i,zY=Hs,YRe=Vl,Qg=ui,kse=N0,ZRe=k0,UP=sh,BY=Sx,H3=b0;function KRe(n,e){return new kse.PointNdConstraint({assembly:H3.Point4dAssembly,components:[(0,UP.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,UP.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,UP.createDimensionConstraint)("z"in n?n.z:void 0,e.z),(0,UP.createDimensionConstraint)("w"in n?n.w:void 0,e.w)]})}function JRe(n,e){return{baseStep:(0,Qg.getBaseStep)(e),constraint:e,textProps:qRe.ValueMap.fromObject({draggingScale:(0,Qg.getSuitableDraggingScale)(e,n),formatter:(0,Nse.createNumberFormatter)((0,Qg.getSuitableDecimalDigits)(e,n))})}}V2.Point4dInputPlugin={id:"input-point4d",type:"input",accept:function(n,e){if(!H3.Point4d.isObject(n))return null;var t=zY.ParamsParsers,r=(0,zY.parseParams)(e,{x:t.optional.custom(Qg.parsePointDimensionParams),y:t.optional.custom(Qg.parsePointDimensionParams),z:t.optional.custom(Qg.parsePointDimensionParams),w:t.optional.custom(Qg.parsePointDimensionParams)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return BY.point4dFromUnknown},constraint:function(n){return KRe(n.params,n.initialValue)},equals:H3.Point4d.equals,writer:function(n){return BY.writePoint4d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof kse.PointNdConstraint))throw YRe.TpError.shouldNeverHappen();return new ZRe.PointNdTextController(n.document,{assembly:H3.Point4dAssembly,axes:e.rawValue.getComponents().map(function(r,i){return JRe(r,t.components[i])}),parser:Nse.parseNumber,value:e,viewProps:n.viewProps})}};var F2={};Object.defineProperty(F2,"__esModule",{value:!0});F2.StringInputPlugin=void 0;var zse=ch,QRe=Zm,$Re=D0,eOe=wb,VY=Lm,FY=$i,UY=Hs,tOe=Jm,VU=ui;function nOe(n){var e=[],t=(0,VU.createListConstraint)(n.options);return t&&e.push(t),new zse.CompositeConstraint(e)}F2.StringInputPlugin={id:"input-string",type:"input",accept:function(n,e){if(typeof n!="string")return null;var t=UY.ParamsParsers,r=(0,UY.parseParams)(e,{options:t.optional.custom(VU.parseListOptions)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return VY.stringFromUnknown},constraint:function(n){return nOe(n.params)},writer:function(n){return tOe.writePrimitive}},controller:function(n){var e,t=n.document,r=n.value,i=n.constraint;return i&&(0,zse.findConstraint)(i,QRe.ListConstraint)?new $Re.ListController(t,{props:FY.ValueMap.fromObject({options:(e=(0,VU.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps}):new eOe.TextController(t,{parser:function(s){return s},props:FY.ValueMap.fromObject({formatter:VY.formatString}),value:r,viewProps:n.viewProps})}};var Qm={};Object.defineProperty(Qm,"__esModule",{value:!0});Qm.Constants=void 0;Qm.Constants={monitor:{defaultInterval:200,defaultLineCount:3}};var U2={},z0={},CD={};Object.defineProperty(CD,"__esModule",{value:!0});CD.MultiLogView=void 0;var rOe=pr,jY=(0,rOe.ClassName)("mll"),iOe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(jY()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("textarea");r.classList.add(jY("i")),r.style.height="calc(var(--bld-us) * "+t.lineCount+")",r.readOnly=!0,t.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this,t=this.textareaElem_,r=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach(function(s){s!==void 0&&i.push(e.formatter_(s))}),t.textContent=i.join(`
`),r&&(t.scrollTop=t.scrollHeight)},n.prototype.onValueUpdate_=function(){this.update_()},n}();CD.MultiLogView=iOe;Object.defineProperty(z0,"__esModule",{value:!0});z0.MultiLogController=void 0;var sOe=CD,oOe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new sOe.MultiLogView(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}return n}();z0.MultiLogController=oOe;var B0={},ED={};Object.defineProperty(ED,"__esModule",{value:!0});ED.SingleLogView=void 0;var aOe=pr,HY=(0,aOe.ClassName)("sgl"),lOe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(HY()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add(HY("i")),r.readOnly=!0,r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""},n.prototype.onValueUpdate_=function(){this.update_()},n}();ED.SingleLogView=lOe;Object.defineProperty(B0,"__esModule",{value:!0});B0.SingleLogController=void 0;var cOe=ED,uOe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new cOe.SingleLogView(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}return n}();B0.SingleLogController=uOe;Object.defineProperty(U2,"__esModule",{value:!0});U2.BooleanMonitorPlugin=void 0;var mV=Zh,WY=Hs,hOe=Qm,dOe=z0,pOe=B0;U2.BooleanMonitorPlugin={id:"monitor-bool",type:"monitor",accept:function(n,e){if(typeof n!="boolean")return null;var t=WY.ParamsParsers,r=(0,WY.parseParams)(e,{lineCount:t.optional.number});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return mV.boolFromUnknown}},controller:function(n){var e;return n.value.rawValue.length===1?new pOe.SingleLogController(n.document,{formatter:mV.BooleanFormatter,value:n.value,viewProps:n.viewProps}):new dOe.MultiLogController(n.document,{formatter:mV.BooleanFormatter,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:hOe.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}};var j2={},AD={};Object.defineProperty(AD,"__esModule",{value:!0});AD.GraphLogView=void 0;var vV=pa,jP=gi,Bse=pr,Ff=(0,Bse.ClassName)("grl"),fOe=function(){function n(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ff()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var r=e.createElementNS(vV.SVG_NS,"svg");r.classList.add(Ff("g")),r.style.height="calc(var(--bld-us) * "+t.lineCount+")",this.element.appendChild(r),this.svgElem_=r;var i=e.createElementNS(vV.SVG_NS,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;var s=e.createElement("div");s.classList.add(Ff("t"),(0,Bse.ClassName)("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"graphElement",{get:function(){return this.svgElem_},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,r=this.props_.get("minValue"),i=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(function(d,p){if(d!==void 0){var f=(0,jP.mapRange)(p,0,t,0,e.width),v=(0,jP.mapRange)(d,r,i,e.height,0);s.push([f,v].join(","))}}),this.lineElem_.setAttributeNS(null,"points",s.join(" "));var o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove(Ff("t","a"));return}var c=(0,jP.mapRange)(this.cursor_.rawValue,0,t,0,e.width),u=(0,jP.mapRange)(a,r,i,e.height,0);o.style.left=c+"px",o.style.top=u+"px",o.textContent=""+this.formatter_(a),o.classList.contains(Ff("t","a"))||(o.classList.add(Ff("t","a"),Ff("t","in")),(0,vV.forceReflow)(o),o.classList.remove(Ff("t","in")))},n.prototype.onValueUpdate_=function(){this.update_()},n.prototype.onCursorChange_=function(){this.update_()},n}();AD.GraphLogView=fOe;Object.defineProperty(j2,"__esModule",{value:!0});j2.GraphLogController=void 0;var mOe=pa,vOe=_l,GY=gi,gOe=dh,_Oe=AD,yOe=function(){function n(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=(0,vOe.createValue)(-1),this.view=new _Oe.GraphLogView(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!(0,mOe.supportsTouch)(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{var r=new gOe.PointerHandler(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}}return n.prototype.onGraphMouseLeave_=function(){this.cursor_.rawValue=-1},n.prototype.onGraphMouseMove_=function(e){var t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor((0,GY.mapRange)(e.offsetX,0,t.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerDown_=function(e){this.onGraphPointerMove_(e)},n.prototype.onGraphPointerMove_=function(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor((0,GY.mapRange)(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerUp_=function(){this.cursor_.rawValue=-1},n}();j2.GraphLogController=yOe;var H2={};Object.defineProperty(H2,"__esModule",{value:!0});H2.NumberMonitorPlugin=void 0;var Vse=ao,xOe=$i,XY=Hs,Fse=Qm,bOe=Wn,wOe=z0,SOe=B0,MOe=j2;function FU(n){return"format"in n&&!(0,bOe.isEmpty)(n.format)?n.format:(0,Vse.createNumberFormatter)(2)}function COe(n){var e;return n.value.rawValue.length===1?new SOe.SingleLogController(n.document,{formatter:FU(n.params),value:n.value,viewProps:n.viewProps}):new wOe.MultiLogController(n.document,{formatter:FU(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Fse.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function EOe(n){var e,t,r;return new MOe.GraphLogController(n.document,{formatter:FU(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Fse.Constants.monitor.defaultLineCount,props:xOe.ValueMap.fromObject({maxValue:(t="max"in n.params?n.params.max:null)!==null&&t!==void 0?t:100,minValue:(r="min"in n.params?n.params.min:null)!==null&&r!==void 0?r:0}),value:n.value,viewProps:n.viewProps})}function qY(n){return"view"in n&&n.view==="graph"}H2.NumberMonitorPlugin={id:"monitor-number",type:"monitor",accept:function(n,e){if(typeof n!="number")return null;var t=XY.ParamsParsers,r=(0,XY.parseParams)(e,{format:t.optional.function,lineCount:t.optional.number,max:t.optional.number,min:t.optional.number,view:t.optional.string});return r?{initialValue:n,params:r}:null},binding:{defaultBufferSize:function(n){return qY(n)?64:1},reader:function(n){return Vse.numberFromUnknown}},controller:function(n){return qY(n.params)?EOe(n):COe(n)}};var W2={};Object.defineProperty(W2,"__esModule",{value:!0});W2.StringMonitorPlugin=void 0;var gV=Lm,YY=Hs,AOe=Qm,POe=z0,TOe=B0;W2.StringMonitorPlugin={id:"monitor-string",type:"monitor",accept:function(n,e){if(typeof n!="string")return null;var t=YY.ParamsParsers,r=(0,YY.parseParams)(e,{lineCount:t.optional.number,multiline:t.optional.boolean});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return gV.stringFromUnknown}},controller:function(n){var e,t=n.value,r=t.rawValue.length>1||"multiline"in n.params&&n.params.multiline;return r?new POe.MultiLogController(n.document,{formatter:gV.formatString,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:AOe.Constants.monitor.defaultLineCount,value:t,viewProps:n.viewProps}):new TOe.SingleLogController(n.document,{formatter:gV.formatString,value:t,viewProps:n.viewProps})}};var Use={};Object.defineProperty(Use,"__esModule",{value:!0});var PD={},G2={},TD={},RD={};Object.defineProperty(RD,"__esModule",{value:!0});RD.InputBinding=void 0;var ROe=Es,OOe=function(){function n(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new ROe.Emitter,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return n.prototype.read=function(){var e=this.target.read();e!==void 0&&(this.value.rawValue=this.reader(e))},n.prototype.write_=function(e){this.writer(this.target,e)},n.prototype.onValueChange_=function(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})},n}();RD.InputBinding=OOe;Object.defineProperty(TD,"__esModule",{value:!0});TD.createInputBindingController=void 0;var LOe=Gm,DOe=Xm,IOe=RD,NOe=$i,kOe=_l,zOe=Ym,BOe=Hs,VOe=Wn;function FOe(n,e){var t=n.accept(e.target.read(),e.params);if((0,VOe.isEmpty)(t))return null;var r=BOe.ParamsParsers,i={target:e.target,initialValue:t.initialValue,params:t.params},s=n.binding.reader(i),o=n.binding.constraint?n.binding.constraint(i):void 0,a=(0,kOe.createValue)(s(t.initialValue),{constraint:o,equals:n.binding.equals}),c=new IOe.InputBinding({reader:s,target:e.target,value:a,writer:n.binding.writer(i)}),u=r.optional.boolean(e.params.disabled).value,d=r.optional.boolean(e.params.hidden).value,p=n.controller({constraint:o,document:e.document,initialValue:t.initialValue,params:t.params,value:c.value,viewProps:zOe.ViewProps.create({disabled:u,hidden:d})}),f=r.optional.string(e.params.label).value;return new DOe.InputBindingController(e.document,{binding:c,blade:(0,LOe.createBlade)(),props:NOe.ValueMap.fromObject({label:f!=null?f:e.target.key}),valueController:p})}TD.createInputBindingController=FOe;var OD={},LD={};Object.defineProperty(LD,"__esModule",{value:!0});LD.MonitorBinding=void 0;var UOe=Dm,jOe=Es,HOe=function(){function n(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new jOe.Emitter,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return n.prototype.dispose=function(){this.ticker.dispose()},n.prototype.read=function(){var e=this.target.read();if(e!==void 0){var t=this.value.rawValue,r=this.reader_(e);this.value.rawValue=(0,UOe.createPushedBuffer)(t,r),this.emitter.emit("update",{rawValue:r,sender:this})}},n.prototype.onTick_=function(e){this.read()},n}();LD.MonitorBinding=HOe;Object.defineProperty(OD,"__esModule",{value:!0});OD.createMonitorBindingController=void 0;var WOe=Gm,GOe=qm,XOe=LD,qOe=w2,YOe=b2,ZOe=Dm,KOe=$i,JOe=Ym,QOe=Hs,$Oe=Qm,eLe=Wn;function tLe(n,e){return e===0?new YOe.ManualTicker:new qOe.IntervalTicker(n,e!=null?e:$Oe.Constants.monitor.defaultInterval)}function nLe(n,e){var t,r,i,s=QOe.ParamsParsers,o=n.accept(e.target.read(),e.params);if((0,eLe.isEmpty)(o))return null;var a={target:e.target,initialValue:o.initialValue,params:o.params},c=n.binding.reader(a),u=(r=(t=s.optional.number(e.params.bufferSize).value)!==null&&t!==void 0?t:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(o.params))!==null&&r!==void 0?r:1,d=s.optional.number(e.params.interval).value,p=new XOe.MonitorBinding({reader:c,target:e.target,ticker:tLe(e.document,d),value:(0,ZOe.initializeBuffer)(u)}),f=s.optional.boolean(e.params.disabled).value,v=s.optional.boolean(e.params.hidden).value,x=n.controller({document:e.document,params:o.params,value:p.value,viewProps:JOe.ViewProps.create({disabled:f,hidden:v})}),y=(i=s.optional.string(e.params.label).value)!==null&&i!==void 0?i:e.target.key;return new GOe.MonitorBindingController(e.document,{binding:p,blade:(0,WOe.createBlade)(),props:KOe.ValueMap.fromObject({label:y}),valueController:x})}OD.createMonitorBindingController=nLe;var _V=At&&At.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(G2,"__esModule",{value:!0});G2.PluginPool=void 0;var rLe=vb,iLe=Xm,sLe=gb,oLe=qm,aLe=x2,lLe=Om,cLe=c2(),AS=Vl,uLe=TD,hLe=Wn,dLe=OD,pLe=function(){function n(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return n.prototype.getAll=function(){return _V(_V(_V([],this.pluginsMap_.blades,!0),this.pluginsMap_.inputs,!0),this.pluginsMap_.monitors,!0)},n.prototype.register=function(e){e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)},n.prototype.createInput=function(e,t,r){var i=t.read();if((0,hLe.isEmpty)(i))throw new AS.TpError({context:{key:t.key},type:"nomatchingcontroller"});var s=this.pluginsMap_.inputs.reduce(function(o,a){return o!=null?o:(0,uLe.createInputBindingController)(a,{document:e,target:t,params:r})},null);if(s)return s;throw new AS.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createMonitor=function(e,t,r){var i=this.pluginsMap_.monitors.reduce(function(s,o){return s!=null?s:(0,dLe.createMonitorBindingController)(o,{document:e,params:r,target:t})},null);if(i)return i;throw new AS.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createBlade=function(e,t){var r=this.pluginsMap_.blades.reduce(function(i,s){return i!=null?i:(0,aLe.createBladeController)(s,{document:e,params:t})},null);if(!r)throw new AS.TpError({type:"nomatchingview",context:{params:t}});return r},n.prototype.createBladeApi=function(e){var t=this;if(e instanceof iLe.InputBindingController)return new rLe.InputBindingApi(e);if(e instanceof oLe.MonitorBindingController)return new sLe.MonitorBindingApi(e);if(e instanceof cLe.RackController)return new lLe.RackApi(e,this);var r=this.pluginsMap_.blades.reduce(function(i,s){return i!=null?i:s.api({controller:e,pool:t})},null);if(!r)throw AS.TpError.shouldNeverHappen();return r},n}();G2.PluginPool=pLe;Object.defineProperty(PD,"__esModule",{value:!0});PD.createDefaultPluginPool=void 0;var fLe=i2,mLe=d2,vLe=m2,gLe=y2,_Le=D2,yLe=I2,xLe=N2,bLe=k2,wLe=Kh,SLe=sh,MLe=B2,CLe=V2,ELe=F2,ALe=U2,PLe=H2,TLe=W2,RLe=G2;function OLe(){var n=new RLe.PluginPool;return[SLe.Point2dInputPlugin,MLe.Point3dInputPlugin,CLe.Point4dInputPlugin,ELe.StringInputPlugin,wLe.NumberInputPlugin,bLe.StringColorInputPlugin,xLe.ObjectColorInputPlugin,yLe.NumberColorInputPlugin,_Le.BooleanInputPlugin,ALe.BooleanMonitorPlugin,TLe.StringMonitorPlugin,PLe.NumberMonitorPlugin,fLe.ButtonBladePlugin,mLe.FolderBladePlugin,vLe.SeparatorBladePlugin,gLe.TabBladePlugin].forEach(function(e){n.register(e)}),n}PD.createDefaultPluginPool=OLe;(function(n){var e=At&&At.__createBinding||(Object.create?function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}:function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]}),t=At&&At.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0}),n.createBladeController=void 0,t(ud,n),t(Wie,n),t(Gie,n),t(To,n),t(e2,n),t(t2,n),t(n2,n),t(r2,n),t(i2,n),t(ef,n),t(L0,n),t(s2,n),t(Gm,n),t(ll,n),t(o2,n),t(a2,n),t(u2,n),t(d2,n),t(vb,n),t(Xm,n),t(O0,n),t(QL,n),t(pb,n),t(gb,n),t(qm,n),t(p2,n),t(f2,n),t(m2,n),t(v2,n),t(g2,n),t(_2,n),t(yb,n),t(y2,n);var r=x2;Object.defineProperty(n,"createBladeController",{enumerable:!0,get:function(){return r.createBladeController}}),t(b2,n),t(w2,n),t(Jie,n),t(ch,n),t($ie,n),t(Zm,n),t(Km,n),t(xb,n),t(ese,n),t(D0,n),t(bb,n),t(wb,n),t(tse,n),t(Zh,n),t(rse,n),t(ao,n),t(lse,n),t(E2,n),t(Lm,n),t(Dm,n),t(Es,n),t(fo,n),t(use,n),t($i,n),t(tf,n),t(_l,n),t(Ym,n),t(nf,n),t(P2,n),t(R2,n),t(A2,n),t(T2,n),t(O2,n),t(pr,n),t(S2,n),t(l2,n),t(dh,n),t(M2,n),t(Nl,n),t(C2,n),t(pse,n),t(sD,n),t(pa,n),t(gi,n),t(Hs,n),t(fse,n),t(Jm,n),t(Vl,n),t(Ro,n),t(ui,n),t(L2,n),t(D2,n),t(I0,n),t(ro,n),t(rf,n),t(za,n),t(I2,n),t(N2,n),t(k2,n),t(N0,n),t(k0,n),t(Kh,n),t(z2,n),t(sh,n),t(B2,n),t(V2,n),t(F2,n),t(Qm,n),t(Wn,n),t(U2,n),t(z0,n),t(B0,n),t(j2,n),t(H2,n),t(W2,n),t(Use,n),t(PD,n),t(G2,n)})(Hie);const jse={...zie,shadowDistance:Number},Hse={...Bie,shadowDistance:new Ti(3e3),shadowResolution:new Ti(1024)};class TM extends KC{constructor(){super(Zye),le(this,"defaultShadowResolution",1024),le(this,"shadowDistanceState",new nn(void 0)),this.createEffect(()=>{const e=this.lightState.get();if(e)return Qt.add(e.target),Qt.attach(e),()=>{Qt.remove(e.target),Qt.remove(e)}},[this.lightState.get]),this.createEffect(()=>{var e,t;const r=this.lightState.get();if(!r)return;const i=Ut().userData.manager,s=i?Math.max(Hie.mapRange(i.innerZ*(i.fov/75)*(1/i.zoom),500,1e3,1,1.5),1):1,o=(t=(e=this.shadowDistanceState.get())!=null?e:vU())!=null?t:bne,a=r.shadow.camera;a.zoom=500/s/o,a.updateProjectionMatrix();const c=this.shadowBiasComputedState.get(),u=this.shadowResolutionComputedState.get();if(!c||!u)return;const d=c;return r.shadow.bias=d*s*(this.defaultShadowResolution/u)*.5,()=>{r.shadow.bias=d}},[this.lightState.get,this.shadowDistanceState.get,vU,Ut,this.shadowBiasComputedState.get,this.shadowResolutionComputedState.get]),this.createEffect(()=>{const e=this.lightState.get();if(!e)return;const t=Ut(),r=Ri(()=>{const i=Kr(t),s=Kr(this.outerObject3d);e.position.copy(i).add(s),e.target.position.copy(i).sub(s)});return()=>{r.cancel()}},[Ut,this.lightState.get])}getWorldPosition(){return iu(Kr(this.outerObject3d))}get shadowDistance(){return this.shadowDistanceState.get()}set shadowDistance(e){this.shadowDistanceState.set(e)}}le(TM,"componentName","directionalLight"),le(TM,"defaults",Hse),le(TM,"schema",jse);const LLe=Object.freeze(Object.defineProperty({__proto__:null,default:TM},Symbol.toStringTag,{value:"Module"})),Wse={...JC,groundColor:String},Gse={...QC,groundColor:"#ffffff",castShadow:!1};class RM extends KC{constructor(){super(Hye),this.innerY=0}get groundColor(){const e=this.lightState.get();return e?"#"+e.groundColor.getHexString():"#ffffff"}set groundColor(e){this.cancelHandle("groundColor",()=>this.lightState.get(t=>t&&(t.groundColor=new Xt(e))))}get castShadow(){return!1}set castShadow(e){}}le(RM,"componentName","skyLight"),le(RM,"defaults",Gse),le(RM,"schema",Wse);const DLe=Object.freeze(Object.defineProperty({__proto__:null,default:RM},Symbol.toStringTag,{value:"Module"})),Xse={...JC,decay:Number,distance:Number},qse={...QC,decay:1,distance:0};class W3 extends KC{constructor(){super(qye)}get decay(){const e=this.lightState.get();return e?e.decay:1}set decay(e){this.cancelHandle("decay",()=>this.lightState.get(t=>t&&(t.decay=e)))}get distance(){const e=this.lightState.get();return e?e.distance:0}set distance(e){this.cancelHandle("distance",()=>this.lightState.get(t=>t&&(t.distance=e)))}}le(W3,"componentName","pointLight"),le(W3,"defaults",qse),le(W3,"schema",Xse);const Yse={...JC,angle:Number,penumbra:Number,decay:Number,distance:Number},Zse={...QC,angle:1,penumbra:0,decay:1,distance:0};class G3 extends KC{constructor(){super(Gye,_xe),this.innerY=0}get angle(){const e=this.lightState.get();return e?e.angle:1}set angle(e){this.cancelHandle("angle",()=>this.lightState.get(t=>t&&(t.angle=e)))}get penumbra(){const e=this.lightState.get();return e?e.penumbra:0}set penumbra(e){this.cancelHandle("penumbra",()=>this.lightState.get(t=>t&&(t.penumbra=e)))}get decay(){const e=this.lightState.get();return e?e.decay:1}set decay(e){this.cancelHandle("decay",()=>this.lightState.get(t=>t&&(t.decay=e)))}get distance(){const e=this.lightState.get();return e?e.distance:0}set distance(e){this.cancelHandle("distance",()=>this.lightState.get(t=>t&&(t.distance=e)))}}le(G3,"componentName","spotLight"),le(G3,"defaults",Zse),le(G3,"schema",Yse);const Kse={...jm,onKeyPress:Function,onKeyUp:Function,onKeyDown:Function},Jse={...Hm,onKeyPress:void 0,onKeyUp:void 0,onKeyDown:void 0},[ILe,NLe]=Bo(),[ZY,kLe]=Bo(),[KY,zLe]=Bo(),pc=new Set,JY=n=>(n=n.length===1?n.toLocaleLowerCase():n,n===" "&&(n="Space"),n);_n(()=>{if(Na()||au()&&Ut()===yi)return;const n=Ri(()=>pc.size>0&&KY()),e=r=>{const i=JY(r.key);pc.add(i),ILe(i)},t=r=>{const i=JY(r.key);pc.delete(i),ZY(i),!pc.size&&KY()};return n.watch(jL(()=>{if(!pc.size)return;const r=[...pc];pc.clear();for(const i of r)ZY(i)})),document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{n.cancel(),document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[Na,au,Ut]);class X3 extends Jp{constructor(){super(),le(this,"onKeyPress"),le(this,"onKeyUp"),le(this,"onKeyDown"),this.watch(zLe(()=>{if(this.onKeyPress){if(!pc.size){this.onKeyPress("",pc);return}for(const e of pc)this.onKeyPress(e,pc)}})),this.watch(kLe(e=>{var t;return(t=this.onKeyUp)==null?void 0:t.call(this,e,pc)})),this.watch(NLe(e=>{var t;return(t=this.onKeyDown)==null?void 0:t.call(this,e,pc)}))}}le(X3,"componentName","keyboard"),le(X3,"defaults",Jse),le(X3,"schema",Kse);const q3=new X3;Ji.delete(q3);"getGamepads"in navigator&&Ri(()=>{for(const n of navigator.getGamepads())if(n){for(let e=0;e<n.buttons.length;e++){const t=n.buttons[e],r=Math.round(t.value*100)+"%";t.pressed&&console.log(e,t.value,t.pressed,r)}for(let e=0;e<n.axes.length;e++){const t=Number(n.axes[e].toFixed(2));t!==0&&console.log(e,t)}}});const BLe=()=>{let n;const e={};return new Proxy(e,{get(t,r){var i;return(i=n==null?void 0:n[r])!=null?i:e[r]},set(t,r,i){if(r==="__target"){n=i;for(const[s,o]of Object.entries(e))i[s]=o;return!0}return e[r]=i,n&&(n[r]=i),!0}})},Qse=new Map,VLe=n=>{var e,t;return Qse.get((t=(e=dL(n)[1])===null||e===void 0?void 0:e.toLowerCase())!==null&&t!==void 0?t:"")},X2=(n,e)=>{for(const t of e)Qse.set(t,n);return e};X2("image",["jpg","jpeg","gif","png","svg","tiff","webp","hdr"]);X2("audio",["m4a","mp3","wav","wma","ogg","flax","flac","aac"]);X2("plainText",["ls","js","ts","jsx","tsx","py","txt","md","json","yaml","c","cpp","h","hpp","css","scss","sass","html"]);X2("model",["gltf","glb","fbx"]);X2("scene",["l3d"]);const $se={...jm,variant:Number},eoe={...Hm,variant:1};class yV extends Jp{constructor(){super(),le(this,"variantState",new nn(1)),this.createEffect(()=>{const e=this.variantState.get(),t=db(`
                <img
                  src="${A9}reticle${e}.png"
                  style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); pointer-events: none; user-select: none; width: 20px;"
                ></img>
            `);return Sr.appendChild(t),()=>{Sr.removeChild(t)}},[this.variantState.get])}get variant(){return this.variantState.get()}set variant(e){this.variantState.set(e)}}le(yV,"componentName","reticle"),le(yV,"defaults",eoe),le(yV,"schema",$se);const Y3=(n,e)=>{const t=e.x-n.x,r=e.y-n.y;return Math.sqrt(t*t+r*r)},FLe=(n,e)=>{const t=e.x-n.x,r=e.y-n.y;return jLe(Math.atan2(r,t))},ULe=(n,e,t)=>{const r={x:0,y:0};return t=UU(t),r.x=n.x-e*Math.cos(t),r.y=n.y-e*Math.sin(t),r},UU=n=>n*(Math.PI/180),jLe=n=>n*(180/Math.PI),HLe=n=>isNaN(n.buttons)?n.pressure!==0:n.buttons!==0,xV=new Map,QY=n=>{xV.has(n)&&clearTimeout(xV.get(n)),xV.set(n,setTimeout(n,100))},cO=(n,e,t)=>{const r=e.split(/[ ,]+/g);let i;for(let s=0;s<r.length;s+=1)i=r[s],n.addEventListener?n.addEventListener(i,t,!1):n.attachEvent&&n.attachEvent(i,t)},$Y=(n,e,t)=>{const r=e.split(/[ ,]+/g);let i;for(let s=0;s<r.length;s+=1)i=r[s],n.removeEventListener?n.removeEventListener(i,t):n.detachEvent&&n.detachEvent(i,t)},toe=n=>(n.preventDefault(),n.type.match(/^touch/)?n.changedTouches:n),eZ=()=>{const n=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:n,y:e}},jU=(n,e)=>{e.top||e.right||e.bottom||e.left?(n.style.top=e.top,n.style.right=e.right,n.style.bottom=e.bottom,n.style.left=e.left):(n.style.left=e.x+"px",n.style.top=e.y+"px")},xH=(n,e,t)=>{const r=noe(n);for(let i in r)if(r.hasOwnProperty(i))if(typeof e=="string")r[i]=e+" "+t;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+t+", ";r[i]=s.slice(0,-2)}return r},WLe=(n,e)=>{const t=noe(n);for(let r in t)t.hasOwnProperty(r)&&(t[r]=e);return t},noe=n=>{const e={};return e[n]="",["webkit","Moz","o"].forEach(function(t){e[t+n.charAt(0).toUpperCase()+n.slice(1)]=""}),e},bV=(n,e)=>{for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},GLe=(n,e)=>{const t={};for(let r in n)n.hasOwnProperty(r)&&e.hasOwnProperty(r)?t[r]=e[r]:n.hasOwnProperty(r)&&(t[r]=n[r]);return t},HU=(n,e)=>{if(n.length)for(let t=0,r=n.length;t<r;t+=1)e(n[t]);else e(n)},XLe=(n,e,t)=>({x:Math.min(Math.max(n.x,e.x-t),e.x+t),y:Math.min(Math.max(n.y,e.y-t),e.y+t)});var qLe="ontouchstart"in window,YLe=!!window.PointerEvent,ZLe=!!window.MSPointerEvent,PS={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},wy,cC={};YLe?wy=PS.pointer:ZLe?wy=PS.MSPointer:qLe?(wy=PS.touch,cC=PS.mouse):wy=PS.mouse;function sf(){}sf.prototype.on=function(n,e){var t=this,r=n.split(/[ ,]+/g),i;t._handlers_=t._handlers_||{};for(var s=0;s<r.length;s+=1)i=r[s],t._handlers_[i]=t._handlers_[i]||[],t._handlers_[i].push(e);return t};sf.prototype.off=function(n,e){var t=this;return t._handlers_=t._handlers_||{},n===void 0?t._handlers_={}:e===void 0?t._handlers_[n]=null:t._handlers_[n]&&t._handlers_[n].indexOf(e)>=0&&t._handlers_[n].splice(t._handlers_[n].indexOf(e),1),t};sf.prototype.trigger=function(n,e){var t=this,r=n.split(/[ ,]+/g),i;t._handlers_=t._handlers_||{};for(var s=0;s<r.length;s+=1)i=r[s],t._handlers_[i]&&t._handlers_[i].length&&t._handlers_[i].forEach(function(o){o.call(t,{type:i,target:t},e)})};sf.prototype.config=function(n){var e=this;e.options=e.defaults||{},n&&(e.options=GLe(e.options,n))};sf.prototype.bindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},t._domHandlers_[e]=function(){typeof t["on"+e]=="function"?t["on"+e].apply(t,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},cO(n,wy[e],t._domHandlers_[e]),cC[e]&&cO(n,cC[e],t._domHandlers_[e]),t};sf.prototype.unbindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},$Y(n,wy[e],t._domHandlers_[e]),cC[e]&&$Y(n,cC[e],t._domHandlers_[e]),delete t._domHandlers_[e],this};function mo(n,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=n,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=mo.id,mo.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}mo.prototype=new sf;mo.constructor=mo;mo.id=0;mo.prototype.buildEl=function(n){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};mo.prototype.stylize=function(){if(this.options.dataOnly)return this;var n=this.options.fadeTime+"ms",e=WLe("borderRadius","50%"),t=xH("transition","opacity",n),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},bV(r.el,t),this.options.shape==="circle"&&bV(r.back,e),bV(r.front,e),this.applyStyles(r),this};mo.prototype.applyStyles=function(n){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var t in n[e])this.ui[e].style[t]=n[e][t];return this};mo.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};mo.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};mo.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};mo.prototype.show=function(n){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof n=="function"&&n.call(this)},e.options.fadeTime)),e};mo.prototype.hide=function(n){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var t=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=t,typeof n=="function"&&n.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const t=e.options.restJoystick,r={};r.x=t===!0||t.x!==!1?0:e.instance.frontPosition.x,r.y=t===!0||t.y!==!1?0:e.instance.frontPosition.y,e.setPosition(n,r)}return e};mo.prototype.setPosition=function(n,e){var t=this;t.frontPosition={x:e.x,y:e.y};var r=t.options.fadeTime+"ms",i={};i.front=xH("transition",["top","left"],r);var s={front:{}};s.front={left:t.frontPosition.x+"px",top:t.frontPosition.y+"px"},t.applyStyles(i),t.applyStyles(s),t.restTimeout=setTimeout(function(){typeof n=="function"&&n.call(t),t.restCallback()},t.options.fadeTime)};mo.prototype.restCallback=function(){var n=this,e={};e.front=xH("transition","none",""),n.applyStyles(e),n.trigger("rested",n.instance)};mo.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};mo.prototype.computeDirection=function(n){var e=n.angle.radian,t=Math.PI/4,r=Math.PI/2,i,s,o;if(e>t&&e<t*3&&!n.lockX?i="up":e>-t&&e<=t&&!n.lockY?i="left":e>-t*3&&e<=-t&&!n.lockX?i="down":n.lockY||(i="right"),n.lockY||(e>-r&&e<r?s="left":s="right"),n.lockX||(e>0?o="up":o="down"),n.force>this.options.threshold){var a={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(a[c]=this.direction[c]);var u={};this.direction={x:s,y:o,angle:i},n.direction=this.direction;for(c in a)a[c]===this.direction[c]&&(u[c]=!0);if(u.x&&u.y&&u.angle)return n;(!u.x||!u.y)&&this.trigger("plain",n),u.x||this.trigger("plain:"+s,n),u.y||this.trigger("plain:"+o,n),u.angle||this.trigger("dir dir:"+i,n)}else this.resetDirection();return n};function Ss(n,e){var t=this;t.nipples=[],t.idles=[],t.actives=[],t.ids=[],t.pressureIntervals={},t.manager=n,t.id=Ss.id,Ss.id+=1,t.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},t.config(e),(t.options.mode==="static"||t.options.mode==="semi")&&(t.options.multitouch=!1),t.options.multitouch||(t.options.maxNumberOfNipples=1);const r=getComputedStyle(t.options.zone.parentElement);return r&&r.display==="flex"&&(t.parentIsFlex=!0),t.updateBox(),t.prepareNipples(),t.bindings(),t.begin(),t.nipples}Ss.prototype=new sf;Ss.constructor=Ss;Ss.id=0;Ss.prototype.prepareNipples=function(){var n=this,e=n.nipples;e.on=n.on.bind(n),e.off=n.off.bind(n),e.options=n.options,e.destroy=n.destroy.bind(n),e.ids=n.ids,e.id=n.id,e.processOnMove=n.processOnMove.bind(n),e.processOnEnd=n.processOnEnd.bind(n),e.get=function(t){if(t===void 0)return e[0];for(var r=0,i=e.length;r<i;r+=1)if(e[r].identifier===t)return e[r];return!1}};Ss.prototype.bindings=function(){var n=this;n.bindEvt(n.options.zone,"start"),n.options.zone.style.touchAction="none",n.options.zone.style.msTouchAction="none"};Ss.prototype.begin=function(){var n=this,e=n.options;if(e.mode==="static"){var t=n.createNipple(e.position,n.manager.getIdentifier());t.add(),n.idles.push(t)}};Ss.prototype.createNipple=function(n,e){var t=this,r=t.manager.scroll,i={},s=t.options,o={x:t.parentIsFlex?r.x:r.x+t.box.left,y:t.parentIsFlex?r.y:r.y+t.box.top};if(n.x&&n.y)i={x:n.x-o.x,y:n.y-o.y};else if(n.top||n.right||n.bottom||n.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=n.top,a.style.right=n.right,a.style.bottom=n.bottom,a.style.left=n.left,a.style.position="absolute",s.zone.appendChild(a);var c=a.getBoundingClientRect();s.zone.removeChild(a),i=n,n={x:c.left+r.x,y:c.top+r.y}}var u=new mo(t,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:n,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(jU(u.ui.el,i),jU(u.ui.front,u.frontPosition)),t.nipples.push(u),t.trigger("added "+u.identifier+":added",u),t.manager.trigger("added "+u.identifier+":added",u),t.bindNipple(u),u};Ss.prototype.updateBox=function(){var n=this;n.box=n.options.zone.getBoundingClientRect()};Ss.prototype.bindNipple=function(n){var e=this,t,r=function(i,s){t=i.type+" "+s.id+":"+i.type,e.trigger(t,s)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",r),n.on("dir:up dir:right dir:down dir:left",r),n.on("plain:up plain:right plain:down plain:left",r)};Ss.prototype.pressureFn=function(n,e,t){var r=this,i=0;clearInterval(r.pressureIntervals[t]),r.pressureIntervals[t]=setInterval(function(){var s=n.force||n.pressure||n.webkitForce||0;s!==i&&(e.trigger("pressure",s),r.trigger("pressure "+e.identifier+":pressure",s),i=s)}.bind(r),100)};Ss.prototype.onstart=function(n){var e=this,t=e.options,r=n;n=toe(n),e.updateBox();var i=function(s){e.actives.length<t.maxNumberOfNipples?e.processOnStart(s):r.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(r.touches).findIndex(function(c){return c.identifier===o})<0){var a=[n[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<t.maxNumberOfNipples&&e.processOnStart(s))};return HU(n,i),e.manager.bindDocument(),!1};Ss.prototype.processOnStart=function(n){var e=this,t=e.options,r,i=e.manager.getIdentifier(n),s=n.force||n.pressure||n.webkitForce||0,o={x:n.pageX,y:n.pageY},a=e.getOrCreate(i,o);a.identifier!==i&&e.manager.removeIdentifier(a.identifier),a.identifier=i;var c=function(d){d.trigger("start",d),e.trigger("start "+d.id+":start",d),d.show(),s>0&&e.pressureFn(n,d,d.identifier),e.processOnMove(n)};if((r=e.idles.indexOf(a))>=0&&e.idles.splice(r,1),e.actives.push(a),e.ids.push(a.identifier),t.mode!=="semi")c(a);else{var u=Y3(o,a.position);if(u<=t.catchDistance)c(a);else{a.destroy(),e.processOnStart(n);return}}return a};Ss.prototype.getOrCreate=function(n,e){var t=this,r=t.options,i;return/(semi|static)/.test(r.mode)?(i=t.idles[0],i?(t.idles.splice(0,1),i):r.mode==="semi"?t.createNipple(e,n):(console.warn("Coudln't find the needed nipple."),!1)):(i=t.createNipple(e,n),i)};Ss.prototype.processOnMove=function(n){var e=this,t=e.options,r=e.manager.getIdentifier(n),i=e.nipples.get(r),s=e.manager.scroll;if(!HLe(n)){this.processOnEnd(n);return}if(!i){console.error("Found zombie joystick with ID "+r),e.manager.removeIdentifier(r);return}if(t.dynamicPage){var o=i.el.getBoundingClientRect();i.position={x:s.x+o.left,y:s.y+o.top}}i.identifier=r;var a=i.options.size/2,c={x:n.pageX,y:n.pageY};t.lockX&&(c.y=i.position.y),t.lockY&&(c.x=i.position.x);var u=Y3(c,i.position),d=FLe(c,i.position),p=UU(d),f=u/a,v={distance:u,position:c},x,y;if(i.options.shape==="circle"?(x=Math.min(u,a),y=ULe(i.position,x,d)):(y=XLe(c,i.position,a),x=Y3(y,i.position)),t.follow){if(u>a){let A=c.x-y.x,P=c.y-y.y;i.position.x+=A,i.position.y+=P,i.el.style.top=i.position.y-(e.box.top+s.y)+"px",i.el.style.left=i.position.x-(e.box.left+s.x)+"px",u=Y3(c,i.position)}}else c=y,u=x;var _=c.x-i.position.x,S=c.y-i.position.y;i.frontPosition={x:_,y:S},t.dataOnly||jU(i.ui.front,i.frontPosition);var C={identifier:i.identifier,position:c,force:f,pressure:n.force||n.pressure||n.webkitForce||0,distance:u,angle:{radian:p,degree:d},vector:{x:_/a,y:-S/a},raw:v,instance:i,lockX:t.lockX,lockY:t.lockY};C=i.computeDirection(C),C.angle={radian:UU(180-d),degree:180-d},i.trigger("move",C),e.trigger("move "+i.id+":move",C)};Ss.prototype.processOnEnd=function(n){var e=this,t=e.options,r=e.manager.getIdentifier(n),i=e.nipples.get(r),s=e.manager.removeIdentifier(i.identifier);!i||(t.dataOnly||i.hide(function(){t.mode==="dynamic"&&(i.trigger("removed",i),e.trigger("removed "+i.id+":removed",i),e.manager.trigger("removed "+i.id+":removed",i),i.destroy())}),clearInterval(e.pressureIntervals[i.identifier]),i.resetDirection(),i.trigger("end",i),e.trigger("end "+i.id+":end",i),e.ids.indexOf(i.identifier)>=0&&e.ids.splice(e.ids.indexOf(i.identifier),1),e.actives.indexOf(i)>=0&&e.actives.splice(e.actives.indexOf(i),1),/(semi|static)/.test(t.mode)?e.idles.push(i):e.nipples.indexOf(i)>=0&&e.nipples.splice(e.nipples.indexOf(i),1),e.manager.unbindDocument(),/(semi|static)/.test(t.mode)&&(e.manager.ids[s.id]=s.identifier))};Ss.prototype.onDestroyed=function(n,e){var t=this;t.nipples.indexOf(e)>=0&&t.nipples.splice(t.nipples.indexOf(e),1),t.actives.indexOf(e)>=0&&t.actives.splice(t.actives.indexOf(e),1),t.idles.indexOf(e)>=0&&t.idles.splice(t.idles.indexOf(e),1),t.ids.indexOf(e.identifier)>=0&&t.ids.splice(t.ids.indexOf(e.identifier),1),t.manager.removeIdentifier(e.identifier),t.manager.unbindDocument()};Ss.prototype.destroy=function(){var n=this;n.unbindEvt(n.options.zone,"start"),n.nipples.forEach(function(t){t.destroy()});for(var e in n.pressureIntervals)n.pressureIntervals.hasOwnProperty(e)&&clearInterval(n.pressureIntervals[e]);n.trigger("destroyed",n.nipples),n.manager.unbindDocument(),n.off()};function ko(n){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=eZ(),e.config(n),e.prepareCollections();var t=function(){var i;e.collections.forEach(function(s){s.forEach(function(o){i=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+i.left,y:e.scroll.y+i.top}})})};cO(window,"resize",function(){QY(t)});var r=function(){e.scroll=eZ()};return cO(window,"scroll",function(){QY(r)}),e.collections}ko.prototype=new sf;ko.constructor=ko;ko.prototype.prepareCollections=function(){var n=this;n.collections.create=n.create.bind(n),n.collections.on=n.on.bind(n),n.collections.off=n.off.bind(n),n.collections.destroy=n.destroy.bind(n),n.collections.get=function(e){var t;return n.collections.every(function(r){return t=r.get(e),!t}),t}};ko.prototype.create=function(n){return this.createCollection(n)};ko.prototype.createCollection=function(n){var e=this,t=new Ss(e,n);return e.bindCollection(t),e.collections.push(t),t};ko.prototype.bindCollection=function(n){var e=this,t,r=function(i,s){t=i.type+" "+s.id+":"+i.type,e.trigger(t,s)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",r),n.on("dir:up dir:right dir:down dir:left",r),n.on("plain:up plain:right plain:down plain:left",r)};ko.prototype.bindDocument=function(){var n=this;n.binded||(n.bindEvt(document,"move").bindEvt(document,"end"),n.binded=!0)};ko.prototype.unbindDocument=function(n){var e=this;(!Object.keys(e.ids).length||n===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};ko.prototype.getIdentifier=function(n){var e;return n?(e=n.identifier===void 0?n.pointerId:n.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};ko.prototype.removeIdentifier=function(n){var e={};for(var t in this.ids)if(this.ids[t]===n){e.id=t,e.identifier=this.ids[t],delete this.ids[t];break}return e};ko.prototype.onmove=function(n){var e=this;return e.onAny("move",n),!1};ko.prototype.onend=function(n){var e=this;return e.onAny("end",n),!1};ko.prototype.oncancel=function(n){var e=this;return e.onAny("end",n),!1};ko.prototype.onAny=function(n,e){var t=this,r,i="processOn"+n.charAt(0).toUpperCase()+n.slice(1);e=toe(e);var s=function(a,c,u){u.ids.indexOf(c)>=0&&(u[i](a),a._found_=!0)},o=function(a){r=t.getIdentifier(a),HU(t.collections,s.bind(null,a,r)),a._found_||t.removeIdentifier(r)};return HU(e,o),!1};ko.prototype.destroy=function(){var n=this;n.unbindDocument(!0),n.ids={},n.index=0,n.collections.forEach(function(e){e.destroy()}),n.off()};ko.prototype.onDestroyed=function(n,e){var t=this;if(t.collections.indexOf(e)<0)return!1;t.collections.splice(t.collections.indexOf(e),1)};const tZ=new ko,KLe={create:function(n){return tZ.create(n)},factory:tZ},roe={...jm,onMove:Function,onMoveStart:Function,onMoveEnd:Function,onPress:Function},ioe={...Hm,onMove:void 0,onMoveStart:void 0,onMoveEnd:void 0,onPress:void 0};class wV extends Jp{constructor(){super(),le(this,"onMove"),le(this,"onMoveStart"),le(this,"onMoveEnd"),le(this,"onPressState",new nn(void 0));let e=new $u(0,0);const[t,r]=yt(!1);this.createEffect(()=>{const i=this.onPressState.get();if(!i||!r())return;const s=Ri(()=>{i(e)});return()=>s.cancel()},[this.onPressState.get,r]),this.createEffect(()=>{const i=db(`
                <div style="width: 150px; height: 150px; position: absolute; bottom: 25px; left: 25px;"></div>
            `);Sr.appendChild(i);const s=a=>{a.preventDefault(),a.stopPropagation()};i.onmousedown=s,i.ontouchstart=s,i.onpointerdown=s;const o=new br;return setTimeout(()=>{const a=KLe.create({zone:i,mode:"static",position:{left:"75px",bottom:"75px"},color:"white"});o.then(()=>a.destroy()),a.on("start",()=>{var c;(c=this.onMoveStart)==null||c.call(this,new $u(0,0)),t(!0)}),a.on("move",(c,u)=>{var d;(d=this.onMove)==null||d.call(this,u.vector),e=u.vector}),a.on("end",()=>{var c;(c=this.onMoveEnd)==null||c.call(this,new $u(0,0)),e=new $u(0,0),t(!1)})}),()=>{o.cancel()}},[])}get onPress(){return this.onPressState.get()}set onPress(e){this.onPressState.set(e)}}le(wV,"componentName","joystick"),le(wV,"defaults",ioe),le(wV,"schema",roe);const DD=(n,e,t)=>{const r=n[e];return r instanceof Ti?t?r.value:void 0:t?r!=null?r:"":r},JLe=(n,e)=>{if(n===e)return"";for(var t=1;t<n.length&&n.charCodeAt(t)===47;++t);for(var r=n.length,i=r-t,s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var o=e.length,a=o-s,c=i<a?i:a,u=-1,d=0;d<=c;++d){if(d===c){if(a>c){if(e.charCodeAt(s+d)===47)return e.slice(s+d+1);if(d===0)return e.slice(s+d)}else i>c&&(n.charCodeAt(t+d)===47?u=d:d===0&&(u=0));break}var p=n.charCodeAt(t+d),f=e.charCodeAt(s+d);if(p!==f)break;p===47&&(u=d)}var v="";for(d=t+u+1;d<=r;++d)(d===r||n.charCodeAt(d)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+e.slice(s+u):(s+=u,e.charCodeAt(s)===47&&++s,e.slice(s))},QLe=(n,e)=>{const t=JLe(Xre(n),e);return qre(t)?t:"./"+t},py=(n,e)=>Number(e.toFixed(2)),soe=["type","children","scale","rotation","velocity","target","proxy","gridHelper","gridHelperSize"],$Le=["autoMount"],WU=async n=>{const e=[];for(const t of n){if(TL.has(t))continue;const{componentName:r,schema:i,defaults:s}=t.constructor,o={type:r};for(const[a,c]of Object.entries(i)){if(c===Function||Array.isArray(c)&&c.includes(Function)||soe.includes(a))continue;let u;if(a==="animations"){if(u=t.serializeAnimations,!u)continue}else if(a==="animation"){if(u=t.serializeAnimation,u===void 0)continue}else u=t[a];const d=typeof u;if(u===DD(s,a)||d==="function")continue;const p=YR();if(d==="string"&&u.startsWith("blob:http")&&p){const f=rH.get(u);u=QLe(p.webkitRelativePath,f.webkitRelativePath)}else d==="number"&&(u=py(a,u));o[a]=u}t.children&&(o.children=await WU(t.children)),e.push(o)}return e},q2=async(n=Ji)=>{if(n instanceof _9)return WU([n]);const e=[];for(const i of n)!(i instanceof xm)&&e.push(i);const t=new xm(!0);Object.assign(t,ra),e.push(t);const r=await WU(e);return r.unshift({type:"lingo3d",version:Cne}),t.dispose(),r},eDe=Xpe({group:()=>new AM,model:()=>new ih,svgMesh:()=>new EM,htmlMesh:()=>new O3,dummy:()=>new Vy,building:()=>new T3,tree:()=>new R3,reflector:()=>new L3,water:()=>new D3,sprite:()=>new ym,trigger:()=>new I3,spawnPoint:()=>new N3,audio:()=>new k3,camera:()=>new z3,thirdPersonCamera:()=>new PM,firstPersonCamera:()=>new kie,orbitCamera:()=>new wM,ambientLight:()=>new B3,areaLight:()=>new V3,directionalLight:()=>new TM,skyLight:()=>new RM,pointLight:()=>new W3,spotLight:()=>new G3,circle:()=>new M3,cone:()=>new Vre,cube:()=>new tre,cylinder:()=>new WL,octahedron:()=>new Fre,plane:()=>new S3,sphere:()=>new qC,tetrahedron:()=>new Ure,torus:()=>new jre,skybox:()=>new MM,environment:()=>new SM,setup:()=>new xm}),ooe=n=>eDe[n](),aoe=(n,e)=>{var t;if(n.type==="animation"||n.type==="lingo3d")return;const r=ooe(n.type);return e&&r instanceof GC&&e.push(r.loaded),Object.assign(r,la.exports.omit(n,soe)),(t=n.children)==null||t.map(i=>aoe(i,e)).forEach(i=>i&&r.append(i)),r},bH=(n,e)=>n.map(t=>aoe(t,e)),loe=(n,e)=>{const t=document.createElement("a"),r=t.href=URL.createObjectURL(e);t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r)},wH=(n,e)=>{const t=new Blob([e],{type:"text/plain"});loe(n,t)},tDe=async()=>{const{default:n}=await rr(()=>import("./standalone.4635a5df.6dd8bb8a.js"),[]).then(r=>r.s),{default:e}=await rr(()=>import("./parser-babel.5d6e25d7.0cc21adb.js"),[]).then(r=>r.p),t=n.format(JSON.stringify(await q2()),{parser:"json",plugins:[e]});wH("scene.json",t)},coe=n=>{let e="";for(const t of n){const r=la.exports.upperFirst(t.type);let i="";for(const[s,o]of Object.entries(t))s==="children"||s==="type"||!o||(typeof o=="string"?i+=` ${s}="${o}"`:o===!0?i+=` ${s}`:typeof o=="object"?i+=` ${s}={${JSON.stringify(o)}}`:i+=` ${s}={${o}}`);e+="children"in t&&t.children?`<${r}${i}>${coe(t.children)}</${r}>`:`<${r}${i} />`}return e},nDe=async()=>{const n=(await rr(()=>import("./standalone.4635a5df.6dd8bb8a.js"),[]).then(r=>r.s)).default,e=(await rr(()=>import("./parser-babel.5d6e25d7.0cc21adb.js"),[]).then(r=>r.p)).default,t=n.format(`const App = () => {
            return (
                <World>
                    ${coe(await q2())}
                </World>
            )
        }`,{parser:"babel",plugins:[e]});wH("App.jsx",t)},uoe=n=>{let e="";for(const t of n){const r=la.exports.upperFirst(t.type);let i="";for(let[s,o]of Object.entries(t))s==="children"||s==="type"||!o||(s=la.exports.kebabCase(s),typeof o=="string"?i+=` ${s}='${o}'`:o===!0?i+=` ${s}`:typeof o=="object"?i+=` :${s}='${JSON.stringify(o)}'`:i+=` :${s}='${o}'`);e+="children"in t&&t.children?`<${r}${i}>
${uoe(t.children)}</${r}>
`:`<${r}${i} />
`}return e},rDe=async()=>{const n=(await rr(()=>import("./standalone.4635a5df.6dd8bb8a.js"),[]).then(r=>r.s)).default,e=(await rr(()=>import("./parser-html.db73c612.a5c1dc34.js"),[]).then(r=>r.p)).default,t=n.format(`<template>
            <World>
                ${uoe(await q2())}
            </World>
        </template>`,{parser:"vue",plugins:[e]});wH("App.vue",t)},ID=(()=>{if(typeof self>"u")return!1;if(!("top"in self&&self!==top)){if("showOpenFilePicker"in self)return"showOpenFilePicker"}return!1})(),iDe=ID?Promise.resolve().then(function(){return uDe}):Promise.resolve().then(function(){return pDe});async function sDe(...n){return(await iDe).default(...n)}const oDe=ID?Promise.resolve().then(function(){return hDe}):Promise.resolve().then(function(){return fDe});async function hoe(...n){return(await oDe).default(...n)}const aDe=ID?Promise.resolve().then(function(){return dDe}):Promise.resolve().then(function(){return mDe});async function lDe(...n){return(await aDe).default(...n)}const cDe=async n=>{const e=await n.getFile();return e.handle=n,e};var doe=async(n=[{}])=>{Array.isArray(n)||(n=[n]);const e=[];n.forEach((i,s)=>{e[s]={description:i.description||"Files",accept:{}},i.mimeTypes?i.mimeTypes.map(o=>{e[s].accept[o]=i.extensions||[]}):e[s].accept["*/*"]=i.extensions||[]});const t=await window.showOpenFilePicker({id:n[0].id,startIn:n[0].startIn,types:e,multiple:n[0].multiple||!1,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1}),r=await Promise.all(t.map(cDe));return n[0].multiple?r:r[0]},uDe={__proto__:null,default:doe};function Z3(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var r=t.done;return Promise.resolve(t.value).then(function(i){return{value:i,done:r}})}return Z3=function(t){this.s=t,this.n=t.next},Z3.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return r===void 0?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return r===void 0?Promise.reject(t):e(r.apply(this.s,arguments))}},new Z3(n)}const poe=async(n,e,t=n.name,r)=>{const i=[],s=[];var o,a=!1,c=!1;try{for(var u,d=function(p){var f,v,x,y=2;for(typeof Symbol<"u"&&(v=Symbol.asyncIterator,x=Symbol.iterator);y--;){if(v&&(f=p[v])!=null)return f.call(p);if(x&&(f=p[x])!=null)return new Z3(f.call(p));v="@@asyncIterator",x="@@iterator"}throw new TypeError("Object is not async iterable")}(n.values());a=!(u=await d.next()).done;a=!1){const p=u.value,f=`${t}/${p.name}`;p.kind==="file"?s.push(p.getFile().then(v=>(v.directoryHandle=n,v.handle=p,Object.defineProperty(v,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>f})))):p.kind!=="directory"||!e||r&&r(p)||i.push(poe(p,e,f,r))}}catch(p){c=!0,o=p}finally{try{a&&d.return!=null&&await d.return()}finally{if(c)throw o}}return[...(await Promise.all(i)).flat(),...await Promise.all(s)]};var foe=async(n={})=>{n.recursive=n.recursive||!1,n.mode=n.mode||"read";const e=await window.showDirectoryPicker({id:n.id,startIn:n.startIn,mode:n.mode});return poe(e,n.recursive,void 0,n.skipDirectory)},hDe={__proto__:null,default:foe},moe=async(n,e=[{}],t=null,r=!1,i=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const s=[];let o=null;if(n instanceof Blob&&n.type?o=n.type:n.headers&&n.headers.get("content-type")&&(o=n.headers.get("content-type")),e.forEach((u,d)=>{s[d]={description:u.description||"Files",accept:{}},u.mimeTypes?(d===0&&o&&u.mimeTypes.push(o),u.mimeTypes.map(p=>{s[d].accept[p]=u.extensions||[]})):o?s[d].accept[o]=u.extensions||[]:s[d].accept["*/*"]=u.extensions||[]}),t)try{await t.getFile()}catch(u){if(t=null,r)throw u}const a=t||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:s,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!t&&i&&i(a);const c=await a.createWritable();return"stream"in n?(await n.stream().pipeTo(c),a):"body"in n?(await n.body.pipeTo(c),a):(await c.write(await n),await c.close(),a)},dDe={__proto__:null,default:moe},voe=async(n=[{}])=>(Array.isArray(n)||(n=[n]),new Promise((e,t)=>{const r=document.createElement("input");r.type="file";const i=[...n.map(c=>c.mimeTypes||[]),...n.map(c=>c.extensions||[])].join();r.multiple=n[0].multiple||!1,r.accept=i||"",r.style.display="none",document.body.append(r);const s=c=>{typeof o=="function"&&o(),e(c)},o=n[0].legacySetup&&n[0].legacySetup(s,()=>o(t),r),a=()=>{window.removeEventListener("focus",a),r.remove()};r.addEventListener("click",()=>{window.addEventListener("focus",a)}),r.addEventListener("change",()=>{window.removeEventListener("focus",a),r.remove(),s(r.multiple?Array.from(r.files):r.files[0])}),r.click()})),pDe={__proto__:null,default:voe},goe=async(n=[{}])=>(Array.isArray(n)||(n=[n]),n[0].recursive=n[0].recursive||!1,new Promise((e,t)=>{const r=document.createElement("input");r.type="file",r.webkitdirectory=!0;const i=o=>{typeof s=="function"&&s(),e(o)},s=n[0].legacySetup&&n[0].legacySetup(i,()=>s(t),r);r.addEventListener("change",()=>{let o=Array.from(r.files);n[0].recursive?n[0].recursive&&n[0].skipDirectory&&(o=o.filter(a=>a.webkitRelativePath.split("/").every(c=>!n[0].skipDirectory({name:c,kind:"directory"})))):o=o.filter(a=>a.webkitRelativePath.split("/").length===2),i(o)}),r.click()})),fDe={__proto__:null,default:goe},_oe=async(n,e={})=>{Array.isArray(e)&&(e=e[0]);const t=document.createElement("a");let r=n;"body"in n&&(r=await async function(o,a){const c=o.getReader(),u=new ReadableStream({start:f=>async function v(){return c.read().then(({done:x,value:y})=>{if(!x)return f.enqueue(y),v();f.close()})}()}),d=new Response(u),p=await d.blob();return c.releaseLock(),new Blob([p],{type:a})}(n.body,n.headers.get("content-type"))),t.download=e.fileName||"Untitled",t.href=URL.createObjectURL(await r);const i=()=>{typeof s=="function"&&s()},s=e.legacySetup&&e.legacySetup(i,()=>s(),t);return t.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(t.href),3e4),i()}),t.click(),null},mDe={__proto__:null,default:_oe};const yoe=Object.freeze(Object.defineProperty({__proto__:null,directoryOpen:hoe,directoryOpenLegacy:goe,directoryOpenModern:foe,fileOpen:sDe,fileOpenLegacy:voe,fileOpenModern:doe,fileSave:lDe,fileSaveLegacy:_oe,fileSaveModern:moe,supported:ID},Symbol.toStringTag,{value:"Module"})),[SH,vDe]=yt(!1),xoe=async()=>{const n=await hoe({recursive:!0,startIn:"downloads",id:"lingo3d",skipDirectory:e=>e.name[0]==="."||e.name==="node_modules"});Yre(n),SH(!0);for(const e of n)if(e.name.toLowerCase().endsWith(".json"))try{const t=await e.text();if(t.includes('"type": "lingo3d"')){for(const r of Ji)r.dispose();tH(e),queueMicrotask(()=>bH(JSON.parse(t)));return}}catch{}},gDe=async()=>{const{fileOpen:n}=await Promise.resolve().then(()=>yoe),e=await n({extensions:[".json"],id:"lingo3d"}),t=await e.text();for(const r of Ji)r.dispose();try{bH(JSON.parse(t)),tH(e)}catch{}},boe=async()=>{const{default:n}=await rr(()=>import("./standalone.4635a5df.6dd8bb8a.js"),[]).then(a=>a.s),{default:e}=await rr(()=>import("./parser-babel.5d6e25d7.0cc21adb.js"),[]).then(a=>a.p),{fileSave:t}=await Promise.resolve().then(()=>yoe),r=async a=>{if(!a)return;const c=n.format(JSON.stringify(await q2()),{parser:"json",plugins:[e]});await t(new Blob([c],{type:"text/plain"}),void 0,a)},i=YR();if(i)return r(i.handle);const s=await t(new Blob([""],{type:"text/plain"}),{extensions:[".json"],startIn:"downloads",id:"lingo3d"}),o=await(s==null?void 0:s.getFile());return o.handle=s,tH(o),r(s)},_De=(n,e,t=500)=>{const[r,i]=O9(n,e),s=Ut();Pi.set(r,i,.5),Pi.unproject(s);const o=Kr(s);Pi.sub(o).normalize();const a=o.add(Pi.multiplyScalar(t*nr));return iu(a)},[JQe,QQe]=yt("https://unpkg.com/lingo3d-wasm@1.0.1/assets/"),yDe=new WeakMap,nZ=new WeakSet,ND=n=>nZ.has(n)?n:hh(yDe,n,()=>{const e=Object.fromEntries(Object.keys(n).map(t=>[t,DD(n,t)]));return nZ.add(e),e}),Fr=(n,e)=>(e=ND(e),Object.fromEntries(Object.entries(n).map(([t,r])=>[t,{type:r===Number?[Number,Object]:r,default:e[t]}]))),woe=Fr(XC,Yu),Soe=document.createElement("div");Object.assign(Soe.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",pointerEvents:"none",userSelect:"none"});const MH=(n,e,t)=>{let r=e;const i=qx([]);return Wp(()=>{if(t!=null&&t.value)return;const s=i.value=[];for(const[o,a]of Object.entries(n)){const c=r[o];c!==a&&(a&&typeof a=="object"?JSON.stringify(a)!==JSON.stringify(c)&&s.push([o,a]):s.push([o,a]))}r={...n}}),i},Moe=new WeakMap,xDe=()=>new Map,rZ=(n,e,t)=>{var r;const i=hh(Moe,n,xDe);for(const[s,o]of Vn(e.value)){if((r=i.get(s))==null||r.cancel(),o instanceof nn){i.set(s,o.get(c=>n[s]=c));continue}const a=t[s];if(a===Ep){if(!o)continue;Array.isArray(o)?n[s](...o):n[s](o);continue}n[s]=o!=null?o:a}},CH=(n,e,t,r)=>{Wp(()=>{if(e!=null||(e=Vn(n==null?void 0:n.value)),!!e)if(Array.isArray(e))for(const i of e)rZ(i,t,r);else rZ(e,t,r)})},kD=(n,e)=>{const t=new e,r=qx(t);aL("parent",r);const i=r0("parent",void 0);Wp(()=>{var a;(a=Vn(i==null?void 0:i.value))==null||a.append(t)});const s=ND(e.defaults),o=MH(n,s);return CH(void 0,t,o,s),Nj(()=>{const a=Moe.get(t);if(a)for(const c of a.values())c.cancel();t.dispose()}),t},Coe=Um({__name:"Setup",props:woe,setup(n,{expose:e}){const t=kD(n,xm);return e(t),(r,i)=>null}}),bDe={style:{height:"100%"}},wDe=Um({__name:"World",props:{...woe,position:String},setup(n){const e=n,t=qx();Wp(i=>{const s=Vn(t.value);!s||(s.appendChild(Soe),ra.autoMount=s,i(()=>{ra.autoMount=!1}))});const r=document.createElement("style");return r.innerHTML=`.lingo3d {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0px;
    left: 0px;
    display: flex;
}`,document.head.appendChild(r),(i,s)=>(mM(),Xee(Al,null,[vM("div",{class:"lingo3d",style:DC({position:e.position})},[vM("div",bDe,[IC(i.$slots,"default")]),vM("div",{ref_key:"divRef",ref:t,style:{height:"100%","flex-grow":"1",position:"relative",overflow:"hidden"}},null,512)],4),sa(Coe,mhe(Zee(i.$props)),null,16)],64))}});var Eoe={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(At,function(){var t=function(){function r(v){return o.appendChild(v.dom),v}function i(v){for(var x=0;x<o.children.length;x++)o.children[x].style.display=x===v?"block":"none";s=v}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(v){v.preventDefault(),i(++s%o.children.length)},!1);var a=(performance||Date).now(),c=a,u=0,d=r(new t.Panel("FPS","#0ff","#002")),p=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=r(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:o,addPanel:r,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){u++;var v=(performance||Date).now();if(p.update(v-a,200),v>c+1e3&&(d.update(1e3*u/(v-c),100),c=v,u=0,f)){var x=performance.memory;f.update(x.usedJSHeapSize/1048576,x.jsHeapSizeLimit/1048576)}return v},update:function(){a=this.end()},domElement:o,setMode:i}};return t.Panel=function(r,i,s){var o=1/0,a=0,c=Math.round,u=c(window.devicePixelRatio||1),d=80*u,p=48*u,f=3*u,v=2*u,x=3*u,y=15*u,_=74*u,S=30*u,C=document.createElement("canvas");C.width=d,C.height=p,C.style.cssText="width:80px;height:48px";var A=C.getContext("2d");return A.font="bold "+9*u+"px Helvetica,Arial,sans-serif",A.textBaseline="top",A.fillStyle=s,A.fillRect(0,0,d,p),A.fillStyle=i,A.fillText(r,f,v),A.fillRect(x,y,_,S),A.fillStyle=s,A.globalAlpha=.9,A.fillRect(x,y,_,S),{dom:C,update:function(P,D){o=Math.min(o,P),a=Math.max(a,P),A.fillStyle=s,A.globalAlpha=1,A.fillRect(0,0,d,y),A.fillStyle=i,A.fillText(c(P)+" "+r+" ("+c(o)+"-"+c(a)+")",f,v),A.drawImage(C,x+u,y,_-u,S,x,y,_-u,S),A.fillRect(x+_-u,y,u,S),A.fillStyle=s,A.globalAlpha=.9,A.fillRect(x+_-u,y,u,c((1-P/D)*S))}}},t})})(Eoe);Eoe.exports;var Y2,un,Aoe,OM,iZ,Poe,uO={},Toe=[],SDe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Dp(n,e){for(var t in e)n[t]=e[t];return n}function Roe(n){var e=n.parentNode;e&&e.removeChild(n)}function Fh(n,e,t){var r,i,s,o={};for(s in e)s=="key"?r=e[s]:s=="ref"?i=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?Y2.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(s in n.defaultProps)o[s]===void 0&&(o[s]=n.defaultProps[s]);return LM(n,o,r,i,null)}function LM(n,e,t,r,i){var s={type:n,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i==null?++Aoe:i};return i==null&&un.vnode!=null&&un.vnode(s),s}function Pc(n){return n.children}function Vp(n,e){this.props=n,this.context=e}function Mx(n,e){if(e==null)return n.__?Mx(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?Mx(n):null}function Ooe(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return Ooe(n)}}function GU(n){(!n.__d&&(n.__d=!0)&&OM.push(n)&&!hO.__r++||iZ!==un.debounceRendering)&&((iZ=un.debounceRendering)||setTimeout)(hO)}function hO(){for(var n;hO.__r=OM.length;)n=OM.sort(function(e,t){return e.__v.__b-t.__v.__b}),OM=[],n.some(function(e){var t,r,i,s,o,a;e.__d&&(o=(s=(t=e).__v).__e,(a=t.__P)&&(r=[],(i=Dp({},s)).__v=s.__v+1,EH(a,s,i,t.__n,a.ownerSVGElement!==void 0,s.__h!=null?[o]:null,r,o==null?Mx(s):o,s.__h),Noe(r,s),s.__e!=o&&Ooe(s)))})}function Loe(n,e,t,r,i,s,o,a,c,u){var d,p,f,v,x,y,_,S=r&&r.__k||Toe,C=S.length;for(t.__k=[],d=0;d<e.length;d++)if((v=t.__k[d]=(v=e[d])==null||typeof v=="boolean"?null:typeof v=="string"||typeof v=="number"||typeof v=="bigint"?LM(null,v,null,null,v):Array.isArray(v)?LM(Pc,{children:v},null,null,null):v.__b>0?LM(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)!=null){if(v.__=t,v.__b=t.__b+1,(f=S[d])===null||f&&v.key==f.key&&v.type===f.type)S[d]=void 0;else for(p=0;p<C;p++){if((f=S[p])&&v.key==f.key&&v.type===f.type){S[p]=void 0;break}f=null}EH(n,v,f=f||uO,i,s,o,a,c,u),x=v.__e,(p=v.ref)&&f.ref!=p&&(_||(_=[]),f.ref&&_.push(f.ref,null,v),_.push(p,v.__c||x,v)),x!=null?(y==null&&(y=x),typeof v.type=="function"&&v.__k===f.__k?v.__d=c=Doe(v,c,n):c=Ioe(n,v,f,S,x,c),typeof t.type=="function"&&(t.__d=c)):c&&f.__e==c&&c.parentNode!=n&&(c=Mx(f))}for(t.__e=y,d=C;d--;)S[d]!=null&&(typeof t.type=="function"&&S[d].__e!=null&&S[d].__e==t.__d&&(t.__d=Mx(r,d+1)),zoe(S[d],S[d]));if(_)for(d=0;d<_.length;d++)koe(_[d],_[++d],_[++d])}function Doe(n,e,t){for(var r,i=n.__k,s=0;i&&s<i.length;s++)(r=i[s])&&(r.__=n,e=typeof r.type=="function"?Doe(r,e,t):Ioe(t,r,r,i,r.__e,e));return e}function dO(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){dO(t,e)}):e.push(n)),e}function Ioe(n,e,t,r,i,s){var o,a,c;if(e.__d!==void 0)o=e.__d,e.__d=void 0;else if(t==null||i!=s||i.parentNode==null)e:if(s==null||s.parentNode!==n)n.appendChild(i),o=null;else{for(a=s,c=0;(a=a.nextSibling)&&c<r.length;c+=2)if(a==i)break e;n.insertBefore(i,s),o=s}return o!==void 0?o:i.nextSibling}function MDe(n,e,t,r,i){var s;for(s in t)s==="children"||s==="key"||s in e||pO(n,s,null,t[s],r);for(s in e)i&&typeof e[s]!="function"||s==="children"||s==="key"||s==="value"||s==="checked"||t[s]===e[s]||pO(n,s,e[s],t[s],r)}function sZ(n,e,t){e[0]==="-"?n.setProperty(e,t):n[e]=t==null?"":typeof t!="number"||SDe.test(e)?t:t+"px"}function pO(n,e,t,r,i){var s;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(e in r)t&&e in t||sZ(n.style,e,"");if(t)for(e in t)r&&t[e]===r[e]||sZ(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")s=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+s]=t,t?r||n.addEventListener(e,s?aZ:oZ,s):n.removeEventListener(e,s?aZ:oZ,s);else if(e!=="dangerouslySetInnerHTML"){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t!=null&&(t!==!1||e[0]==="a"&&e[1]==="r")?n.setAttribute(e,t):n.removeAttribute(e))}}function oZ(n){this.l[n.type+!1](un.event?un.event(n):n)}function aZ(n){this.l[n.type+!0](un.event?un.event(n):n)}function EH(n,e,t,r,i,s,o,a,c){var u,d,p,f,v,x,y,_,S,C,A,P,D,N=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(c=t.__h,a=e.__e=t.__e,e.__h=null,s=[a]),(u=un.__b)&&u(e);try{e:if(typeof N=="function"){if(_=e.props,S=(u=N.contextType)&&r[u.__c],C=u?S?S.props.value:u.__:r,t.__c?y=(d=e.__c=t.__c).__=d.__E:("prototype"in N&&N.prototype.render?e.__c=d=new N(_,C):(e.__c=d=new Vp(_,C),d.constructor=N,d.render=EDe),S&&S.sub(d),d.props=_,d.state||(d.state={}),d.context=C,d.__n=r,p=d.__d=!0,d.__h=[]),d.__s==null&&(d.__s=d.state),N.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Dp({},d.__s)),Dp(d.__s,N.getDerivedStateFromProps(_,d.__s))),f=d.props,v=d.state,p)N.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(N.getDerivedStateFromProps==null&&_!==f&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(_,C),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(_,d.__s,C)===!1||e.__v===t.__v){d.props=_,d.state=d.__s,e.__v!==t.__v&&(d.__d=!1),d.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(j){j&&(j.__=e)}),d.__h.length&&o.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(_,d.__s,C),d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(f,v,x)})}if(d.context=C,d.props=_,d.__v=e,d.__P=n,A=un.__r,P=0,"prototype"in N&&N.prototype.render)d.state=d.__s,d.__d=!1,A&&A(e),u=d.render(d.props,d.state,d.context);else do d.__d=!1,A&&A(e),u=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++P<25);d.state=d.__s,d.getChildContext!=null&&(r=Dp(Dp({},r),d.getChildContext())),p||d.getSnapshotBeforeUpdate==null||(x=d.getSnapshotBeforeUpdate(f,v)),D=u!=null&&u.type===Pc&&u.key==null?u.props.children:u,Loe(n,Array.isArray(D)?D:[D],e,t,r,i,s,o,a,c),d.base=e.__e,e.__h=null,d.__h.length&&o.push(d),y&&(d.__E=d.__=null),d.__e=!1}else s==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=CDe(t.__e,e,t,r,i,s,o,c);(u=un.diffed)&&u(e)}catch(j){e.__v=null,(c||s!=null)&&(e.__e=a,e.__h=!!c,s[s.indexOf(a)]=null),un.__e(j,e,t)}}function Noe(n,e){un.__c&&un.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(r){r.call(t)})}catch(r){un.__e(r,t.__v)}})}function CDe(n,e,t,r,i,s,o,a){var c,u,d,p=t.props,f=e.props,v=e.type,x=0;if(v==="svg"&&(i=!0),s!=null){for(;x<s.length;x++)if((c=s[x])&&"setAttribute"in c==!!v&&(v?c.localName===v:c.nodeType===3)){n=c,s[x]=null;break}}if(n==null){if(v===null)return document.createTextNode(f);n=i?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,f.is&&f),s=null,a=!1}if(v===null)p===f||a&&n.data===f||(n.data=f);else{if(s=s&&Y2.call(n.childNodes),u=(p=t.props||uO).dangerouslySetInnerHTML,d=f.dangerouslySetInnerHTML,!a){if(s!=null)for(p={},x=0;x<n.attributes.length;x++)p[n.attributes[x].name]=n.attributes[x].value;(d||u)&&(d&&(u&&d.__html==u.__html||d.__html===n.innerHTML)||(n.innerHTML=d&&d.__html||""))}if(MDe(n,f,p,i,a),d)e.__k=[];else if(x=e.props.children,Loe(n,Array.isArray(x)?x:[x],e,t,r,i&&v!=="foreignObject",s,o,s?s[0]:t.__k&&Mx(t,0),a),s!=null)for(x=s.length;x--;)s[x]!=null&&Roe(s[x]);a||("value"in f&&(x=f.value)!==void 0&&(x!==n.value||v==="progress"&&!x||v==="option"&&x!==p.value)&&pO(n,"value",x,p.value,!1),"checked"in f&&(x=f.checked)!==void 0&&x!==n.checked&&pO(n,"checked",x,p.checked,!1))}return n}function koe(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(r){un.__e(r,t)}}function zoe(n,e,t){var r,i;if(un.unmount&&un.unmount(n),(r=n.ref)&&(r.current&&r.current!==n.__e||koe(r,null,e)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){un.__e(s,e)}r.base=r.__P=null,n.__c=void 0}if(r=n.__k)for(i=0;i<r.length;i++)r[i]&&zoe(r[i],e,typeof n.type!="function");t||n.__e==null||Roe(n.__e),n.__=n.__e=n.__d=void 0}function EDe(n,e,t){return this.constructor(n,t)}function Cx(n,e,t){var r,i,s;un.__&&un.__(n,e),i=(r=typeof t=="function")?null:t&&t.__k||e.__k,s=[],EH(e,n=(!r&&t||e).__k=Fh(Pc,null,[n]),i||uO,uO,e.ownerSVGElement!==void 0,!r&&t?[t]:i?null:e.firstChild?Y2.call(e.childNodes):null,s,!r&&t?t:i?i.__e:e.firstChild,r),Noe(s,n)}function Boe(n,e){Cx(n,e,Boe)}function Voe(n,e,t){var r,i,s,o=Dp({},n.props);for(s in e)s=="key"?r=e[s]:s=="ref"?i=e[s]:o[s]=e[s];return arguments.length>2&&(o.children=arguments.length>3?Y2.call(arguments,2):t),LM(n.type,o,r||n.key,i||n.ref,null)}function ADe(n,e){var t={__c:e="__cC"+Poe++,__:n,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,s;return this.getChildContext||(i=[],(s={})[e]=this,this.getChildContext=function(){return s},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(GU)},this.sub=function(o){i.push(o);var a=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),a&&a.call(o)}}),r.children}};return t.Provider.__=t.Consumer.contextType=t}Y2=Toe.slice,un={__e:function(n,e,t,r){for(var i,s,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((s=i.constructor)&&s.getDerivedStateFromError!=null&&(i.setState(s.getDerivedStateFromError(n)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,r||{}),o=i.__d),o)return i.__E=i}catch(a){n=a}throw n}},Aoe=0,Vp.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Dp({},this.state),typeof n=="function"&&(n=n(Dp({},t),this.props)),n&&Dp(t,n),n!=null&&this.__v&&(e&&this.__h.push(e),GU(this))},Vp.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),GU(this))},Vp.prototype.render=Pc,OM=[],hO.__r=0,Poe=0;var PDe=0;function Ve(n,e,t,r,i){var s,o,a={};for(o in e)o=="ref"?s=e[o]:a[o]=e[o];var c={type:n,props:a,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--PDe,__source:i,__self:r};if(typeof n=="function"&&(s=n.defaultProps))for(o in s)a[o]===void 0&&(a[o]=s[o]);return un.vnode&&un.vnode(c),c}function AH(){return(AH=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function TDe(n){this.getChildContext=function(){return n.context};var e=n.children,t=function(r,i){if(r==null)return{};var s,o,a={},c=Object.keys(r);for(o=0;o<c.length;o++)i.indexOf(s=c[o])>=0||(a[s]=r[s]);return a}(n,["context","children"]);return Voe(e,t)}function RDe(){var n=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(n),this._vdom=Fh(TDe,AH({},this._props,{context:n.detail.context}),function e(t,r){if(t.nodeType===3)return t.data;if(t.nodeType!==1)return null;var i=[],s={},o=0,a=t.attributes,c=t.childNodes;for(o=a.length;o--;)a[o].name!=="slot"&&(s[a[o].name]=a[o].value,s[Foe(a[o].name)]=a[o].value);for(o=c.length;o--;){var u=e(c[o],null),d=c[o].slot;d?s[d]=Fh(lZ,{name:d},u):i[o]=u}var p=r?Fh(lZ,null,i):i;return Fh(r||t.nodeName.toLowerCase(),s,p)}(this,this._vdomComponent)),(this.hasAttribute("hydrate")?Boe:Cx)(this._vdom,this._root)}function Foe(n){return n.replace(/-(\w)/g,function(e,t){return t?t.toUpperCase():""})}function ODe(n,e,t){if(this._vdom){var r={};r[n]=t=t==null?void 0:t,r[Foe(n)]=t,this._vdom=Voe(this._vdom,r),Cx(this._vdom,this._root)}}function LDe(){Cx(this._vdom=null,this._root)}function lZ(n,e){var t=this;return Fh("slot",AH({},n,{ref:function(r){r?(t.ref=r,t._listener||(t._listener=function(i){i.stopPropagation(),i.detail.context=e},r.addEventListener("_preact",t._listener))):t.ref.removeEventListener("_preact",t._listener)}}))}function $m(n,e,t,r){function i(){var s=Reflect.construct(HTMLElement,[],i);return s._vdomComponent=n,s._root=r&&r.shadow?s.attachShadow({mode:"open"}):s,s}return(i.prototype=Object.create(HTMLElement.prototype)).constructor=i,i.prototype.connectedCallback=RDe,i.prototype.attributeChangedCallback=ODe,i.prototype.disconnectedCallback=LDe,t=t||n.observedAttributes||Object.keys(n.propTypes||{}),i.observedAttributes=t,t.forEach(function(s){Object.defineProperty(i.prototype,s,{get:function(){return this._vdom.props[s]},set:function(o){this._vdom?this.attributeChangedCallback(s,null,o):(this._props||(this._props={}),this._props[s]=o,this.connectedCallback());var a=typeof o;o!=null&&a!=="string"&&a!=="boolean"&&a!=="number"||this.setAttribute(s,o)}})}),customElements.define(e||n.tagName||n.displayName||n.name,i)}const DDe=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M960 480L768 320v128H512V192h128L480 0 320 192h128v256H192V320L0 480l192 160V512h256v256H320l160 192 160-192H512V512h256v128l192-160z"})}),IDe=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M929 849a30 30 0 01-30-30v-83.137a447.514 447.514 0 01-70.921 92.209C722.935 933.225 578.442 975.008 442 953.482a444.917 444.917 0 01-241.139-120.591 30 30 0 1137.258-47.01l.231-.231A385.175 385.175 0 00442 892.625v-.006c120.855 22.123 250.206-13.519 343.656-106.975a386.646 386.646 0 0070.6-96.653h-87.247a30 30 0 010-60H929a30 30 0 0130 30V819a30 30 0 01-30 30zM512 392a120 120 0 11-120 120 120 120 0 01120-120zm293.005-147.025a29.87 29.87 0 01-19.117-6.882l-.232.231A386.5 386.5 0 00689.478 168h-.011c-145.646-75.182-329.021-51.747-451.117 70.35a386.615 386.615 0 00-70.6 96.65H255a30 30 0 010 60H95a30 30 0 01-30-30V205a30 30 0 0160 0v83.129a447.534 447.534 0 0170.923-92.206C317.981 73.866 493.048 37.2 647 85.836v-.045a444.883 444.883 0 01176.143 105.291 30 30 0 01-18.138 53.893z"})}),NDe=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M609.52 584.92a35.309 35.309 0 0124.98-10.36c9.37 0 18.36 3.73 24.98 10.36l189.29 189.22-.07-114.3.57-6.35c3.25-17.98 19.7-30.5 37.9-28.85 18.2 1.65 32.12 16.92 32.09 35.2v200.23c-.05 1.49-.19 2.97-.42 4.45l-.21 1.13c-.22 1.44-.55 2.85-.99 4.24l-.57 1.62-.56 1.41a34.163 34.163 0 01-7.62 11.36l2.12-2.4-.14.14-.92 1.06-1.06 1.2-.57.57-.56.57a36.378 36.378 0 01-16.23 8.39l-3.53.5-4.02.35h-199.6l-6.35-.63c-16.73-3.06-28.9-17.63-28.93-34.64l.56-6.35c3.07-16.76 17.67-28.93 34.71-28.92l114.29-.14-189.07-189.1-4.09-4.94c-9.71-14.01-8.01-32.95 4.02-45.02zm-162.06 0c12.06 12.05 13.78 30.99 4.09 45.01l-4.09 4.94-189.15 189.08 114.3.14c17.04-.01 31.65 12.17 34.71 28.92l.57 6.35c-.03 17.01-12.19 31.58-28.92 34.64l-6.35.63H173.09l-4.23-.42-3.39-.49a36.38 36.38 0 01-17.36-9.52l-1.06-1.13-.98-1.13.98 1.06-1.97-2.26.85 1.06-.42-.56a35.137 35.137 0 01-3.74-5.64l-1.13-2.68a34.71 34.71 0 01-2.11-7.33l-.28-1.13c-.21-1.47-.33-2.96-.36-4.45V659.78c-.03-18.28 13.89-33.55 32.09-35.2 18.2-1.65 34.65 10.87 37.9 28.85l.57 6.35-.07 114.36 189.29-189.22c13.77-13.77 36.11-13.77 49.88 0h-.09zm-74.71-471.71l6.35.57c16.76 3.06 28.93 17.67 28.92 34.71l-.63 6.35c-3.07 16.76-17.67 28.93-34.71 28.92l-114.3.14 189.15 189.08 4.09 4.94c10.26 15.02 7.42 35.37-6.55 47.01-13.98 11.63-34.51 10.74-47.42-2.07L208.29 233.71l.07 114.3-.57 6.35c-3.25 17.98-19.7 30.5-37.9 28.85-18.2-1.65-32.12-16.92-32.09-35.2V147.78c0-1.55.14-3.03.35-4.51l.21-1.13c.24-1.44.59-2.85 1.06-4.23a34.97 34.97 0 018.68-14.39l-2.12 2.4-.42.57 1.55-1.84-.99 1.06.92-.98 2.26-2.33c3.04-2.73 6.52-4.92 10.3-6.49l2.82-1.06c3.45-1.07 7.04-1.62 10.65-1.62l-3.6.14h.49l1.48-.14h201.31zm512.91 0l1.41.14h.42c2.43.29 4.84.79 7.19 1.48l2.82 1.06 2.61 1.2 3.04 1.76c2.09 1.33 4.03 2.89 5.78 4.66l1.13 1.2.78.98.21.14.49.64 2.33 3.17c2.35 3.83 3.98 8.07 4.8 12.49l.21 1.13c.21 1.48.35 2.96.35 4.44v200.37c-.16 18.13-14.03 33.19-32.08 34.83-18.06 1.64-34.42-10.67-37.83-28.48l-.57-6.35V233.65L659.54 422.87c-12.9 12.95-33.56 13.91-47.59 2.2-14.04-11.71-16.81-32.2-6.38-47.22l4.02-4.86 189.22-189.08-114.29-.14c-17.06.04-31.71-12.14-34.78-28.92l-.63-6.35c-.01-17.04 12.16-31.65 28.93-34.71l6.35-.57h201.27zm0 0"})}),kDe=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Ve("path",{fill:"#fff",d:"M96 892.8V121.6c0-16 12.8-28.8 28.8-28.8h774.4c16 0 28.8 12.8 28.8 28.8v771.2c0 16-12.8 28.8-28.8 28.8H124.8c-16 3.2-28.8-9.6-28.8-28.8zm64-736v704h704v-704H160z"}),Ve("path",{fill:"#fff",d:"M352 656V358.4c0-6.4 6.4-12.8 9.6-12.8h297.6c6.4 0 9.6 6.4 9.6 12.8V656c0 6.4-6.4 12.8-9.6 12.8H361.6c-3.2 0-9.6-6.4-9.6-12.8zm80-227.2v160h160v-160H432zm240 108.8v-48h192v48H672zm121.6-48H736v48h57.6v-48zm-633.6 48v-48h192v48H160zm124.8-48H224v48h57.6v-48z"}),Ve("path",{fill:"#fff",d:"M489.6 156.8h48v192h-48v-192zm48 121.6v-57.6h-48v57.6h48zm-48 387.2h48v195.2h-48V665.6zm48 124.8v-57.6h-48v57.6h48z"})]}),zDe=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M185.6 489.6h-48c-3.2 0-9.6 3.2-9.6 9.6v384c0 3.2 3.2 9.6 9.6 9.6h48c3.2 0 9.6-3.2 9.6-9.6v-384c-3.2-6.4-6.4-9.6-9.6-9.6zm217.6 236.8c6.4 0 12.8-3.2 12.8-9.6v-48c0-3.2-6.4-9.6-12.8-9.6H140.8c-6.4 0-12.8 3.2-12.8 9.6v48c0 3.2 6.4 9.6 12.8 9.6h262.4zm512-547.2v-48c0-3.2-3.2-9.6-9.6-9.6h-384c-3.2 0-9.6 3.2-9.6 9.6v48c0 3.2 3.2 9.6 9.6 9.6h384c6.4 0 9.6-6.4 9.6-9.6zM678.4 377.6c0 6.4 3.2 9.6 9.6 9.6h48c3.2 0 9.6-3.2 9.6-9.6V134.4c0-6.4-3.2-9.6-9.6-9.6h-48c-3.2 0-9.6 3.2-9.6 9.6v243.2zm-195.2 89.6v416c0 9.6 6.4 16 16 16h400c9.6 0 16-6.4 16-16v-416c0-9.6-6.4-16-16-16h-400c-9.6 0-16 9.6-16 16zm361.6 57.6v304h-288v-304h288z"})}),lc=({children:n,onClick:e,active:t,disabled:r})=>Ve("div",{style:{width:30,height:30,display:"flex",alignItems:"center",justifyContent:"center",margin:6,borderRadius:4,background:t?"rgba(255, 255, 255, 0.1)":void 0,opacity:r?.25:t?1:.75,cursor:"pointer"},onClick:r||t?void 0:e,children:n});var Sb,hs,SV,cZ,fO=0,Uoe=[],K3=[],uZ=un.__b,hZ=un.__r,dZ=un.diffed,pZ=un.__c,fZ=un.unmount;function Z2(n,e){un.__h&&un.__h(hs,n,fO||e),fO=0;var t=hs.__H||(hs.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({__V:K3}),t.__[n]}function Tc(n){return fO=1,BDe(Hoe,n)}function BDe(n,e,t){var r=Z2(Sb++,2);if(r.t=n,!r.__c&&(r.__=[t?t(e):Hoe(void 0,e),function(s){var o=r.__N?r.__N[0]:r.__[0],a=r.t(o,s);o!==a&&(r.__N=[a,r.__[1]],r.__c.setState({}))}],r.__c=hs,!hs.u)){hs.u=!0;var i=hs.shouldComponentUpdate;hs.shouldComponentUpdate=function(s,o,a){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(d){return d.__c});if(c.every(function(d){return!d.__N}))return!i||i.call(this,s,o,a);var u=!1;return c.forEach(function(d){if(d.__N){var p=d.__[0];d.__=d.__N,d.__N=void 0,p!==d.__[0]&&(u=!0)}}),!!u&&(!i||i.call(this,s,o,a))}}return r.__N||r.__}function Rc(n,e){var t=Z2(Sb++,3);!un.__s&&PH(t.__H,e)&&(t.__=n,t.i=e,hs.__H.__h.push(t))}function XU(n,e){var t=Z2(Sb++,4);!un.__s&&PH(t.__H,e)&&(t.__=n,t.i=e,hs.__h.push(t))}function mO(n){return fO=5,Im(function(){return{current:n}},[])}function Im(n,e){var t=Z2(Sb++,7);return PH(t.__H,e)?(t.__V=n(),t.i=e,t.__h=n,t.__V):t.__}function joe(n){var e=hs.context[n.__c],t=Z2(Sb++,9);return t.c=n,e?(t.__==null&&(t.__=!0,e.sub(hs)),e.props.value):n.__}function VDe(){for(var n;n=Uoe.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(J3),n.__H.__h.forEach(qU),n.__H.__h=[]}catch(e){n.__H.__h=[],un.__e(e,n.__v)}}un.__b=function(n){typeof n.type!="function"||n.o||n.type===Pc?n.o||(n.o=n.__&&n.__.o?n.__.o:""):n.o=(n.__&&n.__.o?n.__.o:"")+(n.__&&n.__.__k?n.__.__k.indexOf(n):0),hs=null,uZ&&uZ(n)},un.__r=function(n){hZ&&hZ(n),Sb=0;var e=(hs=n.__c).__H;e&&(SV===hs?(e.__h=[],hs.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=K3,t.__N=t.i=void 0})):(e.__h.forEach(J3),e.__h.forEach(qU),e.__h=[])),SV=hs},un.diffed=function(n){dZ&&dZ(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Uoe.push(e)!==1&&cZ===un.requestAnimationFrame||((cZ=un.requestAnimationFrame)||FDe)(VDe)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==K3&&(t.__=t.__V),t.i=void 0,t.__V=K3})),SV=hs=null},un.__c=function(n,e){e.some(function(t){try{t.__h.forEach(J3),t.__h=t.__h.filter(function(r){return!r.__||qU(r)})}catch(r){e.some(function(i){i.__h&&(i.__h=[])}),e=[],un.__e(r,t.__v)}}),pZ&&pZ(n,e)},un.unmount=function(n){fZ&&fZ(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(r){try{J3(r)}catch(i){e=i}}),t.__H=void 0,e&&un.__e(e,t.__v))};var mZ=typeof requestAnimationFrame=="function";function FDe(n){var e,t=function(){clearTimeout(r),mZ&&cancelAnimationFrame(e),setTimeout(n)},r=setTimeout(t,100);mZ&&(e=requestAnimationFrame(t))}function J3(n){var e=hs,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),hs=e}function qU(n){var e=hs;n.__c=n.__(),hs=e}function PH(n,e){return!n||n.length!==e.length||e.some(function(t,r){return t!==n[r]})}function Hoe(n,e){return typeof e=="function"?e(n):e}const Ba=(n,e)=>()=>{const[t,r]=Tc(()=>e());return Rc(()=>{const i=e(r);return()=>{i.cancel()}},[]),[t,n]},[zD,UDe]=yt(void 0);ps(()=>zD(void 0));const[Woe,jDe]=yt(void 0),[HDe,WDe]=yt(!1),[GDe,XDe]=yt(""),[Goe,qDe]=yt(void 0),K2=Ba(lx,ps),TH=Ba(SL,lh),YDe=Ba(I9,IL),ZDe=Ba(V9,F9),KDe=Ba(T9,dx),JDe=Ba(y3,Ut),QDe=Ba(eM,y0),$De=Ba(oU,aU),Xoe=Ba(zD,UDe),qoe=Ba(Woe,jDe),RH=Ba(HDe,WDe),e4e=Ba(P9,au),t4e=Ba(Yre,yU),n4e=Ba(Goe,qDe),r4e=Ba(SH,vDe),Yoe=Ba(GDe,XDe),i4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",style:{left:-2},children:Ve("path",{fill:"#fff",d:"M279.552 198.879a22.26 22.26 0 0135.217-20.347L933.265 628.47a22.26 22.26 0 01-11.799 40.248l-324.43 19.456a22.26 22.26 0 00-17.23 9.972l-179.11 271.227a22.26 22.26 0 01-40.738-9.929L279.597 198.88z"})}),s4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Ve("path",{fill:"#fff",d:"M870.4 342.4c-12.8 0-24-11.2-24-24V153.6c0-12.8 11.2-24 24-24s24 11.2 24 24v164.8c0 12.8-11.2 24-24 24z"}),Ve("path",{fill:"#fff",d:"M870.4 177.6H705.6c-12.8 0-24-11.2-24-24s11.2-24 24-24h164.8c12.8 0 24 11.2 24 24s-11.2 24-24 24zm-96 716.8H249.6c-65.6 0-120-54.4-120-120V249.6c0-65.6 54.4-120 120-120H512c12.8 0 24 11.2 24 24s-11.2 24-24 24H249.6c-40 0-72 32-72 72v524.8c0 40 32 72 72 72h524.8c40 0 72-32 72-72V512c0-12.8 11.2-24 24-24s24 11.2 24 24v262.4c0 65.6-54.4 120-120 120z"}),Ve("path",{fill:"#fff",d:"M526.4 521.6c-6.4 0-12.8-1.6-17.6-6.4-9.6-9.6-9.6-24 0-33.6l344-344c9.6-9.6 24-9.6 33.6 0 9.6 9.6 9.6 24 0 33.6l-344 344c-4.8 4.8-11.2 6.4-16 6.4z"})]}),o4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M836.8 353.6c-11.2-3.2-20.8-6.4-32-9.6 1.6-8 3.2-14.4 4.8-22.4 24-118.4 8-214.4-46.4-246.4C710.4 44.8 624 76.8 537.6 152c-8 8-17.6 14.4-25.6 22.4-4.8-4.8-11.2-9.6-16-16-91.2-81.6-182.4-115.2-236.8-83.2-52.8 30.4-68.8 120-46.4 233.6 1.6 11.2 4.8 22.4 8 33.6-12.8 3.2-25.6 8-36.8 11.2C76.8 392 0 451.2 0 510.4c0 62.4 81.6 124.8 192 163.2 9.6 3.2 17.6 6.4 27.2 8-3.2 12.8-6.4 24-8 36.8-20.8 110.4-4.8 198.4 48 228.8 54.4 32 145.6 0 233.6-78.4 6.4-6.4 14.4-12.8 20.8-19.2 8 8 17.6 16 27.2 24 84.8 73.6 169.6 104 222.4 73.6 54.4-32 72-126.4 48-241.6-1.6-8-3.2-17.6-6.4-27.2 6.4-1.6 12.8-3.2 19.2-6.4 116.8-35.2 200-97.6 200-161.6 0-59.2-78.4-118.4-187.2-156.8zM566.4 184c75.2-65.6 144-89.6 176-72 33.6 19.2 46.4 97.6 25.6 201.6-1.6 6.4-3.2 12.8-4.8 20.8-44.8-9.6-89.6-17.6-134.4-20.8C603.2 276.8 574.4 240 544 208c6.4-9.6 14.4-16 22.4-24zm-232 430.4c9.6 17.6 20.8 35.2 32 51.2-32-3.2-62.4-8-92.8-14.4 8-28.8 19.2-59.2 32-89.6 9.6 19.2 19.2 36.8 28.8 52.8zm-60.8-240c28.8-6.4 59.2-11.2 91.2-16-11.2 16-20.8 33.6-30.4 51.2-9.6 17.6-19.2 33.6-28.8 52.8-12.8-30.4-22.4-59.2-32-88zM328 512c12.8-27.2 27.2-54.4 43.2-81.6s32-52.8 48-78.4c30.4-1.6 60.8-3.2 91.2-3.2s62.4 1.6 91.2 3.2c17.6 25.6 33.6 51.2 48 76.8s30.4 52.8 43.2 81.6c-12.8 27.2-27.2 54.4-43.2 81.6-16 27.2-32 52.8-48 78.4-30.4 1.6-60.8 3.2-92.8 3.2s-62.4-1.6-91.2-3.2C400 644.8 384 619.2 368 592s-25.6-52.8-40-80zm361.6 102.4l28.8-52.8c12.8 28.8 24 59.2 33.6 88-30.4 6.4-62.4 12.8-94.4 16 11.2-16 22.4-33.6 32-51.2zm28.8-153.6L689.6 408c-9.6-17.6-20.8-33.6-30.4-49.6 32 4.8 62.4 9.6 91.2 16-8 30.4-19.2 59.2-32 86.4zM512 236.8c20.8 22.4 40 46.4 59.2 72-40-1.6-80-1.6-118.4 0 19.2-27.2 40-51.2 59.2-72zM280 113.6c33.6-19.2 108.8 8 187.2 78.4 4.8 4.8 9.6 9.6 16 14.4C452.8 240 424 275.2 396.8 312c-44.8 4.8-89.6 11.2-134.4 20.8-3.2-9.6-4.8-20.8-6.4-30.4-19.2-97.6-6.4-169.6 24-188.8zm-48 528c-8-3.2-16-4.8-25.6-8-43.2-12.8-91.2-35.2-126.4-62.4C59.2 556.8 46.4 536 41.6 512c0-36.8 64-83.2 155.2-115.2 11.2-4.8 22.4-8 35.2-11.2 14.4 43.2 30.4 86.4 49.6 128-19.2 40-36.8 83.2-49.6 128zm232 195.2c-33.6 30.4-72 54.4-113.6 70.4-22.4 11.2-48 11.2-70.4 3.2-32-19.2-44.8-89.6-27.2-184 1.6-11.2 4.8-22.4 8-33.6 44.8 9.6 89.6 16 136 19.2 25.6 36.8 56 73.6 86.4 107.2-6.4 6.4-12.8 12.8-19.2 17.6zm49.6-48c-20.8-22.4-40-46.4-60.8-72 19.2 0 38.4 1.6 59.2 1.6 20.8 0 41.6 0 60.8-1.6-19.2 24-38.4 48-59.2 72zM774.4 848c-1.6 24-14.4 48-33.6 62.4-32 19.2-99.2-4.8-172.8-68.8-8-8-16-14.4-25.6-22.4 30.4-33.6 59.2-68.8 84.8-107.2 46.4-3.2 91.2-11.2 136-20.8l4.8 24c11.2 43.2 12.8 89.6 6.4 132.8zm36.8-214.4c-4.8 1.6-11.2 3.2-17.6 4.8-14.4-43.2-32-86.4-51.2-128 19.2-40 35.2-83.2 49.6-126.4 11.2 3.2 20.8 6.4 30.4 9.6 92.8 32 158.4 80 158.4 116.8 0 40-68.8 89.6-169.6 123.2zM512 603.2c51.2 0 91.2-41.6 91.2-91.2s-41.6-91.2-91.2-91.2-91.2 41.6-91.2 91.2 40 91.2 91.2 91.2z"})}),a4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M777.8 128.6H624L512 305.8l-96-177.2H64L512 896l448-767.4H777.8zm-602.4 64H283L512 589l228.8-396.4h107.6L512 769 175.4 192.6z"})}),l4e=()=>Ve("div",{style:{width:"60%",height:2,background:"rgba(255, 255, 255, 0.1)",margin:12}}),HP=({children:n})=>!Array.isArray(n)||!n.length?null:Ve(Pc,{children:[n,Ve(l4e,{})]}),J2=()=>{const n=mO(null);return Rc(()=>{const e=n.current;if(!e)return;const t=r=>r.stopPropagation();return e.addEventListener("mousedown",t),e.addEventListener("pointerdown",t),e.addEventListener("touchstart",t),e.addEventListener("keydown",t),()=>{e.removeEventListener("mousedown",t),e.removeEventListener("pointerdown",t),e.removeEventListener("touchstart",t),e.removeEventListener("keydown",t)}},[]),n},c4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Ve("path",{fill:"#fff",d:"M856.2 47.8H167.8c-66.2 0-120 53.8-120 120v688.6c0 66.2 53.8 120 120 120h688.6c66.2 0 120-53.8 120-120V167.8c-.2-66.2-54-120-120.2-120zm60 808.4c0 33-27 60-60 60H167.8c-33 0-60-27-60-60V167.8c0-33 27-60 60-60h688.6c33 0 60 27 60 60v688.4z"}),Ve("path",{fill:"#fff",d:"M646.6 466.2l-163.4-94.4c-16.8-9.8-37-9.8-54 0-16.8 9.8-27 27.2-27 46.8v188.8c0 19.6 10 37 27 46.8 8.4 4.8 17.8 7.4 27 7.4s18.6-2.4 27-7.4l163.4-94.4c16.8-9.8 27-27.2 27-46.8-.2-19.6-10.2-37-27-46.8z"})]}),u4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M96 160h343.968l87.808 160H928v544H96V160zm64 64v576h704V384H489.92l-87.84-160H160z"})}),h4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:[Ve("path",{fill:"#fff",d:"M832 928H192c-52.8 0-96-43.2-96-96V192c0-52.8 43.2-96 96-96h576c8 0 16 3.2 22.4 9.6l128 128c6.4 6.4 9.6 14.4 9.6 22.4v576c0 52.8-43.2 96-96 96zM192 160c-17.6 0-32 14.4-32 32v640c0 17.6 14.4 32 32 32h640c17.6 0 32-14.4 32-32V268.8L755.2 160H192z"}),Ve("path",{fill:"#fff",d:"M736 928H288c-17.6 0-32-14.4-32-32V643.2c0-54.4 44.8-99.2 99.2-99.2h315.2c54.4 0 99.2 44.8 99.2 99.2V896c-1.6 17.6-16 32-33.6 32zm-416-64h384V643.2c0-19.2-16-35.2-35.2-35.2H355.2c-19.2 0-35.2 16-35.2 35.2V864zm315.2-448H388.8c-46.4 0-84.8-38.4-84.8-84.8V128c0-17.6 14.4-32 32-32h352c17.6 0 32 14.4 32 32v203.2c0 46.4-38.4 84.8-84.8 84.8zM368 160v171.2c0 11.2 9.6 20.8 20.8 20.8h246.4c11.2 0 20.8-9.6 20.8-20.8V160H368z"}),Ve("path",{fill:"#fff",d:"M576 304c-17.6 0-32-14.4-32-32v-32c0-17.6 14.4-32 32-32s32 14.4 32 32v32c0 17.6-14.4 32-32 32z"})]}),d4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M213.333 128h85.334v85.333h-85.334v213.334A85.333 85.333 0 01128 512a85.333 85.333 0 0185.333 85.333v213.334h85.334V896h-85.334C167.68 884.48 128 857.6 128 810.667V640a85.333 85.333 0 00-85.333-85.333H0v-85.334h42.667A85.333 85.333 0 00128 384V213.333A85.333 85.333 0 01213.333 128m597.334 0A85.333 85.333 0 01896 213.333V384a85.333 85.333 0 0085.333 85.333H1024v85.334h-42.667A85.333 85.333 0 00896 640v170.667A85.333 85.333 0 01810.667 896h-85.334v-85.333h85.334V597.333A85.333 85.333 0 01896 512a85.333 85.333 0 01-85.333-85.333V213.333h-85.334V128h85.334M512 640a42.667 42.667 0 0142.667 42.667A42.667 42.667 0 01512 725.333a42.667 42.667 0 01-42.667-42.666A42.667 42.667 0 01512 640m-170.667 0A42.667 42.667 0 01384 682.667a42.667 42.667 0 01-42.667 42.666 42.667 42.667 0 01-42.666-42.666A42.667 42.667 0 01341.333 640m341.334 0a42.667 42.667 0 0142.666 42.667 42.667 42.667 0 01-42.666 42.666A42.667 42.667 0 01640 682.667 42.667 42.667 0 01682.667 640z"})}),Zoe=()=>{const n=J2(),[e]=QDe(),[t]=$De(),[r]=K2(),i=r&&v0(r)&&!(r instanceof lb);return Rc(()=>(LL(),()=>{DL()}),[]),Ve("div",{ref:n,className:"lingo3d-ui lingo3d-bg",style:{width:50,height:"100%",overflowY:"scroll"},children:Ve("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",opacity:.75,paddingTop:12},children:[Ve(HP,{children:[Ve(lc,{active:e==="select",onClick:()=>Xg("select"),children:Ve(i4e,{})}),Ve(lc,{active:e==="translate",onClick:()=>Xg("translate"),children:Ve(DDe,{})}),Ve(lc,{active:e==="rotate",disabled:i,onClick:()=>Xg("rotate"),children:Ve(IDe,{})}),Ve(lc,{active:e==="scale",disabled:i,onClick:()=>Xg("scale"),children:Ve(NDe,{})}),ube,Ve(lc,{active:e==="play",onClick:()=>Xg("play"),children:Ve(c4e,{})})]}),Ve(HP,{children:[Ve(lc,{active:t==="world",onClick:()=>iU("world"),disabled:e!=="translate"&&e!=="rotate",children:Ve(kDe,{})}),Ve(lc,{active:t==="local",onClick:()=>iU("local"),disabled:e!=="translate"&&e!=="rotate"&&e!=="scale",children:Ve(zDe,{})})]}),Ve(HP,{children:[Ve(lc,{onClick:xoe,children:Ve(u4e,{})}),Ve(lc,{onClick:gDe,children:Ve(s4e,{})}),Ve(lc,{onClick:boe,children:Ve(h4e,{})})]}),Ve(HP,{children:[Ve(lc,{onClick:tDe,children:Ve(d4e,{})}),Ve(lc,{onClick:nDe,children:Ve(o4e,{})}),Ve(lc,{onClick:rDe,children:Ve(a4e,{})})]})]})})};$m(Zoe,"lingo3d-toolbar",["buttons"]);const Koe=()=>Ve("path",{fill:"#fff",d:"M914.5 653.5c-5.5 0-11 1.1-16 3.3l-.2.1h-.2L510.2 822.2 122.2 657h-.2l-.2-.1c-5-2.1-10.3-3.3-16-3.3-23.1 0-41.8 19.3-41.8 43.1 0 18 10.7 33.3 25.8 39.8l403.9 172.1.4.1c10.2 4.4 21.8 4.4 32 0l.2-.1c.1 0 .1-.1.2-.1l403.9-172.1c15.1-6.5 25.8-21.8 25.8-39.8.1-23.8-18.6-43.1-41.7-43.1zm0-186.5c-7.9-.2-16 3.2-16 3.2L510.2 635.6 121.8 470.2s-10.3-3.2-16-3.2C82.7 467 64 486.2 64 510c0 17.9 10.7 33.3 25.8 39.7l403.9 172c.1 0 .1.1.2.1l.1.1c5 2.1 10.3 3.3 16 3.3 5.7 0 11.1-1.2 16-3.3l.2-.1c.1 0 .1 0 .2-.1l403.9-172c15.1-6.4 25.8-21.8 25.9-39.7.1-23.8-18.6-43-41.7-43zM89.8 363.2l403.9 172.1c.1 0 .1 0 .2.1l.1.1c5 2.1 10.3 3.2 16 3.2 5.5 0 10.9-1.1 16-3.2l.2-.1.2-.1 403.9-172c15.1-6.5 25.8-21.8 25.9-39.7 0-18-10.7-33.3-25.8-39.8L526.5 111.6c-.1 0-.1 0-.2-.1l-.2-.1c-10.2-4.4-21.8-4.4-32 0l-.1.1L89.8 283.7C74.7 290.1 64 305.5 64 323.5c0 17.9 10.7 33.2 25.8 39.7z"}),p4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,opacity:.25,flexShrink:0},children:Ve(Koe,{})}),f4e=({style:n,onClick:e})=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,flexShrink:0,...n},onMouseDown:t=>t.stopPropagation(),onClick:t=>(t.stopPropagation(),e==null?void 0:e()),children:Ve("path",{fill:"#fff",d:"M752 240H144c-17.7 0-32 14.3-32 32v608c0 17.7 14.3 32 32 32h608c17.7 0 32-14.3 32-32V272c0-17.7-14.3-32-32-32zM596 606c0 4.4-3.6 8-8 8H308c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h280c4.4 0 8 3.6 8 8v48zm284-494H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h576v576c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V144c0-17.7-14.3-32-32-32z"})}),m4e=({style:n,onClick:e})=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,flexShrink:0,...n},onMouseDown:t=>t.stopPropagation(),onClick:t=>(t.stopPropagation(),e==null?void 0:e()),children:Ve("path",{fill:"#fff",d:"M928.1 928.2H98v-830h830.1v830zm-104.8-415c0-24.6-19.9-44.5-44.5-44.5H556.5V246.4c0-24.6-19.9-44.5-44.5-44.5s-44.5 19.9-44.5 44.5v222.3H245.2c-24.6 0-44.5 19.9-44.5 44.5s19.9 44.5 44.5 44.5h222.3V780c0 24.6 19.9 44.5 44.5 44.5s44.5-19.9 44.5-44.5V557.7h222.3c24.6 0 44.5-20 44.5-44.5z"})}),OH=ADe({}),v4e=({children:n})=>Ve(OH.Provider,{value:{},children:n}),g4e=n=>{const[e,t]=Tc(null);return Rc(()=>{if(!e||!n)return;let r=0,i=0,s=0;const o=u=>{u.stopPropagation(),r=Date.now(),i=u.clientX,s=u.clientY},a=u=>{u.stopPropagation();const d=Date.now(),p=d-r,f=Math.abs(u.clientX-i),v=Math.abs(u.clientY-s);r=d,i=u.clientX,s=u.clientY,p<300&&f<5&&v<5&&n(u)},c=u=>{u.stopPropagation()};return e.addEventListener("mousedown",o),e.addEventListener("mouseup",a),e.addEventListener("click",c),()=>{e.removeEventListener("mousedown",o),e.removeEventListener("mouseup",a),e.removeEventListener("click",c)}},[e]),t},_4e=(...n)=>e=>{for(const t of n)typeof t=="function"?t(e):t.current=e},LH=({label:n,children:e,selected:t,onCollapse:r,onExpand:i,onClick:s,onDrop:o,myDraggingItem:a,draggable:c,expanded:u,expandable:d,outlined:p,IconComponent:f})=>{const v={opacity:d?.5:.05,cursor:"pointer"},[x,y]=Tc(!!u);Rc(()=>{y(!!u)},[u]);const _=mO(null),S=mO(null),C=Im(()=>{if(!t||!_.current||!S.current)return;const ee=_.current.getBoundingClientRect();return S.current.getBoundingClientRect().right-ee.left+4},[t,x]),A=()=>{y(!1),r==null||r()},P=()=>{y(!0),i==null||i()},D=ee=>{ee.stopPropagation(),x?A():P()},N=joe(OH),j=()=>c&&N.draggingItem&&N.draggingItem!==a,[T,k]=Tc(!1),U=g4e(s);return Ve("div",{draggable:c,onDragStart:ee=>{ee.stopPropagation(),N.draggingItem=a},onDragEnd:ee=>{ee.stopPropagation(),N.draggingItem=void 0},onDragOver:ee=>{ee.stopPropagation(),ee.preventDefault(),j()&&k(!0)},onDragEnter:ee=>{ee.stopPropagation(),ee.preventDefault(),j()&&k(!0)},onDragLeave:ee=>{ee.stopPropagation(),j()&&k(!1)},onDrop:ee=>{ee.stopPropagation(),j()&&(k(!1),N.draggingItem.traverseSome(xe=>a===xe)||o==null||o(N.draggingItem))},style:{color:"rgba(255, 255, 255, 0.75)",marginLeft:8,borderLeft:"1px solid rgba(255, 255, 255, 0.05)",background:T?"rgba(255, 255, 255, 0.5)":"none"},children:[Ve("div",{ref:_4e(_,U),onDblClick:D,style:{display:"flex",alignItems:"center",backgroundColor:t&&!p?"rgba(255, 255, 255, 0.1)":void 0,outline:t&&p?"1px solid rgba(255, 255, 255, 0.5)":void 0,width:C,minWidth:"100%",cursor:"default"},children:[x?Ve(f4e,{style:v,onClick:A}):Ve(m4e,{style:v,onClick:P}),f&&Ve(f,{}),Ve("div",{ref:S,children:n})]}),x&&(typeof e=="function"?e():e)]})},Joe=({appendable:n,object3d:e})=>{const[t,r]=Tc(!1),[i]=Xoe(),s=Im(()=>eae(e,n),[]),[o,a]=qoe();Rc(()=>{o!=null&&o.has(e)&&r(!0)},[o]);const c=i===e;return Ve(LH,{label:e.name,selected:c,onCollapse:()=>a(void 0),onClick:s,expanded:t,expandable:!!e.children.length,outlined:!0,IconComponent:p4e,children:()=>e.children.map(u=>Ve(Joe,{object3d:u,appendable:n},u.uuid))})},Qoe=({appendable:n})=>{const[e,t]=Tc(),{loaded:r}=n;return Rc(()=>{t(void 0);const i=r.then(()=>{t(n.loadedGroup.children[0])});return()=>{i.cancel()}},[r]),Ve(DH,{appendable:n,expandable:!!e,children:e&&Ve(Joe,{appendable:n,object3d:e})})},$oe=n=>n.name||la.exports.upperFirst(n.constructor.componentName),y4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,opacity:.25,flexShrink:0},children:Ve("path",{fill:"#fff",d:"M838.4 325.12L554.24 479.36C528 493.44 512 521.6 512 552.96V851.2c0 32 31.36 53.12 57.6 38.4l284.16-154.24c25.6-14.08 42.24-42.24 42.24-73.6v-297.6c0-32.64-31.36-53.12-57.6-39.04zm-432.64 153.6L121.6 325.12c-26.24-14.08-57.6 6.4-57.6 38.4v299.52c0 31.36 16 59.52 42.24 73.6l284.16 153.6c26.24 14.08 57.6-7.04 57.6-39.04V552.32c0-31.36-16-59.52-42.24-73.6zm406.4-223.36c13.44-7.04 19.84-19.2 18.56-30.72 1.28-12.16-5.12-23.68-18.56-30.72L522.88 42.88c-12.8-7.04-28.16-10.24-43.52-10.24-15.36 0-30.72 3.2-43.52 10.24l-289.28 150.4c-13.44 7.04-19.2 19.2-18.56 30.72-.64 12.16 5.12 24.32 18.56 31.36l289.28 150.4C448.64 412.8 464 416 479.36 416c15.36 0 30.72-3.2 43.52-10.24l289.28-150.4z"})}),eae=(n,e)=>()=>{!Na()&&Xg("translate"),v0(e)&&ps()!==e&&Ki(e),n instanceof wr?queueMicrotask(()=>zD(n)):Ki(n)},DH=({appendable:n,children:e,expandable:t})=>{var r;const i=Im(()=>n.children?[...n.children].filter(p=>!TL.has(p)):void 0,[(r=n.children)==null?void 0:r.size]),[s]=K2(),[o]=TH(),a=s===n||o.includes(n),c=Im(()=>eae(n),[]),[u,d]=qoe();return Ve(LH,{label:$oe(n),selected:a,draggable:!0,myDraggingItem:n,onDrop:p=>n.attach(p),expanded:u==null?void 0:u.has(n.outerObject3d),onCollapse:()=>d(void 0),expandable:t!=null?t:!!(i!=null&&i.length),onClick:c,IconComponent:y4e,children:()=>Ve(Pc,{children:[i==null?void 0:i.map(p=>p instanceof ih?Ve(Qoe,{appendable:p},p.uuid):Ve(DH,{appendable:p},p.uuid)),e]})})},x4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M640 384h224a32 32 0 0132 32v384h-96v96H416a32 32 0 01-32-32V640H160a32 32 0 01-32-32V224h96v-96h384a32 32 0 0132 32v224zm0 32v192a32 32 0 01-32 32H416v224h352v-96h96V416H640zM96 96h96v96H96V96zm736 0h96v96h-96V96zM96 832h96v96H96v-96zm736 0h96v96h-96v-96z"})}),b4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M630.09 151.91V62.16H361.84v89.74H93.6v134.62h89.41v673.11h625.93v-673.1h89.42V151.91H630.09zM361.84 869.89h-89.43V286.53h89.43v583.36zm178.84 0h-89.43V286.53h89.43v583.36zm178.84 0h-89.43V286.53h89.43v583.36z"})}),Q3=({children:n,onClick:e,disabled:t})=>Ve("div",{onClick:t?void 0:e,style:{width:24,height:24,display:"flex",justifyContent:"center",alignItems:"center",marginRight:2,opacity:t?.1:.5,cursor:t?"default":"pointer"},children:n}),tae=()=>{if(lu())return;const n=ps(),e=lh();n==null||n.dispose();for(const t of e)t.dispose()},w4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 1024 1024",children:Ve(Koe,{})});function S4e(n,e){for(var t in e)n[t]=e[t];return n}function vZ(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var r in e)if(r!=="__source"&&n[r]!==e[r])return!0;return!1}function gZ(n){this.props=n}(gZ.prototype=new Vp).isPureReactComponent=!0,gZ.prototype.shouldComponentUpdate=function(n,e){return vZ(this.props,n)||vZ(this.state,e)};var _Z=un.__b;un.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),_Z&&_Z(n)};var M4e=un.__e;un.__e=function(n,e,t,r){if(n.then){for(var i,s=e;s=s.__;)if((i=s.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(n,e)}M4e(n,e,t,r)};var yZ=un.unmount;function nae(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),n.__c.__H=null),(n=S4e({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(r){return nae(r,e,t)})),n}function rae(n,e,t){return n&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(r){return rae(r,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.insertBefore(n.__e,n.__d),n.__c.__e=!0,n.__c.__P=t)),n}function MV(){this.__u=0,this.t=null,this.__b=null}function iae(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function WP(){this.u=null,this.o=null}un.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),yZ&&yZ(n)},(MV.prototype=new Vp).__c=function(n,e){var t=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(t);var i=iae(r.__v),s=!1,o=function(){s||(s=!0,t.__R=null,i?i(a):a())};t.__R=o;var a=function(){if(!--r.__u){if(r.state.__a){var u=r.state.__a;r.__v.__k[0]=rae(u,u.__c.__P,u.__c.__O)}var d;for(r.setState({__a:r.__b=null});d=r.t.pop();)d.forceUpdate()}},c=e.__h===!0;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),n.then(o,o)},MV.prototype.componentWillUnmount=function(){this.t=[]},MV.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=nae(this.__b,t,r.__O=r.__P)}this.__b=null}var i=e.__a&&Fh(Pc,null,n.fallback);return i&&(i.__h=null),[Fh(Pc,null,e.__a?null:n.children),i]};var xZ=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function C4e(n){return this.getChildContext=function(){return n.context},n.children}function E4e(n){var e=this,t=n.i;e.componentWillUnmount=function(){Cx(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(r){this.childNodes.push(r),e.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),e.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),e.i.removeChild(r)}}),Cx(Fh(C4e,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function sae(n,e){var t=Fh(E4e,{__v:n,i:e});return t.containerInfo=e,t}(WP.prototype=new Vp).__a=function(n){var e=this,t=iae(e.__v),r=e.o.get(n);return r[0]++,function(i){var s=function(){e.props.revealOrder?(r.push(i),xZ(e,n,r)):i()};t?t(s):s()}},WP.prototype.render=function(n){this.u=null,this.o=new Map;var e=dO(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},WP.prototype.componentDidUpdate=WP.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){xZ(n,t,e)})};var A4e=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,P4e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,T4e=typeof document<"u",R4e=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};Vp.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Vp.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var bZ=un.event;function O4e(){}function L4e(){return this.cancelBubble}function D4e(){return this.defaultPrevented}un.event=function(n){return bZ&&(n=bZ(n)),n.persist=O4e,n.isPropagationStopped=L4e,n.isDefaultPrevented=D4e,n.nativeEvent=n};var wZ={configurable:!0,get:function(){return this.class}},SZ=un.vnode;un.vnode=function(n){var e=n.type,t=n.props,r=t;if(typeof e=="string"){var i=e.indexOf("-")===-1;for(var s in r={},t){var o=t[s];T4e&&s==="children"&&e==="noscript"||s==="value"&&"defaultValue"in t&&o==null||(s==="defaultValue"&&"value"in t&&t.value==null?s="value":s==="download"&&o===!0?o="":/ondoubleclick/i.test(s)?s="ondblclick":/^onchange(textarea|input)/i.test(s+e)&&!R4e(t.type)?s="oninput":/^onfocus$/i.test(s)?s="onfocusin":/^onblur$/i.test(s)?s="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(s)?s=s.toLowerCase():i&&P4e.test(s)?s=s.replace(/[A-Z0-9]/g,"-$&").toLowerCase():o===null&&(o=void 0),/^oninput$/i.test(s)&&(s=s.toLowerCase(),r[s]&&(s="oninputCapture")),r[s]=o)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=dO(t.children).forEach(function(a){a.props.selected=r.value.indexOf(a.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=dO(t.children).forEach(function(a){a.props.selected=r.multiple?r.defaultValue.indexOf(a.props.value)!=-1:r.defaultValue==a.props.value})),n.props=r,t.class!=t.className&&(wZ.enumerable="className"in t,t.className!=null&&(r.class=t.className),Object.defineProperty(r,"className",wZ))}n.$$typeof=A4e,SZ&&SZ(n)};var MZ=un.__r;un.__r=function(n){MZ&&MZ(n),n.__c};const I4e=({data:n,setData:e,children:t})=>{const r=J2();return n?sae(Ve("div",{ref:r,className:"lingo3d-ui",style:{zIndex:2,position:"absolute",left:0,top:0,width:"100%",height:"100%"},children:[Ve("div",{onMouseDown:()=>e(void 0),style:{position:"absolute",left:0,top:0,width:"100%",height:"100%"}}),Ve("div",{className:"lingo3d-bg",style:{position:"absolute",left:n.x,top:n.y,padding:6},children:t})]}),document.body):null},GP=({disabled:n,onClick:e,setData:t,children:r})=>{const[i,s]=Tc(!1);return Ve("div",{style:{padding:6,whiteSpace:"nowrap",background:!n&&i?"rgba(255, 255, 255, 0.1)":void 0,opacity:n?.5:1},onClick:n?void 0:()=>{t==null||t(void 0),e==null||e()},onMouseEnter:n?void 0:()=>s(!0),onMouseLeave:n?void 0:()=>s(!1),children:r})},oae=(n,e)=>{var t,r,i;e.add(n);const s=(i=(r=(t=n.userData.manager)==null?void 0:t.parent)==null?void 0:r.outerObject3d)!=null?i:n.parent;s&&oae(s,e)},N4e=(n,e)=>{const t=n.toLowerCase();let r;if(e instanceof GC?e.loadedGroup.traverse(s=>{r||s.name.toLowerCase().includes(t)&&(r=s)}):e.outerObject3d.traverse(s=>{r||s.name.toLowerCase().includes(t)&&(r=s)}),!r)return;const i=new Set;oae(r,i),Woe(i),zD(r)},k4e=()=>{const[n,e]=Tc(void 0),[t,r]=Tc(!1),[i]=K2(),[[s]]=YDe();return Rc(()=>{let[o,a]=[0,0];const c=d=>[o,a]=[d.clientX,d.clientY];document.addEventListener("mousemove",c);const u=Qp(({target:d,rightClick:p})=>{p&&e({x:o,y:a,target:d})});return()=>{u.cancel(),document.removeEventListener("mousemove",c)}},[]),Rc(()=>{!n&&r(!1)},[n]),n?Ve(I4e,{data:n,setData:e,children:t?Ve("input",{ref:o=>o==null?void 0:o.focus(),style:{all:"unset",padding:6},onKeyDown:o=>{o.stopPropagation(),!(o.key!=="Enter"&&o.key!=="Escape")&&(o.key==="Enter"&&i&&N4e(o.target.value,i),e(void 0))}}):Ve(Pc,{children:[n.target&&Ve(Pc,{children:[Ve(GP,{setData:void 0,onClick:()=>r(!0),children:"Search children"}),Ve(GP,{setData:e,onClick:()=>_re(i)&&Ube(i),children:"Freeze selection"}),i instanceof Vy&&qg.has(i)&&Ve(GP,{setData:e,onClick:async()=>{const o=qg.get(i)==="dummy"?by:E9+"readyplayerme/reference.fbx",a=await fetch(o);loe("model.fbx",await a.blob())},children:"Download for Mixamo"})]}),Ve(GP,{setData:e,disabled:!s.size,onClick:()=>jbe(),children:"Unfreeze all"})]})}):null},[z4e,B4e]=Bo(),[$Qe,CZ]=yt(void 0);_n(()=>{const n=CZ();if(!n)return;const e=new br;return e.watch(n.loaded.then(t=>{t.getObjectByProperty("type","Bone").traverse(r=>r.name="mixamorig"+r.name)})),()=>{e.cancel()}},[CZ]);const V4e=({onDrop:n})=>{const[e,t]=Tc(!1),r=joe(OH);return Ve("div",{onDragOver:i=>{i.stopPropagation(),i.preventDefault(),r.draggingItem&&t(!0)},onDragEnter:i=>{i.stopPropagation(),i.preventDefault(),r.draggingItem&&t(!0)},onDragLeave:i=>{i.stopPropagation(),t(!1)},onDrop:i=>{i.stopPropagation(),t(!1),r.draggingItem&&(n==null||n(r.draggingItem))},style:{background:e?"rgba(255, 255, 255, 0.5)":"none",width:"100%",height:18}})},aae=({title:n,children:e,gap:t})=>Ve("div",{className:"lingo3d-bg",style:{height:24,display:"flex",alignItems:"center",paddingLeft:12,paddingRight:t},children:[Ve("div",{children:n}),Ve("div",{style:{flexGrow:1,minWidth:t}}),e]}),lae=()=>{const[n,e]=Tc({}),t=J2();XU(()=>{const a=()=>e({}),c=ob(a),u=B4e(a);return LL(),()=>{c.cancel(),u.cancel(),DL()}},[]);const r=Im(()=>[...Ji].filter(a=>!rne.has(a)&&!TL.has(a)),[n]),[i]=TH(),[s]=K2(),[o]=Xoe();return Ve("div",{ref:t,className:"lingo3d-ui lingo3d-bg",onClick:()=>Ki(),style:{width:200,height:"100%",paddingTop:0,display:"flex",flexDirection:"column"},children:[Ve(aae,{title:"scenegraph",children:[Ve(Q3,{disabled:!o,onClick:()=>{(o==null?void 0:o.name)&&s instanceof Bl&&setTimeout(()=>Ki(s.find(o.name)))},children:Ve(w4e,{})}),Ve(Q3,{disabled:!i.length,onClick:kSe,children:Ve(x4e,{})}),Ve(Q3,{disabled:!s,onClick:tae,children:Ve(b4e,{})})]}),Ve("div",{style:{overflow:"scroll",flexGrow:1},className:"lingo3d-ui",children:Ve(v4e,{children:[r.map(a=>a instanceof ih?Ve(Qoe,{appendable:a},a.uuid):Ve(DH,{appendable:a},a.uuid)),Ve(V4e,{onDrop:a=>{var c,u;_3(),Ji.add(a),Qt.attach(a.outerObject3d),(u=(c=a.parent)==null?void 0:c.children)==null||u.delete(a),a.parent=void 0}})]})}),Ve(k4e,{})]})};$m(lae,"lingo3d-scenegraph");var YU={exports:{}};/*! Tweakpane 3.1.0 (c) 2016 cocopon, licensed under the MIT license. */(function(n,e){(function(t,r){r(e)})(At,function(t){class r{constructor(g){const[b,L]=g.split("-"),Q=b.split(".");this.major=parseInt(Q[0],10),this.minor=parseInt(Q[1],10),this.patch=parseInt(Q[2],10),this.prerelease=L!=null?L:null}toString(){const g=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[g,this.prerelease].join("-"):g}}class i{constructor(g){this.controller_=g}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(g){this.controller_.viewProps.set("disabled",g)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(g){this.controller_.viewProps.set("hidden",g)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class s{constructor(g){this.target=g}}class o extends s{constructor(g,b,L,Q){super(g),this.value=b,this.presetKey=L,this.last=Q!=null?Q:!0}}class a extends s{constructor(g,b,L){super(g),this.value=b,this.presetKey=L}}class c extends s{constructor(g,b){super(g),this.expanded=b}}class u extends s{constructor(g,b){super(g),this.index=b}}function d(M){return M==null}function p(M,g){if(M.length!==g.length)return!1;for(let b=0;b<M.length;b++)if(M[b]!==g[b])return!1;return!0}const f={alreadydisposed:()=>"View has been already disposed",invalidparams:M=>`Invalid parameters for '${M.name}'`,nomatchingcontroller:M=>`No matching controller for '${M.key}'`,nomatchingview:M=>`No matching view for '${JSON.stringify(M.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:M=>`Property '${M.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class v{constructor(g){var b;this.message=(b=f[g.type](g.context))!==null&&b!==void 0?b:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=g.type}static alreadyDisposed(){return new v({type:"alreadydisposed"})}static notBindable(){return new v({type:"notbindable"})}static propertyNotFound(g){return new v({type:"propertynotfound",context:{name:g}})}static shouldNeverHappen(){return new v({type:"shouldneverhappen"})}}class x{constructor(g,b,L){this.obj_=g,this.key_=b,this.presetKey_=L!=null?L:b}static isBindable(g){return!(g===null||typeof g!="object")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(g){this.obj_[this.key_]=g}writeProperty(g,b){const L=this.read();if(!x.isBindable(L))throw v.notBindable();if(!(g in L))throw v.propertyNotFound(g);L[g]=b}}class y extends i{get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}get title(){var g;return(g=this.controller_.valueController.props.get("title"))!==null&&g!==void 0?g:""}set title(g){this.controller_.valueController.props.set("title",g)}on(g,b){const L=b.bind(this);return this.controller_.valueController.emitter.on(g,()=>{L(new s(this))}),this}}class _{constructor(){this.observers_={}}on(g,b){let L=this.observers_[g];return L||(L=this.observers_[g]=[]),L.push({handler:b}),this}off(g,b){const L=this.observers_[g];return L&&(this.observers_[g]=L.filter(Q=>Q.handler!==b)),this}emit(g,b){const L=this.observers_[g];!L||L.forEach(Q=>{Q.handler(b)})}}const S="tp";function C(M){return(g,b)=>[S,"-",M,"v",g?`_${g}`:"",b?`-${b}`:""].join("")}function A(M,g){return b=>g(M(b))}function P(M){return M.rawValue}function D(M,g){M.emitter.on("change",A(P,g)),g(M.rawValue)}function N(M,g,b){D(M.value(g),b)}function j(M,g,b){b?M.classList.add(g):M.classList.remove(g)}function T(M,g){return b=>{j(M,g,b)}}function k(M,g){D(M,b=>{g.textContent=b!=null?b:""})}const U=C("btn");class ee{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(U()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("button");L.classList.add(U("b")),b.viewProps.bindDisabled(L),this.element.appendChild(L),this.buttonElement=L;const Q=g.createElement("div");Q.classList.add(U("t")),k(b.props.value("title"),Q),this.buttonElement.appendChild(Q)}}class xe{constructor(g,b){this.emitter=new _,this.onClick_=this.onClick_.bind(this),this.props=b.props,this.viewProps=b.viewProps,this.view=new ee(g,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ce{constructor(g,b){var L;this.constraint_=b==null?void 0:b.constraint,this.equals_=(L=b==null?void 0:b.equals)!==null&&L!==void 0?L:(Q,Pe)=>Q===Pe,this.emitter=new _,this.rawValue_=g}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(g){this.setRawValue(g,{forceEmit:!1,last:!0})}setRawValue(g,b){const L=b!=null?b:{forceEmit:!1,last:!0},Q=this.constraint_?this.constraint_.constrain(g):g;!!this.equals_(this.rawValue_,Q)&&!L.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=Q,this.emitter.emit("change",{options:L,rawValue:Q,sender:this}))}}class te{constructor(g){this.emitter=new _,this.value_=g}get rawValue(){return this.value_}set rawValue(g){this.setRawValue(g,{forceEmit:!1,last:!0})}setRawValue(g,b){const L=b!=null?b:{forceEmit:!1,last:!0};this.value_===g&&!L.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=g,this.emitter.emit("change",{options:L,rawValue:this.value_,sender:this}))}}function fe(M,g){const b=g==null?void 0:g.constraint,L=g==null?void 0:g.equals;return!b&&!L?new te(M):new ce(M,g)}class ge{constructor(g){this.emitter=new _,this.valMap_=g;for(const b in this.valMap_)this.valMap_[b].emitter.on("change",()=>{this.emitter.emit("change",{key:b,sender:this})})}static createCore(g){return Object.keys(g).reduce((b,L)=>Object.assign(b,{[L]:fe(g[L])}),{})}static fromObject(g){const b=this.createCore(g);return new ge(b)}get(g){return this.valMap_[g].rawValue}set(g,b){this.valMap_[g].rawValue=b}value(g){return this.valMap_[g]}}function Se(M,g){return Object.keys(g).reduce((L,Q)=>{if(L===void 0)return;const Pe=g[Q],Ye=Pe(M[Q]);return Ye.succeeded?Object.assign(Object.assign({},L),{[Q]:Ye.value}):void 0},{})}function pe(M,g){return M.reduce((b,L)=>{if(b===void 0)return;const Q=g(L);if(!(!Q.succeeded||Q.value===void 0))return[...b,Q.value]},[])}function se(M){return M===null?!1:typeof M=="object"}function ae(M){return g=>b=>{if(!g&&b===void 0)return{succeeded:!1,value:void 0};if(g&&b===void 0)return{succeeded:!0,value:void 0};const L=M(b);return L!==void 0?{succeeded:!0,value:L}:{succeeded:!1,value:void 0}}}function Le(M){return{custom:g=>ae(g)(M),boolean:ae(g=>typeof g=="boolean"?g:void 0)(M),number:ae(g=>typeof g=="number"?g:void 0)(M),string:ae(g=>typeof g=="string"?g:void 0)(M),function:ae(g=>typeof g=="function"?g:void 0)(M),constant:g=>ae(b=>b===g?g:void 0)(M),raw:ae(g=>g)(M),object:g=>ae(b=>{if(se(b))return Se(b,g)})(M),array:g=>ae(b=>{if(Array.isArray(b))return pe(b,g)})(M)}}const Re={optional:Le(!0),required:Le(!1)};function Ue(M,g){const b=Re.required.object(g)(M);return b.succeeded?b.value:void 0}function Ze(M){return M&&M.parentElement&&M.parentElement.removeChild(M),null}function st(){return["veryfirst","first","last","verylast"]}const we=C(""),Mt={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class rt{constructor(g){this.parent_=null,this.blade=g.blade,this.view=g.view,this.viewProps=g.viewProps;const b=this.view.element;this.blade.value("positions").emitter.on("change",()=>{st().forEach(L=>{b.classList.remove(we(void 0,Mt[L]))}),this.blade.get("positions").forEach(L=>{b.classList.add(we(void 0,Mt[L]))})}),this.viewProps.handleDispose(()=>{Ze(b)})}get parent(){return this.parent_}}const it="http://www.w3.org/2000/svg";function Ke(M){M.offsetHeight}function Qe(M,g){const b=M.style.transition;M.style.transition="none",g(),M.style.transition=b}function Y(M){return M.ontouchstart!==void 0}function K(){return new Function("return this")()}function ve(){return K().document}function Ae(M){const g=M.ownerDocument.defaultView;return g&&"document"in g?M.getContext("2d"):null}const De={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function je(M,g){const b=M.createElementNS(it,"svg");return b.innerHTML=De[g],b}function Xe(M,g,b){M.insertBefore(g,M.children[b])}function He(M){M.parentElement&&M.parentElement.removeChild(M)}function ne(M){for(;M.children.length>0;)M.removeChild(M.children[0])}function W(M){for(;M.childNodes.length>0;)M.removeChild(M.childNodes[0])}function O(M){return M.relatedTarget?M.relatedTarget:"explicitOriginalTarget"in M?M.explicitOriginalTarget:null}const E=C("lbl");function F(M,g){const b=M.createDocumentFragment();return g.split(`
`).map(L=>M.createTextNode(L)).forEach((L,Q)=>{Q>0&&b.appendChild(M.createElement("br")),b.appendChild(L)}),b}class z{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(E()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("div");L.classList.add(E("l")),N(b.props,"label",Pe=>{d(Pe)?this.element.classList.add(E(void 0,"nol")):(this.element.classList.remove(E(void 0,"nol")),W(L),L.appendChild(F(g,Pe)))}),this.element.appendChild(L),this.labelElement=L;const Q=g.createElement("div");Q.classList.add(E("v")),this.element.appendChild(Q),this.valueElement=Q}}class Z extends rt{constructor(g,b){const L=b.valueController.viewProps;super(Object.assign(Object.assign({},b),{view:new z(g,{props:b.props,viewProps:L}),viewProps:L})),this.props=b.props,this.valueController=b.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const de={id:"button",type:"blade",accept(M){const g=Re,b=Ue(M,{title:g.required.string,view:g.required.constant("button"),label:g.optional.string});return b?{params:b}:null},controller(M){return new Z(M.document,{blade:M.blade,props:ge.fromObject({label:M.params.label}),valueController:new xe(M.document,{props:ge.fromObject({title:M.params.title}),viewProps:M.viewProps})})},api(M){return!(M.controller instanceof Z)||!(M.controller.valueController instanceof xe)?null:new y(M.controller)}};class be extends rt{constructor(g){super(g),this.value=g.value}}function oe(){return new ge({positions:fe([],{equals:p})})}class ze extends ge{constructor(g){super(g)}static create(g){const b={completed:!0,expanded:g,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},L=ge.createCore(b);return new ze(L)}get styleExpanded(){var g;return(g=this.get("temporaryExpanded"))!==null&&g!==void 0?g:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const g=this.get("expandedHeight");return this.get("shouldFixHeight")&&!d(g)?`${g}px`:"auto"}bindExpandedClass(g,b){const L=()=>{this.styleExpanded?g.classList.add(b):g.classList.remove(b)};N(this,"expanded",L),N(this,"temporaryExpanded",L)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function ke(M,g){let b=0;return Qe(g,()=>{M.set("expandedHeight",null),M.set("temporaryExpanded",!0),Ke(g),b=g.clientHeight,M.set("temporaryExpanded",null),Ke(g)}),b}function Fe(M,g){g.style.height=M.styleHeight}function Ge(M,g){M.value("expanded").emitter.on("beforechange",()=>{M.set("completed",!1),d(M.get("expandedHeight"))&&M.set("expandedHeight",ke(M,g)),M.set("shouldFixHeight",!0),Ke(g)}),M.emitter.on("change",()=>{Fe(M,g)}),Fe(M,g),g.addEventListener("transitionend",b=>{b.propertyName==="height"&&M.cleanUpTransition()})}class at extends i{constructor(g,b){super(g),this.rackApi_=b}}function pt(M,g){return M.addBlade(Object.assign(Object.assign({},g),{view:"button"}))}function Dt(M,g){return M.addBlade(Object.assign(Object.assign({},g),{view:"folder"}))}function re(M,g){const b=g!=null?g:{};return M.addBlade(Object.assign(Object.assign({},b),{view:"separator"}))}function $e(M,g){return M.addBlade(Object.assign(Object.assign({},g),{view:"tab"}))}class Me{constructor(g){this.emitter=new _,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=g}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(g){for(const b of this.allItems())if(g(b))return b;return null}includes(g){return this.cache_.has(g)}add(g,b){if(this.includes(g))throw v.shouldNeverHappen();const L=b!==void 0?b:this.items_.length;this.items_.splice(L,0,g),this.cache_.add(g);const Q=this.extract_(g);Q&&(Q.emitter.on("add",this.onSubListAdd_),Q.emitter.on("remove",this.onSubListRemove_),Q.allItems().forEach(Pe=>{this.cache_.add(Pe)})),this.emitter.emit("add",{index:L,item:g,root:this,target:this})}remove(g){const b=this.items_.indexOf(g);if(b<0)return;this.items_.splice(b,1),this.cache_.delete(g);const L=this.extract_(g);L&&(L.emitter.off("add",this.onSubListAdd_),L.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:b,item:g,root:this,target:this})}onSubListAdd_(g){this.cache_.add(g.item),this.emitter.emit("add",{index:g.index,item:g.item,root:this,target:g.target})}onSubListRemove_(g){this.cache_.delete(g.item),this.emitter.emit("remove",{index:g.index,item:g.item,root:this,target:g.target})}}class tt extends i{constructor(g){super(g),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new _,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(g){const b=g.sender.target.read();this.emitter_.emit("change",{event:new o(this,b,this.controller_.binding.target.presetKey,g.options.last)})}}class Je extends Z{constructor(g,b){super(g,b),this.binding=b.binding}}class Ft extends i{constructor(g){super(g),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new _,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(g){const b=g.sender.target.read();this.emitter_.emit("update",{event:new a(this,b,this.controller_.binding.target.presetKey)})}}class vn extends Z{constructor(g,b){super(g,b),this.binding=b.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function hn(M){return M instanceof xr?M.apiSet_:M instanceof at?M.rackApi_.apiSet_:null}function zr(M,g){const b=M.find(L=>L.controller_===g);if(!b)throw v.shouldNeverHappen();return b}function qt(M,g,b){if(!x.isBindable(M))throw v.notBindable();return new x(M,g,b)}class xr extends i{constructor(g,b){super(g),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new _,this.apiSet_=new Me(hn),this.pool_=b;const L=this.controller_.rack;L.emitter.on("add",this.onRackAdd_),L.emitter.on("remove",this.onRackRemove_),L.emitter.on("inputchange",this.onRackInputChange_),L.emitter.on("monitorupdate",this.onRackMonitorUpdate_),L.children.forEach(Q=>{this.setUpApi_(Q)})}get children(){return this.controller_.rack.children.map(g=>zr(this.apiSet_,g))}addInput(g,b,L){const Q=L!=null?L:{},Pe=this.controller_.view.element.ownerDocument,Ye=this.pool_.createInput(Pe,qt(g,b,Q.presetKey),Q),_t=new tt(Ye);return this.add(_t,Q.index)}addMonitor(g,b,L){const Q=L!=null?L:{},Pe=this.controller_.view.element.ownerDocument,Ye=this.pool_.createMonitor(Pe,qt(g,b),Q),_t=new Ft(Ye);return this.add(_t,Q.index)}addFolder(g){return Dt(this,g)}addButton(g){return pt(this,g)}addSeparator(g){return re(this,g)}addTab(g){return $e(this,g)}add(g,b){this.controller_.rack.add(g.controller_,b);const L=this.apiSet_.find(Q=>Q.controller_===g.controller_);return L&&this.apiSet_.remove(L),this.apiSet_.add(g),g}remove(g){this.controller_.rack.remove(g.controller_)}addBlade(g){const b=this.controller_.view.element.ownerDocument,L=this.pool_.createBlade(b,g),Q=this.pool_.createBladeApi(L);return this.add(Q,g.index)}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}setUpApi_(g){this.apiSet_.find(b=>b.controller_===g)||this.apiSet_.add(this.pool_.createBladeApi(g))}onRackAdd_(g){this.setUpApi_(g.bladeController)}onRackRemove_(g){if(g.isRoot){const b=zr(this.apiSet_,g.bladeController);this.apiSet_.remove(b)}}onRackInputChange_(g){const b=g.bladeController;if(b instanceof Je){const L=zr(this.apiSet_,b),Q=b.binding;this.emitter_.emit("change",{event:new o(L,Q.target.read(),Q.target.presetKey,g.options.last)})}else if(b instanceof be){const L=zr(this.apiSet_,b);this.emitter_.emit("change",{event:new o(L,b.value.rawValue,void 0,g.options.last)})}}onRackMonitorUpdate_(g){if(!(g.bladeController instanceof vn))throw v.shouldNeverHappen();const b=zr(this.apiSet_,g.bladeController),L=g.bladeController.binding;this.emitter_.emit("update",{event:new a(b,L.target.read(),L.target.presetKey)})}}class or extends at{constructor(g,b){super(g,new xr(g.rackController,b)),this.emitter_=new _,this.controller_.foldable.value("expanded").emitter.on("change",L=>{this.emitter_.emit("fold",{event:new c(this,L.sender.rawValue)})}),this.rackApi_.on("change",L=>{this.emitter_.emit("change",{event:L})}),this.rackApi_.on("update",L=>{this.emitter_.emit("update",{event:L})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(g){this.controller_.foldable.set("expanded",g)}get title(){return this.controller_.props.get("title")}set title(g){this.controller_.props.set("title",g)}get children(){return this.rackApi_.children}addInput(g,b,L){return this.rackApi_.addInput(g,b,L)}addMonitor(g,b,L){return this.rackApi_.addMonitor(g,b,L)}addFolder(g){return this.rackApi_.addFolder(g)}addButton(g){return this.rackApi_.addButton(g)}addSeparator(g){return this.rackApi_.addSeparator(g)}addTab(g){return this.rackApi_.addTab(g)}add(g,b){return this.rackApi_.add(g,b)}remove(g){this.rackApi_.remove(g)}addBlade(g){return this.rackApi_.addBlade(g)}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}}class Ul extends rt{constructor(g){super({blade:g.blade,view:g.view,viewProps:g.rackController.viewProps}),this.rackController=g.rackController}}class Vo{constructor(g,b){const L=C(b.viewName);this.element=g.createElement("div"),this.element.classList.add(L()),b.viewProps.bindClassModifiers(this.element)}}function Fo(M,g){for(let b=0;b<M.length;b++){const L=M[b];if(L instanceof Je&&L.binding===g)return L}return null}function Lc(M,g){for(let b=0;b<M.length;b++){const L=M[b];if(L instanceof vn&&L.binding===g)return L}return null}function va(M,g){for(let b=0;b<M.length;b++){const L=M[b];if(L instanceof be&&L.value===g)return L}return null}function ei(M){return M instanceof Ce?M.rack:M instanceof Ul?M.rackController.rack:null}function H(M){const g=ei(M);return g?g.bcSet_:null}class me{constructor(g){var b;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new _,this.blade_=g!=null?g:null,(b=this.blade_)===null||b===void 0||b.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new Me(H),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(g,b){g.parent&&g.parent.remove(g),g.parent_=this,this.bcSet_.add(g,b)}remove(g){g.parent_=null,this.bcSet_.remove(g)}find(g){return this.bcSet_.allItems().filter(b=>b instanceof g)}onSetAdd_(g){this.updatePositions_();const b=g.target===g.root;if(this.emitter.emit("add",{bladeController:g.item,index:g.index,isRoot:b,sender:this}),!b)return;const L=g.item;if(L.viewProps.emitter.on("change",this.onChildViewPropsChange_),L.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),L.viewProps.handleDispose(this.onChildDispose_),L instanceof Je)L.binding.emitter.on("change",this.onChildInputChange_);else if(L instanceof vn)L.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(L instanceof be)L.value.emitter.on("change",this.onChildValueChange_);else{const Q=ei(L);if(Q){const Pe=Q.emitter;Pe.on("layout",this.onDescendantLayout_),Pe.on("inputchange",this.onDescendantInputChange_),Pe.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(g){this.updatePositions_();const b=g.target===g.root;if(this.emitter.emit("remove",{bladeController:g.item,isRoot:b,sender:this}),!b)return;const L=g.item;if(L instanceof Je)L.binding.emitter.off("change",this.onChildInputChange_);else if(L instanceof vn)L.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(L instanceof be)L.value.emitter.off("change",this.onChildValueChange_);else{const Q=ei(L);if(Q){const Pe=Q.emitter;Pe.off("layout",this.onDescendantLayout_),Pe.off("inputchange",this.onDescendantInputChange_),Pe.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const g=this.bcSet_.items.filter(Q=>!Q.viewProps.get("hidden")),b=g[0],L=g[g.length-1];this.bcSet_.items.forEach(Q=>{const Pe=[];Q===b&&(Pe.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&Pe.push("veryfirst")),Q===L&&(Pe.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&Pe.push("verylast")),Q.blade.set("positions",Pe)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(g){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(g=>g.viewProps.get("disposed")).forEach(g=>{this.bcSet_.remove(g)})}onChildInputChange_(g){const b=Fo(this.find(Je),g.sender);if(!b)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:g.options,sender:this})}onChildMonitorUpdate_(g){const b=Lc(this.find(vn),g.sender);if(!b)throw v.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:b,sender:this})}onChildValueChange_(g){const b=va(this.find(be),g.sender);if(!b)throw v.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:g.options,sender:this})}onDescendantLayout_(g){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(g){this.emitter.emit("inputchange",{bladeController:g.bladeController,options:g.options,sender:this})}onDescendantMonitorUpdate_(g){this.emitter.emit("monitorupdate",{bladeController:g.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Ce extends rt{constructor(g,b){super(Object.assign(Object.assign({},b),{view:new Vo(g,{viewName:"brk",viewProps:b.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const L=new me(b.root?void 0:b.blade);L.emitter.on("add",this.onRackAdd_),L.emitter.on("remove",this.onRackRemove_),this.rack=L,this.viewProps.handleDispose(()=>{for(let Q=this.rack.children.length-1;Q>=0;Q--)this.rack.children[Q].viewProps.set("disposed",!0)})}onRackAdd_(g){!g.isRoot||Xe(this.view.element,g.bladeController.view.element,g.index)}onRackRemove_(g){!g.isRoot||He(g.bladeController.view.element)}}const ue=C("cnt");class Oe{constructor(g,b){var L;this.className_=C((L=b.viewName)!==null&&L!==void 0?L:"fld"),this.element=g.createElement("div"),this.element.classList.add(this.className_(),ue()),b.viewProps.bindClassModifiers(this.element),this.foldable_=b.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),N(this.foldable_,"completed",T(this.element,this.className_(void 0,"cpl")));const Q=g.createElement("button");Q.classList.add(this.className_("b")),N(b.props,"title",Kt=>{d(Kt)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),b.viewProps.bindDisabled(Q),this.element.appendChild(Q),this.buttonElement=Q;const Pe=g.createElement("div");Pe.classList.add(this.className_("t")),k(b.props.value("title"),Pe),this.buttonElement.appendChild(Pe),this.titleElement=Pe;const Ye=g.createElement("div");Ye.classList.add(this.className_("m")),this.buttonElement.appendChild(Ye);const _t=b.containerElement;_t.classList.add(this.className_("c")),this.element.appendChild(_t),this.containerElement=_t}}class lt extends Ul{constructor(g,b){var L;const Q=ze.create((L=b.expanded)!==null&&L!==void 0?L:!0),Pe=new Ce(g,{blade:b.blade,root:b.root,viewProps:b.viewProps});super(Object.assign(Object.assign({},b),{rackController:Pe,view:new Oe(g,{containerElement:Pe.view.element,foldable:Q,props:b.props,viewName:b.root?"rot":void 0,viewProps:b.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=b.props,this.foldable=Q,Ge(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const xt={id:"folder",type:"blade",accept(M){const g=Re,b=Ue(M,{title:g.required.string,view:g.required.constant("folder"),expanded:g.optional.boolean});return b?{params:b}:null},controller(M){return new lt(M.document,{blade:M.blade,expanded:M.params.expanded,props:ge.fromObject({title:M.params.title}),viewProps:M.viewProps})},api(M){return M.controller instanceof lt?new or(M.controller,M.pool):null}};class bt extends be{constructor(g,b){const L=b.valueController.viewProps;super(Object.assign(Object.assign({},b),{value:b.valueController.value,view:new z(g,{props:b.props,viewProps:L}),viewProps:L})),this.props=b.props,this.valueController=b.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class wt extends i{}const Zt=C("spr");class kt{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Zt()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("hr");L.classList.add(Zt("r")),this.element.appendChild(L)}}class It extends rt{constructor(g,b){super(Object.assign(Object.assign({},b),{view:new kt(g,{viewProps:b.viewProps})}))}}const gn={id:"separator",type:"blade",accept(M){const g=Ue(M,{view:Re.required.constant("separator")});return g?{params:g}:null},controller(M){return new It(M.document,{blade:M.blade,viewProps:M.viewProps})},api(M){return M.controller instanceof It?new wt(M.controller):null}},Bi=C("");function Mr(M,g){return T(M,Bi(void 0,g))}class Ln extends ge{constructor(g){super(g)}static create(g){var b,L;const Q=g!=null?g:{},Pe={disabled:(b=Q.disabled)!==null&&b!==void 0?b:!1,disposed:!1,hidden:(L=Q.hidden)!==null&&L!==void 0?L:!1},Ye=ge.createCore(Pe);return new Ln(Ye)}bindClassModifiers(g){N(this,"disabled",Mr(g,"disabled")),N(this,"hidden",Mr(g,"hidden"))}bindDisabled(g){N(this,"disabled",b=>{g.disabled=b})}bindTabIndex(g){N(this,"disabled",b=>{g.tabIndex=b?-1:0})}handleDispose(g){this.value("disposed").emitter.on("change",b=>{b&&g()})}}const Dn=C("tbi");class Wt{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Dn()),b.viewProps.bindClassModifiers(this.element),N(b.props,"selected",Pe=>{Pe?this.element.classList.add(Dn(void 0,"sel")):this.element.classList.remove(Dn(void 0,"sel"))});const L=g.createElement("button");L.classList.add(Dn("b")),b.viewProps.bindDisabled(L),this.element.appendChild(L),this.buttonElement=L;const Q=g.createElement("div");Q.classList.add(Dn("t")),k(b.props.value("title"),Q),this.buttonElement.appendChild(Q),this.titleElement=Q}}class ts{constructor(g,b){this.emitter=new _,this.onClick_=this.onClick_.bind(this),this.props=b.props,this.viewProps=b.viewProps,this.view=new Wt(g,{props:b.props,viewProps:b.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Fn{constructor(g,b){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ts(g,{props:b.itemProps,viewProps:Ln.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Ce(g,{blade:oe(),viewProps:Ln.create()}),this.props=b.props,N(this.props,"selected",L=>{this.itemController.props.set("selected",L),this.contentController.viewProps.set("hidden",!L)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Zn{constructor(g,b){this.controller_=g,this.rackApi_=b}get title(){var g;return(g=this.controller_.itemController.props.get("title"))!==null&&g!==void 0?g:""}set title(g){this.controller_.itemController.props.set("title",g)}get selected(){return this.controller_.props.get("selected")}set selected(g){this.controller_.props.set("selected",g)}get children(){return this.rackApi_.children}addButton(g){return this.rackApi_.addButton(g)}addFolder(g){return this.rackApi_.addFolder(g)}addSeparator(g){return this.rackApi_.addSeparator(g)}addTab(g){return this.rackApi_.addTab(g)}add(g,b){this.rackApi_.add(g,b)}remove(g){this.rackApi_.remove(g)}addInput(g,b,L){return this.rackApi_.addInput(g,b,L)}addMonitor(g,b,L){return this.rackApi_.addMonitor(g,b,L)}addBlade(g){return this.rackApi_.addBlade(g)}}class Cr extends at{constructor(g,b){super(g,new xr(g.rackController,b)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new _,this.pageApiMap_=new Map,this.rackApi_.on("change",L=>{this.emitter_.emit("change",{event:L})}),this.rackApi_.on("update",L=>{this.emitter_.emit("update",{event:L})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(L=>{this.setUpPageApi_(L)})}get pages(){return this.controller_.pageSet.items.map(g=>{const b=this.pageApiMap_.get(g);if(!b)throw v.shouldNeverHappen();return b})}addPage(g){const b=this.controller_.view.element.ownerDocument,L=new Fn(b,{itemProps:ge.fromObject({selected:!1,title:g.title}),props:ge.fromObject({selected:!1})});this.controller_.add(L,g.index);const Q=this.pageApiMap_.get(L);if(!Q)throw v.shouldNeverHappen();return Q}removePage(g){this.controller_.remove(g)}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}setUpPageApi_(g){const b=this.rackApi_.apiSet_.find(Q=>Q.controller_===g.contentController);if(!b)throw v.shouldNeverHappen();const L=new Zn(g,b);this.pageApiMap_.set(g,L)}onPageAdd_(g){this.setUpPageApi_(g.item)}onPageRemove_(g){if(!this.pageApiMap_.get(g.item))throw v.shouldNeverHappen();this.pageApiMap_.delete(g.item)}onSelect_(g){this.emitter_.emit("select",{event:new u(this,g.rawValue)})}}const Xr=-1;class Ts{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=fe(!0),this.selectedIndex=fe(Xr),this.items_=[]}add(g,b){const L=b!=null?b:this.items_.length;this.items_.splice(L,0,g),g.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(g){const b=this.items_.indexOf(g);b<0||(this.items_.splice(b,1),g.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Xr,this.empty.rawValue=!0;return}const g=this.items_.findIndex(b=>b.rawValue);g<0?(this.items_.forEach((b,L)=>{b.rawValue=L===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((b,L)=>{b.rawValue=L===g}),this.selectedIndex.rawValue=g),this.empty.rawValue=!1}onItemSelectedChange_(g){if(g.rawValue){const b=this.items_.findIndex(L=>L===g.sender);this.items_.forEach((L,Q)=>{L.rawValue=Q===b}),this.selectedIndex.rawValue=b}else this.keepSelection_()}}const Rn=C("tab");class Vi{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Rn(),ue()),b.viewProps.bindClassModifiers(this.element),D(b.empty,T(this.element,Rn(void 0,"nop")));const L=g.createElement("div");L.classList.add(Rn("i")),this.element.appendChild(L),this.itemsElement=L;const Q=b.contentsElement;Q.classList.add(Rn("c")),this.element.appendChild(Q),this.contentsElement=Q}}class Uo extends Ul{constructor(g,b){const L=new Ce(g,{blade:b.blade,viewProps:b.viewProps}),Q=new Ts;super({blade:b.blade,rackController:L,view:new Vi(g,{contentsElement:L.view.element,empty:Q.empty,viewProps:b.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Me(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=Q}get pageSet(){return this.pageSet_}add(g,b){this.pageSet_.add(g,b)}remove(g){this.pageSet_.remove(this.pageSet_.items[g])}onPageAdd_(g){const b=g.item;Xe(this.view.itemsElement,b.itemController.view.element,g.index),this.rackController.rack.add(b.contentController,g.index),this.tab.add(b.props.value("selected"))}onPageRemove_(g){const b=g.item;He(b.itemController.view.element),this.rackController.rack.remove(b.contentController),this.tab.remove(b.props.value("selected"))}}const Un={id:"tab",type:"blade",accept(M){const g=Re,b=Ue(M,{pages:g.required.array(g.required.object({title:g.required.string})),view:g.required.constant("tab")});return!b||b.pages.length===0?null:{params:b}},controller(M){const g=new Uo(M.document,{blade:M.blade,viewProps:M.viewProps});return M.params.pages.forEach(b=>{const L=new Fn(M.document,{itemProps:ge.fromObject({selected:!1,title:b.title}),props:ge.fromObject({selected:!1})});g.add(L)}),g},api(M){return M.controller instanceof Uo?new Cr(M.controller,M.pool):null}};function fs(M,g){const b=M.accept(g.params);if(!b)return null;const L=Re.optional.boolean(g.params.disabled).value,Q=Re.optional.boolean(g.params.hidden).value;return M.controller({blade:oe(),document:g.document,params:Object.assign(Object.assign({},b.params),{disabled:L,hidden:Q}),viewProps:Ln.create({disabled:L,hidden:Q})})}class jl{constructor(){this.disabled=!1,this.emitter=new _}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class jo{constructor(g,b){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=g,this.emitter=new _,this.interval_=b,this.setTimer_()}get disabled(){return this.disabled_}set disabled(g){this.disabled_=g,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const g=this.doc_.defaultView;g&&g.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const g=this.doc_.defaultView;g&&(this.timerId_=g.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Hl{constructor(g){this.constraints=g}constrain(g){return this.constraints.reduce((b,L)=>L.constrain(b),g)}}function Rs(M,g){if(M instanceof g)return M;if(M instanceof Hl){const b=M.constraints.reduce((L,Q)=>L||(Q instanceof g?Q:null),null);if(b)return b}return null}class Ho{constructor(g){this.options=g}constrain(g){const b=this.options;return b.length===0||b.filter(L=>L.value===g).length>0?g:b[0].value}}class Fa{constructor(g){this.maxValue=g.max,this.minValue=g.min}constrain(g){let b=g;return d(this.minValue)||(b=Math.max(b,this.minValue)),d(this.maxValue)||(b=Math.min(b,this.maxValue)),b}}class fh{constructor(g,b=0){this.step=g,this.origin=b}constrain(g){const b=this.origin%this.step,L=Math.round((g-b)/this.step);return b+L*this.step}}const Wo=C("lst");class md{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),this.props_=b.props,this.element=g.createElement("div"),this.element.classList.add(Wo()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("select");L.classList.add(Wo("s")),N(this.props_,"options",Pe=>{ne(L),Pe.forEach((Ye,_t)=>{const Kt=g.createElement("option");Kt.dataset.index=String(_t),Kt.textContent=Ye.text,Kt.value=String(Ye.value),L.appendChild(Kt)})}),b.viewProps.bindDisabled(L),this.element.appendChild(L),this.selectElement=L;const Q=g.createElement("div");Q.classList.add(Wo("m")),Q.appendChild(je(g,"dropdown")),this.element.appendChild(Q),b.value.emitter.on("change",this.onValueChange_),this.value_=b.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ua{constructor(g,b){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=b.props,this.value=b.value,this.viewProps=b.viewProps,this.view=new md(g,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(g){const b=g.currentTarget.selectedOptions.item(0);if(!b)return;const L=Number(b.dataset.index);this.value.rawValue=this.props.get("options")[L].value}}const vd=C("pop");class mh{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(vd()),b.viewProps.bindClassModifiers(this.element),D(b.shows,T(this.element,vd(void 0,"v")))}}class xl{constructor(g,b){this.shows=fe(!1),this.viewProps=b.viewProps,this.view=new mh(g,{shows:this.shows,viewProps:this.viewProps})}}const bl=C("txt");class Go{constructor(g,b){this.onChange_=this.onChange_.bind(this),this.element=g.createElement("div"),this.element.classList.add(bl()),b.viewProps.bindClassModifiers(this.element),this.props_=b.props,this.props_.emitter.on("change",this.onChange_);const L=g.createElement("input");L.classList.add(bl("i")),L.type="text",b.viewProps.bindDisabled(L),this.element.appendChild(L),this.inputElement=L,b.value.emitter.on("change",this.onChange_),this.value_=b.value,this.refresh()}refresh(){const g=this.props_.get("formatter");this.inputElement.value=g(this.value_.rawValue)}onChange_(){this.refresh()}}class Dc{constructor(g,b){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=b.parser,this.props=b.props,this.value=b.value,this.viewProps=b.viewProps,this.view=new Go(g,{props:b.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(g){const b=g.currentTarget.value,L=this.parser_(b);d(L)||(this.value.rawValue=L),this.view.refresh()}}function pu(M){return String(M)}function df(M){return M==="false"?!1:!!M}function fu(M){return pu(M)}class gd{constructor(g){this.text=g}evaluate(){return Number(this.text)}toString(){return this.text}}const _d={"**":(M,g)=>Math.pow(M,g),"*":(M,g)=>M*g,"/":(M,g)=>M/g,"%":(M,g)=>M%g,"+":(M,g)=>M+g,"-":(M,g)=>M-g,"<<":(M,g)=>M<<g,">>":(M,g)=>M>>g,">>>":(M,g)=>M>>>g,"&":(M,g)=>M&g,"^":(M,g)=>M^g,"|":(M,g)=>M|g};class Li{constructor(g,b,L){this.left=b,this.operator=g,this.right=L}evaluate(){const g=_d[this.operator];if(!g)throw new Error(`unexpected binary operator: '${this.operator}`);return g(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const hv={"+":M=>M,"-":M=>-M,"~":M=>~M};class Wl{constructor(g,b){this.operator=g,this.expression=b}evaluate(){const g=hv[this.operator];if(!g)throw new Error(`unexpected unary operator: '${this.operator}`);return g(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function mu(M){return(g,b)=>{for(let L=0;L<M.length;L++){const Q=M[L](g,b);if(Q!=="")return Q}return""}}function ja(M,g){var b;const L=M.substr(g).match(/^\s+/);return(b=L&&L[0])!==null&&b!==void 0?b:""}function dv(M,g){const b=M.substr(g,1);return b.match(/^[1-9]$/)?b:""}function X(M,g){var b;const L=M.substr(g).match(/^[0-9]+/);return(b=L&&L[0])!==null&&b!==void 0?b:""}function B(M,g){const b=X(M,g);if(b!=="")return b;const L=M.substr(g,1);if(g+=1,L!=="-"&&L!=="+")return"";const Q=X(M,g);return Q===""?"":L+Q}function q(M,g){const b=M.substr(g,1);if(g+=1,b.toLowerCase()!=="e")return"";const L=B(M,g);return L===""?"":b+L}function he(M,g){const b=M.substr(g,1);if(b==="0")return b;const L=dv(M,g);return g+=L.length,L===""?"":L+X(M,g)}function qe(M,g){const b=he(M,g);if(g+=b.length,b==="")return"";const L=M.substr(g,1);if(g+=L.length,L!==".")return"";const Q=X(M,g);return g+=Q.length,b+L+Q+q(M,g)}function dt(M,g){const b=M.substr(g,1);if(g+=b.length,b!==".")return"";const L=X(M,g);return g+=L.length,L===""?"":b+L+q(M,g)}function on(M,g){const b=he(M,g);return g+=b.length,b===""?"":b+q(M,g)}const Gt=mu([qe,dt,on]);function In(M,g){var b;const L=M.substr(g).match(/^[01]+/);return(b=L&&L[0])!==null&&b!==void 0?b:""}function gt(M,g){const b=M.substr(g,2);if(g+=b.length,b.toLowerCase()!=="0b")return"";const L=In(M,g);return L===""?"":b+L}function ht(M,g){var b;const L=M.substr(g).match(/^[0-7]+/);return(b=L&&L[0])!==null&&b!==void 0?b:""}function $t(M,g){const b=M.substr(g,2);if(g+=b.length,b.toLowerCase()!=="0o")return"";const L=ht(M,g);return L===""?"":b+L}function Kn(M,g){var b;const L=M.substr(g).match(/^[0-9a-f]+/i);return(b=L&&L[0])!==null&&b!==void 0?b:""}function Mn(M,g){const b=M.substr(g,2);if(g+=b.length,b.toLowerCase()!=="0x")return"";const L=Kn(M,g);return L===""?"":b+L}const dn=mu([gt,$t,Mn]),wn=mu([dn,Gt]);function Xn(M,g){const b=wn(M,g);return g+=b.length,b===""?null:{evaluable:new gd(b),cursor:g}}function tn(M,g){const b=M.substr(g,1);if(g+=b.length,b!=="(")return null;const L=ga(M,g);if(!L)return null;g=L.cursor,g+=ja(M,g).length;const Q=M.substr(g,1);return g+=Q.length,Q!==")"?null:{evaluable:L.evaluable,cursor:g}}function Nn(M,g){var b;return(b=Xn(M,g))!==null&&b!==void 0?b:tn(M,g)}function ln(M,g){const b=Nn(M,g);if(b)return b;const L=M.substr(g,1);if(g+=L.length,L!=="+"&&L!=="-"&&L!=="~")return null;const Q=ln(M,g);return Q?(g=Q.cursor,{cursor:g,evaluable:new Wl(L,Q.evaluable)}):null}function pn(M,g,b){b+=ja(g,b).length;const L=M.filter(Q=>g.startsWith(Q,b))[0];return L?(b+=L.length,b+=ja(g,b).length,{cursor:b,operator:L}):null}function qn(M,g){return(b,L)=>{const Q=M(b,L);if(!Q)return null;L=Q.cursor;let Pe=Q.evaluable;for(;;){const Ye=pn(g,b,L);if(!Ye)break;L=Ye.cursor;const _t=M(b,L);if(!_t)return null;L=_t.cursor,Pe=new Li(Ye.operator,Pe,_t.evaluable)}return Pe?{cursor:L,evaluable:Pe}:null}}const Os=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((M,g)=>qn(M,g),ln);function ga(M,g){return g+=ja(M,g).length,Os(M,g)}function On(M){const g=ga(M,0);return!g||g.cursor+ja(M,g.cursor).length!==M.length?null:g.evaluable}function ur(M){var g;const b=On(M);return(g=b==null?void 0:b.evaluate())!==null&&g!==void 0?g:null}function ti(M){if(typeof M=="number")return M;if(typeof M=="string"){const g=ur(M);if(!d(g))return g}return 0}function vu(M){return String(M)}function mr(M){return g=>g.toFixed(Math.max(Math.min(M,20),0))}const Ic=mr(0);function yo(M){return Ic(M)+"%"}function Jn(M){return String(M)}function yd(M){return M}function vr(M,g){for(;M.length<g;)M.push(void 0)}function qb(M){const g=[];return vr(g,M),fe(g)}function pv(M){const g=M.indexOf(void 0);return g<0?M:M.slice(0,g)}function Gs(M,g){const b=[...pv(M),g];return b.length>M.length?b.splice(0,b.length-M.length):vr(b,M.length),b}function Ha({primary:M,secondary:g,forward:b,backward:L}){let Q=!1;function Pe(Ye){Q||(Q=!0,Ye(),Q=!1)}M.emitter.on("change",Ye=>{Pe(()=>{g.setRawValue(b(M,g),Ye.options)})}),g.emitter.on("change",Ye=>{Pe(()=>{M.setRawValue(L(M,g),Ye.options)}),Pe(()=>{g.setRawValue(b(M,g),Ye.options)})}),Pe(()=>{g.setRawValue(b(M,g),{forceEmit:!1,last:!0})})}function ns(M,g){const b=M*(g.altKey?.1:1)*(g.shiftKey?10:1);return g.upKey?+b:g.downKey?-b:0}function cn(M){return{altKey:M.altKey,downKey:M.key==="ArrowDown",shiftKey:M.shiftKey,upKey:M.key==="ArrowUp"}}function ni(M){return{altKey:M.altKey,downKey:M.key==="ArrowLeft",shiftKey:M.shiftKey,upKey:M.key==="ArrowRight"}}function xd(M){return M==="ArrowUp"||M==="ArrowDown"}function K0(M){return xd(M)||M==="ArrowLeft"||M==="ArrowRight"}function gu(M,g){var b,L;const Q=g.ownerDocument.defaultView,Pe=g.getBoundingClientRect();return{x:M.pageX-(((b=Q&&Q.scrollX)!==null&&b!==void 0?b:0)+Pe.left),y:M.pageY-(((L=Q&&Q.scrollY)!==null&&L!==void 0?L:0)+Pe.top)}}class _u{constructor(g){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=g,this.emitter=new _,g.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),g.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),g.addEventListener("touchend",this.onTouchEnd_),g.addEventListener("mousedown",this.onMouseDown_)}computePosition_(g){const b=this.elem_.getBoundingClientRect();return{bounds:{width:b.width,height:b.height},point:g?{x:g.x,y:g.y}:null}}onMouseDown_(g){var b;g.preventDefault(),(b=g.currentTarget)===null||b===void 0||b.focus();const L=this.elem_.ownerDocument;L.addEventListener("mousemove",this.onDocumentMouseMove_),L.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:g.altKey,data:this.computePosition_(gu(g,this.elem_)),sender:this,shiftKey:g.shiftKey})}onDocumentMouseMove_(g){this.emitter.emit("move",{altKey:g.altKey,data:this.computePosition_(gu(g,this.elem_)),sender:this,shiftKey:g.shiftKey})}onDocumentMouseUp_(g){const b=this.elem_.ownerDocument;b.removeEventListener("mousemove",this.onDocumentMouseMove_),b.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:g.altKey,data:this.computePosition_(gu(g,this.elem_)),sender:this,shiftKey:g.shiftKey})}onTouchStart_(g){g.preventDefault();const b=g.targetTouches.item(0),L=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:g.altKey,data:this.computePosition_(b?{x:b.clientX-L.left,y:b.clientY-L.top}:void 0),sender:this,shiftKey:g.shiftKey}),this.lastTouch_=b}onTouchMove_(g){const b=g.targetTouches.item(0),L=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:g.altKey,data:this.computePosition_(b?{x:b.clientX-L.left,y:b.clientY-L.top}:void 0),sender:this,shiftKey:g.shiftKey}),this.lastTouch_=b}onTouchEnd_(g){var b;const L=(b=g.targetTouches.item(0))!==null&&b!==void 0?b:this.lastTouch_,Q=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:g.altKey,data:this.computePosition_(L?{x:L.clientX-Q.left,y:L.clientY-Q.top}:void 0),sender:this,shiftKey:g.shiftKey})}}function qr(M,g,b,L,Q){const Pe=(M-g)/(b-g);return L+Pe*(Q-L)}function J0(M){return String(M.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function bi(M,g,b){return Math.min(Math.max(M,g),b)}function Nc(M,g){return(M%g+g)%g}const fi=C("txt");class Yb{constructor(g,b){this.onChange_=this.onChange_.bind(this),this.props_=b.props,this.props_.emitter.on("change",this.onChange_),this.element=g.createElement("div"),this.element.classList.add(fi(),fi(void 0,"num")),b.arrayPosition&&this.element.classList.add(fi(void 0,b.arrayPosition)),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("input");L.classList.add(fi("i")),L.type="text",b.viewProps.bindDisabled(L),this.element.appendChild(L),this.inputElement=L,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=b.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(fi()),this.inputElement.classList.add(fi("i"));const Q=g.createElement("div");Q.classList.add(fi("k")),this.element.appendChild(Q),this.knobElement=Q;const Pe=g.createElementNS(it,"svg");Pe.classList.add(fi("g")),this.knobElement.appendChild(Pe);const Ye=g.createElementNS(it,"path");Ye.classList.add(fi("gb")),Pe.appendChild(Ye),this.guideBodyElem_=Ye;const _t=g.createElementNS(it,"path");_t.classList.add(fi("gh")),Pe.appendChild(_t),this.guideHeadElem_=_t;const Kt=g.createElement("div");Kt.classList.add(C("tt")()),this.knobElement.appendChild(Kt),this.tooltipElem_=Kt,b.value.emitter.on("change",this.onChange_),this.value=b.value,this.refresh()}onDraggingChange_(g){if(g.rawValue===null){this.element.classList.remove(fi(void 0,"drg"));return}this.element.classList.add(fi(void 0,"drg"));const b=g.rawValue/this.props_.get("draggingScale"),L=b+(b>0?-1:b<0?1:0),Q=bi(-L,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${L+Q},0 L${L},4 L${L+Q},8`,`M ${b},-1 L${b},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${b},4`);const Pe=this.props_.get("formatter");this.tooltipElem_.textContent=Pe(this.value.rawValue),this.tooltipElem_.style.left=`${b}px`}refresh(){const g=this.props_.get("formatter");this.inputElement.value=g(this.value.rawValue)}onChange_(){this.refresh()}}class yu{constructor(g,b){var L;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=b.baseStep,this.parser_=b.parser,this.props=b.props,this.sliderProps_=(L=b.sliderProps)!==null&&L!==void 0?L:null,this.value=b.value,this.viewProps=b.viewProps,this.dragging_=fe(null),this.view=new Yb(g,{arrayPosition:b.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const Q=new _u(this.view.knobElement);Q.emitter.on("down",this.onPointerDown_),Q.emitter.on("move",this.onPointerMove_),Q.emitter.on("up",this.onPointerUp_)}constrainValue_(g){var b,L;const Q=(b=this.sliderProps_)===null||b===void 0?void 0:b.get("minValue"),Pe=(L=this.sliderProps_)===null||L===void 0?void 0:L.get("maxValue");let Ye=g;return Q!==void 0&&(Ye=Math.max(Ye,Q)),Pe!==void 0&&(Ye=Math.min(Ye,Pe)),Ye}onInputChange_(g){const b=g.currentTarget.value,L=this.parser_(b);d(L)||(this.value.rawValue=this.constrainValue_(L)),this.view.refresh()}onInputKeyDown_(g){const b=ns(this.baseStep_,cn(g));b!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+b),{forceEmit:!1,last:!1})}onInputKeyUp_(g){ns(this.baseStep_,cn(g))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(g){if(!g.point)return null;const b=g.point.x-g.bounds.width/2;return this.constrainValue_(this.originRawValue_+b*this.props.get("draggingScale"))}onPointerMove_(g){const b=this.computeDraggingValue_(g.data);b!==null&&(this.value.setRawValue(b,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(g){const b=this.computeDraggingValue_(g.data);b!==null&&(this.value.setRawValue(b,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const bd=C("sld");class wd{constructor(g,b){this.onChange_=this.onChange_.bind(this),this.props_=b.props,this.props_.emitter.on("change",this.onChange_),this.element=g.createElement("div"),this.element.classList.add(bd()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("div");L.classList.add(bd("t")),b.viewProps.bindTabIndex(L),this.element.appendChild(L),this.trackElement=L;const Q=g.createElement("div");Q.classList.add(bd("k")),this.trackElement.appendChild(Q),this.knobElement=Q,b.value.emitter.on("change",this.onChange_),this.value=b.value,this.update_()}update_(){const g=bi(qr(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${g}%`}onChange_(){this.update_()}}class Sd{constructor(g,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=b.baseStep,this.value=b.value,this.viewProps=b.viewProps,this.props=b.props,this.view=new wd(g,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new _u(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(g,b){!g.point||this.value.setRawValue(qr(bi(g.point.x,0,g.bounds.width),0,g.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),b)}onPointerDownOrMove_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerUp_(g){this.handlePointerEvent_(g.data,{forceEmit:!0,last:!0})}onKeyDown_(g){const b=ns(this.baseStep_,ni(g));b!==0&&this.value.setRawValue(this.value.rawValue+b,{forceEmit:!1,last:!1})}onKeyUp_(g){ns(this.baseStep_,ni(g))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Md=C("sldtxt");class Zb{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Md());const L=g.createElement("div");L.classList.add(Md("s")),this.sliderView_=b.sliderView,L.appendChild(this.sliderView_.element),this.element.appendChild(L);const Q=g.createElement("div");Q.classList.add(Md("t")),this.textView_=b.textView,Q.appendChild(this.textView_.element),this.element.appendChild(Q)}}class xu{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.sliderC_=new Sd(g,{baseStep:b.baseStep,props:b.sliderProps,value:b.value,viewProps:this.viewProps}),this.textC_=new yu(g,{baseStep:b.baseStep,parser:b.parser,props:b.textProps,sliderProps:b.sliderProps,value:b.value,viewProps:b.viewProps}),this.view=new Zb(g,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Gl(M,g){M.write(g)}function pf(M){const g=Re;if(Array.isArray(M))return g.required.array(g.required.object({text:g.required.string,value:g.required.raw}))(M).value;if(typeof M=="object")return g.required.raw(M).value}function ff(M){if(M==="inline"||M==="popup")return M}function ir(M){const g=Re;return g.required.object({max:g.optional.number,min:g.optional.number,step:g.optional.number})(M).value}function vh(M){if(Array.isArray(M))return M;const g=[];return Object.keys(M).forEach(b=>{g.push({text:b,value:M[b]})}),g}function Wa(M){return d(M)?null:new Ho(vh(M))}function Cd(M){const g=M?Rs(M,Ho):null;return g?g.options:null}function fv(M){const g=M?Rs(M,fh):null;return g?g.step:null}function mf(M,g){const b=M&&Rs(M,fh);return b?J0(b.step):Math.max(J0(g),2)}function gh(M){const g=fv(M);return g!=null?g:1}function _h(M,g){var b;const L=M&&Rs(M,fh),Q=Math.abs((b=L==null?void 0:L.step)!==null&&b!==void 0?b:g);return Q===0?.1:Math.pow(10,Math.floor(Math.log10(Q))-1)}const vf=C("ckb");class Kb{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),this.element=g.createElement("div"),this.element.classList.add(vf()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("label");L.classList.add(vf("l")),this.element.appendChild(L);const Q=g.createElement("input");Q.classList.add(vf("i")),Q.type="checkbox",L.appendChild(Q),this.inputElement=Q,b.viewProps.bindDisabled(this.inputElement);const Pe=g.createElement("div");Pe.classList.add(vf("w")),L.appendChild(Pe);const Ye=je(g,"check");Pe.appendChild(Ye),b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ga{constructor(g,b){this.onInputChange_=this.onInputChange_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new Kb(g,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(g){const b=g.currentTarget;this.value.rawValue=b.checked}}function Jb(M){const g=[],b=Wa(M.options);return b&&g.push(b),new Hl(g)}const Qb={id:"input-bool",type:"input",accept:(M,g)=>{if(typeof M!="boolean")return null;const b=Ue(g,{options:Re.optional.custom(pf)});return b?{initialValue:M,params:b}:null},binding:{reader:M=>df,constraint:M=>Jb(M.params),writer:M=>Gl},controller:M=>{var g;const b=M.document,L=M.value,Q=M.constraint;return Q&&Rs(Q,Ho)?new Ua(b,{props:ge.fromObject({options:(g=Cd(Q))!==null&&g!==void 0?g:[]}),value:L,viewProps:M.viewProps}):new Ga(b,{value:L,viewProps:M.viewProps})}},Xa=C("col");class mv{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Xa()),b.foldable.bindExpandedClass(this.element,Xa(void 0,"expanded")),N(b.foldable,"completed",T(this.element,Xa(void 0,"cpl")));const L=g.createElement("div");L.classList.add(Xa("h")),this.element.appendChild(L);const Q=g.createElement("div");Q.classList.add(Xa("s")),L.appendChild(Q),this.swatchElement=Q;const Pe=g.createElement("div");if(Pe.classList.add(Xa("t")),L.appendChild(Pe),this.textElement=Pe,b.pickerLayout==="inline"){const Ye=g.createElement("div");Ye.classList.add(Xa("p")),this.element.appendChild(Ye),this.pickerElement=Ye}else this.pickerElement=null}}function Xs(M,g,b){const L=bi(M/255,0,1),Q=bi(g/255,0,1),Pe=bi(b/255,0,1),Ye=Math.max(L,Q,Pe),_t=Math.min(L,Q,Pe),Kt=Ye-_t;let fn=0,Yn=0;const an=(_t+Ye)/2;return Kt!==0&&(Yn=Kt/(1-Math.abs(Ye+_t-1)),L===Ye?fn=(Q-Pe)/Kt:Q===Ye?fn=2+(Pe-L)/Kt:fn=4+(L-Q)/Kt,fn=fn/6+(fn<0?1:0)),[fn*360,Yn*100,an*100]}function bu(M,g,b){const L=(M%360+360)%360,Q=bi(g/100,0,1),Pe=bi(b/100,0,1),Ye=(1-Math.abs(2*Pe-1))*Q,_t=Ye*(1-Math.abs(L/60%2-1)),Kt=Pe-Ye/2;let fn,Yn,an;return L>=0&&L<60?[fn,Yn,an]=[Ye,_t,0]:L>=60&&L<120?[fn,Yn,an]=[_t,Ye,0]:L>=120&&L<180?[fn,Yn,an]=[0,Ye,_t]:L>=180&&L<240?[fn,Yn,an]=[0,_t,Ye]:L>=240&&L<300?[fn,Yn,an]=[_t,0,Ye]:[fn,Yn,an]=[Ye,0,_t],[(fn+Kt)*255,(Yn+Kt)*255,(an+Kt)*255]}function $b(M,g,b){const L=bi(M/255,0,1),Q=bi(g/255,0,1),Pe=bi(b/255,0,1),Ye=Math.max(L,Q,Pe),_t=Math.min(L,Q,Pe),Kt=Ye-_t;let fn;Kt===0?fn=0:Ye===L?fn=60*(((Q-Pe)/Kt%6+6)%6):Ye===Q?fn=60*((Pe-L)/Kt+2):fn=60*((L-Q)/Kt+4);const Yn=Ye===0?0:Kt/Ye,an=Ye;return[fn,Yn*100,an*100]}function Q0(M,g,b){const L=Nc(M,360),Q=bi(g/100,0,1),Pe=bi(b/100,0,1),Ye=Pe*Q,_t=Ye*(1-Math.abs(L/60%2-1)),Kt=Pe-Ye;let fn,Yn,an;return L>=0&&L<60?[fn,Yn,an]=[Ye,_t,0]:L>=60&&L<120?[fn,Yn,an]=[_t,Ye,0]:L>=120&&L<180?[fn,Yn,an]=[0,Ye,_t]:L>=180&&L<240?[fn,Yn,an]=[0,_t,Ye]:L>=240&&L<300?[fn,Yn,an]=[_t,0,Ye]:[fn,Yn,an]=[Ye,0,_t],[(fn+Kt)*255,(Yn+Kt)*255,(an+Kt)*255]}function ew(M,g,b){const L=b+g*(100-Math.abs(2*b-100))/200;return[M,L!==0?g*(100-Math.abs(2*b-100))/L:0,b+g*(100-Math.abs(2*b-100))/(2*100)]}function qa(M,g,b){const L=100-Math.abs(b*(200-g)/100-100);return[M,L!==0?g*b/L:0,b*(200-g)/(2*100)]}function Er(M){return[M[0],M[1],M[2]]}function gf(M,g){return[M[0],M[1],M[2],g]}const tw={hsl:{hsl:(M,g,b)=>[M,g,b],hsv:ew,rgb:bu},hsv:{hsl:qa,hsv:(M,g,b)=>[M,g,b],rgb:Q0},rgb:{hsl:Xs,hsv:$b,rgb:(M,g,b)=>[M,g,b]}};function _f(M,g){return[g==="float"?1:M==="rgb"?255:360,g==="float"?1:M==="rgb"?255:100,g==="float"?1:M==="rgb"?255:100]}function nw(M,g,b){var L;const Q=_f(g,b);return[g==="rgb"?bi(M[0],0,Q[0]):Nc(M[0],Q[0]),bi(M[1],0,Q[1]),bi(M[2],0,Q[2]),bi((L=M[3])!==null&&L!==void 0?L:1,0,1)]}function $0(M,g,b,L){const Q=_f(g,b),Pe=_f(g,L);return M.map((Ye,_t)=>Ye/Q[_t]*Pe[_t])}function rw(M,g,b){const L=$0(M,g.mode,g.type,"int"),Q=tw[g.mode][b.mode](...L);return $0(Q,b.mode,"int",b.type)}function xo(M,g){return typeof M!="object"||d(M)?!1:g in M&&typeof M[g]=="number"}class ${constructor(g,b,L="int"){this.mode=b,this.type=L,this.comps_=nw(g,b,L)}static black(g="int"){return new $([0,0,0],"rgb",g)}static fromObject(g,b="int"){const L="a"in g?[g.r,g.g,g.b,g.a]:[g.r,g.g,g.b];return new $(L,"rgb",b)}static toRgbaObject(g,b="int"){return g.toRgbaObject(b)}static isRgbColorObject(g){return xo(g,"r")&&xo(g,"g")&&xo(g,"b")}static isRgbaColorObject(g){return this.isRgbColorObject(g)&&xo(g,"a")}static isColorObject(g){return this.isRgbColorObject(g)}static equals(g,b){if(g.mode!==b.mode)return!1;const L=g.comps_,Q=b.comps_;for(let Pe=0;Pe<L.length;Pe++)if(L[Pe]!==Q[Pe])return!1;return!0}getComponents(g,b="int"){return gf(rw(Er(this.comps_),{mode:this.mode,type:this.type},{mode:g!=null?g:this.mode,type:b}),this.comps_[3])}toRgbaObject(g="int"){const b=this.getComponents("rgb",g);return{r:b[0],g:b[1],b:b[2],a:b[3]}}}const Ee=C("colp");class _e{constructor(g,b){this.alphaViews_=null,this.element=g.createElement("div"),this.element.classList.add(Ee());const L=g.createElement("div");L.classList.add(Ee("hsv"));const Q=g.createElement("div");Q.classList.add(Ee("sv")),this.svPaletteView_=b.svPaletteView,Q.appendChild(this.svPaletteView_.element),L.appendChild(Q);const Pe=g.createElement("div");Pe.classList.add(Ee("h")),this.hPaletteView_=b.hPaletteView,Pe.appendChild(this.hPaletteView_.element),L.appendChild(Pe),this.element.appendChild(L);const Ye=g.createElement("div");if(Ye.classList.add(Ee("rgb")),this.textView_=b.textView,Ye.appendChild(this.textView_.element),this.element.appendChild(Ye),b.alphaViews){this.alphaViews_={palette:b.alphaViews.palette,text:b.alphaViews.text};const _t=g.createElement("div");_t.classList.add(Ee("a"));const Kt=g.createElement("div");Kt.classList.add(Ee("ap")),Kt.appendChild(this.alphaViews_.palette.element),_t.appendChild(Kt);const fn=g.createElement("div");fn.classList.add(Ee("at")),fn.appendChild(this.alphaViews_.text.element),_t.appendChild(fn),this.element.appendChild(_t)}}get allFocusableElements(){const g=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(b=>b.inputElement)];return this.alphaViews_&&g.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),g}}function nt(M){return M==="int"?"int":M==="float"?"float":void 0}function St(M){const g=Re;return Ue(M,{alpha:g.optional.boolean,color:g.optional.object({alpha:g.optional.boolean,type:g.optional.custom(nt)}),expanded:g.optional.boolean,picker:g.optional.custom(ff)})}function jt(M){return M?.1:1}function xn(M){var g;return(g=M.color)===null||g===void 0?void 0:g.type}function sn(M,g){return M.alpha===g.alpha&&M.mode===g.mode&&M.notation===g.notation&&M.type===g.type}function Ls(M,g){const b=M.match(/^(.+)%$/);return Math.min(b?parseFloat(b[1])*.01*g:parseFloat(M),g)}const iw={deg:M=>M,grad:M=>M*360/400,rad:M=>M*360/(2*Math.PI),turn:M=>M*360};function Yr(M){const g=M.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!g)return parseFloat(M);const b=parseFloat(g[1]),L=g[2];return iw[L](b)}function kc(M){const g=M.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!g)return null;const b=[Ls(g[1],255),Ls(g[2],255),Ls(g[3],255)];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])?null:b}function e_(M){return g=>{const b=kc(g);return b?new $(b,"rgb",M):null}}function _a(M){const g=M.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!g)return null;const b=[Ls(g[1],255),Ls(g[2],255),Ls(g[3],255),Ls(g[4],1)];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])||isNaN(b[3])?null:b}function zc(M){return g=>{const b=_a(g);return b?new $(b,"rgb",M):null}}function Bc(M){const g=M.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!g)return null;const b=[Yr(g[1]),Ls(g[2],100),Ls(g[3],100)];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])?null:b}function Yt(M){return g=>{const b=Bc(g);return b?new $(b,"hsl",M):null}}function t_(M){const g=M.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!g)return null;const b=[Yr(g[1]),Ls(g[2],100),Ls(g[3],100),Ls(g[4],1)];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])||isNaN(b[3])?null:b}function yf(M){return g=>{const b=t_(g);return b?new $(b,"hsl",M):null}}function Vc(M){const g=M.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(g)return[parseInt(g[1]+g[1],16),parseInt(g[2]+g[2],16),parseInt(g[3]+g[3],16)];const b=M.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:null}function sw(M){const g=Vc(M);return g?new $(g,"rgb","int"):null}function n_(M){const g=M.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(g)return[parseInt(g[1]+g[1],16),parseInt(g[2]+g[2],16),parseInt(g[3]+g[3],16),qr(parseInt(g[4]+g[4],16),0,255,0,1)];const b=M.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),qr(parseInt(b[4],16),0,255,0,1)]:null}function ow(M){const g=n_(M);return g?new $(g,"rgb","int"):null}function Fc(M){const g=M.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!g)return null;const b=[parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])?null:b}function Ds(M){return g=>{const b=Fc(g);return b?new $(b,"rgb",M):null}}function Uc(M){const g=M.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!g)return null;const b=[parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]),parseFloat(g[4])];return isNaN(b[0])||isNaN(b[1])||isNaN(b[2])||isNaN(b[3])?null:b}function xf(M){return g=>{const b=Uc(g);return b?new $(b,"rgb",M):null}}const wu=[{parser:Vc,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:n_,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:kc,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:_a,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Bc,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:t_,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Fc,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Uc,result:{alpha:!0,mode:"rgb",notation:"object"}}];function vv(M){return wu.reduce((g,{parser:b,result:L})=>g||(b(M)?L:null),null)}function Ed(M,g="int"){const b=vv(M);return b?b.notation==="hex"&&g!=="float"?Object.assign(Object.assign({},b),{type:"int"}):b.notation==="func"?Object.assign(Object.assign({},b),{type:g}):null:null}const jc={int:[sw,ow,e_("int"),zc("int"),Yt("int"),yf("int"),Ds("int"),xf("int")],float:[e_("float"),zc("float"),Yt("float"),yf("float"),Ds("float"),xf("float")]};function gv(M){const g=jc[M];return b=>{if(typeof b!="string")return $.black(M);const L=g.reduce((Q,Pe)=>Q||Pe(b),null);return L!=null?L:$.black(M)}}function Ya(M){const g=jc[M];return b=>g.reduce((L,Q)=>L||Q(b),null)}function bo(M){const g=bi(Math.floor(M),0,255).toString(16);return g.length===1?`0${g}`:g}function Hc(M,g="#"){const b=Er(M.getComponents("rgb")).map(bo).join("");return`${g}${b}`}function _v(M,g="#"){const b=M.getComponents("rgb"),L=[b[0],b[1],b[2],b[3]*255].map(bo).join("");return`${g}${L}`}function r_(M,g){const b=mr(g==="float"?2:0);return`rgb(${Er(M.getComponents("rgb",g)).map(L=>b(L)).join(", ")})`}function aw(M){return g=>r_(g,M)}function wl(M,g){const b=mr(2),L=mr(g==="float"?2:0);return`rgba(${M.getComponents("rgb",g).map((Q,Pe)=>(Pe===3?b:L)(Q)).join(", ")})`}function Su(M){return g=>wl(g,M)}function Ad(M){const g=[mr(0),yo,yo];return`hsl(${Er(M.getComponents("hsl")).map((b,L)=>g[L](b)).join(", ")})`}function lw(M){const g=[mr(0),yo,yo,mr(2)];return`hsla(${M.getComponents("hsl").map((b,L)=>g[L](b)).join(", ")})`}function bf(M,g){const b=mr(g==="float"?2:0),L=["r","g","b"];return`{${Er(M.getComponents("rgb",g)).map((Q,Pe)=>`${L[Pe]}: ${b(Q)}`).join(", ")}}`}function cw(M){return g=>bf(g,M)}function i_(M,g){const b=mr(2),L=mr(g==="float"?2:0),Q=["r","g","b","a"];return`{${M.getComponents("rgb",g).map((Pe,Ye)=>{const _t=Ye===3?b:L;return`${Q[Ye]}: ${_t(Pe)}`}).join(", ")}}`}function kn(M){return g=>i_(g,M)}const ar=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Hc},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:_v},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Ad},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:lw},...["int","float"].reduce((M,g)=>[...M,{format:{alpha:!1,mode:"rgb",notation:"func",type:g},stringifier:aw(g)},{format:{alpha:!0,mode:"rgb",notation:"func",type:g},stringifier:Su(g)},{format:{alpha:!1,mode:"rgb",notation:"object",type:g},stringifier:cw(g)},{format:{alpha:!0,mode:"rgb",notation:"object",type:g},stringifier:kn(g)}],[])];function yv(M){return ar.reduce((g,b)=>g||(sn(b.format,M)?b.stringifier:null),null)}const Pd=C("apl");class xv{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=g.createElement("div"),this.element.classList.add(Pd()),b.viewProps.bindTabIndex(this.element);const L=g.createElement("div");L.classList.add(Pd("b")),this.element.appendChild(L);const Q=g.createElement("div");Q.classList.add(Pd("c")),L.appendChild(Q),this.colorElem_=Q;const Pe=g.createElement("div");Pe.classList.add(Pd("m")),this.element.appendChild(Pe),this.markerElem_=Pe;const Ye=g.createElement("div");Ye.classList.add(Pd("p")),this.markerElem_.appendChild(Ye),this.previewElem_=Ye,this.update_()}update_(){const g=this.value.rawValue,b=g.getComponents("rgb"),L=new $([b[0],b[1],b[2],0],"rgb"),Q=new $([b[0],b[1],b[2],255],"rgb"),Pe=["to right",wl(L),wl(Q)];this.colorElem_.style.background=`linear-gradient(${Pe.join(",")})`,this.previewElem_.style.backgroundColor=wl(g);const Ye=qr(b[3],0,1,0,100);this.markerElem_.style.left=`${Ye}%`}onValueChange_(){this.update_()}}class uw{constructor(g,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new xv(g,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new _u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(g,b){if(!g.point)return;const L=g.point.x/g.bounds.width,Q=this.value.rawValue,[Pe,Ye,_t]=Q.getComponents("hsv");this.value.setRawValue(new $([Pe,Ye,_t,L],"hsv"),b)}onPointerDown_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerMove_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerUp_(g){this.handlePointerEvent_(g.data,{forceEmit:!0,last:!0})}onKeyDown_(g){const b=ns(jt(!0),ni(g));if(b===0)return;const L=this.value.rawValue,[Q,Pe,Ye,_t]=L.getComponents("hsv");this.value.setRawValue(new $([Q,Pe,Ye,_t+b],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(g){ns(jt(!0),ni(g))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Sl=C("coltxt");function Xl(M){const g=M.createElement("select"),b=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return g.appendChild(b.reduce((L,Q)=>{const Pe=M.createElement("option");return Pe.textContent=Q.text,Pe.value=Q.value,L.appendChild(Pe),L},M.createDocumentFragment())),g}class Td{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(Sl());const L=g.createElement("div");L.classList.add(Sl("m")),this.modeElem_=Xl(g),this.modeElem_.classList.add(Sl("ms")),L.appendChild(this.modeSelectElement);const Q=g.createElement("div");Q.classList.add(Sl("mm")),Q.appendChild(je(g,"dropdown")),L.appendChild(Q),this.element.appendChild(L);const Pe=g.createElement("div");Pe.classList.add(Sl("w")),this.element.appendChild(Pe),this.textsElem_=Pe,this.textViews_=b.textViews,this.applyTextViews_(),D(b.colorMode,Ye=>{this.modeElem_.value=Ye})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(g){this.textViews_=g,this.applyTextViews_()}applyTextViews_(){ne(this.textsElem_);const g=this.element.ownerDocument;this.textViews_.forEach(b=>{const L=g.createElement("div");L.classList.add(Sl("c")),L.appendChild(b.element),this.textsElem_.appendChild(L)})}}function Za(M){return mr(M==="float"?2:0)}function ql(M,g,b){const L=_f(M,g)[b];return new Fa({min:0,max:L})}function Ka(M,g,b){return new yu(M,{arrayPosition:b===0?"fst":b===3-1?"lst":"mid",baseStep:jt(!1),parser:g.parser,props:ge.fromObject({draggingScale:g.colorType==="float"?.01:1,formatter:Za(g.colorType)}),value:fe(0,{constraint:ql(g.colorMode,g.colorType,b)}),viewProps:g.viewProps})}class Mu{constructor(g,b){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=b.colorType,this.parser_=b.parser,this.value=b.value,this.viewProps=b.viewProps,this.colorMode=fe(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(g),this.view=new Td(g,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(g){const b={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},L=[Ka(g,b,0),Ka(g,b,1),Ka(g,b,2)];return L.forEach((Q,Pe)=>{Ha({primary:this.value,secondary:Q.value,forward:Ye=>Ye.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[Pe],backward:(Ye,_t)=>{const Kt=this.colorMode.rawValue,fn=Ye.rawValue.getComponents(Kt,this.colorType_);return fn[Pe]=_t.rawValue,new $(gf(Er(fn),fn[3]),Kt,this.colorType_)}})}),L}onModeSelectChange_(g){const b=g.currentTarget;this.colorMode.rawValue=b.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Xo=C("hpl");class hw{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=g.createElement("div"),this.element.classList.add(Xo()),b.viewProps.bindTabIndex(this.element);const L=g.createElement("div");L.classList.add(Xo("c")),this.element.appendChild(L);const Q=g.createElement("div");Q.classList.add(Xo("m")),this.element.appendChild(Q),this.markerElem_=Q,this.update_()}update_(){const g=this.value.rawValue,[b]=g.getComponents("hsv");this.markerElem_.style.backgroundColor=r_(new $([b,100,100],"hsv"));const L=qr(b,0,360,0,100);this.markerElem_.style.left=`${L}%`}onValueChange_(){this.update_()}}class dw{constructor(g,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new hw(g,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new _u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(g,b){if(!g.point)return;const L=qr(bi(g.point.x,0,g.bounds.width),0,g.bounds.width,0,359),Q=this.value.rawValue,[,Pe,Ye,_t]=Q.getComponents("hsv");this.value.setRawValue(new $([L,Pe,Ye,_t],"hsv"),b)}onPointerDown_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerMove_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerUp_(g){this.handlePointerEvent_(g.data,{forceEmit:!0,last:!0})}onKeyDown_(g){const b=ns(jt(!1),ni(g));if(b===0)return;const L=this.value.rawValue,[Q,Pe,Ye,_t]=L.getComponents("hsv");this.value.setRawValue(new $([Q+b,Pe,Ye,_t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(g){ns(jt(!1),ni(g))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const bv=C("svp"),s_=64;class pw{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=g.createElement("div"),this.element.classList.add(bv()),b.viewProps.bindTabIndex(this.element);const L=g.createElement("canvas");L.height=s_,L.width=s_,L.classList.add(bv("c")),this.element.appendChild(L),this.canvasElement=L;const Q=g.createElement("div");Q.classList.add(bv("m")),this.element.appendChild(Q),this.markerElem_=Q,this.update_()}update_(){const g=Ae(this.canvasElement);if(!g)return;const b=this.value.rawValue.getComponents("hsv"),L=this.canvasElement.width,Q=this.canvasElement.height,Pe=g.getImageData(0,0,L,Q),Ye=Pe.data;for(let fn=0;fn<Q;fn++)for(let Yn=0;Yn<L;Yn++){const an=qr(Yn,0,L,0,100),vi=qr(fn,0,Q,100,0),Qa=Q0(b[0],an,vi),Yc=(fn*L+Yn)*4;Ye[Yc]=Qa[0],Ye[Yc+1]=Qa[1],Ye[Yc+2]=Qa[2],Ye[Yc+3]=255}g.putImageData(Pe,0,0);const _t=qr(b[1],0,100,0,100);this.markerElem_.style.left=`${_t}%`;const Kt=qr(b[2],0,100,100,0);this.markerElem_.style.top=`${Kt}%`}onValueChange_(){this.update_()}}class Cu{constructor(g,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new pw(g,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new _u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(g,b){if(!g.point)return;const L=qr(g.point.x,0,g.bounds.width,0,100),Q=qr(g.point.y,0,g.bounds.height,100,0),[Pe,,,Ye]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new $([Pe,L,Q,Ye],"hsv"),b)}onPointerDown_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerMove_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerUp_(g){this.handlePointerEvent_(g.data,{forceEmit:!0,last:!0})}onKeyDown_(g){K0(g.key)&&g.preventDefault();const[b,L,Q,Pe]=this.value.rawValue.getComponents("hsv"),Ye=jt(!1),_t=ns(Ye,ni(g)),Kt=ns(Ye,cn(g));_t===0&&Kt===0||this.value.setRawValue(new $([b,L+_t,Q+Kt,Pe],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(g){const b=jt(!1),L=ns(b,ni(g)),Q=ns(b,cn(g));L===0&&Q===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Yl{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.hPaletteC_=new dw(g,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Cu(g,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=b.supportsAlpha?{palette:new uw(g,{value:this.value,viewProps:this.viewProps}),text:new yu(g,{parser:ur,baseStep:.1,props:ge.fromObject({draggingScale:.01,formatter:mr(2)}),value:fe(0,{constraint:new Fa({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ha({primary:this.value,secondary:this.alphaIcs_.text.value,forward:L=>L.rawValue.getComponents()[3],backward:(L,Q)=>{const Pe=L.rawValue.getComponents();return Pe[3]=Q.rawValue,new $(Pe,L.rawValue.mode)}}),this.textC_=new Mu(g,{colorType:b.colorType,parser:ur,value:this.value,viewProps:this.viewProps}),this.view=new _e(g,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:b.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const Rd=C("colsw");class I{constructor(g,b){this.onValueChange_=this.onValueChange_.bind(this),b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.element=g.createElement("div"),this.element.classList.add(Rd()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("div");L.classList.add(Rd("sw")),this.element.appendChild(L),this.swatchElem_=L;const Q=g.createElement("button");Q.classList.add(Rd("b")),b.viewProps.bindDisabled(Q),this.element.appendChild(Q),this.buttonElement=Q,this.update_()}update_(){const g=this.value.rawValue;this.swatchElem_.style.backgroundColor=_v(g)}onValueChange_(){this.update_()}}class Ja{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new I(g,{value:this.value,viewProps:this.viewProps})}}class Zl{constructor(g,b){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.foldable_=ze.create(b.expanded),this.swatchC_=new Ja(g,{value:this.value,viewProps:this.viewProps});const L=this.swatchC_.view.buttonElement;L.addEventListener("blur",this.onButtonBlur_),L.addEventListener("click",this.onButtonClick_),this.textC_=new Dc(g,{parser:b.parser,props:ge.fromObject({formatter:b.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new mv(g,{foldable:this.foldable_,pickerLayout:b.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=b.pickerLayout==="popup"?new xl(g,{viewProps:this.viewProps}):null;const Q=new Yl(g,{colorType:b.colorType,supportsAlpha:b.supportsAlpha,value:this.value,viewProps:this.viewProps});Q.view.allFocusableElements.forEach(Pe=>{Pe.addEventListener("blur",this.onPopupChildBlur_),Pe.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=Q,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(Q.view.element),Ha({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:Pe=>Pe.rawValue,backward:(Pe,Ye)=>Ye.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ge(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(g){if(!this.popC_)return;const b=this.view.element,L=g.relatedTarget;(!L||!b.contains(L))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(g){if(!this.popC_)return;const b=this.popC_.view.element,L=O(g);L&&b.contains(L)||L&&L===this.swatchC_.view.buttonElement&&!Y(b.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(g){this.popC_?g.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&g.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function ri(M,g){return $.isColorObject(M)?$.fromObject(M,g):$.black(g)}function Bt(M){return Er(M.getComponents("rgb")).reduce((g,b)=>g<<8|Math.floor(b)&255,0)}function fw(M){return M.getComponents("rgb").reduce((g,b,L)=>{const Q=Math.floor(L===3?b*255:b)&255;return g<<8|Q},0)>>>0}function mw(M){return new $([M>>16&255,M>>8&255,M&255],"rgb")}function vw(M){return new $([M>>24&255,M>>16&255,M>>8&255,qr(M&255,0,255,0,1)],"rgb")}function qo(M){return typeof M!="number"?$.black():mw(M)}function gw(M){return typeof M!="number"?$.black():vw(M)}function _w(M){const g=yv(M);return g?(b,L)=>{Gl(b,g(L))}:null}function yw(M){const g=M?fw:Bt;return(b,L)=>{Gl(b,g(L))}}function xw(M,g,b){const L=g.toRgbaObject(b);M.writeProperty("r",L.r),M.writeProperty("g",L.g),M.writeProperty("b",L.b),M.writeProperty("a",L.a)}function bw(M,g,b){const L=g.toRgbaObject(b);M.writeProperty("r",L.r),M.writeProperty("g",L.g),M.writeProperty("b",L.b)}function ms(M,g){return(b,L)=>{M?xw(b,L,g):bw(b,L,g)}}function wv(M){var g;return!!((M==null?void 0:M.alpha)||((g=M==null?void 0:M.color)===null||g===void 0?void 0:g.alpha))}function ww(M){return M?g=>_v(g,"0x"):g=>Hc(g,"0x")}function Sw(M){return"color"in M||"view"in M&&M.view==="color"}const Mw={id:"input-color-number",type:"input",accept:(M,g)=>{if(typeof M!="number"||!Sw(g))return null;const b=St(g);return b?{initialValue:M,params:b}:null},binding:{reader:M=>wv(M.params)?gw:qo,equals:$.equals,writer:M=>yw(wv(M.params))},controller:M=>{const g=wv(M.params),b="expanded"in M.params?M.params.expanded:void 0,L="picker"in M.params?M.params.picker:void 0;return new Zl(M.document,{colorType:"int",expanded:b!=null?b:!1,formatter:ww(g),parser:Ya("int"),pickerLayout:L!=null?L:"popup",supportsAlpha:g,value:M.value,viewProps:M.viewProps})}};function Cw(M){return $.isRgbaColorObject(M)}function vs(M){return g=>ri(g,M)}function Ew(M,g){return b=>M?i_(b,g):bf(b,g)}const Aw={id:"input-color-object",type:"input",accept:(M,g)=>{if(!$.isColorObject(M))return null;const b=St(g);return b?{initialValue:M,params:b}:null},binding:{reader:M=>vs(xn(M.params)),equals:$.equals,writer:M=>ms(Cw(M.initialValue),xn(M.params))},controller:M=>{var g;const b=$.isRgbaColorObject(M.initialValue),L="expanded"in M.params?M.params.expanded:void 0,Q="picker"in M.params?M.params.picker:void 0,Pe=(g=xn(M.params))!==null&&g!==void 0?g:"int";return new Zl(M.document,{colorType:Pe,expanded:L!=null?L:!1,formatter:Ew(b,Pe),parser:Ya(Pe),pickerLayout:Q!=null?Q:"popup",supportsAlpha:b,value:M.value,viewProps:M.viewProps})}},Pw={id:"input-color-string",type:"input",accept:(M,g)=>{if(typeof M!="string"||"view"in g&&g.view==="text")return null;const b=Ed(M,xn(g));if(!b||!yv(b))return null;const L=St(g);return L?{initialValue:M,params:L}:null},binding:{reader:M=>{var g;return gv((g=xn(M.params))!==null&&g!==void 0?g:"int")},equals:$.equals,writer:M=>{const g=Ed(M.initialValue,xn(M.params));if(!g)throw v.shouldNeverHappen();const b=_w(g);if(!b)throw v.notBindable();return b}},controller:M=>{const g=Ed(M.initialValue,xn(M.params));if(!g)throw v.shouldNeverHappen();const b=yv(g);if(!b)throw v.shouldNeverHappen();const L="expanded"in M.params?M.params.expanded:void 0,Q="picker"in M.params?M.params.picker:void 0;return new Zl(M.document,{colorType:g.type,expanded:L!=null?L:!1,formatter:b,parser:Ya(g.type),pickerLayout:Q!=null?Q:"popup",supportsAlpha:g.alpha,value:M.value,viewProps:M.viewProps})}};class Wc{constructor(g){this.components=g.components,this.asm_=g.assembly}constrain(g){const b=this.asm_.toComponents(g).map((L,Q)=>{var Pe,Ye;return(Ye=(Pe=this.components[Q])===null||Pe===void 0?void 0:Pe.constrain(L))!==null&&Ye!==void 0?Ye:L});return this.asm_.fromComponents(b)}}const o_=C("pndtxt");class Yo{constructor(g,b){this.textViews=b.textViews,this.element=g.createElement("div"),this.element.classList.add(o_()),this.textViews.forEach(L=>{const Q=g.createElement("div");Q.classList.add(o_("a")),Q.appendChild(L.element),this.element.appendChild(Q)})}}function Tw(M,g,b){return new yu(M,{arrayPosition:b===0?"fst":b===g.axes.length-1?"lst":"mid",baseStep:g.axes[b].baseStep,parser:g.parser,props:g.axes[b].textProps,value:fe(0,{constraint:g.axes[b].constraint}),viewProps:g.viewProps})}class Sv{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.acs_=b.axes.map((L,Q)=>Tw(g,b,Q)),this.acs_.forEach((L,Q)=>{Ha({primary:this.value,secondary:L.value,forward:Pe=>b.assembly.toComponents(Pe.rawValue)[Q],backward:(Pe,Ye)=>{const _t=b.assembly.toComponents(Pe.rawValue);return _t[Q]=Ye.rawValue,b.assembly.fromComponents(_t)}})}),this.view=new Yo(g,{textViews:this.acs_.map(L=>L.view)})}}function mi(M,g){return"step"in M&&!d(M.step)?new fh(M.step,g):null}function a_(M){return"max"in M&&!d(M.max)||"min"in M&&!d(M.min)?new Fa({max:M.max,min:M.min}):null}function Rw(M,g){const b=[],L=mi(M,g);L&&b.push(L);const Q=a_(M);Q&&b.push(Q);const Pe=Wa(M.options);return Pe&&b.push(Pe),new Hl(b)}function Ow(M){const g=M?Rs(M,Fa):null;return g?[g.minValue,g.maxValue]:[void 0,void 0]}function Lw(M){const[g,b]=Ow(M);return[g!=null?g:0,b!=null?b:100]}const Dw={id:"input-number",type:"input",accept:(M,g)=>{if(typeof M!="number")return null;const b=Re,L=Ue(g,{format:b.optional.function,max:b.optional.number,min:b.optional.number,options:b.optional.custom(pf),step:b.optional.number});return L?{initialValue:M,params:L}:null},binding:{reader:M=>ti,constraint:M=>Rw(M.params,M.initialValue),writer:M=>Gl},controller:M=>{var g,b;const L=M.value,Q=M.constraint;if(Q&&Rs(Q,Ho))return new Ua(M.document,{props:ge.fromObject({options:(g=Cd(Q))!==null&&g!==void 0?g:[]}),value:L,viewProps:M.viewProps});const Pe=(b="format"in M.params?M.params.format:void 0)!==null&&b!==void 0?b:mr(mf(Q,L.rawValue));if(Q&&Rs(Q,Fa)){const[Ye,_t]=Lw(Q);return new xu(M.document,{baseStep:gh(Q),parser:ur,sliderProps:ge.fromObject({maxValue:_t,minValue:Ye}),textProps:ge.fromObject({draggingScale:_h(Q,L.rawValue),formatter:Pe}),value:L,viewProps:M.viewProps})}return new yu(M.document,{baseStep:gh(Q),parser:ur,props:ge.fromObject({draggingScale:_h(Q,L.rawValue),formatter:Pe}),value:L,viewProps:M.viewProps})}};class Ml{constructor(g=0,b=0){this.x=g,this.y=b}getComponents(){return[this.x,this.y]}static isObject(g){if(d(g))return!1;const b=g.x,L=g.y;return!(typeof b!="number"||typeof L!="number")}static equals(g,b){return g.x===b.x&&g.y===b.y}toObject(){return{x:this.x,y:this.y}}}const wf={toComponents:M=>M.getComponents(),fromComponents:M=>new Ml(...M)},yh=C("p2d");class Iw{constructor(g,b){this.element=g.createElement("div"),this.element.classList.add(yh()),b.viewProps.bindClassModifiers(this.element),D(b.expanded,T(this.element,yh(void 0,"expanded")));const L=g.createElement("div");L.classList.add(yh("h")),this.element.appendChild(L);const Q=g.createElement("button");Q.classList.add(yh("b")),Q.appendChild(je(g,"p2dpad")),b.viewProps.bindDisabled(Q),L.appendChild(Q),this.buttonElement=Q;const Pe=g.createElement("div");if(Pe.classList.add(yh("t")),L.appendChild(Pe),this.textElement=Pe,b.pickerLayout==="inline"){const Ye=g.createElement("div");Ye.classList.add(yh("p")),this.element.appendChild(Ye),this.pickerElement=Ye}else this.pickerElement=null}}const ya=C("p2dp");class Kl{constructor(g,b){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=b.invertsY,this.maxValue_=b.maxValue,this.element=g.createElement("div"),this.element.classList.add(ya()),b.layout==="popup"&&this.element.classList.add(ya(void 0,"p"));const L=g.createElement("div");L.classList.add(ya("p")),b.viewProps.bindTabIndex(L),this.element.appendChild(L),this.padElement=L;const Q=g.createElementNS(it,"svg");Q.classList.add(ya("g")),this.padElement.appendChild(Q),this.svgElem_=Q;const Pe=g.createElementNS(it,"line");Pe.classList.add(ya("ax")),Pe.setAttributeNS(null,"x1","0"),Pe.setAttributeNS(null,"y1","50%"),Pe.setAttributeNS(null,"x2","100%"),Pe.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(Pe);const Ye=g.createElementNS(it,"line");Ye.classList.add(ya("ax")),Ye.setAttributeNS(null,"x1","50%"),Ye.setAttributeNS(null,"y1","0"),Ye.setAttributeNS(null,"x2","50%"),Ye.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(Ye);const _t=g.createElementNS(it,"line");_t.classList.add(ya("l")),_t.setAttributeNS(null,"x1","50%"),_t.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(_t),this.lineElem_=_t;const Kt=g.createElement("div");Kt.classList.add(ya("m")),this.padElement.appendChild(Kt),this.markerElem_=Kt,b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[g,b]=this.value.rawValue.getComponents(),L=this.maxValue_,Q=qr(g,-L,+L,0,100),Pe=qr(b,-L,+L,0,100),Ye=this.invertsY_?100-Pe:Pe;this.lineElem_.setAttributeNS(null,"x2",`${Q}%`),this.lineElem_.setAttributeNS(null,"y2",`${Ye}%`),this.markerElem_.style.left=`${Q}%`,this.markerElem_.style.top=`${Ye}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Gc(M,g,b){return[ns(g[0],ni(M)),ns(g[1],cn(M))*(b?1:-1)]}class Nw{constructor(g,b){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.baseSteps_=b.baseSteps,this.maxValue_=b.maxValue,this.invertsY_=b.invertsY,this.view=new Kl(g,{invertsY:this.invertsY_,layout:b.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new _u(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(g,b){if(!g.point)return;const L=this.maxValue_,Q=qr(g.point.x,0,g.bounds.width,-L,+L),Pe=qr(this.invertsY_?g.bounds.height-g.point.y:g.point.y,0,g.bounds.height,-L,+L);this.value.setRawValue(new Ml(Q,Pe),b)}onPointerDown_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerMove_(g){this.handlePointerEvent_(g.data,{forceEmit:!1,last:!1})}onPointerUp_(g){this.handlePointerEvent_(g.data,{forceEmit:!0,last:!0})}onPadKeyDown_(g){K0(g.key)&&g.preventDefault();const[b,L]=Gc(g,this.baseSteps_,this.invertsY_);b===0&&L===0||this.value.setRawValue(new Ml(this.value.rawValue.x+b,this.value.rawValue.y+L),{forceEmit:!1,last:!1})}onPadKeyUp_(g){const[b,L]=Gc(g,this.baseSteps_,this.invertsY_);b===0&&L===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Mv{constructor(g,b){var L,Q;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.foldable_=ze.create(b.expanded),this.popC_=b.pickerLayout==="popup"?new xl(g,{viewProps:this.viewProps}):null;const Pe=new Nw(g,{baseSteps:[b.axes[0].baseStep,b.axes[1].baseStep],invertsY:b.invertsY,layout:b.pickerLayout,maxValue:b.maxValue,value:this.value,viewProps:this.viewProps});Pe.view.allFocusableElements.forEach(Ye=>{Ye.addEventListener("blur",this.onPopupChildBlur_),Ye.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=Pe,this.textC_=new Sv(g,{assembly:wf,axes:b.axes,parser:b.parser,value:this.value,viewProps:this.viewProps}),this.view=new Iw(g,{expanded:this.foldable_.value("expanded"),pickerLayout:b.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(L=this.view.buttonElement)===null||L===void 0||L.addEventListener("blur",this.onPadButtonBlur_),(Q=this.view.buttonElement)===null||Q===void 0||Q.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ha({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:Ye=>Ye.rawValue,backward:(Ye,_t)=>_t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ge(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(g){if(!this.popC_)return;const b=this.view.element,L=g.relatedTarget;(!L||!b.contains(L))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(g){if(!this.popC_)return;const b=this.popC_.view.element,L=O(g);L&&b.contains(L)||L&&L===this.view.buttonElement&&!Y(b.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(g){this.popC_?g.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&g.key==="Escape"&&this.view.buttonElement.focus()}}function kw(M){return Ml.isObject(M)?new Ml(M.x,M.y):new Ml}function gs(M,g){M.writeProperty("x",g.x),M.writeProperty("y",g.y)}function Zo(M,g){if(!M)return;const b=[],L=mi(M,g);L&&b.push(L);const Q=a_(M);return Q&&b.push(Q),new Hl(b)}function Ko(M,g){return new Wc({assembly:wf,components:[Zo("x"in M?M.x:void 0,g.x),Zo("y"in M?M.y:void 0,g.y)]})}function Zr(M,g){var b,L;const Q=M&&Rs(M,Fa);if(Q)return Math.max(Math.abs((b=Q.minValue)!==null&&b!==void 0?b:0),Math.abs((L=Q.maxValue)!==null&&L!==void 0?L:0));const Pe=gh(M);return Math.max(Math.abs(Pe)*10,Math.abs(g)*10)}function zw(M,g){const b=g instanceof Wc?g.components[0]:void 0,L=g instanceof Wc?g.components[1]:void 0,Q=Zr(b,M.x),Pe=Zr(L,M.y);return Math.max(Q,Pe)}function Sf(M,g){return{baseStep:gh(g),constraint:g,textProps:ge.fromObject({draggingScale:_h(g,M),formatter:mr(mf(g,M))})}}function Cv(M){if(!("y"in M))return!1;const g=M.y;return g&&"inverted"in g?!!g.inverted:!1}const Jl={id:"input-point2d",type:"input",accept:(M,g)=>{if(!Ml.isObject(M))return null;const b=Re,L=Ue(g,{expanded:b.optional.boolean,picker:b.optional.custom(ff),x:b.optional.custom(ir),y:b.optional.object({inverted:b.optional.boolean,max:b.optional.number,min:b.optional.number,step:b.optional.number})});return L?{initialValue:M,params:L}:null},binding:{reader:M=>kw,constraint:M=>Ko(M.params,M.initialValue),equals:Ml.equals,writer:M=>gs},controller:M=>{const g=M.document,b=M.value,L=M.constraint;if(!(L instanceof Wc))throw v.shouldNeverHappen();const Q="expanded"in M.params?M.params.expanded:void 0,Pe="picker"in M.params?M.params.picker:void 0;return new Mv(g,{axes:[Sf(b.rawValue.x,L.components[0]),Sf(b.rawValue.y,L.components[1])],expanded:Q!=null?Q:!1,invertsY:Cv(M.params),maxValue:zw(b.rawValue,L),parser:ur,pickerLayout:Pe!=null?Pe:"popup",value:b,viewProps:M.viewProps})}};class Di{constructor(g=0,b=0,L=0){this.x=g,this.y=b,this.z=L}getComponents(){return[this.x,this.y,this.z]}static isObject(g){if(d(g))return!1;const b=g.x,L=g.y,Q=g.z;return!(typeof b!="number"||typeof L!="number"||typeof Q!="number")}static equals(g,b){return g.x===b.x&&g.y===b.y&&g.z===b.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Mf={toComponents:M=>M.getComponents(),fromComponents:M=>new Di(...M)};function Bw(M){return Di.isObject(M)?new Di(M.x,M.y,M.z):new Di}function Eu(M,g){M.writeProperty("x",g.x),M.writeProperty("y",g.y),M.writeProperty("z",g.z)}function Vw(M,g){return new Wc({assembly:Mf,components:[Zo("x"in M?M.x:void 0,g.x),Zo("y"in M?M.y:void 0,g.y),Zo("z"in M?M.z:void 0,g.z)]})}function Od(M,g){return{baseStep:gh(g),constraint:g,textProps:ge.fromObject({draggingScale:_h(g,M),formatter:mr(mf(g,M))})}}const Qn={id:"input-point3d",type:"input",accept:(M,g)=>{if(!Di.isObject(M))return null;const b=Re,L=Ue(g,{x:b.optional.custom(ir),y:b.optional.custom(ir),z:b.optional.custom(ir)});return L?{initialValue:M,params:L}:null},binding:{reader:M=>Bw,constraint:M=>Vw(M.params,M.initialValue),equals:Di.equals,writer:M=>Eu},controller:M=>{const g=M.value,b=M.constraint;if(!(b instanceof Wc))throw v.shouldNeverHappen();return new Sv(M.document,{assembly:Mf,axes:[Od(g.rawValue.x,b.components[0]),Od(g.rawValue.y,b.components[1]),Od(g.rawValue.z,b.components[2])],parser:ur,value:g,viewProps:M.viewProps})}};class Cl{constructor(g=0,b=0,L=0,Q=0){this.x=g,this.y=b,this.z=L,this.w=Q}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(g){if(d(g))return!1;const b=g.x,L=g.y,Q=g.z,Pe=g.w;return!(typeof b!="number"||typeof L!="number"||typeof Q!="number"||typeof Pe!="number")}static equals(g,b){return g.x===b.x&&g.y===b.y&&g.z===b.z&&g.w===b.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Cf={toComponents:M=>M.getComponents(),fromComponents:M=>new Cl(...M)};function Fi(M){return Cl.isObject(M)?new Cl(M.x,M.y,M.z,M.w):new Cl}function Ld(M,g){M.writeProperty("x",g.x),M.writeProperty("y",g.y),M.writeProperty("z",g.z),M.writeProperty("w",g.w)}function Au(M,g){return new Wc({assembly:Cf,components:[Zo("x"in M?M.x:void 0,g.x),Zo("y"in M?M.y:void 0,g.y),Zo("z"in M?M.z:void 0,g.z),Zo("w"in M?M.w:void 0,g.w)]})}function Jo(M,g){return{baseStep:gh(g),constraint:g,textProps:ge.fromObject({draggingScale:_h(g,M),formatter:mr(mf(g,M))})}}const Ev={id:"input-point4d",type:"input",accept:(M,g)=>{if(!Cl.isObject(M))return null;const b=Re,L=Ue(g,{x:b.optional.custom(ir),y:b.optional.custom(ir),z:b.optional.custom(ir),w:b.optional.custom(ir)});return L?{initialValue:M,params:L}:null},binding:{reader:M=>Fi,constraint:M=>Au(M.params,M.initialValue),equals:Cl.equals,writer:M=>Ld},controller:M=>{const g=M.value,b=M.constraint;if(!(b instanceof Wc))throw v.shouldNeverHappen();return new Sv(M.document,{assembly:Cf,axes:g.rawValue.getComponents().map((L,Q)=>Jo(L,b.components[Q])),parser:ur,value:g,viewProps:M.viewProps})}};function gr(M){const g=[],b=Wa(M.options);return b&&g.push(b),new Hl(g)}const Dd={id:"input-string",type:"input",accept:(M,g)=>{if(typeof M!="string")return null;const b=Ue(g,{options:Re.optional.custom(pf)});return b?{initialValue:M,params:b}:null},binding:{reader:M=>Jn,constraint:M=>gr(M.params),writer:M=>Gl},controller:M=>{var g;const b=M.document,L=M.value,Q=M.constraint;return Q&&Rs(Q,Ho)?new Ua(b,{props:ge.fromObject({options:(g=Cd(Q))!==null&&g!==void 0?g:[]}),value:L,viewProps:M.viewProps}):new Dc(b,{parser:Pe=>Pe,props:ge.fromObject({formatter:yd}),value:L,viewProps:M.viewProps})}},Id={monitor:{defaultInterval:200,defaultLineCount:3}},l_=C("mll");class Fw{constructor(g,b){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=b.formatter,this.element=g.createElement("div"),this.element.classList.add(l_()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("textarea");L.classList.add(l_("i")),L.style.height=`calc(var(--bld-us) * ${b.lineCount})`,L.readOnly=!0,b.viewProps.bindDisabled(L),this.element.appendChild(L),this.textareaElem_=L,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}update_(){const g=this.textareaElem_,b=g.scrollTop===g.scrollHeight-g.clientHeight,L=[];this.value.rawValue.forEach(Q=>{Q!==void 0&&L.push(this.formatter_(Q))}),g.textContent=L.join(`
`),b&&(g.scrollTop=g.scrollHeight)}onValueUpdate_(){this.update_()}}class Pu{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new Fw(g,{formatter:b.formatter,lineCount:b.lineCount,value:this.value,viewProps:this.viewProps})}}const c_=C("sgl");class Ql{constructor(g,b){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=b.formatter,this.element=g.createElement("div"),this.element.classList.add(c_()),b.viewProps.bindClassModifiers(this.element);const L=g.createElement("input");L.classList.add(c_("i")),L.readOnly=!0,L.type="text",b.viewProps.bindDisabled(L),this.element.appendChild(L),this.inputElement=L,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}update_(){const g=this.value.rawValue,b=g[g.length-1];this.inputElement.value=b!==void 0?this.formatter_(b):""}onValueUpdate_(){this.update_()}}class Nd{constructor(g,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new Ql(g,{formatter:b.formatter,value:this.value,viewProps:this.viewProps})}}const Uw={id:"monitor-bool",type:"monitor",accept:(M,g)=>{if(typeof M!="boolean")return null;const b=Ue(g,{lineCount:Re.optional.number});return b?{initialValue:M,params:b}:null},binding:{reader:M=>df},controller:M=>{var g;return M.value.rawValue.length===1?new Nd(M.document,{formatter:fu,value:M.value,viewProps:M.viewProps}):new Pu(M.document,{formatter:fu,lineCount:(g=M.params.lineCount)!==null&&g!==void 0?g:Id.monitor.defaultLineCount,value:M.value,viewProps:M.viewProps})}},Xc=C("grl");class $l{constructor(g,b){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=g.createElement("div"),this.element.classList.add(Xc()),b.viewProps.bindClassModifiers(this.element),this.formatter_=b.formatter,this.props_=b.props,this.cursor_=b.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const L=g.createElementNS(it,"svg");L.classList.add(Xc("g")),L.style.height=`calc(var(--bld-us) * ${b.lineCount})`,this.element.appendChild(L),this.svgElem_=L;const Q=g.createElementNS(it,"polyline");this.svgElem_.appendChild(Q),this.lineElem_=Q;const Pe=g.createElement("div");Pe.classList.add(Xc("t"),C("tt")()),this.element.appendChild(Pe),this.tooltipElem_=Pe,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const g=this.svgElem_.getBoundingClientRect(),b=this.value.rawValue.length-1,L=this.props_.get("minValue"),Q=this.props_.get("maxValue"),Pe=[];this.value.rawValue.forEach((Yn,an)=>{if(Yn===void 0)return;const vi=qr(an,0,b,0,g.width),Qa=qr(Yn,L,Q,g.height,0);Pe.push([vi,Qa].join(","))}),this.lineElem_.setAttributeNS(null,"points",Pe.join(" "));const Ye=this.tooltipElem_,_t=this.value.rawValue[this.cursor_.rawValue];if(_t===void 0){Ye.classList.remove(Xc("t","a"));return}const Kt=qr(this.cursor_.rawValue,0,b,0,g.width),fn=qr(_t,L,Q,g.height,0);Ye.style.left=`${Kt}px`,Ye.style.top=`${fn}px`,Ye.textContent=`${this.formatter_(_t)}`,Ye.classList.contains(Xc("t","a"))||(Ye.classList.add(Xc("t","a"),Xc("t","in")),Ke(Ye),Ye.classList.remove(Xc("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class jw{constructor(g,b){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=b.props,this.value=b.value,this.viewProps=b.viewProps,this.cursor_=fe(-1),this.view=new $l(g,{cursor:this.cursor_,formatter:b.formatter,lineCount:b.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!Y(g))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const L=new _u(this.view.element);L.emitter.on("down",this.onGraphPointerDown_),L.emitter.on("move",this.onGraphPointerMove_),L.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(g){const b=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(qr(g.offsetX,0,b.width,0,this.value.rawValue.length))}onGraphPointerDown_(g){this.onGraphPointerMove_(g)}onGraphPointerMove_(g){if(!g.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(qr(g.data.point.x,0,g.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Av(M){return"format"in M&&!d(M.format)?M.format:mr(2)}function kd(M){var g;return M.value.rawValue.length===1?new Nd(M.document,{formatter:Av(M.params),value:M.value,viewProps:M.viewProps}):new Pu(M.document,{formatter:Av(M.params),lineCount:(g=M.params.lineCount)!==null&&g!==void 0?g:Id.monitor.defaultLineCount,value:M.value,viewProps:M.viewProps})}function Pv(M){var g,b,L;return new jw(M.document,{formatter:Av(M.params),lineCount:(g=M.params.lineCount)!==null&&g!==void 0?g:Id.monitor.defaultLineCount,props:ge.fromObject({maxValue:(b="max"in M.params?M.params.max:null)!==null&&b!==void 0?b:100,minValue:(L="min"in M.params?M.params.min:null)!==null&&L!==void 0?L:0}),value:M.value,viewProps:M.viewProps})}function u_(M){return"view"in M&&M.view==="graph"}const Hw={id:"monitor-number",type:"monitor",accept:(M,g)=>{if(typeof M!="number")return null;const b=Re,L=Ue(g,{format:b.optional.function,lineCount:b.optional.number,max:b.optional.number,min:b.optional.number,view:b.optional.string});return L?{initialValue:M,params:L}:null},binding:{defaultBufferSize:M=>u_(M)?64:1,reader:M=>ti},controller:M=>u_(M.params)?Pv(M):kd(M)},Ww={id:"monitor-string",type:"monitor",accept:(M,g)=>{if(typeof M!="string")return null;const b=Re,L=Ue(g,{lineCount:b.optional.number,multiline:b.optional.boolean});return L?{initialValue:M,params:L}:null},binding:{reader:M=>Jn},controller:M=>{var g;const b=M.value;return b.rawValue.length>1||"multiline"in M.params&&M.params.multiline?new Pu(M.document,{formatter:yd,lineCount:(g=M.params.lineCount)!==null&&g!==void 0?g:Id.monitor.defaultLineCount,value:b,viewProps:M.viewProps}):new Nd(M.document,{formatter:yd,value:b,viewProps:M.viewProps})}};class Tv{constructor(g){this.onValueChange_=this.onValueChange_.bind(this),this.reader=g.reader,this.writer=g.writer,this.emitter=new _,this.value=g.value,this.value.emitter.on("change",this.onValueChange_),this.target=g.target,this.read()}read(){const g=this.target.read();g!==void 0&&(this.value.rawValue=this.reader(g))}write_(g){this.writer(this.target,g)}onValueChange_(g){this.write_(g.rawValue),this.emitter.emit("change",{options:g.options,rawValue:g.rawValue,sender:this})}}function zd(M,g){const b=M.accept(g.target.read(),g.params);if(d(b))return null;const L=Re,Q={target:g.target,initialValue:b.initialValue,params:b.params},Pe=M.binding.reader(Q),Ye=M.binding.constraint?M.binding.constraint(Q):void 0,_t=fe(Pe(b.initialValue),{constraint:Ye,equals:M.binding.equals}),Kt=new Tv({reader:Pe,target:g.target,value:_t,writer:M.binding.writer(Q)}),fn=L.optional.boolean(g.params.disabled).value,Yn=L.optional.boolean(g.params.hidden).value,an=M.controller({constraint:Ye,document:g.document,initialValue:b.initialValue,params:b.params,value:Kt.value,viewProps:Ln.create({disabled:fn,hidden:Yn})}),vi=L.optional.string(g.params.label).value;return new Je(g.document,{binding:Kt,blade:oe(),props:ge.fromObject({label:vi!=null?vi:g.target.key}),valueController:an})}class Gw{constructor(g){this.onTick_=this.onTick_.bind(this),this.reader_=g.reader,this.target=g.target,this.emitter=new _,this.value=g.value,this.ticker=g.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const g=this.target.read();if(g===void 0)return;const b=this.value.rawValue,L=this.reader_(g);this.value.rawValue=Gs(b,L),this.emitter.emit("update",{rawValue:L,sender:this})}onTick_(g){this.read()}}function Bd(M,g){return g===0?new jl:new jo(M,g!=null?g:Id.monitor.defaultInterval)}function Rv(M,g){var b,L,Q;const Pe=Re,Ye=M.accept(g.target.read(),g.params);if(d(Ye))return null;const _t={target:g.target,initialValue:Ye.initialValue,params:Ye.params},Kt=M.binding.reader(_t),fn=(L=(b=Pe.optional.number(g.params.bufferSize).value)!==null&&b!==void 0?b:M.binding.defaultBufferSize&&M.binding.defaultBufferSize(Ye.params))!==null&&L!==void 0?L:1,Yn=Pe.optional.number(g.params.interval).value,an=new Gw({reader:Kt,target:g.target,ticker:Bd(g.document,Yn),value:qb(fn)}),vi=Pe.optional.boolean(g.params.disabled).value,Qa=Pe.optional.boolean(g.params.hidden).value,Yc=M.controller({document:g.document,params:Ye.params,value:an.value,viewProps:Ln.create({disabled:vi,hidden:Qa})}),Tu=(Q=Pe.optional.string(g.params.label).value)!==null&&Q!==void 0?Q:g.target.key;return new vn(g.document,{binding:an,blade:oe(),props:ge.fromObject({label:Tu}),valueController:Yc})}class Ov{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(g){g.type==="blade"?this.pluginsMap_.blades.unshift(g):g.type==="input"?this.pluginsMap_.inputs.unshift(g):g.type==="monitor"&&this.pluginsMap_.monitors.unshift(g)}createInput(g,b,L){const Q=b.read();if(d(Q))throw new v({context:{key:b.key},type:"nomatchingcontroller"});const Pe=this.pluginsMap_.inputs.reduce((Ye,_t)=>Ye!=null?Ye:zd(_t,{document:g,target:b,params:L}),null);if(Pe)return Pe;throw new v({context:{key:b.key},type:"nomatchingcontroller"})}createMonitor(g,b,L){const Q=this.pluginsMap_.monitors.reduce((Pe,Ye)=>Pe!=null?Pe:Rv(Ye,{document:g,params:L,target:b}),null);if(Q)return Q;throw new v({context:{key:b.key},type:"nomatchingcontroller"})}createBlade(g,b){const L=this.pluginsMap_.blades.reduce((Q,Pe)=>Q!=null?Q:fs(Pe,{document:g,params:b}),null);if(!L)throw new v({type:"nomatchingview",context:{params:b}});return L}createBladeApi(g){if(g instanceof Je)return new tt(g);if(g instanceof vn)return new Ft(g);if(g instanceof Ce)return new xr(g,this);const b=this.pluginsMap_.blades.reduce((L,Q)=>L!=null?L:Q.api({controller:g,pool:this}),null);if(!b)throw v.shouldNeverHappen();return b}}function Lv(){const M=new Ov;return[Jl,Qn,Ev,Dd,Dw,Pw,Aw,Mw,Qb,Uw,Ww,Hw,de,xt,gn,Un].forEach(g=>{M.register(g)}),M}class qc extends i{constructor(g){super(g),this.emitter_=new _,this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new o(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}get options(){return this.controller_.valueController.props.get("options")}set options(g){this.controller_.valueController.props.set("options",g)}get value(){return this.controller_.valueController.value.rawValue}set value(g){this.controller_.valueController.value.rawValue=g}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}}class h_ extends i{constructor(g){super(g),this.emitter_=new _,this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new o(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(g){this.controller_.valueController.sliderController.props.set("maxValue",g)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(g){this.controller_.valueController.sliderController.props.set("minValue",g)}get value(){return this.controller_.valueController.value.rawValue}set value(g){this.controller_.valueController.value.rawValue=g}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}}class Ef extends i{constructor(g){super(g),this.emitter_=new _,this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new o(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(g){this.controller_.props.set("label",g)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(g){this.controller_.valueController.props.set("formatter",g)}get value(){return this.controller_.valueController.value.rawValue}set value(g){this.controller_.valueController.value.rawValue=g}on(g,b){const L=b.bind(this);return this.emitter_.on(g,Q=>{L(Q.event)}),this}}const Dv=function(){return{id:"list",type:"blade",accept(M){const g=Re,b=Ue(M,{options:g.required.custom(pf),value:g.required.raw,view:g.required.constant("list"),label:g.optional.string});return b?{params:b}:null},controller(M){const g=new Ua(M.document,{props:ge.fromObject({options:vh(M.params.options)}),value:fe(M.params.value),viewProps:M.viewProps});return new bt(M.document,{blade:M.blade,props:ge.fromObject({label:M.params.label}),valueController:g})},api(M){return!(M.controller instanceof bt)||!(M.controller.valueController instanceof Ua)?null:new qc(M.controller)}}}();function Xw(M){return M.reduce((g,b)=>Object.assign(g,{[b.presetKey]:b.read()}),{})}function Iv(M,g){M.forEach(b=>{const L=g[b.presetKey];L!==void 0&&b.write(L)})}class qw extends or{constructor(g,b){super(g,b)}get element(){return this.controller_.view.element}importPreset(g){const b=this.controller_.rackController.rack.find(Je).map(L=>L.binding.target);Iv(b,g),this.refresh()}exportPreset(){const g=this.controller_.rackController.rack.find(Je).map(b=>b.binding.target);return Xw(g)}refresh(){this.controller_.rackController.rack.find(Je).forEach(g=>{g.binding.read()}),this.controller_.rackController.rack.find(vn).forEach(g=>{g.binding.read()})}}class Vd extends lt{constructor(g,b){super(g,{expanded:b.expanded,blade:b.blade,props:b.props,root:!0,viewProps:b.viewProps})}}const Nv={id:"slider",type:"blade",accept(M){const g=Re,b=Ue(M,{max:g.required.number,min:g.required.number,view:g.required.constant("slider"),format:g.optional.function,label:g.optional.string,value:g.optional.number});return b?{params:b}:null},controller(M){var g,b;const L=(g=M.params.value)!==null&&g!==void 0?g:0,Q=new xu(M.document,{baseStep:1,parser:ur,sliderProps:ge.fromObject({maxValue:M.params.max,minValue:M.params.min}),textProps:ge.fromObject({draggingScale:_h(void 0,L),formatter:(b=M.params.format)!==null&&b!==void 0?b:vu}),value:fe(L),viewProps:M.viewProps});return new bt(M.document,{blade:M.blade,props:ge.fromObject({label:M.params.label}),valueController:Q})},api(M){return!(M.controller instanceof bt)||!(M.controller.valueController instanceof xu)?null:new h_(M.controller)}},Fd=function(){return{id:"text",type:"blade",accept(M){const g=Re,b=Ue(M,{parse:g.required.function,value:g.required.raw,view:g.required.constant("text"),format:g.optional.function,label:g.optional.string});return b?{params:b}:null},controller(M){var g;const b=new Dc(M.document,{parser:M.params.parse,props:ge.fromObject({formatter:(g=M.params.format)!==null&&g!==void 0?g:L=>String(L)}),value:fe(M.params.value),viewProps:M.viewProps});return new bt(M.document,{blade:M.blade,props:ge.fromObject({label:M.params.label}),valueController:b})},api(M){return!(M.controller instanceof bt)||!(M.controller.valueController instanceof Dc)?null:new Ef(M.controller)}}}();function Yw(M){const g=M.createElement("div");return g.classList.add(C("dfw")()),M.body&&M.body.appendChild(g),g}function xh(M,g,b){if(M.querySelector(`style[data-tp-style=${g}]`))return;const L=M.createElement("style");L.dataset.tpStyle=g,L.textContent=b,M.head.appendChild(L)}class Rt extends qw{constructor(g){var b,L;const Q=g!=null?g:{},Pe=(b=Q.document)!==null&&b!==void 0?b:ve(),Ye=Lv(),_t=new Vd(Pe,{expanded:Q.expanded,blade:oe(),props:ge.fromObject({title:Q.title}),viewProps:Ln.create()});super(_t,Ye),this.pool_=Ye,this.containerElem_=(L=Q.container)!==null&&L!==void 0?L:Yw(Pe),this.containerElem_.appendChild(this.element),this.doc_=Pe,this.usesDefaultWrapper_=!Q.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw v.alreadyDisposed();return this.doc_}dispose(){const g=this.containerElem_;if(!g)throw v.alreadyDisposed();if(this.usesDefaultWrapper_){const b=g.parentElement;b&&b.removeChild(g)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(g){("plugin"in g?[g.plugin]:"plugins"in g?g.plugins:[]).forEach(b=>{this.pool_.register(b),this.embedPluginStyle_(b)})}embedPluginStyle_(g){g.css&&xh(this.document,`plugin-${g.id}`,g.css)}setUpDefaultPlugins_(){xh(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(g=>{this.embedPluginStyle_(g)}),this.registerPlugin({plugins:[Nv,Dv,Un,Fd]})}}const Zw=new r("3.1.0");t.BladeApi=i,t.ButtonApi=y,t.FolderApi=or,t.InputBindingApi=tt,t.ListApi=qc,t.MonitorBindingApi=Ft,t.Pane=Rt,t.SeparatorApi=wt,t.SliderApi=h_,t.TabApi=Cr,t.TabPageApi=Zn,t.TextApi=Ef,t.TpChangeEvent=o,t.VERSION=Zw,Object.defineProperty(t,"__esModule",{value:!0})})})(YU,YU.exports);const F4e=db(`
    <div>
        <svg t="1656447640895" class="icon" viewBox="0 0 1084 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1297" width="10" height="10"><path d="M788.804292 977.500541a503.543363 503.543363 0 0 0 162.507176-119.862595 509.687074 509.687074 0 0 0 103.780528-174.312738 515.047762 515.047762 0 0 0 28.550186-194.068985 514.385205 514.385205 0 0 0-45.53574-190.816432 508.663122 508.663122 0 0 0-118.657945-164.193685A501.676156 501.676156 0 0 0 554.921651 0.530046 503.904757 503.904757 0 0 0 203.585714 166.530704a509.807538 509.807538 0 0 0-94.564962 150.159522L0 290.187944l45.174345 154.014399 45.234577 154.0144 109.382147-116.610042L309.173215 365.056891l-103.057738-24.936238a411.387699 411.387699 0 0 1 69.990118-106.611453 405.846313 405.846313 0 0 1 576.906499-25.960191c166.181356 153.592772 177.625524 415.001647 25.659027 582.869512a406.087243 406.087243 0 0 1-577.026963 25.899958l-66.315938 73.302904a502.097784 502.097784 0 0 0 364.707543 133.836525 499.387323 499.387323 0 0 0 188.768529-45.957367z" p-id="1298" fill="#ffffff"></path></svg>
    </div>
`);let cae=!1,CV=!0;const U4e=uu(()=>{cae=CV,CV=!CV},100,"both"),EZ=n=>n&&typeof n=="object"&&"x"in n&&"y"in n,AZ=n=>n===!0||n==="true",PZ=n=>n===!1||n==="false",j4e=(n,e)=>EZ(n)&&EZ(e)?n.x===e.x&&n.y===e.y&&n.z===e.z:AZ(n)&&AZ(e)||PZ(n)&&PZ(e)?!0:n===e,So=(n,e,t,r,i={...t})=>{const s=n.addFolder({title:e});for(const[o,a]of Object.entries(i))switch(typeof a){case"undefined":i[o]="";break;case"number":i[o]=py(o,a);break;case"object":if(Array.isArray(a)){i[o]=JSON.stringify(a);break}typeof(a==null?void 0:a.x)=="number"&&(a.x=py("x",a.x)),typeof(a==null?void 0:a.y)=="number"&&(a.y=py("y",a.y)),typeof(a==null?void 0:a.z)=="number"&&(a.z=py("z",a.z));break}return Object.fromEntries(Object.keys(i).map(o=>{const a=s.addInput(i,o),c=F4e.cloneNode(!0);a.element.prepend(c),c.style.opacity="0.1";const u=DD(r,o,!0),d=uu(()=>{const p=j4e(i[o],u);c.style.opacity=p?"0.1":"0.5",c.style.cursor=p?"auto":"pointer"},100,"trailing");return d(),c.onclick=()=>{i[o]=JSON.parse(JSON.stringify(u)),a.refresh()},a.on("change",({value:p})=>{if(d(),!cae){if(typeof p=="string"){if(p==="true"||p==="false"){t[o]=p==="true";return}const f=parseFloat(p);if(!Number.isNaN(f)){t[o]=f;return}}t[o]=typeof p=="number"?py(o,p):p}}),[o,a]}))},TZ=(n,e,t)=>{const r={};for(const[i,s]of Object.entries(n)){if(lne.has(i))continue;let o=t[i];s===Function||typeof o=="function"||(s===Object||typeof o=="object"&&!Array.isArray(o))&&(!o||typeof o.x!="number"||typeof o.y!="number")||(o!=null||(o=DD(e,i,!0)),o===1/0?o=999999999:o===-1/0?o=-999999999:Array.isArray(o)&&(o=JSON.stringify(o)),r[i]=o)}return r},rl=(n,e)=>{let t;for(const s of e)s in n&&((t!=null?t:t={})[s]=n[s]);const r=new Set(e),i={};for(const[s,o]of Object.entries(n))!r.has(s)&&(i[s]=o);return[t,i]},H4e=(n,e,t)=>{for(const r of t)r in n&&(n[r]=e[r])},W4e=()=>{Rc(()=>{const n=async r=>{if((r.key==="Shift"||r.key==="Meta"||r.key==="Control")&&I5(!0),r.key==="Backspace"||r.key==="Delete"){r.preventDefault(),!N9()&&tae();return}const i=r.key.toLocaleLowerCase();if(i==="g"){ra.gridHelper=!ra.gridHelper;return}const s=ps();if(r.metaKey||r.ctrlKey){if(r.preventDefault(),i==="s")boe();else if(i==="o")xoe();else if(s)if(i==="c"){if(!lh().length){const[o]=bH(await q2(s));s.parent&&o&&(s.parent.attach(o),Ki(o))}}else r.key==="ArrowUp"&&Gp()&&(Iie(s),iU("local"))}else i==="c"&&v0(s)&&hwe(s)},e=r=>{(r.key==="Shift"||r.key==="Meta"||r.key==="Control")&&I5(!1)};document.addEventListener("keydown",n),document.addEventListener("keyup",e);const t=jL(()=>I5(!1));return()=>{document.removeEventListener("keydown",n),document.removeEventListener("keyup",e),t.cancel()}},[])};Object.assign(uH,{stride:{x:0,y:0}});const G4e=()=>{const n=J2();W4e(),XU(()=>{window.onbeforeunload=d;function d(){return"Are you sure you want to close the current page?"}return Rl.active=!0,NX(!0),ra.gridHelper=!0,LL(),()=>{NX(!1),ra.gridHelper=!1,DL()}},[]);const[e]=KDe(),t=Yx(e),[r]=K2(),[i]=TH(),[s]=ZDe(),[o,a]=Tc(),[c,u]=Tc();return XU(()=>{var d;if(!o||!c)return;const p="editor camera",f=s.reduce((_,S,C)=>(_[C===0?p:$oe(S.userData.manager)]=C,_),{}),v=o.addInput({camera:s.indexOf(t)},"camera",{options:f});c.add(v),v.on("change",({value:_})=>{s[_].userData.manager.active=!0});const x={none:0,...la.exports.omit(f,p)},y=o.addInput({"secondary camera":s.indexOf((d=VR())!=null?d:yi)},"secondary camera",{options:x});return c.add(y),y.on("change",({value:_})=>xbe(_===0?void 0:s[_])),()=>{v.dispose(),y.dispose()}},[o,c,s,t]),Rc(()=>{const d=n.current;if(!d)return;const p=new YU.exports.Pane({container:d});if(a(p),u(p.addFolder({title:"camera"})),!r){const[x,y]=rl(la.exports.omit(TZ(XC,Yu,ra),$Le),["gridHelper","gridHelperSize"]);So(p,"editor",ra,Yu,x);const[_,S]=rl(y,["antiAlias","pixelRatio","fps","logarithmicDepth","pbr"]);So(p,"renderer",ra,Yu,_);const[C,A]=rl(S,["exposure","defaultLight","shadowDistance","shadowResolution","shadowBias","skybox","texture","color"]);So(p,"lighting & environment",ra,Yu,C);const[P,D]=rl(A,["ambientOcclusion","bloom","bloomStrength","bloomRadius","bloomThreshold","bokeh","bokehAperture","bokehFocus","bokehMaxBlur","lensDistortion","lensIor","lensBand","motionBlur","motionBlurStrength"]);So(p,"effects",ra,Yu,P);const[N,j]=rl(D,["outlineColor","outlineHiddenColor","outlinePattern","outlinePulse","outlineStrength","outlineThickness"]);So(p,"outline effect",ra,Yu,N);const[T,k]=rl(j,["gravity","repulsion","centripetal"]);return So(p,"physics",ra,Yu,T),Object.keys(k).length&&So(p,"settings",ra,Yu,k),()=>{p.dispose()}}const f=r,v=new br;if(!i.length){const{schema:x,defaults:y,componentName:_}=f.constructor,[S,C]=rl(la.exports.omit(TZ(x,y,f),["rotation","innerRotation","frustumCulled","minAzimuthAngle","maxAzimuthAngle"]),["name","id","physics","gravity"]);if(S){const{name:Se}=So(p,"general",f,y,S);Se==null||Se.on("change",()=>z4e())}const[A,P]=rl(C,["x","y","z","rotationX","rotationY","rotationZ","scale","scaleX","scaleY","scaleZ","innerX","innerY","innerZ","innerRotationX","innerRotationY","innerRotationZ","width","height","depth"]);if(A){const[Se,pe]=rl(A,["innerX","innerY","innerZ","innerRotationX","innerRotationY","innerRotationZ","width","height","depth"]);So(p,"transform",f,y,pe),Se&&So(p,"inner transform",f,y,Se),v.watch(xre(()=>{U4e(),H4e(pe,f,["x","y","z","rotationX","rotationY","rotationZ","scaleX","scaleY","scaleZ"]),p.refresh()}))}const[D,N]=rl(P,["visible","innerVisible","castShadow","receiveShadow"]);D&&So(p,"display",f,y,D);const[j,T]=rl(N,["bloom","outline"]);j&&So(p,"effects",f,y,j);const[k,U]=rl(T,["animation","animationPaused","animationRepeat"]);k&&So(p,"animation",f,y,k);const[ee,xe]=rl(U,["metalnessFactor","roughnessFactor","opacityFactor","envFactor","adjustColor","reflection","illumination","toon"]);ee&&So(p,"adjust material",f,y,ee);const[ce,te]=rl(xe,["fog","opacity","color","texture","textureRepeat","textureFlipY","textureRotation","videoTexture","wireframe"]);ce&&So(p,"material",f,y,ce);const[fe,ge]=rl(te,["metalnessMap","metalness","roughnessMap","roughness","normalMap","normalScale","normalMapType","bumpMap","bumpScale","displacementMap","displacementScale","displacementBias","aoMap","aoMapIntensity","lightMap","lightMapIntensity","emissiveMap","emissiveIntensity","emissiveColor","emissive","envMap","alphaMap"]);if(fe&&So(p,"pbr material",f,y,fe),_==="dummy"){ge.stride={x:f.strideRight,y:-f.strideForward};const{stride:Se}=So(p,_,f,y,ge);Se.on("change",({value:pe})=>{Object.assign(ge,{strideForward:-pe.y,strideRight:pe.x}),p.refresh()})}else Object.keys(ge).length&&So(p,_,f,y,ge)}return()=>{v.cancel(),p.dispose()}},[r,i]),Ve("div",{ref:n,className:"lingo3d-ui lingo3d-bg",style:{width:300,height:"100%",overflowY:"scroll"}})},uae=()=>{const[n]=RH();return n?null:Ve(G4e,{})};$m(uae,"lingo3d-editor");const X4e=()=>Ve("div",{className:"lingo3d-ui",style:{overflow:"hidden",width:500,height:"100%",background:"rgb(40, 41, 46)"},children:"hello world"}),hae=()=>{const[n]=RH();return n?Ve(X4e,{}):null};$m(hae,"lingo3d-node-editor");const[EV,AV]=yt(void 0);_n(()=>{var n;const e=AV(),t=GM({x:0,y:0,z:0}),r=GM(),i=e instanceof DragEvent,s=Kpe(()=>{if(!i)return;const p=new qC;return p.name="indicator",Zne.add(p),p.opacity=.5,p},[i]);if(typeof e=="function"){const p=e(r.current);if(!p)return;Object.assign(p,t.current),Ki(p);return}if(!i||!s)return;const[o,a]=O9(e.clientX,e.clientY),c=Xne(o,a,WC);r.current=c==null?void 0:c.object.userData.manager;const u=(n=c==null?void 0:c.point)!=null?n:y9(_De(e.clientX,e.clientY)),d=iu(u);return Object.assign(s,d),t.current=d,()=>{!(AV()instanceof DragEvent)&&s.dispose()}},[AV]);Sr.addEventListener("dragenter",n=>n.preventDefault());Sr.addEventListener("dragover",n=>n.preventDefault());Sr.addEventListener("dragleave",n=>n.preventDefault());Sr.addEventListener("drop",n=>n.preventDefault());document.addEventListener("drop",n=>n.preventDefault());const dae=n=>{let e;return Sr.addEventListener("dragover",t=>e&&EV(t)),Sr.addEventListener("dragleave",()=>EV(void 0)),Sr.addEventListener("drop",()=>e&&EV(t=>n(e,t))),t=>e=t},pae=document.createElement("img"),RZ=dae(ooe),OZ=({name:n,iconName:e=n})=>Ve("div",{draggable:!0,onDragStart:t=>{RZ(n),t.dataTransfer.setDragImage(pae,0,0)},onDragEnd:()=>RZ(void 0),style:{width:"50%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:20,paddingBottom:20},children:[Ve("div",{style:{width:50,height:50,backgroundImage:`url(https://unpkg.com/lingo3d-editor@1.0.3/assets/${e}.png)`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),Ve("div",{style:{marginTop:6,opacity:.75,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:la.exports.upperFirst(n)})]}),LZ=n=>typeof n=="string"?n.endsWith("Camera")?"camera":n.endsWith("Light")?"light":n:Object.values(n)[0],DZ=n=>typeof n=="string"?n:Object.keys(n)[0],q4e=({names:n})=>{const e=[];let t=[],r=0;for(const i of n)r===0&&e.push(t=[]),t.push(i),++r===2&&(r=0);return Ve(Pc,{children:e.map(([i,s],o)=>Ve("div",{style:{display:"flex"},children:[Ve(OZ,{name:DZ(i),iconName:LZ(i)}),s&&Ve(OZ,{name:DZ(s),iconName:LZ(s)})]},o))})},fae=()=>{const n=J2(),[e]=RH();return Rc(()=>(LL(),()=>{DL()}),[]),e?null:Ve("div",{ref:n,className:"lingo3d-ui lingo3d-bg",style:{width:200,height:"100%",padding:10,overflowY:"scroll"},children:Ve(q4e,{names:["model","dummy","svgMesh","htmlMesh",{sprite:"plane"},"trigger","spawnPoint","audio","group","reflector","water","cube","sphere","cone","cylinder","octahedron","tetrahedron","torus","plane","circle","areaLight","ambientLight","skyLight","directionalLight","pointLight","spotLight",{environment:"light"},"camera","thirdPersonCamera","firstPersonCamera","orbitCamera"]})})};$m(fae,"lingo3d-library");const wa=({hotkey:n,description:e})=>Ve("div",{style:{display:"flex",alignItems:"center",marginTop:4,whiteSpace:"nowrap"},children:[Ve("div",{style:{border:"1px solid white",borderRadius:"4px",padding:"2px 4px 2px 4px"},children:Ve("div",{style:{minWidth:10,display:"flex",justifyContent:"center",alignItems:"center"},children:n})}),n&&e&&Ve("div",{style:{padding:"0 1px 0 1px"},children:"\xA0-\xA0"}),Ve("div",{style:{padding:"2px 0px 2px 0px"},children:e})]}),mae=()=>{const[n]=e4e(),[e]=JDe();return sae(Ve("div",{className:"lingo3d-ui",style:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",padding:10},children:!!n&&e===yi&&Ve("div",{style:{opacity:.5},children:[Ve(wa,{hotkey:"\u21E7",description:"accelerate"}),Ve(wa,{hotkey:"W",description:"move forward"}),Ve(wa,{hotkey:"S",description:"move backwards"}),Ve(wa,{hotkey:"A",description:"move left"}),Ve(wa,{hotkey:"D",description:"move right"}),Ve(wa,{hotkey:"\u2191",description:"move up"}),Ve(wa,{hotkey:"\u2193",description:"move down"}),Ve(wa,{hotkey:"C",description:"center selected"}),Ve(wa,{hotkey:"\u232B",description:"delete selected"}),Ve("div",{style:{display:"flex",gap:4},children:[Ve(wa,{hotkey:"\u2318"}),Ve(wa,{hotkey:"C",description:"copy selected"})]}),Ve("div",{style:{display:"flex",gap:4},children:[Ve(wa,{hotkey:"\u2318"}),Ve(wa,{hotkey:"O",description:"open folder"})]}),Ve("div",{style:{display:"flex",gap:4},children:[Ve(wa,{hotkey:"\u2318"}),Ve(wa,{hotkey:"S",description:"save scene"})]}),Ve(wa,{hotkey:"G",description:"toggle grid"})]})}),Sr)};$m(mae,"lingo3d-hud");const Y4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M546.942 511.819L874.4 185.689c9.617-9.577 9.648-25.135.07-34.75-9.577-9.618-25.137-9.648-34.75-.072l-327.6 326.27-327.598-326.269c-9.617-9.577-25.177-9.545-34.752.071-9.578 9.616-9.546 25.174.07 34.752l327.458 326.128L149.84 837.948c-9.616 9.577-9.647 25.135-.07 34.751a24.496 24.496 0 0017.411 7.232 24.5 24.5 0 0017.34-7.162l327.6-326.27 327.6 326.27a24.492 24.492 0 0017.34 7.162 24.503 24.503 0 0017.41-7.232c9.578-9.617 9.546-25.175-.07-34.751l-327.458-326.13z"})}),Z4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 1024 1024",children:Ve("path",{fill:"#fff",d:"M888.495 313.883l-198.02-198.02c-7.992-7.992-20.957-7.992-28.95 0s-7.992 20.947 0 28.939L824.61 307.886H608.815v-265.2c0-11.307-9.159-20.466-20.466-20.466H180.254c-11.307 0-20.466 9.159-20.466 20.466v938.628c0 11.297 9.159 20.466 20.466 20.466h693.761c11.308 0 20.466-9.169 20.466-20.466V328.352a20.463 20.463 0 00-5.986-14.47zm-34.946 646.965H200.72V63.152h367.163v265.2c0 11.308 9.169 20.466 20.466 20.466h265.2v612.03z"})}),IZ=dae((n,e)=>{const t=VLe(n.name),[r,i]=dL(n.name),s=()=>Zre(n,i==null?void 0:i.toLowerCase());if(t==="model"){const o=new ih;return o.src=s(),o}else if(t==="image"&&e&&"texture"in e){const o=r.toLowerCase();"roughness"in e?o.includes("rough")?e.roughnessMap=s():o.includes("metal")?e.metalnessMap=s():o.includes("normal")?e.normalMap=s():o.includes("disp")?e.displacementMap=s():o.includes("emissive")?e.emissiveMap=s():e.texture=s():e.texture=s()}}),K4e=({file:n})=>{const[e,t]=n4e();return Ve("div",{style:{width:70,height:90,background:e===n?"rgba(255, 255, 255, 0.1)":void 0},draggable:!0,onDragStart:r=>{IZ(n),r.dataTransfer.setDragImage(pae,0,0)},onDragEnd:()=>IZ(void 0),onMouseDown:r=>(r.stopPropagation(),t(n)),children:[Ve("div",{style:{display:"flex",width:"100%",justifyContent:"center",paddingTop:10,paddingBottom:4},children:Ve(Z4e,{})}),Ve("div",{style:{display:"flex",width:"100%",justifyContent:"center",paddingLeft:10,paddingRight:10},children:Ve("div",{style:{wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",lineClamp:2,webkitLineClamp:2,webkitBoxOrient:"vertical"},children:n.name})})]})},J4e=()=>Ve("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 1024 1024",style:{margin:2,opacity:.25,flexShrink:0},children:Ve("path",{fill:"#fff",d:"M880 298.4H521L403.7 186.2c-1.5-1.4-3.5-2.2-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32z"})}),$3=new WeakMap,vae=({fileStructure:n,firstFolderName:e,folderName:t,myPath:r})=>{const i=Object.entries(n),[s,o]=Yoe(),a=()=>i.map(([c,u])=>u instanceof File?null:Ve(vae,{fileStructure:u,firstFolderName:e,folderName:c,myPath:e+$3.get(u)}));return r?Ve(LH,{label:t,expanded:!0,expandable:!0,selected:r===s,onClick:()=>o(r),IconComponent:J4e,children:a}):Ve(Pc,{children:a()})},gae=()=>{const[n]=t4e(),[e,t]=Yoe(),[r,i]=Im(()=>{const o={};let a="";if(n){for(const c of n)Gpe(o,c.webkitRelativePath.split("/"),c);a=Object.keys(o)[0],PR(o,(c,u,d)=>{let p="";$3.has(d)&&(p=$3.get(d)+"/"+c),typeof u=="object"&&$3.set(u,p)})}return t(a),[o,a]},[n]),s=Im(()=>{const o=la.exports.get(r,e.split("/"));return o&&Object.values(o).filter(a=>a instanceof File&&a.name[0]!==".")},[r,e]);return Ve("div",{className:"lingo3d-ui lingo3d-bg",style:{height:200,width:"100%",display:"grid",gridTemplateColumns:"200px 1fr",gridTemplateRows:"24px 1fr",gridColumnGap:"0px",gridRowGap:"0px"},children:[Ve("div",{style:{gridArea:"1 / 1 / 2 / 3",background:"rgba(0, 0, 0, 0.1)",display:"flex"},children:Ve(aae,{title:"file browser",gap:4,children:Ve(Q3,{onClick:()=>SH(!1),children:Ve(Y4e,{})})})}),Ve("div",{style:{gridArea:"2 / 1 / 3 / 2",overflow:"scroll"},children:Ve(vae,{fileStructure:r,firstFolderName:i})}),Ve("div",{style:{gridArea:"2 / 2 / 3 / 3"},children:Ve("div",{style:{width:"100%",height:"100%",overflow:"scroll",display:"flex",flexWrap:"wrap",position:"absolute"},onMouseDown:()=>Goe(void 0),children:s==null?void 0:s.map(o=>Ve(K4e,{file:o}))})})]})};$m(gae,"lingo3d-filebrowser");const Q4e=({embedded:n})=>{const e=mO(null);Rc(()=>{const r=e.current;!r||n||(ra.autoMount=r)},[n]);const[t]=r4e();return Ve("div",{className:"lingo3d-ui",style:n?{display:"flex",flexWrap:"nowrap",height:"100vh"}:{width:"100%",height:"100%",position:"absolute",left:0,top:0,display:"flex",flexWrap:"nowrap"},children:[Ve(Zoe,{}),Ve("div",{children:[Ve("div",{style:{height:t?"calc(100% - 200px)":"100%"},children:[Ve(lae,{}),Ve(uae,{}),Ve(hae,{}),Ve(fae,{})]}),t&&Ve(gae,{})]}),Ve(mae,{}),Ve("div",{ref:e,style:{height:"100%",flexGrow:1,position:"relative"}})]})};$m(Q4e,"lingo3d-lingoeditor");const $4e=db(`
    <style>
        .lingo3d-ui * {
            user-select: none;
            -webkit-user-select: none;
            position: relative;
            box-sizing: border-box;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji" !important;
            scrollbar-width: thin;
            scrollbar-color: rgba(100,100,100,0.1);
        }
        .lingo3d-ui {
            position: relative;
            box-sizing: border-box;
            overflow: hidden;
            float: left;
            color: white;
            font-size: 11px;
            max-height: 100%;
        }
        .lingo3d-ui *::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }
        .lingo3d-ui *::-webkit-scrollbar-thumb {
            background: rgba(100,100,100,0.7);
        }
        .lingo3d-ui *::-webkit-scrollbar-track {
            background: rgba(100,100,100,0.1);
        }
        .lingo3d-ui *::-webkit-scrollbar-corner {
            background: rgba(100,100,100,0.1);
        }
        .lingo3d-bg {
            background: rgb(40, 41, 46);
        }
        .tp-lblv_l {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .tp-rotv {
            box-shadow: none !important;
            background-color: transparent !important;
        }
        .tp-brkv {
            border-left: none !important;
        }
    </style>
`);document.head.appendChild($4e);uu(()=>{},100,"both");Fr(Kse,Jse);Fr(Wne,Gne);Fr(Pie,Tie);const eIe=Fr(XL,qL),NZ=Um({__name:"Model",props:eIe,setup(n,{expose:e}){const t=kD(n,ih);return e(t),(r,i)=>IC(r.$slots,"default")}}),tIe=Fr(mie,uH),kZ=Um({__name:"Dummy",props:tIe,setup(n,{expose:e}){const t=kD(n,Vy);return e(t),(r,i)=>IC(r.$slots,"default")}});Fr(vie,gie);const nIe={...hu,element:Object,innerHTML:String,cssColor:String,sprite:Boolean};sb(["element"]);const rIe={...du,element:void 0,innerHTML:void 0,cssColor:"#ffffff",sprite:!1};Fr(nIe,rIe);Fr(_ie,yie);Fr(xie,bie);Fr(Nre,kre);Fr(Ore,Lre);Fr(mre,vre);Fr(wie,Sie);Fr(Mie,Cie);Fr(Eie,Aie);Fr(Rie,Oie);Fr(dre,pre);const iIe=Fr(Lie,Die),sIe=Um({__name:"ThirdPersonCamera",props:iIe,setup(n,{expose:e}){const t=kD(n,PM);return e(t),(r,i)=>IC(r.$slots,"default")}});Fr(hH,dH);Fr(Vie,Fie);Fr(Uie,jie);Fr(jse,Hse);Fr(Xse,qse);Fr(Wse,Gse);Fr(Yse,Zse);Fr(NL,kL);const _ae=Fr(hne,PL),oIe=Um({__name:"Find",props:{..._ae,onLoad:Function},setup(n){const e=n,t=r0("parent",void 0),r=qx();aL("parent",r),Wp(a=>{const{name:c}=e,u=Vn(t==null?void 0:t.value);if(!(!u||!c)){if("loaded"in u){const d=u.loaded.then(()=>{r.value=u.find(c)});return a(()=>{d.cancel()})}r.value=u.find(c)}});const i=Fj(()=>!r.value),s=ND(PL),o=MH(e,s,i);return CH(r,void 0,o,s),Wp(()=>{var a;const c=Vn(r.value);c&&((a=e.onLoad)==null||a.call(e,c))}),(a,c)=>IC(a.$slots,"default")}});({..._ae});Fr(roe,ioe);Fr($se,eoe);const yae=(n,e)=>t=>Math.max(Math.min(t,e),n);function aIe(n){return typeof n=="string"}const IH={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n};Object.assign(Object.assign({},IH),{transform:yae(0,1)});Object.assign(Object.assign({},IH),{default:1});const lIe=n=>({test:e=>aIe(e)&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),PV=lIe("%");Object.assign(Object.assign({},PV),{parse:n=>PV.parse(n)/100,transform:n=>PV.transform(n*100)});const cIe=yae(0,255);Object.assign(Object.assign({},IH),{transform:n=>Math.round(cIe(n))});const xae=1/60*1e3,uIe=typeof performance<"u"?()=>performance.now():()=>Date.now(),bae=typeof window<"u"?n=>window.requestAnimationFrame(n):n=>setTimeout(()=>n(uIe()),xae);function hIe(n){let e=[],t=[],r=0,i=!1,s=!1;const o=new WeakSet,a={schedule:(c,u=!1,d=!1)=>{const p=d&&i,f=p?e:t;return u&&o.add(c),f.indexOf(c)===-1&&(f.push(c),p&&i&&(r=e.length)),c},cancel:c=>{const u=t.indexOf(c);u!==-1&&t.splice(u,1),o.delete(c)},process:c=>{if(i){s=!0;return}if(i=!0,[e,t]=[t,e],t.length=0,r=e.length,r)for(let u=0;u<r;u++){const d=e[u];d(c),o.has(d)&&(a.schedule(d),n())}i=!1,s&&(s=!1,a.process(c))}};return a}const dIe=40;let ZU=!0,uC=!1,KU=!1;const DM={delta:0,timestamp:0},Q2=["read","update","preRender","render","postRender"],BD=Q2.reduce((n,e)=>(n[e]=hIe(()=>uC=!0),n),{});Q2.reduce((n,e)=>{const t=BD[e];return n[e]=(r,i=!1,s=!1)=>(uC||fIe(),t.schedule(r,i,s)),n},{});Q2.reduce((n,e)=>(n[e]=BD[e].cancel,n),{});Q2.reduce((n,e)=>(n[e]=()=>BD[e].process(DM),n),{});const pIe=n=>BD[n].process(DM),wae=n=>{uC=!1,DM.delta=ZU?xae:Math.max(Math.min(n-DM.timestamp,dIe),1),DM.timestamp=n,KU=!0,Q2.forEach(pIe),KU=!1,uC&&(ZU=!1,bae(wae))},fIe=()=>{uC=!0,ZU=!0,KU||bae(wae)};var Ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},JU={exports:{}};(function(n,e){(function(t,r){r(e)})(Ct,function(t){ArrayBuffer.isView||(ArrayBuffer.isView=function(E){return E!==null&&typeof E=="object"&&E.buffer instanceof ArrayBuffer}),typeof globalThis>"u"&&typeof window<"u"&&(window.globalThis=window);/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.

	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.

	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */var r=function(E,F){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,Z){z.__proto__=Z}||function(z,Z){for(var de in Z)Object.prototype.hasOwnProperty.call(Z,de)&&(z[de]=Z[de])},r(E,F)};function i(E,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");r(E,F);function z(){this.constructor=E}E.prototype=F===null?Object.create(F):(z.prototype=F.prototype,new z)}function s(E,F,z,Z){function de(be){return be instanceof z?be:new z(function(oe){oe(be)})}return new(z||(z=Promise))(function(be,oe){function ze(Ge){try{Fe(Z.next(Ge))}catch(at){oe(at)}}function ke(Ge){try{Fe(Z.throw(Ge))}catch(at){oe(at)}}function Fe(Ge){Ge.done?be(Ge.value):de(Ge.value).then(ze,ke)}Fe((Z=Z.apply(E,F||[])).next())})}function o(E,F){var z={label:0,sent:function(){if(be[0]&1)throw be[1];return be[1]},trys:[],ops:[]},Z,de,be,oe;return oe={next:ze(0),throw:ze(1),return:ze(2)},typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function ze(Fe){return function(Ge){return ke([Fe,Ge])}}function ke(Fe){if(Z)throw new TypeError("Generator is already executing.");for(;z;)try{if(Z=1,de&&(be=Fe[0]&2?de.return:Fe[0]?de.throw||((be=de.return)&&be.call(de),0):de.next)&&!(be=be.call(de,Fe[1])).done)return be;switch(de=0,be&&(Fe=[Fe[0]&2,be.value]),Fe[0]){case 0:case 1:be=Fe;break;case 4:return z.label++,{value:Fe[1],done:!1};case 5:z.label++,de=Fe[1],Fe=[0];continue;case 7:Fe=z.ops.pop(),z.trys.pop();continue;default:if(be=z.trys,!(be=be.length>0&&be[be.length-1])&&(Fe[0]===6||Fe[0]===2)){z=0;continue}if(Fe[0]===3&&(!be||Fe[1]>be[0]&&Fe[1]<be[3])){z.label=Fe[1];break}if(Fe[0]===6&&z.label<be[1]){z.label=be[1],be=Fe;break}if(be&&z.label<be[2]){z.label=be[2],z.ops.push(Fe);break}be[2]&&z.ops.pop(),z.trys.pop();continue}Fe=F.call(E,z)}catch(Ge){Fe=[6,Ge],de=0}finally{Z=be=0}if(Fe[0]&5)throw Fe[1];return{value:Fe[0]?Fe[1]:void 0,done:!0}}}function a(E,F){F.headers=E.headers||{},F.statusMessage=E.statusText,F.statusCode=E.status,F.data=E.response}function c(E,F,z){return new Promise(function(Z,de){z=z||{};var be=new XMLHttpRequest,oe,ze,ke,Fe=z.body,Ge=z.headers||{};z.timeout&&(be.timeout=z.timeout),be.ontimeout=be.onerror=function(at){at.timeout=at.type=="timeout",de(at)},be.open(E,F.href||F),be.onload=function(){for(ke=be.getAllResponseHeaders().trim().split(/[\r\n]+/),a(be,be);ze=ke.shift();)ze=ze.split(": "),be.headers[ze.shift().toLowerCase()]=ze.join(": ");if(ze=be.headers["content-type"],ze&&!!~ze.indexOf("application/json"))try{be.data=JSON.parse(be.data,z.reviver)}catch(at){return a(be,at),de(at)}(be.status>=400?de:Z)(be)},typeof FormData<"u"&&Fe instanceof FormData||Fe&&typeof Fe=="object"&&(Ge["content-type"]="application/json",Fe=JSON.stringify(Fe)),be.withCredentials=!!z.withCredentials;for(oe in Ge)be.setRequestHeader(oe,Ge[oe]);be.send(Fe)})}var u=c.bind(c,"GET"),d=c.bind(c,"POST"),p=c.bind(c,"PATCH"),f=c.bind(c,"DELETE"),v=c.bind(c,"PUT"),x=f,y=u,_=p,S=d,C=v,A=c,P={del:x,get:y,patch:_,post:S,put:C,send:A},D=Object.freeze(Object.assign(Object.create(null),P,{default:P,del:x,get:y,patch:_,post:S,put:C,send:A})),N=function(E){i(F,E);function F(z,Z){var de=E.call(this,Z)||this;return de.name="ServerError",de.code=z,de}return F}(Error);function j(E,F){if(this._offset=F,E instanceof ArrayBuffer)this._buffer=E,this._view=new DataView(this._buffer);else if(ArrayBuffer.isView(E))this._buffer=E.buffer,this._view=new DataView(this._buffer,E.byteOffset,E.byteLength);else throw new Error("Invalid argument")}function T(E,F,z){for(var Z="",de=0,be=F,oe=F+z;be<oe;be++){var ze=E.getUint8(be);if((ze&128)===0){Z+=String.fromCharCode(ze);continue}if((ze&224)===192){Z+=String.fromCharCode((ze&31)<<6|E.getUint8(++be)&63);continue}if((ze&240)===224){Z+=String.fromCharCode((ze&15)<<12|(E.getUint8(++be)&63)<<6|(E.getUint8(++be)&63)<<0);continue}if((ze&248)===240){de=(ze&7)<<18|(E.getUint8(++be)&63)<<12|(E.getUint8(++be)&63)<<6|(E.getUint8(++be)&63)<<0,de>=65536?(de-=65536,Z+=String.fromCharCode((de>>>10)+55296,(de&1023)+56320)):Z+=String.fromCharCode(de);continue}throw new Error("Invalid byte "+ze.toString(16))}return Z}j.prototype._array=function(E){for(var F=new Array(E),z=0;z<E;z++)F[z]=this._parse();return F},j.prototype._map=function(E){for(var F="",z={},Z=0;Z<E;Z++)F=this._parse(),z[F]=this._parse();return z},j.prototype._str=function(E){var F=T(this._view,this._offset,E);return this._offset+=E,F},j.prototype._bin=function(E){var F=this._buffer.slice(this._offset,this._offset+E);return this._offset+=E,F},j.prototype._parse=function(){var E=this._view.getUint8(this._offset++),F,z=0,Z=0,de=0,be=0;if(E<192)return E<128?E:E<144?this._map(E&15):E<160?this._array(E&15):this._str(E&31);if(E>223)return(255-E+1)*-1;switch(E){case 192:return null;case 194:return!1;case 195:return!0;case 196:return z=this._view.getUint8(this._offset),this._offset+=1,this._bin(z);case 197:return z=this._view.getUint16(this._offset),this._offset+=2,this._bin(z);case 198:return z=this._view.getUint32(this._offset),this._offset+=4,this._bin(z);case 199:return z=this._view.getUint8(this._offset),Z=this._view.getInt8(this._offset+1),this._offset+=2,[Z,this._bin(z)];case 200:return z=this._view.getUint16(this._offset),Z=this._view.getInt8(this._offset+2),this._offset+=3,[Z,this._bin(z)];case 201:return z=this._view.getUint32(this._offset),Z=this._view.getInt8(this._offset+4),this._offset+=5,[Z,this._bin(z)];case 202:return F=this._view.getFloat32(this._offset),this._offset+=4,F;case 203:return F=this._view.getFloat64(this._offset),this._offset+=8,F;case 204:return F=this._view.getUint8(this._offset),this._offset+=1,F;case 205:return F=this._view.getUint16(this._offset),this._offset+=2,F;case 206:return F=this._view.getUint32(this._offset),this._offset+=4,F;case 207:return de=this._view.getUint32(this._offset)*Math.pow(2,32),be=this._view.getUint32(this._offset+4),this._offset+=8,de+be;case 208:return F=this._view.getInt8(this._offset),this._offset+=1,F;case 209:return F=this._view.getInt16(this._offset),this._offset+=2,F;case 210:return F=this._view.getInt32(this._offset),this._offset+=4,F;case 211:return de=this._view.getInt32(this._offset)*Math.pow(2,32),be=this._view.getUint32(this._offset+4),this._offset+=8,de+be;case 212:if(Z=this._view.getInt8(this._offset),this._offset+=1,Z===0){this._offset+=1;return}return[Z,this._bin(1)];case 213:return Z=this._view.getInt8(this._offset),this._offset+=1,[Z,this._bin(2)];case 214:return Z=this._view.getInt8(this._offset),this._offset+=1,[Z,this._bin(4)];case 215:return Z=this._view.getInt8(this._offset),this._offset+=1,Z===0?(de=this._view.getInt32(this._offset)*Math.pow(2,32),be=this._view.getUint32(this._offset+4),this._offset+=8,new Date(de+be)):[Z,this._bin(8)];case 216:return Z=this._view.getInt8(this._offset),this._offset+=1,[Z,this._bin(16)];case 217:return z=this._view.getUint8(this._offset),this._offset+=1,this._str(z);case 218:return z=this._view.getUint16(this._offset),this._offset+=2,this._str(z);case 219:return z=this._view.getUint32(this._offset),this._offset+=4,this._str(z);case 220:return z=this._view.getUint16(this._offset),this._offset+=2,this._array(z);case 221:return z=this._view.getUint32(this._offset),this._offset+=4,this._array(z);case 222:return z=this._view.getUint16(this._offset),this._offset+=2,this._map(z);case 223:return z=this._view.getUint32(this._offset),this._offset+=4,this._map(z)}throw new Error("Could not parse")};function k(E,F){F===void 0&&(F=0);var z=new j(E,F),Z=z._parse();if(z._offset!==E.byteLength)throw new Error(E.byteLength-z._offset+" trailing bytes");return Z}function U(E,F,z){for(var Z=0,de=0,be=z.length;de<be;de++)Z=z.charCodeAt(de),Z<128?E.setUint8(F++,Z):Z<2048?(E.setUint8(F++,192|Z>>6),E.setUint8(F++,128|Z&63)):Z<55296||Z>=57344?(E.setUint8(F++,224|Z>>12),E.setUint8(F++,128|Z>>6&63),E.setUint8(F++,128|Z&63)):(de++,Z=65536+((Z&1023)<<10|z.charCodeAt(de)&1023),E.setUint8(F++,240|Z>>18),E.setUint8(F++,128|Z>>12&63),E.setUint8(F++,128|Z>>6&63),E.setUint8(F++,128|Z&63))}function ee(E){for(var F=0,z=0,Z=0,de=E.length;Z<de;Z++)F=E.charCodeAt(Z),F<128?z+=1:F<2048?z+=2:F<55296||F>=57344?z+=3:(Z++,z+=4);return z}function xe(E,F,z){var Z=typeof z,de=0,be=0,oe=0,ze=0,ke=0,Fe=0;if(Z==="string"){if(ke=ee(z),ke<32)E.push(ke|160),Fe=1;else if(ke<256)E.push(217,ke),Fe=2;else if(ke<65536)E.push(218,ke>>8,ke),Fe=3;else if(ke<4294967296)E.push(219,ke>>24,ke>>16,ke>>8,ke),Fe=5;else throw new Error("String too long");return F.push({_str:z,_length:ke,_offset:E.length}),Fe+ke}if(Z==="number")return Math.floor(z)!==z||!isFinite(z)?(E.push(203),F.push({_float:z,_length:8,_offset:E.length}),9):z>=0?z<128?(E.push(z),1):z<256?(E.push(204,z),2):z<65536?(E.push(205,z>>8,z),3):z<4294967296?(E.push(206,z>>24,z>>16,z>>8,z),5):(oe=z/Math.pow(2,32)>>0,ze=z>>>0,E.push(207,oe>>24,oe>>16,oe>>8,oe,ze>>24,ze>>16,ze>>8,ze),9):z>=-32?(E.push(z),1):z>=-128?(E.push(208,z),2):z>=-32768?(E.push(209,z>>8,z),3):z>=-2147483648?(E.push(210,z>>24,z>>16,z>>8,z),5):(oe=Math.floor(z/Math.pow(2,32)),ze=z>>>0,E.push(211,oe>>24,oe>>16,oe>>8,oe,ze>>24,ze>>16,ze>>8,ze),9);if(Z==="object"){if(z===null)return E.push(192),1;if(Array.isArray(z)){if(ke=z.length,ke<16)E.push(ke|144),Fe=1;else if(ke<65536)E.push(220,ke>>8,ke),Fe=3;else if(ke<4294967296)E.push(221,ke>>24,ke>>16,ke>>8,ke),Fe=5;else throw new Error("Array too large");for(de=0;de<ke;de++)Fe+=xe(E,F,z[de]);return Fe}if(z instanceof Date){var Ge=z.getTime();return oe=Math.floor(Ge/Math.pow(2,32)),ze=Ge>>>0,E.push(215,0,oe>>24,oe>>16,oe>>8,oe,ze>>24,ze>>16,ze>>8,ze),10}if(z instanceof ArrayBuffer){if(ke=z.byteLength,ke<256)E.push(196,ke),Fe=2;else if(ke<65536)E.push(197,ke>>8,ke),Fe=3;else if(ke<4294967296)E.push(198,ke>>24,ke>>16,ke>>8,ke),Fe=5;else throw new Error("Buffer too large");return F.push({_bin:z,_length:ke,_offset:E.length}),Fe+ke}if(typeof z.toJSON=="function")return xe(E,F,z.toJSON());var at=[],pt="",Dt=Object.keys(z);for(de=0,be=Dt.length;de<be;de++)pt=Dt[de],typeof z[pt]!="function"&&at.push(pt);if(ke=at.length,ke<16)E.push(ke|128),Fe=1;else if(ke<65536)E.push(222,ke>>8,ke),Fe=3;else if(ke<4294967296)E.push(223,ke>>24,ke>>16,ke>>8,ke),Fe=5;else throw new Error("Object too large");for(de=0;de<ke;de++)pt=at[de],Fe+=xe(E,F,pt),Fe+=xe(E,F,z[pt]);return Fe}if(Z==="boolean")return E.push(z?195:194),1;if(Z==="undefined")return E.push(212,0,0),3;throw new Error("Could not encode")}function ce(E){var F=[],z=[],Z=xe(F,z,E),de=new ArrayBuffer(Z),be=new DataView(de),oe=0,ze=0,ke=-1;z.length>0&&(ke=z[0]._offset);for(var Fe,Ge=0,at=0,pt=0,Dt=F.length;pt<Dt;pt++)if(be.setUint8(ze+pt,F[pt]),pt+1===ke){if(Fe=z[oe],Ge=Fe._length,at=ze+ke,Fe._bin)for(var re=new Uint8Array(Fe._bin),$e=0;$e<Ge;$e++)be.setUint8(at+$e,re[$e]);else Fe._str?U(be,at,Fe._str):Fe._float!==void 0&&be.setFloat64(at,Fe._float);oe++,ze+=Ge,z[oe]&&(ke=z[oe]._offset)}return de}var te=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},fe=globalThis.WebSocket||te,ge=function(){function E(F){this.events=F}return E.prototype.send=function(F){F instanceof ArrayBuffer?this.ws.send(F):Array.isArray(F)&&this.ws.send(new Uint8Array(F).buffer)},E.prototype.connect=function(F){this.ws=new fe(F,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror},E.prototype.close=function(F,z){this.ws.close(F,z)},E}(),Se=function(){function E(){this.events={},this.transport=new ge(this.events)}return E.prototype.send=function(F){this.transport.send(F)},E.prototype.connect=function(F){this.transport.connect(F)},E.prototype.close=function(F,z){this.transport.close(F,z)},E}(),pe={};function se(E,F){pe[E]=F}function ae(E){var F=pe[E];if(!F)throw new Error("missing serializer: "+E);return F}t.Protocol=void 0,function(E){E[E.HANDSHAKE=9]="HANDSHAKE",E[E.JOIN_ROOM=10]="JOIN_ROOM",E[E.ERROR=11]="ERROR",E[E.LEAVE_ROOM=12]="LEAVE_ROOM",E[E.ROOM_DATA=13]="ROOM_DATA",E[E.ROOM_STATE=14]="ROOM_STATE",E[E.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",E[E.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA"}(t.Protocol||(t.Protocol={})),t.ErrorCode=void 0,function(E){E[E.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",E[E.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",E[E.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",E[E.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",E[E.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",E[E.AUTH_FAILED=4215]="AUTH_FAILED",E[E.APPLICATION_ERROR=4216]="APPLICATION_ERROR"}(t.ErrorCode||(t.ErrorCode={}));function Le(E,F){for(var z=E[F++],Z="",de=0,be=F,oe=F+z;be<oe;be++){var ze=E[be];if((ze&128)===0){Z+=String.fromCharCode(ze);continue}if((ze&224)===192){Z+=String.fromCharCode((ze&31)<<6|E[++be]&63);continue}if((ze&240)===224){Z+=String.fromCharCode((ze&15)<<12|(E[++be]&63)<<6|(E[++be]&63)<<0);continue}if((ze&248)===240){de=(ze&7)<<18|(E[++be]&63)<<12|(E[++be]&63)<<6|(E[++be]&63)<<0,de>=65536?(de-=65536,Z+=String.fromCharCode((de>>>10)+55296,(de&1023)+56320)):Z+=String.fromCharCode(de);continue}throw new Error("Invalid byte "+ze.toString(16))}return Z}function Re(E){E===void 0&&(E="");for(var F=0,z=0,Z=0,de=E.length;Z<de;Z++)F=E.charCodeAt(Z),F<128?z+=1:F<2048?z+=2:F<55296||F>=57344?z+=3:(Z++,z+=4);return z+1}let Ue=()=>({events:{},emit(E,...F){(this.events[E]||[]).forEach(z=>z(...F))},on(E,F){return(this.events[E]=this.events[E]||[]).push(F),()=>this.events[E]=(this.events[E]||[]).filter(z=>z!==F)}});var Ze=function(){function E(){this.handlers=[]}return E.prototype.register=function(F,z){return this.handlers.push(F),this},E.prototype.invoke=function(){for(var F=this,z=[],Z=0;Z<arguments.length;Z++)z[Z]=arguments[Z];this.handlers.forEach(function(de){return de.apply(F,z)})},E.prototype.invokeAsync=function(){for(var F=this,z=[],Z=0;Z<arguments.length;Z++)z[Z]=arguments[Z];return Promise.all(this.handlers.map(function(de){return de.apply(F,z)}))},E.prototype.remove=function(F){var z=this.handlers.indexOf(F);this.handlers[z]=this.handlers[this.handlers.length-1],this.handlers.pop()},E.prototype.clear=function(){this.handlers=[]},E}();function st(){var E=new Ze;function F(z){return E.register(z,this===null)}return F.once=function(z){var Z=function(){for(var de=[],be=0;be<arguments.length;be++)de[be]=arguments[be];z.apply(this,de),E.remove(Z)};E.register(Z)},F.remove=function(z){return E.remove(z)},F.invoke=function(){for(var z=[],Z=0;Z<arguments.length;Z++)z[Z]=arguments[Z];return E.invoke.apply(E,z)},F.invokeAsync=function(){for(var z=[],Z=0;Z<arguments.length;Z++)z[Z]=arguments[Z];return E.invokeAsync.apply(E,z)},F.clear=function(){return E.clear()},F}var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ct<"u"?Ct:typeof self<"u"?self:{};function Mt(E){var F={exports:{}};return E(F,F.exports),F.exports}var rt=Mt(function(E,F){(function(z,Z){Z(F)})(we,function(z){/*! *****************************************************************************
	        Copyright (c) Microsoft Corporation.

	        Permission to use, copy, modify, and/or distribute this software for any
	        purpose with or without fee is hereby granted.

	        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	        PERFORMANCE OF THIS SOFTWARE.
	        ***************************************************************************** */var Z=function(X,B){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,he){q.__proto__=he}||function(q,he){for(var qe in he)Object.prototype.hasOwnProperty.call(he,qe)&&(q[qe]=he[qe])},Z(X,B)};function de(X,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");Z(X,B);function q(){this.constructor=X}X.prototype=B===null?Object.create(B):(q.prototype=B.prototype,new q)}function be(X,B,q,he){var qe=arguments.length,dt=qe<3?B:he===null?he=Object.getOwnPropertyDescriptor(B,q):he,on;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")dt=Reflect.decorate(X,B,q,he);else for(var Gt=X.length-1;Gt>=0;Gt--)(on=X[Gt])&&(dt=(qe<3?on(dt):qe>3?on(B,q,dt):on(B,q))||dt);return qe>3&&dt&&Object.defineProperty(B,q,dt),dt}function oe(X,B){for(var q=0,he=B.length,qe=X.length;q<he;q++,qe++)X[qe]=B[q];return X}var ze=255,ke=213;z.OPERATION=void 0,function(X){X[X.ADD=128]="ADD",X[X.REPLACE=0]="REPLACE",X[X.DELETE=64]="DELETE",X[X.DELETE_AND_ADD=192]="DELETE_AND_ADD",X[X.TOUCH=1]="TOUCH",X[X.CLEAR=10]="CLEAR"}(z.OPERATION||(z.OPERATION={}));var Fe=function(){function X(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return X.prototype.getNextUniqueId=function(){return this.nextUniqueId++},X.prototype.addRef=function(B,q,he){he===void 0&&(he=!0),this.refs.set(B,q),he&&(this.refCounts[B]=(this.refCounts[B]||0)+1)},X.prototype.removeRef=function(B){this.refCounts[B]=this.refCounts[B]-1,this.deletedRefs.add(B)},X.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},X.prototype.garbageCollectDeletedRefs=function(){var B=this;this.deletedRefs.forEach(function(q){if(B.refCounts[q]<=0){var he=B.refs.get(q);if(he instanceof Li)for(var qe in he._definition.schema)typeof he._definition.schema[qe]!="string"&&he[qe]&&he[qe].$changes&&B.removeRef(he[qe].$changes.refId);else{var dt=he.$changes.parent._definition,on=dt.schema[dt.fieldsByIndex[he.$changes.parentIndex]];typeof Object.values(on)[0]=="function"&&Array.from(he.values()).forEach(function(Gt){return B.removeRef(Gt.$changes.refId)})}B.refs.delete(q),delete B.refCounts[q]}}),this.deletedRefs.clear()},X}(),Ge=function(){function X(B,q,he){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=B,this.setParent(q,he)}return X.prototype.setParent=function(B,q,he){var qe=this;if(this.indexes||(this.indexes=this.ref instanceof Li?this.ref._definition.indexes:{}),this.parent=B,this.parentIndex=he,!!q)if(this.root=q,this.ref instanceof Li){var dt=this.ref._definition;for(var on in dt.schema){var Gt=this.ref[on];if(Gt&&Gt.$changes){var In=dt.indexes[on];Gt.$changes.setParent(this.ref,q,In)}}}else typeof this.ref=="object"&&this.ref.forEach(function(gt,ht){if(gt instanceof Li){var $t=gt.$changes,Kn=qe.ref.$changes.indexes[ht];$t.setParent(qe.ref,qe.root,Kn)}})},X.prototype.operation=function(B){this.changes.set(--this.currentCustomOperation,B)},X.prototype.change=function(B,q){q===void 0&&(q=z.OPERATION.ADD);var he=typeof B=="number"?B:this.indexes[B];this.assertValidIndex(he,B);var qe=this.changes.get(he);(!qe||qe.op===z.OPERATION.DELETE||qe.op===z.OPERATION.TOUCH)&&this.changes.set(he,{op:qe&&qe.op===z.OPERATION.DELETE?z.OPERATION.DELETE_AND_ADD:q,index:he}),this.allChanges.add(he),this.changed=!0,this.touchParents()},X.prototype.touch=function(B){var q=typeof B=="number"?B:this.indexes[B];this.assertValidIndex(q,B),this.changes.has(q)||this.changes.set(q,{op:z.OPERATION.TOUCH,index:q}),this.allChanges.add(q),this.touchParents()},X.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},X.prototype.getType=function(B){if(this.ref._definition){var q=this.ref._definition;return q.schema[q.fieldsByIndex[B]]}else{var q=this.parent._definition,he=q.schema[q.fieldsByIndex[this.parentIndex]];return Object.values(he)[0]}},X.prototype.getChildrenFilter=function(){var B=this.parent._definition.childFilters;return B&&B[this.parentIndex]},X.prototype.getValue=function(B){return this.ref.getByIndex(B)},X.prototype.delete=function(B){var q=typeof B=="number"?B:this.indexes[B];if(q===void 0){console.warn("@colyseus/schema "+this.ref.constructor.name+": trying to delete non-existing index: "+B+" ("+q+")");return}var he=this.getValue(q);this.changes.set(q,{op:z.OPERATION.DELETE,index:q}),this.allChanges.delete(q),delete this.caches[q],he&&he.$changes&&(he.$changes.parent=void 0),this.changed=!0,this.touchParents()},X.prototype.discard=function(B,q){var he=this;B===void 0&&(B=!1),q===void 0&&(q=!1),this.ref instanceof Li||this.changes.forEach(function(qe){if(qe.op===z.OPERATION.DELETE){var dt=he.ref.getIndex(qe.index);delete he.indexes[dt]}}),this.changes.clear(),this.changed=B,q&&this.allChanges.clear(),this.currentCustomOperation=0},X.prototype.discardAll=function(){var B=this;this.changes.forEach(function(q){var he=B.getValue(q.index);he&&he.$changes&&he.$changes.discardAll()}),this.discard()},X.prototype.cache=function(B,q){this.caches[B]=q},X.prototype.clone=function(){return new X(this.ref,this.parent,this.root)},X.prototype.ensureRefId=function(){this.refId===void 0&&(this.refId=this.root.getNextUniqueId())},X.prototype.assertValidIndex=function(B,q){if(B===void 0)throw new Error('ChangeTree: missing index for field "'+q+'"')},X}(),at=function(X,B){var q=X.toString(),he=B.toString();return q<he?-1:q>he?1:0};function pt(X){return X.$proxy=!0,X=new Proxy(X,{get:function(B,q){return typeof q!="symbol"&&!isNaN(q)?B.at(q):B[q]},set:function(B,q,he){if(typeof q!="symbol"&&!isNaN(q)){var qe=Array.from(B.$items.keys()),dt=parseInt(qe[q]||q);he==null?B.deleteAt(dt):B.setAt(dt,he)}else B[q]=he;return!0},deleteProperty:function(B,q){return typeof q=="number"?B.deleteAt(q):delete B[q],!0}}),X}var Dt=function(){function X(){for(var B=[],q=0;q<arguments.length;q++)B[q]=arguments[q];this.$changes=new Ge(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,B)}return X.is=function(B){return Array.isArray(B)||B.array!==void 0},Object.defineProperty(X.prototype,"length",{get:function(){return this.$items.size},set:function(B){B===0?this.clear():this.splice(B,this.length-B)},enumerable:!1,configurable:!0}),X.prototype.push=function(){for(var B=this,q=[],he=0;he<arguments.length;he++)q[he]=arguments[he];var qe;return q.forEach(function(dt){qe=B.$refId++,B.setAt(qe,dt)}),qe},X.prototype.pop=function(){var B=Array.from(this.$indexes.values()).pop();if(B!==void 0){this.$changes.delete(B),this.$indexes.delete(B);var q=this.$items.get(B);return this.$items.delete(B),q}},X.prototype.at=function(B){var q=Array.from(this.$items.keys())[B];return this.$items.get(q)},X.prototype.setAt=function(B,q){var he,qe;q.$changes!==void 0&&q.$changes.setParent(this,this.$changes.root,B);var dt=(qe=(he=this.$changes.indexes[B])===null||he===void 0?void 0:he.op)!==null&&qe!==void 0?qe:z.OPERATION.ADD;this.$changes.indexes[B]=B,this.$indexes.set(B,B),this.$items.set(B,q),this.$changes.change(B,dt)},X.prototype.deleteAt=function(B){var q=Array.from(this.$items.keys())[B];return q===void 0?!1:this.$deleteAt(q)},X.prototype.$deleteAt=function(B){return this.$changes.delete(B),this.$indexes.delete(B),this.$items.delete(B)},X.prototype.clear=function(B){var q=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),B&&typeof this.$changes.getType()!="string"&&this.$items.forEach(function(he){q.$changes.root.removeRef(he.$changes.refId)}),this.$items.clear(),this.$changes.operation({index:0,op:z.OPERATION.CLEAR}),this.$changes.touchParents()},X.prototype.concat=function(){for(var B,q=[],he=0;he<arguments.length;he++)q[he]=arguments[he];return new(X.bind.apply(X,oe([void 0],(B=Array.from(this.$items.values())).concat.apply(B,q))))},X.prototype.join=function(B){return Array.from(this.$items.values()).join(B)},X.prototype.reverse=function(){var B=this,q=Array.from(this.$items.keys()),he=Array.from(this.$items.values()).reverse();return he.forEach(function(qe,dt){B.setAt(q[dt],qe)}),this},X.prototype.shift=function(){var B=Array.from(this.$items.keys()),q=B.shift();if(q!==void 0){var he=this.$items.get(q);return this.$deleteAt(q),he}},X.prototype.slice=function(B,q){return new(X.bind.apply(X,oe([void 0],Array.from(this.$items.values()).slice(B,q))))},X.prototype.sort=function(B){var q=this;B===void 0&&(B=at);var he=Array.from(this.$items.keys()),qe=Array.from(this.$items.values()).sort(B);return qe.forEach(function(dt,on){q.setAt(he[on],dt)}),this},X.prototype.splice=function(B,q){q===void 0&&(q=this.length-B);for(var he=Array.from(this.$items.keys()),qe=[],dt=B;dt<B+q;dt++)qe.push(this.$items.get(he[dt])),this.$deleteAt(he[dt]);return qe},X.prototype.unshift=function(){for(var B=this,q=[],he=0;he<arguments.length;he++)q[he]=arguments[he];var qe=this.length,dt=q.length,on=Array.from(this.$items.values());return q.forEach(function(Gt,In){B.setAt(In,Gt)}),on.forEach(function(Gt,In){B.setAt(dt+In,Gt)}),qe+dt},X.prototype.indexOf=function(B,q){return Array.from(this.$items.values()).indexOf(B,q)},X.prototype.lastIndexOf=function(B,q){return q===void 0&&(q=this.length-1),Array.from(this.$items.values()).lastIndexOf(B,q)},X.prototype.every=function(B,q){return Array.from(this.$items.values()).every(B,q)},X.prototype.some=function(B,q){return Array.from(this.$items.values()).some(B,q)},X.prototype.forEach=function(B,q){Array.from(this.$items.values()).forEach(B,q)},X.prototype.map=function(B,q){return Array.from(this.$items.values()).map(B,q)},X.prototype.filter=function(B,q){return Array.from(this.$items.values()).filter(B,q)},X.prototype.reduce=function(B,q){return Array.from(this.$items.values()).reduce(B,q)},X.prototype.reduceRight=function(B,q){return Array.from(this.$items.values()).reduceRight(B,q)},X.prototype.find=function(B,q){return Array.from(this.$items.values()).find(B,q)},X.prototype.findIndex=function(B,q){return Array.from(this.$items.values()).findIndex(B,q)},X.prototype.fill=function(B,q,he){throw new Error("ArraySchema#fill() not implemented")},X.prototype.copyWithin=function(B,q,he){throw new Error("ArraySchema#copyWithin() not implemented")},X.prototype.toString=function(){return this.$items.toString()},X.prototype.toLocaleString=function(){return this.$items.toLocaleString()},X.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},X.prototype[Symbol.unscopables]=function(){return this.$items[Symbol.unscopables]()},X.prototype.entries=function(){return this.$items.entries()},X.prototype.keys=function(){return this.$items.keys()},X.prototype.values=function(){return this.$items.values()},X.prototype.includes=function(B,q){return Array.from(this.$items.values()).includes(B,q)},X.prototype.flatMap=function(B,q){throw new Error("ArraySchema#flatMap() is not supported.")},X.prototype.flat=function(B){throw new Error("ArraySchema#flat() is not supported.")},X.prototype.setIndex=function(B,q){this.$indexes.set(B,q)},X.prototype.getIndex=function(B){return this.$indexes.get(B)},X.prototype.getByIndex=function(B){return this.$items.get(this.$indexes.get(B))},X.prototype.deleteByIndex=function(B){var q=this.$indexes.get(B);this.$items.delete(q),this.$indexes.delete(B)},X.prototype.toArray=function(){return Array.from(this.$items.values())},X.prototype.toJSON=function(){return this.toArray().map(function(B){return typeof B.toJSON=="function"?B.toJSON():B})},X.prototype.clone=function(B){var q;return B?q=new(X.bind.apply(X,oe([void 0],Array.from(this.$items.values())))):q=new(X.bind.apply(X,oe([void 0],this.map(function(he){return he.$changes?he.clone():he})))),q},X.prototype.triggerAll=function(){Li.prototype.triggerAll.apply(this)},X}();function re(X){return X.$proxy=!0,X=new Proxy(X,{get:function(B,q){return typeof q!="symbol"&&typeof B[q]>"u"?B.get(q):B[q]},set:function(B,q,he){return typeof q!="symbol"&&q.indexOf("$")===-1&&q!=="onAdd"&&q!=="onRemove"&&q!=="onChange"?B.set(q,he):B[q]=he,!0},deleteProperty:function(B,q){return B.delete(q),!0}}),X}var $e=function(){function X(B){var q=this;if(this.$changes=new Ge(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,B)if(B instanceof Map)B.forEach(function(qe,dt){return q.set(dt,qe)});else for(var he in B)this.set(he,B[he])}return X.is=function(B){return B.map!==void 0},X.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(X.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),X.prototype.set=function(B,q){if(q==null)throw new Error("MapSchema#set('"+B+"', "+q+"): trying to set "+q+" value on '"+B+"'.");var he=typeof this.$changes.indexes[B]<"u",qe=he?this.$changes.indexes[B]:this.$refId++,dt=he?z.OPERATION.REPLACE:z.OPERATION.ADD,on=q.$changes!==void 0;return on&&q.$changes.setParent(this,this.$changes.root,qe),he?on&&this.$items.get(B)!==q&&(dt=z.OPERATION.ADD):(this.$changes.indexes[B]=qe,this.$indexes.set(qe,B)),this.$items.set(B,q),this.$changes.change(B,dt),this},X.prototype.get=function(B){return this.$items.get(B)},X.prototype.delete=function(B){return this.$changes.delete(B),this.$items.delete(B)},X.prototype.clear=function(B){var q=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),B&&typeof this.$changes.getType()!="string"&&this.$items.forEach(function(he){q.$changes.root.removeRef(he.$changes.refId)}),this.$items.clear(),this.$changes.operation({index:0,op:z.OPERATION.CLEAR}),this.$changes.touchParents()},X.prototype.has=function(B){return this.$items.has(B)},X.prototype.forEach=function(B){this.$items.forEach(B)},X.prototype.entries=function(){return this.$items.entries()},X.prototype.keys=function(){return this.$items.keys()},X.prototype.values=function(){return this.$items.values()},Object.defineProperty(X.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),X.prototype.setIndex=function(B,q){this.$indexes.set(B,q)},X.prototype.getIndex=function(B){return this.$indexes.get(B)},X.prototype.getByIndex=function(B){return this.$items.get(this.$indexes.get(B))},X.prototype.deleteByIndex=function(B){var q=this.$indexes.get(B);this.$items.delete(q),this.$indexes.delete(B)},X.prototype.toJSON=function(){var B={};return this.forEach(function(q,he){B[he]=typeof q.toJSON=="function"?q.toJSON():q}),B},X.prototype.clone=function(B){var q;return B?q=Object.assign(new X,this):(q=new X,this.forEach(function(he,qe){he.$changes?q.set(qe,he.clone()):q.set(qe,he)})),q},X.prototype.triggerAll=function(){Li.prototype.triggerAll.apply(this)},X}(),Me={};function tt(X,B){Me[X]=B}function Je(X){return Me[X]}var Ft=function(){function X(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return X.create=function(B){var q=new X;return q.schema=Object.assign({},B&&B.schema||{}),q.indexes=Object.assign({},B&&B.indexes||{}),q.fieldsByIndex=Object.assign({},B&&B.fieldsByIndex||{}),q.descriptors=Object.assign({},B&&B.descriptors||{}),q.deprecated=Object.assign({},B&&B.deprecated||{}),q},X.prototype.addField=function(B,q){var he=this.getNextFieldIndex();this.fieldsByIndex[he]=B,this.indexes[B]=he,this.schema[B]=Array.isArray(q)?{array:q[0]}:q},X.prototype.addFilter=function(B,q){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[B]]=q,this.indexesWithFilters.push(this.indexes[B]),!0},X.prototype.addChildrenFilter=function(B,q){var he=this.indexes[B],qe=this.schema[B];if(Je(Object.keys(qe)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[he]=q,!0;console.warn("@filterChildren: field '"+B+"' can't have children. Ignoring filter.")},X.prototype.getChildrenFilter=function(B){return this.childFilters&&this.childFilters[this.indexes[B]]},X.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},X}();function vn(X){return X._context&&X._context.useFilters}var hn=function(){function X(){this.types={},this.schemas=new Map,this.useFilters=!1}return X.prototype.has=function(B){return this.schemas.has(B)},X.prototype.get=function(B){return this.types[B]},X.prototype.add=function(B,q){q===void 0&&(q=this.schemas.size),B._definition=Ft.create(B._definition),B._typeid=q,this.types[q]=B,this.schemas.set(B,q)},X.create=function(B){return B===void 0&&(B=new X),function(q){return qt(q,B)}},X}(),zr=new hn;function qt(X,B){return B===void 0&&(B=zr),function(q,he){var qe=q.constructor;qe._context=B,B.has(qe)||B.add(qe);var dt=qe._definition;if(dt.addField(he,X),dt.descriptors[he]){if(dt.deprecated[he])return;try{throw new Error("@colyseus/schema: Duplicate '"+he+"' definition on '"+qe.name+`'.
Check @type() annotation`)}catch($t){var on=$t.stack.split(`
`)[4].trim();throw new Error($t.message+" "+on)}}var Gt=Dt.is(X),In=!Gt&&$e.is(X);if(typeof X!="string"&&!Li.is(X)){var gt=Object.values(X)[0];typeof gt!="string"&&!B.has(gt)&&B.add(gt)}var ht="_"+he;dt.descriptors[ht]={enumerable:!1,configurable:!1,writable:!0},dt.descriptors[he]={get:function(){return this[ht]},set:function($t){$t!==this[ht]&&($t!=null?(Gt&&!($t instanceof Dt)&&($t=new(Dt.bind.apply(Dt,oe([void 0],$t)))),In&&!($t instanceof $e)&&($t=new $e($t)),$t.$proxy===void 0&&(In?$t=re($t):Gt&&($t=pt($t))),this.$changes.change(he),$t.$changes&&$t.$changes.setParent(this,this.$changes.root,this._definition.indexes[he])):this.$changes.delete(he),this[ht]=$t)},enumerable:!0,configurable:!0}}}function xr(X){return function(B,q){var he=B.constructor,qe=he._definition;qe.addFilter(q,X)&&(he._context.useFilters=!0)}}function or(X){return function(B,q){var he=B.constructor,qe=he._definition;qe.addChildrenFilter(q,X)&&(he._context.useFilters=!0)}}function Ul(X,B){return X===void 0&&(X=!0),function(q,he){var qe=q.constructor,dt=qe._definition;dt.deprecated[he]=!0,X&&(dt.descriptors[he]={get:function(){throw new Error(he+" is deprecated.")},set:function(on){},enumerable:!1,configurable:!0})}}function Vo(X,B,q){q===void 0&&(q=X._context||zr);for(var he in B)qt(B[he],q)(X.prototype,he);return X}function Fo(X){for(var B=0,q=0,he=0,qe=X.length;he<qe;he++)B=X.charCodeAt(he),B<128?q+=1:B<2048?q+=2:B<55296||B>=57344?q+=3:(he++,q+=4);return q}function Lc(X,B,q){for(var he=0,qe=0,dt=q.length;qe<dt;qe++)he=q.charCodeAt(qe),he<128?X[B++]=he:he<2048?(X[B++]=192|he>>6,X[B++]=128|he&63):he<55296||he>=57344?(X[B++]=224|he>>12,X[B++]=128|he>>6&63,X[B++]=128|he&63):(qe++,he=65536+((he&1023)<<10|q.charCodeAt(qe)&1023),X[B++]=240|he>>18,X[B++]=128|he>>12&63,X[B++]=128|he>>6&63,X[B++]=128|he&63)}function va(X,B){X.push(B&255)}function ei(X,B){X.push(B&255)}function H(X,B){X.push(B&255),X.push(B>>8&255)}function me(X,B){X.push(B&255),X.push(B>>8&255)}function Ce(X,B){X.push(B&255),X.push(B>>8&255),X.push(B>>16&255),X.push(B>>24&255)}function ue(X,B){var q=B>>24,he=B>>16,qe=B>>8,dt=B;X.push(dt&255),X.push(qe&255),X.push(he&255),X.push(q&255)}function Oe(X,B){var q=Math.floor(B/Math.pow(2,32)),he=B>>>0;ue(X,he),ue(X,q)}function lt(X,B){var q=B/Math.pow(2,32)>>0,he=B>>>0;ue(X,he),ue(X,q)}function xt(X,B){It(X,B)}function bt(X,B){gn(X,B)}var wt=new Int32Array(2),Zt=new Float32Array(wt.buffer),kt=new Float64Array(wt.buffer);function It(X,B){Zt[0]=B,Ce(X,wt[0])}function gn(X,B){kt[0]=B,Ce(X,wt[0]),Ce(X,wt[1])}function Bi(X,B){return ei(X,B?1:0)}function Mr(X,B){B||(B="");var q=Fo(B),he=0;if(q<32)X.push(q|160),he=1;else if(q<256)X.push(217),ei(X,q),he=2;else if(q<65536)X.push(218),me(X,q),he=3;else if(q<4294967296)X.push(219),ue(X,q),he=5;else throw new Error("String too long");return Lc(X,X.length,B),he+q}function Ln(X,B){if(isNaN(B))return Ln(X,0);if(isFinite(B)){if(B!==(B|0))return X.push(203),gn(X,B),9}else return Ln(X,B>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER);return B>=0?B<128?(ei(X,B),1):B<256?(X.push(204),ei(X,B),2):B<65536?(X.push(205),me(X,B),3):B<4294967296?(X.push(206),ue(X,B),5):(X.push(207),lt(X,B),9):B>=-32?(X.push(224|B+32),1):B>=-128?(X.push(208),va(X,B),2):B>=-32768?(X.push(209),H(X,B),3):B>=-2147483648?(X.push(210),Ce(X,B),5):(X.push(211),Oe(X,B),9)}var Dn=Object.freeze({__proto__:null,utf8Write:Lc,int8:va,uint8:ei,int16:H,uint16:me,int32:Ce,uint32:ue,int64:Oe,uint64:lt,float32:xt,float64:bt,writeFloat32:It,writeFloat64:gn,boolean:Bi,string:Mr,number:Ln});function Wt(X,B,q){for(var he="",qe=0,dt=B,on=B+q;dt<on;dt++){var Gt=X[dt];if((Gt&128)===0){he+=String.fromCharCode(Gt);continue}if((Gt&224)===192){he+=String.fromCharCode((Gt&31)<<6|X[++dt]&63);continue}if((Gt&240)===224){he+=String.fromCharCode((Gt&15)<<12|(X[++dt]&63)<<6|(X[++dt]&63)<<0);continue}if((Gt&248)===240){qe=(Gt&7)<<18|(X[++dt]&63)<<12|(X[++dt]&63)<<6|(X[++dt]&63)<<0,qe>=65536?(qe-=65536,he+=String.fromCharCode((qe>>>10)+55296,(qe&1023)+56320)):he+=String.fromCharCode(qe);continue}console.error("Invalid byte "+Gt.toString(16))}return he}function ts(X,B){return Fn(X,B)<<24>>24}function Fn(X,B){return X[B.offset++]}function Zn(X,B){return Cr(X,B)<<16>>16}function Cr(X,B){return X[B.offset++]|X[B.offset++]<<8}function Xr(X,B){return X[B.offset++]|X[B.offset++]<<8|X[B.offset++]<<16|X[B.offset++]<<24}function Ts(X,B){return Xr(X,B)>>>0}function Rn(X,B){return Hl(X,B)}function Vi(X,B){return Rs(X,B)}function Uo(X,B){var q=Ts(X,B),he=Xr(X,B)*Math.pow(2,32);return he+q}function Un(X,B){var q=Ts(X,B),he=Ts(X,B)*Math.pow(2,32);return he+q}var fs=new Int32Array(2),jl=new Float32Array(fs.buffer),jo=new Float64Array(fs.buffer);function Hl(X,B){return fs[0]=Xr(X,B),jl[0]}function Rs(X,B){return fs[0]=Xr(X,B),fs[1]=Xr(X,B),jo[0]}function Ho(X,B){return Fn(X,B)>0}function Fa(X,B){var q=X[B.offset++],he;q<192?he=q&31:q===217?he=Fn(X,B):q===218?he=Cr(X,B):q===219&&(he=Ts(X,B));var qe=Wt(X,B.offset,he);return B.offset+=he,qe}function fh(X,B){var q=X[B.offset];return q<192&&q>160||q===217||q===218||q===219}function Wo(X,B){var q=X[B.offset++];if(q<128)return q;if(q===202)return Hl(X,B);if(q===203)return Rs(X,B);if(q===204)return Fn(X,B);if(q===205)return Cr(X,B);if(q===206)return Ts(X,B);if(q===207)return Un(X,B);if(q===208)return ts(X,B);if(q===209)return Zn(X,B);if(q===210)return Xr(X,B);if(q===211)return Uo(X,B);if(q>223)return(255-q+1)*-1}function md(X,B){var q=X[B.offset];return q<128||q>=202&&q<=211}function Ua(X,B){return X[B.offset]<160}function vd(X,B){return X[B.offset-1]===ze&&(X[B.offset]<128||X[B.offset]>=202&&X[B.offset]<=211)}var mh=Object.freeze({__proto__:null,int8:ts,uint8:Fn,int16:Zn,uint16:Cr,int32:Xr,uint32:Ts,float32:Rn,float64:Vi,int64:Uo,uint64:Un,readFloat32:Hl,readFloat64:Rs,boolean:Ho,string:Fa,stringCheck:fh,number:Wo,numberCheck:md,arrayCheck:Ua,switchStructureCheck:vd}),xl=function(){function X(B){var q=this;this.$changes=new Ge(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,B&&B.forEach(function(he){return q.add(he)})}return X.is=function(B){return B.collection!==void 0},X.prototype.add=function(B){var q=this.$refId++,he=B.$changes!==void 0;return he&&B.$changes.setParent(this,this.$changes.root,q),this.$changes.indexes[q]=q,this.$indexes.set(q,q),this.$items.set(q,B),this.$changes.change(q),q},X.prototype.at=function(B){var q=Array.from(this.$items.keys())[B];return this.$items.get(q)},X.prototype.entries=function(){return this.$items.entries()},X.prototype.delete=function(B){for(var q=this.$items.entries(),he,qe;(qe=q.next())&&!qe.done;)if(B===qe.value[1]){he=qe.value[0];break}return he===void 0?!1:(this.$changes.delete(he),this.$indexes.delete(he),this.$items.delete(he))},X.prototype.clear=function(B){var q=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),B&&typeof this.$changes.getType()!="string"&&this.$items.forEach(function(he){q.$changes.root.removeRef(he.$changes.refId)}),this.$items.clear(),this.$changes.operation({index:0,op:z.OPERATION.CLEAR}),this.$changes.touchParents()},X.prototype.has=function(B){return Array.from(this.$items.values()).some(function(q){return q===B})},X.prototype.forEach=function(B){var q=this;this.$items.forEach(function(he,qe,dt){return B(he,qe,q)})},X.prototype.values=function(){return this.$items.values()},Object.defineProperty(X.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),X.prototype.setIndex=function(B,q){this.$indexes.set(B,q)},X.prototype.getIndex=function(B){return this.$indexes.get(B)},X.prototype.getByIndex=function(B){return this.$items.get(this.$indexes.get(B))},X.prototype.deleteByIndex=function(B){var q=this.$indexes.get(B);this.$items.delete(q),this.$indexes.delete(B)},X.prototype.toArray=function(){return Array.from(this.$items.values())},X.prototype.toJSON=function(){var B=[];return this.forEach(function(q,he){B.push(typeof q.toJSON=="function"?q.toJSON():q)}),B},X.prototype.clone=function(B){var q;return B?q=Object.assign(new X,this):(q=new X,this.forEach(function(he){he.$changes?q.add(he.clone()):q.add(he)})),q},X.prototype.triggerAll=function(){Li.prototype.triggerAll.apply(this)},X}(),bl=function(){function X(B){var q=this;this.$changes=new Ge(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,B&&B.forEach(function(he){return q.add(he)})}return X.is=function(B){return B.set!==void 0},X.prototype.add=function(B){var q,he;if(this.has(B))return!1;var qe=this.$refId++;B.$changes!==void 0&&B.$changes.setParent(this,this.$changes.root,qe);var dt=(he=(q=this.$changes.indexes[qe])===null||q===void 0?void 0:q.op)!==null&&he!==void 0?he:z.OPERATION.ADD;return this.$changes.indexes[qe]=qe,this.$indexes.set(qe,qe),this.$items.set(qe,B),this.$changes.change(qe,dt),qe},X.prototype.entries=function(){return this.$items.entries()},X.prototype.delete=function(B){for(var q=this.$items.entries(),he,qe;(qe=q.next())&&!qe.done;)if(B===qe.value[1]){he=qe.value[0];break}return he===void 0?!1:(this.$changes.delete(he),this.$indexes.delete(he),this.$items.delete(he))},X.prototype.clear=function(B){var q=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),B&&typeof this.$changes.getType()!="string"&&this.$items.forEach(function(he){q.$changes.root.removeRef(he.$changes.refId)}),this.$items.clear(),this.$changes.operation({index:0,op:z.OPERATION.CLEAR}),this.$changes.touchParents()},X.prototype.has=function(B){for(var q=this.$items.values(),he=!1,qe;(qe=q.next())&&!qe.done;)if(B===qe.value){he=!0;break}return he},X.prototype.forEach=function(B){var q=this;this.$items.forEach(function(he,qe,dt){return B(he,qe,q)})},X.prototype.values=function(){return this.$items.values()},Object.defineProperty(X.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),X.prototype.setIndex=function(B,q){this.$indexes.set(B,q)},X.prototype.getIndex=function(B){return this.$indexes.get(B)},X.prototype.getByIndex=function(B){return this.$items.get(this.$indexes.get(B))},X.prototype.deleteByIndex=function(B){var q=this.$indexes.get(B);this.$items.delete(q),this.$indexes.delete(B)},X.prototype.toArray=function(){return Array.from(this.$items.values())},X.prototype.toJSON=function(){var B=[];return this.forEach(function(q,he){B.push(typeof q.toJSON=="function"?q.toJSON():q)}),B},X.prototype.clone=function(B){var q;return B?q=Object.assign(new X,this):(q=new X,this.forEach(function(he){he.$changes?q.add(he.clone()):q.add(he)})),q},X.prototype.triggerAll=function(){Li.prototype.triggerAll.apply(this)},X}(),Go=function(){function X(){this.handlers=[]}return X.prototype.register=function(B,q){return this.handlers.push(B),this},X.prototype.invoke=function(){for(var B=[],q=0;q<arguments.length;q++)B[q]=arguments[q];this.handlers.forEach(function(he){return he.apply(void 0,B)})},X.prototype.invokeAsync=function(){for(var B=[],q=0;q<arguments.length;q++)B[q]=arguments[q];return Promise.all(this.handlers.map(function(he){return he.apply(void 0,B)}))},X.prototype.remove=function(B){var q=this.handlers.indexOf(B);this.handlers[q]=this.handlers[this.handlers.length-1],this.handlers.pop()},X.prototype.clear=function(){this.handlers=[]},X}(),Dc=function(){function X(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return X.prototype.addRefId=function(B){this.refIds.has(B)||(this.refIds.add(B),this.containerIndexes.set(B,new Set))},X.get=function(B){return B.$filterState===void 0&&(B.$filterState=new X),B.$filterState},X}(),pu=function(X){de(B,X);function B(){return X!==null&&X.apply(this,arguments)||this}return B}(Error);function df(X,B,q,he){var qe,dt=!1;switch(B){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":qe="number",isNaN(X)&&console.log('trying to encode "NaN" in '+q.constructor.name+"#"+he);break;case"string":qe="string",dt=!0;break;case"boolean":return}if(typeof X!==qe&&(!dt||dt&&X!==null)){var on="'"+JSON.stringify(X)+"'"+(X&&X.constructor&&" ("+X.constructor.name+")"||"");throw new pu("a '"+qe+"' was expected, but "+on+" was provided in "+q.constructor.name+"#"+he)}}function fu(X,B,q,he){if(!(X instanceof B))throw new pu("a '"+B.name+"' was expected, but '"+X.constructor.name+"' was provided in "+q.constructor.name+"#"+he)}function gd(X,B,q,he,qe){df(q,X,he,qe);var dt=Dn[X];if(dt)dt(B,q);else throw new pu("a '"+X+"' was expected, but "+q+" was provided in "+he.constructor.name+"#"+qe)}function _d(X,B,q){return mh[X](B,q)}var Li=function(){function X(){for(var B=[],q=0;q<arguments.length;q++)B[q]=arguments[q];Object.defineProperties(this,{$changes:{value:new Ge(this,void 0,new Fe),enumerable:!1,writable:!0},$listeners:{value:{},enumerable:!1,writable:!0}});var he=this._definition.descriptors;he&&Object.defineProperties(this,he),B[0]&&this.assign(B[0])}return X.onError=function(B){console.error(B)},X.is=function(B){return B._definition&&B._definition.schema!==void 0},X.prototype.assign=function(B){return Object.assign(this,B),this},Object.defineProperty(X.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),X.prototype.listen=function(B,q){var he=this;return this.$listeners[B]||(this.$listeners[B]=new Go),this.$listeners[B].register(q),function(){return he.$listeners[B].remove(q)}},X.prototype.decode=function(B,q,he,qe){q===void 0&&(q={offset:0}),he===void 0&&(he=this),qe===void 0&&(qe=new Map);var dt=this.$changes.root,on=B.length,Gt=0,In=[];for(dt.refs.set(Gt,this),qe.set(Gt,In);q.offset<on;){var gt=B[q.offset++];if(gt==ze){Gt=Wo(B,q);var ht=dt.refs.get(Gt);if(!ht)throw new Error('"refId" not found: '+Gt);he=ht,In=[],qe.set(Gt,In);continue}var $t=he.$changes,Kn=he._definition!==void 0,Mn=Kn?gt>>6<<6:gt;if(Mn===z.OPERATION.CLEAR){he.clear(!0);continue}var dn=Kn?gt%(Mn||255):Wo(B,q),wn=Kn?he._definition.fieldsByIndex[dn]:"",Xn=$t.getType(dn),tn=void 0,Nn=void 0,ln=void 0;if(Kn?Nn=he["_"+wn]:(Nn=he.getByIndex(dn),(Mn&z.OPERATION.ADD)===z.OPERATION.ADD?(ln=he instanceof $e?Fa(B,q):dn,he.setIndex(dn,ln)):ln=he.getIndex(dn)),(Mn&z.OPERATION.DELETE)===z.OPERATION.DELETE&&(Mn!==z.OPERATION.DELETE_AND_ADD&&he.deleteByIndex(dn),Nn&&Nn.$changes&&dt.removeRef(Nn.$changes.refId),tn=null),wn===void 0){console.warn("@colyseus/schema: definition mismatch");for(var pn={offset:q.offset};q.offset<on&&!(vd(B,q)&&(pn.offset=q.offset+1,dt.refs.has(Wo(B,pn))));)q.offset++;continue}else if(Mn!==z.OPERATION.DELETE)if(X.is(Xn)){var qn=Wo(B,q);if(tn=dt.refs.get(qn),Mn!==z.OPERATION.REPLACE){var Os=this.getSchemaType(B,q,Xn);tn||(tn=this.createTypeInstance(Os),tn.$changes.refId=qn,Nn&&(tn.onChange=Nn.onChange,tn.onRemove=Nn.onRemove,tn.$listeners=Nn.$listeners,Nn.$changes.refId&&qn!==Nn.$changes.refId&&dt.removeRef(Nn.$changes.refId))),dt.addRef(qn,tn,tn!==Nn)}}else if(typeof Xn=="string")tn=_d(Xn,B,q);else{var ga=Je(Object.keys(Xn)[0]),On=Wo(B,q),ur=dt.refs.has(On)?Nn||dt.refs.get(On):new ga.constructor;if(tn=ur.clone(!0),tn.$changes.refId=On,Nn&&(tn.onAdd=Nn.onAdd,tn.onRemove=Nn.onRemove,tn.onChange=Nn.onChange,Nn.$changes.refId&&On!==Nn.$changes.refId)){dt.removeRef(Nn.$changes.refId);for(var ti=[],vu=Nn.entries(),mr=void 0;(mr=vu.next())&&!mr.done;){var Ic=mr.value,yo=Ic[0],Jn=Ic[1];ti.push({op:z.OPERATION.DELETE,field:yo,value:void 0,previousValue:Jn})}qe.set(Nn.$changes.refId,ti)}dt.addRef(On,tn,ur!==Nn),ga.getProxy&&(tn=ga.getProxy(tn))}var yd=Nn!==tn;if(tn!=null){if(tn.$changes&&tn.$changes.setParent($t.ref,$t.root,dn),he instanceof X)he[wn]=tn;else if(he instanceof $e){var yo=ln;he.$items.set(yo,tn)}else if(he instanceof Dt)he.setAt(dn,tn);else if(he instanceof xl){var vr=he.add(tn);he.setIndex(dn,vr)}else if(he instanceof bl){var vr=he.add(tn);vr!==!1&&he.setIndex(dn,vr)}}yd&&In.push({op:Mn,field:wn,dynamicIndex:ln,value:tn,previousValue:Nn})}return this._triggerChanges(qe),dt.garbageCollectDeletedRefs(),qe},X.prototype.encode=function(B,q,he){B===void 0&&(B=!1),q===void 0&&(q=[]),he===void 0&&(he=!1);for(var qe=this.$changes,dt=new WeakSet,on=[qe],Gt=1,In=0;In<Gt;In++){var gt=on[In],ht=gt.ref,$t=ht instanceof X;gt.ensureRefId(),dt.add(gt),gt!==qe&&(gt.changed||B)&&(ei(q,ze),Ln(q,gt.refId));for(var Kn=B?Array.from(gt.allChanges):Array.from(gt.changes.values()),Mn=0,dn=Kn.length;Mn<dn;Mn++){var wn=B?{op:z.OPERATION.ADD,index:Kn[Mn]}:Kn[Mn],Xn=wn.index,tn=$t?ht._definition.fieldsByIndex&&ht._definition.fieldsByIndex[Xn]:Xn,Nn=q.length;if(wn.op!==z.OPERATION.TOUCH)if($t)ei(q,Xn|wn.op);else{if(ei(q,wn.op),wn.op===z.OPERATION.CLEAR)continue;Ln(q,Xn)}if(!$t&&(wn.op&z.OPERATION.ADD)==z.OPERATION.ADD&&ht instanceof $e){var ln=gt.ref.$indexes.get(Xn);Mr(q,ln)}if(wn.op!==z.OPERATION.DELETE){var pn=gt.getType(Xn),qn=gt.getValue(Xn);if(qn&&qn.$changes&&!dt.has(qn.$changes)&&(on.push(qn.$changes),qn.$changes.ensureRefId(),Gt++),wn.op!==z.OPERATION.TOUCH){if(X.is(pn))fu(qn,pn,ht,tn),Ln(q,qn.$changes.refId),(wn.op&z.OPERATION.ADD)===z.OPERATION.ADD&&this.tryEncodeTypeId(q,pn,qn.constructor);else if(typeof pn=="string")gd(pn,q,qn,ht,tn);else{var Os=Je(Object.keys(pn)[0]);fu(ht["_"+tn],Os.constructor,ht,tn),Ln(q,qn.$changes.refId)}he&&gt.cache(Xn,q.slice(Nn))}}}!B&&!he&&gt.discard()}return q},X.prototype.encodeAll=function(B){return this.encode(!0,[],B)},X.prototype.applyFilters=function(B,q){var he,qe;q===void 0&&(q=!1);for(var dt=this,on=new Set,Gt=Dc.get(B),In=[this.$changes],gt=1,ht=[],$t=function(Mn){var dn=In[Mn];if(on.has(dn.refId))return"continue";var wn=dn.ref,Xn=wn instanceof X;ei(ht,ze),Ln(ht,dn.refId);var tn=Gt.refIds.has(dn),Nn=q||!tn;Gt.addRefId(dn);var ln=Gt.containerIndexes.get(dn),pn=Nn?Array.from(dn.allChanges):Array.from(dn.changes.values());if(!q&&Xn&&wn._definition.indexesWithFilters){var qn=wn._definition.indexesWithFilters;qn.forEach(function(Jn){!ln.has(Jn)&&dn.allChanges.has(Jn)&&(Nn?pn.push(Jn):pn.push({op:z.OPERATION.ADD,index:Jn}))})}for(var Os=0,ga=pn.length;Os<ga;Os++){var On=Nn?{op:z.OPERATION.ADD,index:pn[Os]}:pn[Os];if(On.op===z.OPERATION.CLEAR){ei(ht,On.op);continue}var ur=On.index;if(On.op===z.OPERATION.DELETE){Xn?ei(ht,On.op|ur):(ei(ht,On.op),Ln(ht,ur));continue}var ti=dn.getValue(ur),vu=dn.getType(ur);if(Xn){var mr=wn._definition.filters&&wn._definition.filters[ur];if(mr&&!mr.call(wn,B,ti,dt)){ti&&ti.$changes&&on.add(ti.$changes.refId);continue}}else{var Ic=dn.parent,mr=dn.getChildrenFilter();if(mr&&!mr.call(Ic,B,wn.$indexes.get(ur),ti,dt)){ti&&ti.$changes&&on.add(ti.$changes.refId);continue}}if(ti.$changes&&(In.push(ti.$changes),gt++),On.op!==z.OPERATION.TOUCH)if(On.op===z.OPERATION.ADD||Xn)ht.push.apply(ht,(he=dn.caches[ur])!==null&&he!==void 0?he:[]),ln.add(ur);else if(ln.has(ur))ht.push.apply(ht,(qe=dn.caches[ur])!==null&&qe!==void 0?qe:[]);else{if(ln.add(ur),ei(ht,z.OPERATION.ADD),Ln(ht,ur),wn instanceof $e){var yo=dn.ref.$indexes.get(ur);Mr(ht,yo)}ti.$changes?Ln(ht,ti.$changes.refId):Dn[vu](ht,ti)}else if(ti.$changes&&!Xn){if(ei(ht,z.OPERATION.ADD),Ln(ht,ur),wn instanceof $e){var yo=dn.ref.$indexes.get(ur);Mr(ht,yo)}Ln(ht,ti.$changes.refId)}}},Kn=0;Kn<gt;Kn++)$t(Kn);return ht},X.prototype.clone=function(){var B=new this.constructor,q=this._definition.schema;for(var he in q)typeof this[he]=="object"&&typeof this[he].clone=="function"?B[he]=this[he].clone():B[he]=this[he];return B},X.prototype.triggerAll=function(){if(this.$changes.root.refs.size!==0){var B=new Map;X.prototype._triggerAllFillChanges.call(this,this,B);try{X.prototype._triggerChanges.call(this,B)}catch(q){X.onError(q)}}},X.prototype.toJSON=function(){var B=this._definition.schema,q=this._definition.deprecated,he={};for(var qe in B)!q[qe]&&this[qe]!==null&&typeof this[qe]<"u"&&(he[qe]=typeof this[qe].toJSON=="function"?this[qe].toJSON():this["_"+qe]);return he},X.prototype.discardAllChanges=function(){this.$changes.discardAll()},X.prototype.getByIndex=function(B){return this[this._definition.fieldsByIndex[B]]},X.prototype.deleteByIndex=function(B){this[this._definition.fieldsByIndex[B]]=void 0},X.prototype.tryEncodeTypeId=function(B,q,he){q._typeid!==he._typeid&&(ei(B,ke),Ln(B,he._typeid))},X.prototype.getSchemaType=function(B,q,he){var qe;return B[q.offset]===ke&&(q.offset++,qe=this.constructor._context.get(Wo(B,q))),qe||he},X.prototype.createTypeInstance=function(B){var q=new B;return q.$changes.root=this.$changes.root,q},X.prototype._triggerAllFillChanges=function(B,q){if(!q.has(B.$changes.refId)){var he=[];if(q.set(B.$changes.refId||0,he),B instanceof X){var qe=B._definition.schema;for(var dt in qe){var on="_"+dt,Gt=B[on];Gt!==void 0&&(he.push({op:z.OPERATION.ADD,field:dt,value:Gt,previousValue:void 0}),Gt.$changes!==void 0&&X.prototype._triggerAllFillChanges.call(this,Gt,q))}}else for(var In=B.entries(),gt=void 0;(gt=In.next())&&!gt.done;){var ht=gt.value,$t=ht[0],Gt=ht[1];he.push({op:z.OPERATION.ADD,field:$t,dynamicIndex:$t,value:Gt,previousValue:void 0}),Gt.$changes!==void 0&&X.prototype._triggerAllFillChanges.call(this,Gt,q)}}},X.prototype._triggerChanges=function(B){var q=this;B.forEach(function(he,qe){var dt,on,Gt,In,gt,ht,$t,Kn,Mn,dn,wn,Xn;if(he.length>0){for(var tn=q.$changes.root.refs.get(qe),Nn=tn instanceof X,ln=0;ln<he.length;ln++){var pn=he[ln],qn=tn.$listeners&&tn.$listeners[pn.field];if(Nn||(pn.op===z.OPERATION.ADD&&pn.previousValue===void 0?(on=(dt=tn).onAdd)===null||on===void 0||on.call(dt,pn.value,(Gt=pn.dynamicIndex)!==null&&Gt!==void 0?Gt:pn.field):pn.op===z.OPERATION.DELETE?pn.previousValue!==void 0&&((gt=(In=tn).onRemove)===null||gt===void 0||gt.call(In,pn.previousValue,(ht=pn.dynamicIndex)!==null&&ht!==void 0?ht:pn.field)):pn.op===z.OPERATION.DELETE_AND_ADD?(pn.previousValue!==void 0&&((Kn=($t=tn).onRemove)===null||Kn===void 0||Kn.call($t,pn.previousValue,pn.dynamicIndex)),(dn=(Mn=tn).onAdd)===null||dn===void 0||dn.call(Mn,pn.value,pn.dynamicIndex)):(pn.op===z.OPERATION.REPLACE||pn.value!==pn.previousValue)&&((Xn=(wn=tn).onChange)===null||Xn===void 0||Xn.call(wn,pn.value,pn.dynamicIndex))),(pn.op&z.OPERATION.DELETE)===z.OPERATION.DELETE&&pn.previousValue instanceof X&&pn.previousValue.onRemove&&pn.previousValue.onRemove(),qn)try{qn.invoke(pn.value,pn.previousValue)}catch(Os){X.onError(Os)}}if(Nn&&tn.onChange)try{tn.onChange(he)}catch(Os){X.onError(Os)}}})},X._definition=Ft.create(),X}();function hv(X){for(var B=[X.$changes],q=1,he={},qe=he,dt=function(Gt){var In=B[Gt];In.changes.forEach(function(gt){var ht=In.ref,$t=gt.index,Kn=ht._definition?ht._definition.fieldsByIndex[$t]:ht.$indexes.get($t);qe[Kn]=In.getValue($t)})},on=0;on<q;on++)dt(on);return he}var Wl=new hn,mu=function(X){de(B,X);function B(){return X!==null&&X.apply(this,arguments)||this}return be([qt("string",Wl)],B.prototype,"name",void 0),be([qt("string",Wl)],B.prototype,"type",void 0),be([qt("number",Wl)],B.prototype,"referencedType",void 0),B}(Li),ja=function(X){de(B,X);function B(){var q=X!==null&&X.apply(this,arguments)||this;return q.fields=new Dt,q}return be([qt("number",Wl)],B.prototype,"id",void 0),be([qt([mu],Wl)],B.prototype,"fields",void 0),B}(Li),dv=function(X){de(B,X);function B(){var q=X!==null&&X.apply(this,arguments)||this;return q.types=new Dt,q}return B.encode=function(q){var he=q.constructor,qe=new B;qe.rootType=he._typeid;var dt=function(gt,ht){for(var $t in ht){var Kn=new mu;Kn.name=$t;var Mn=void 0;if(typeof ht[$t]=="string")Mn=ht[$t];else{var dn=ht[$t],wn=void 0;Li.is(dn)?(Mn="ref",wn=ht[$t]):(Mn=Object.keys(dn)[0],typeof dn[Mn]=="string"?Mn+=":"+dn[Mn]:wn=dn[Mn]),Kn.referencedType=wn?wn._typeid:-1}Kn.type=Mn,gt.fields.push(Kn)}qe.types.push(gt)},on=he._context.types;for(var Gt in on){var In=new ja;In.id=Number(Gt),dt(In,on[Gt]._definition.schema)}return qe.encodeAll()},B.decode=function(q,he){var qe=new hn,dt=new B;dt.decode(q,he);var on=dt.types.reduce(function($t,Kn){var Mn=function(wn){de(Xn,wn);function Xn(){return wn!==null&&wn.apply(this,arguments)||this}return Xn}(Li),dn=Kn.id;return $t[dn]=Mn,qe.add(Mn,dn),$t},{});dt.types.forEach(function($t){var Kn=on[$t.id];$t.fields.forEach(function(Mn){var dn;if(Mn.referencedType!==void 0){var wn=Mn.type,Xn=on[Mn.referencedType];if(!Xn){var tn=Mn.type.split(":");wn=tn[0],Xn=tn[1]}wn==="ref"?qt(Xn,qe)(Kn.prototype,Mn.name):qt((dn={},dn[wn]=Xn,dn),qe)(Kn.prototype,Mn.name)}else qt(Mn.type,qe)(Kn.prototype,Mn.name)})});var Gt=on[dt.rootType],In=new Gt;for(var gt in Gt._definition.schema){var ht=Gt._definition.schema[gt];typeof ht!="string"&&(In[gt]=typeof ht=="function"?new ht:new(Je(Object.keys(ht)[0])).constructor)}return In},be([qt([ja],Wl)],B.prototype,"types",void 0),be([qt("number",Wl)],B.prototype,"rootType",void 0),B}(Li);tt("map",{constructor:$e,getProxy:re}),tt("array",{constructor:Dt,getProxy:pt}),tt("set",{constructor:bl}),tt("collection",{constructor:xl}),z.ArraySchema=Dt,z.CollectionSchema=xl,z.Context=hn,z.MapSchema=$e,z.Reflection=dv,z.ReflectionField=mu,z.ReflectionType=ja,z.Schema=Li,z.SchemaDefinition=Ft,z.SetSchema=bl,z.decode=mh,z.defineTypes=Vo,z.deprecated=Ul,z.dumpChanges=hv,z.encode=Dn,z.filter=xr,z.filterChildren=or,z.hasFilter=vn,z.registerType=tt,z.type=qt,Object.defineProperty(z,"__esModule",{value:!0})})}),it=function(){function E(F,z){var Z=this;this.onStateChange=st(),this.onError=st(),this.onLeave=st(),this.onJoin=st(),this.hasJoined=!1,this.onMessageHandlers=Ue(),this.id=null,this.name=F,z&&(this.serializer=new(ae("schema")),this.rootSchema=z,this.serializer.state=new z),this.onError(function(de,be){return console.warn("colyseus.js - onError => ("+de+") "+be)}),this.onLeave(function(){return Z.removeAllListeners()})}return E.prototype.connect=function(F){var z=this;this.connection=new Se,this.connection.events.onmessage=this.onMessageCallback.bind(this),this.connection.events.onclose=function(Z){if(!z.hasJoined){console.warn("Room connection was closed unexpectedly ("+Z.code+"): "+Z.reason),z.onError.invoke(Z.code,Z.reason);return}z.onLeave.invoke(Z.code),z.destroy()},this.connection.events.onerror=function(Z){console.warn("Room, onError ("+Z.code+"): "+Z.reason),z.onError.invoke(Z.code,Z.reason)},this.connection.connect(F)},E.prototype.leave=function(F){var z=this;return F===void 0&&(F=!0),new Promise(function(Z){z.onLeave(function(de){return Z(de)}),z.connection?F?z.connection.send([t.Protocol.LEAVE_ROOM]):z.connection.close():z.onLeave.invoke(4e3)})},E.prototype.onMessage=function(F,z){return this.onMessageHandlers.on(this.getMessageHandlerKey(F),z)},E.prototype.send=function(F,z){var Z=[t.Protocol.ROOM_DATA];typeof F=="string"?rt.encode.string(Z,F):rt.encode.number(Z,F);var de;if(z!==void 0){var be=ce(z);de=new Uint8Array(Z.length+be.byteLength),de.set(new Uint8Array(Z),0),de.set(new Uint8Array(be),Z.length)}else de=new Uint8Array(Z);this.connection.send(de.buffer)},Object.defineProperty(E.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),E.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}},E.prototype.onMessageCallback=function(F){var z=Array.from(new Uint8Array(F.data)),Z=z[0];if(Z===t.Protocol.JOIN_ROOM){var de=1;if(this.serializerId=Le(z,de),de+=Re(this.serializerId),!this.serializer){var be=ae(this.serializerId);this.serializer=new be}z.length>de&&this.serializer.handshake&&this.serializer.handshake(z,{offset:de}),this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([t.Protocol.JOIN_ROOM])}else if(Z===t.Protocol.ERROR){var oe={offset:1},ze=rt.decode.number(z,oe),ke=rt.decode.string(z,oe);this.onError.invoke(ze,ke)}else if(Z===t.Protocol.LEAVE_ROOM)this.leave();else if(Z===t.Protocol.ROOM_DATA_SCHEMA){var Fe={offset:1},Ge=this.serializer.getState().constructor._context,at=Ge.get(rt.decode.number(z,Fe)),ke=new at;ke.decode(z,Fe),this.dispatchMessage(at,ke)}else if(Z===t.Protocol.ROOM_STATE)z.shift(),this.setState(z);else if(Z===t.Protocol.ROOM_STATE_PATCH)z.shift(),this.patch(z);else if(Z===t.Protocol.ROOM_DATA){var pt={offset:1},at=rt.decode.stringCheck(z,pt)?rt.decode.string(z,pt):rt.decode.number(z,pt),ke=z.length>pt.offset?k(F.data,pt.offset):void 0;this.dispatchMessage(at,ke)}},E.prototype.setState=function(F){this.serializer.setState(F),this.onStateChange.invoke(this.serializer.getState())},E.prototype.patch=function(F){this.serializer.patch(F),this.onStateChange.invoke(this.serializer.getState())},E.prototype.dispatchMessage=function(F,z){var Z=this.getMessageHandlerKey(F);this.onMessageHandlers.events[Z]?this.onMessageHandlers.emit(Z,z):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",F,z):console.warn("colyseus.js: onMessage() not registered for type '"+F+"'.")},E.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},E.prototype.getMessageHandlerKey=function(F){switch(typeof F){case"function":return"$"+F._typeid;case"string":return F;case"number":return"i"+F;default:throw new Error("invalid message type.")}},E}(),Ke;function Qe(){return Ke||(Ke=typeof cc<"u"&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:typeof window<"u"&&window.localStorage?window.localStorage:{cache:{},setItem:function(E,F){this.cache[E]=F},getItem:function(E){this.cache[E]},removeItem:function(E){delete this.cache[E]}}),Ke}function Y(E,F){Qe().setItem(E,F)}function K(E){Qe().removeItem(E)}function ve(E,F){var z=Qe().getItem(E);typeof Promise>"u"||!(z instanceof Promise)?F(z):z.then(function(Z){return F(Z)})}var Ae="colyseus-auth-token";t.Platform=void 0,function(E){E.ios="ios",E.android="android"}(t.Platform||(t.Platform={}));var De=function(){function E(F){var z=this;this._id=void 0,this.username=void 0,this.displayName=void 0,this.avatarUrl=void 0,this.isAnonymous=void 0,this.email=void 0,this.lang=void 0,this.location=void 0,this.timezone=void 0,this.metadata=void 0,this.devices=void 0,this.facebookId=void 0,this.twitterId=void 0,this.googleId=void 0,this.gameCenterId=void 0,this.steamId=void 0,this.friendIds=void 0,this.blockedUserIds=void 0,this.createdAt=void 0,this.updatedAt=void 0,this.token=void 0,this.endpoint=F.replace("ws","http"),ve(Ae,function(Z){return z.token=Z})}return Object.defineProperty(E.prototype,"hasToken",{get:function(){return!!this.token},enumerable:!1,configurable:!0}),E.prototype.login=function(F){return F===void 0&&(F={}),s(this,void 0,void 0,function(){var z,Z,de;return o(this,function(be){switch(be.label){case 0:return z=Object.assign({},F),this.hasToken&&(z.token=this.token),[4,this.request("post","/auth",z)];case 1:Z=be.sent(),this.token=Z.token,Y(Ae,this.token);for(de in Z)this.hasOwnProperty(de)&&(this[de]=Z[de]);return this.registerPingService(),[2,this]}})})},E.prototype.save=function(){return s(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return[4,this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone})];case 1:return F.sent(),[2,this]}})})},E.prototype.getFriends=function(){return s(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return[4,this.request("get","/friends/all")];case 1:return[2,F.sent()]}})})},E.prototype.getOnlineFriends=function(){return s(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return[4,this.request("get","/friends/online")];case 1:return[2,F.sent()]}})})},E.prototype.getFriendRequests=function(){return s(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return[4,this.request("get","/friends/requests")];case 1:return[2,F.sent()]}})})},E.prototype.sendFriendRequest=function(F){return s(this,void 0,void 0,function(){return o(this,function(z){switch(z.label){case 0:return[4,this.request("post","/friends/requests",{userId:F})];case 1:return[2,z.sent()]}})})},E.prototype.acceptFriendRequest=function(F){return s(this,void 0,void 0,function(){return o(this,function(z){switch(z.label){case 0:return[4,this.request("put","/friends/requests",{userId:F})];case 1:return[2,z.sent()]}})})},E.prototype.declineFriendRequest=function(F){return s(this,void 0,void 0,function(){return o(this,function(z){switch(z.label){case 0:return[4,this.request("del","/friends/requests",{userId:F})];case 1:return[2,z.sent()]}})})},E.prototype.blockUser=function(F){return s(this,void 0,void 0,function(){return o(this,function(z){switch(z.label){case 0:return[4,this.request("post","/friends/block",{userId:F})];case 1:return[2,z.sent()]}})})},E.prototype.unblockUser=function(F){return s(this,void 0,void 0,function(){return o(this,function(z){switch(z.label){case 0:return[4,this.request("put","/friends/block",{userId:F})];case 1:return[2,z.sent()]}})})},E.prototype.request=function(F,z,Z,de,be){return Z===void 0&&(Z={}),be===void 0&&(be={}),s(this,void 0,void 0,function(){var oe,ze,ke,Fe;return o(this,function(Ge){switch(Ge.label){case 0:be.Accept="application/json",this.hasToken&&(be.Authorization="Bearer "+this.token),oe=[];for(ze in Z)oe.push(ze+"="+Z[ze]);return ke=oe.length>0?"?"+oe.join("&"):"",Fe={headers:be},de&&(Fe.body=de),[4,D[F](""+this.endpoint+z+ke,Fe)];case 1:return[2,Ge.sent().data]}})})},E.prototype.logout=function(){this.token=void 0,K(Ae),this.unregisterPingService()},E.prototype.registerPingService=function(F){var z=this;F===void 0&&(F=15e3),this.unregisterPingService(),this.keepOnlineInterval=setInterval(function(){return z.request("get","/auth")},F)},E.prototype.unregisterPingService=function(){clearInterval(this.keepOnlineInterval)},E}(),je,Xe=function(E){i(F,E);function F(z,Z){var de=E.call(this,z)||this;return de.code=Z,Object.setPrototypeOf(de,F.prototype),de}return F}(Error),He=typeof window<"u"&&typeof((je=window==null?void 0:window.location)===null||je===void 0?void 0:je.hostname)<"u"?window.location.protocol.replace("http","ws")+"//"+window.location.hostname+(window.location.port&&":"+window.location.port):"ws://127.0.0.1:2567",ne=function(){function E(F){F===void 0&&(F=He),this.endpoint=F}return Object.defineProperty(E.prototype,"auth",{get:function(){return this._auth||(this._auth=new De(this.endpoint)),this._auth},enumerable:!1,configurable:!0}),E.prototype.joinOrCreate=function(F,z,Z){return z===void 0&&(z={}),s(this,void 0,void 0,function(){return o(this,function(de){switch(de.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",F,z,Z)];case 1:return[2,de.sent()]}})})},E.prototype.create=function(F,z,Z){return z===void 0&&(z={}),s(this,void 0,void 0,function(){return o(this,function(de){switch(de.label){case 0:return[4,this.createMatchMakeRequest("create",F,z,Z)];case 1:return[2,de.sent()]}})})},E.prototype.join=function(F,z,Z){return z===void 0&&(z={}),s(this,void 0,void 0,function(){return o(this,function(de){switch(de.label){case 0:return[4,this.createMatchMakeRequest("join",F,z,Z)];case 1:return[2,de.sent()]}})})},E.prototype.joinById=function(F,z,Z){return z===void 0&&(z={}),s(this,void 0,void 0,function(){return o(this,function(de){switch(de.label){case 0:return[4,this.createMatchMakeRequest("joinById",F,z,Z)];case 1:return[2,de.sent()]}})})},E.prototype.reconnect=function(F,z,Z){return s(this,void 0,void 0,function(){return o(this,function(de){switch(de.label){case 0:return[4,this.createMatchMakeRequest("joinById",F,{sessionId:z},Z)];case 1:return[2,de.sent()]}})})},E.prototype.getAvailableRooms=function(F){return F===void 0&&(F=""),s(this,void 0,void 0,function(){var z;return o(this,function(Z){switch(Z.label){case 0:return z=this.endpoint.replace("ws","http")+"/matchmake/"+F,[4,y(z,{headers:{Accept:"application/json"}})];case 1:return[2,Z.sent().data]}})})},E.prototype.consumeSeatReservation=function(F,z){return s(this,void 0,void 0,function(){var Z;return o(this,function(de){return Z=this.createRoom(F.room.name,z),Z.id=F.room.roomId,Z.sessionId=F.sessionId,Z.connect(this.buildEndpoint(F.room,{sessionId:Z.sessionId})),[2,new Promise(function(be,oe){var ze=function(ke,Fe){return oe(new N(ke,Fe))};Z.onError.once(ze),Z.onJoin.once(function(){Z.onError.remove(ze),be(Z)})})]})})},E.prototype.createMatchMakeRequest=function(F,z,Z,de){return Z===void 0&&(Z={}),s(this,void 0,void 0,function(){var be,oe;return o(this,function(ze){switch(ze.label){case 0:return be=this.endpoint.replace("ws","http")+"/matchmake/"+F+"/"+z,this._auth&&this._auth.hasToken&&(Z.token=this._auth.token),[4,S(be,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Z)})];case 1:if(oe=ze.sent().data,oe.error)throw new Xe(oe.error,oe.code);return[2,this.consumeSeatReservation(oe,de)]}})})},E.prototype.createRoom=function(F,z){return new it(F,z)},E.prototype.buildEndpoint=function(F,z){z===void 0&&(z={});var Z=[];for(var de in z)!z.hasOwnProperty(de)||Z.push(de+"="+z[de]);return this.endpoint+"/"+F.processId+"/"+F.roomId+"?"+Z.join("&")},E}(),W=function(){function E(){}return E.prototype.setState=function(F){this.state.decode(F)},E.prototype.getState=function(){return this.state},E.prototype.patch=function(F){this.state.decode(F)},E.prototype.teardown=function(){var F,z;(z=(F=this.state)===null||F===void 0?void 0:F.$changes)===null||z===void 0||z.root.clearRefs()},E.prototype.handshake=function(F,z){if(this.state){var Z=new rt.Reflection;Z.decode(F,z)}else this.state=rt.Reflection.decode(F,z)},E}(),O=function(){function E(){}return E.prototype.setState=function(F){},E.prototype.getState=function(){return null},E.prototype.patch=function(F){},E.prototype.teardown=function(){},E.prototype.handshake=function(F){},E}();se("schema",W),se("none",O),t.Auth=De,t.Client=ne,t.Room=it,t.SchemaSerializer=W,t.registerSerializer=se,Object.defineProperty(t,"__esModule",{value:!0})})})(JU,JU.exports);var zZ={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",u=500,d="__lodash_placeholder__",p=1,f=2,v=4,x=1,y=2,_=1,S=2,C=4,A=8,P=16,D=32,N=64,j=128,T=256,k=512,U=30,ee="...",xe=800,ce=16,te=1,fe=2,ge=3,Se=1/0,pe=9007199254740991,se=17976931348623157e292,ae=0/0,Le=4294967295,Re=Le-1,Ue=Le>>>1,Ze=[["ary",j],["bind",_],["bindKey",S],["curry",A],["curryRight",P],["flip",k],["partial",D],["partialRight",N],["rearg",T]],st="[object Arguments]",we="[object Array]",Mt="[object AsyncFunction]",rt="[object Boolean]",it="[object Date]",Ke="[object DOMException]",Qe="[object Error]",Y="[object Function]",K="[object GeneratorFunction]",ve="[object Map]",Ae="[object Number]",De="[object Null]",je="[object Object]",Xe="[object Promise]",He="[object Proxy]",ne="[object RegExp]",W="[object Set]",O="[object String]",E="[object Symbol]",F="[object Undefined]",z="[object WeakMap]",Z="[object WeakSet]",de="[object ArrayBuffer]",be="[object DataView]",oe="[object Float32Array]",ze="[object Float64Array]",ke="[object Int8Array]",Fe="[object Int16Array]",Ge="[object Int32Array]",at="[object Uint8Array]",pt="[object Uint8ClampedArray]",Dt="[object Uint16Array]",re="[object Uint32Array]",$e=/\b__p \+= '';/g,Me=/\b(__p \+=) '' \+/g,tt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Je=/&(?:amp|lt|gt|quot|#39);/g,Ft=/[&<>"']/g,vn=RegExp(Je.source),hn=RegExp(Ft.source),zr=/<%-([\s\S]+?)%>/g,qt=/<%([\s\S]+?)%>/g,xr=/<%=([\s\S]+?)%>/g,or=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ul=/^\w*$/,Vo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fo=/[\\^$.*+?()[\]{}|]/g,Lc=RegExp(Fo.source),va=/^\s+/,ei=/\s/,H=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,Ce=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oe=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bt=/\w*$/,wt=/^[-+]0x[0-9a-f]+$/i,Zt=/^0b[01]+$/i,kt=/^\[object .+?Constructor\]$/,It=/^0o[0-7]+$/i,gn=/^(?:0|[1-9]\d*)$/,Bi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mr=/($^)/,Ln=/['\n\r\u2028\u2029\\]/g,Dn="\\ud800-\\udfff",Wt="\\u0300-\\u036f",ts="\\ufe20-\\ufe2f",Fn="\\u20d0-\\u20ff",Zn=Wt+ts+Fn,Cr="\\u2700-\\u27bf",Xr="a-z\\xdf-\\xf6\\xf8-\\xff",Ts="\\xac\\xb1\\xd7\\xf7",Rn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Vi="\\u2000-\\u206f",Uo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Un="A-Z\\xc0-\\xd6\\xd8-\\xde",fs="\\ufe0e\\ufe0f",jl=Ts+Rn+Vi+Uo,jo="['\u2019]",Hl="["+Dn+"]",Rs="["+jl+"]",Ho="["+Zn+"]",Fa="\\d+",fh="["+Cr+"]",Wo="["+Xr+"]",md="[^"+Dn+jl+Fa+Cr+Xr+Un+"]",Ua="\\ud83c[\\udffb-\\udfff]",vd="(?:"+Ho+"|"+Ua+")",mh="[^"+Dn+"]",xl="(?:\\ud83c[\\udde6-\\uddff]){2}",bl="[\\ud800-\\udbff][\\udc00-\\udfff]",Go="["+Un+"]",Dc="\\u200d",pu="(?:"+Wo+"|"+md+")",df="(?:"+Go+"|"+md+")",fu="(?:"+jo+"(?:d|ll|m|re|s|t|ve))?",gd="(?:"+jo+"(?:D|LL|M|RE|S|T|VE))?",_d=vd+"?",Li="["+fs+"]?",hv="(?:"+Dc+"(?:"+[mh,xl,bl].join("|")+")"+Li+_d+")*",Wl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ja=Li+_d+hv,dv="(?:"+[fh,xl,bl].join("|")+")"+ja,X="(?:"+[mh+Ho+"?",Ho,xl,bl,Hl].join("|")+")",B=RegExp(jo,"g"),q=RegExp(Ho,"g"),he=RegExp(Ua+"(?="+Ua+")|"+X+ja,"g"),qe=RegExp([Go+"?"+Wo+"+"+fu+"(?="+[Rs,Go,"$"].join("|")+")",df+"+"+gd+"(?="+[Rs,Go+pu,"$"].join("|")+")",Go+"?"+pu+"+"+fu,Go+"+"+gd,mu,Wl,Fa,dv].join("|"),"g"),dt=RegExp("["+Dc+Dn+Zn+fs+"]"),on=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],In=-1,gt={};gt[oe]=gt[ze]=gt[ke]=gt[Fe]=gt[Ge]=gt[at]=gt[pt]=gt[Dt]=gt[re]=!0,gt[st]=gt[we]=gt[de]=gt[rt]=gt[be]=gt[it]=gt[Qe]=gt[Y]=gt[ve]=gt[Ae]=gt[je]=gt[ne]=gt[W]=gt[O]=gt[z]=!1;var ht={};ht[st]=ht[we]=ht[de]=ht[be]=ht[rt]=ht[it]=ht[oe]=ht[ze]=ht[ke]=ht[Fe]=ht[Ge]=ht[ve]=ht[Ae]=ht[je]=ht[ne]=ht[W]=ht[O]=ht[E]=ht[at]=ht[pt]=ht[Dt]=ht[re]=!0,ht[Qe]=ht[Y]=ht[z]=!1;var $t={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Kn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},dn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},wn=parseFloat,Xn=parseInt,tn=typeof Ct=="object"&&Ct&&Ct.Object===Object&&Ct,Nn=typeof self=="object"&&self&&self.Object===Object&&self,ln=tn||Nn||Function("return this")(),pn=e&&!e.nodeType&&e,qn=pn&&!0&&n&&!n.nodeType&&n,Os=qn&&qn.exports===pn,ga=Os&&tn.process,On=function(){try{var $=qn&&qn.require&&qn.require("util").types;return $||ga&&ga.binding&&ga.binding("util")}catch{}}(),ur=On&&On.isArrayBuffer,ti=On&&On.isDate,vu=On&&On.isMap,mr=On&&On.isRegExp,Ic=On&&On.isSet,yo=On&&On.isTypedArray;function Jn($,Ee,_e){switch(_e.length){case 0:return $.call(Ee);case 1:return $.call(Ee,_e[0]);case 2:return $.call(Ee,_e[0],_e[1]);case 3:return $.call(Ee,_e[0],_e[1],_e[2])}return $.apply(Ee,_e)}function yd($,Ee,_e,nt){for(var St=-1,jt=$==null?0:$.length;++St<jt;){var xn=$[St];Ee(nt,xn,_e(xn),$)}return nt}function vr($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt&&Ee($[_e],_e,$)!==!1;);return $}function qb($,Ee){for(var _e=$==null?0:$.length;_e--&&Ee($[_e],_e,$)!==!1;);return $}function pv($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt;)if(!Ee($[_e],_e,$))return!1;return!0}function Gs($,Ee){for(var _e=-1,nt=$==null?0:$.length,St=0,jt=[];++_e<nt;){var xn=$[_e];Ee(xn,_e,$)&&(jt[St++]=xn)}return jt}function Ha($,Ee){var _e=$==null?0:$.length;return!!_e&&fi($,Ee,0)>-1}function ns($,Ee,_e){for(var nt=-1,St=$==null?0:$.length;++nt<St;)if(_e(Ee,$[nt]))return!0;return!1}function cn($,Ee){for(var _e=-1,nt=$==null?0:$.length,St=Array(nt);++_e<nt;)St[_e]=Ee($[_e],_e,$);return St}function ni($,Ee){for(var _e=-1,nt=Ee.length,St=$.length;++_e<nt;)$[St+_e]=Ee[_e];return $}function xd($,Ee,_e,nt){var St=-1,jt=$==null?0:$.length;for(nt&&jt&&(_e=$[++St]);++St<jt;)_e=Ee(_e,$[St],St,$);return _e}function K0($,Ee,_e,nt){var St=$==null?0:$.length;for(nt&&St&&(_e=$[--St]);St--;)_e=Ee(_e,$[St],St,$);return _e}function gu($,Ee){for(var _e=-1,nt=$==null?0:$.length;++_e<nt;)if(Ee($[_e],_e,$))return!0;return!1}var _u=wd("length");function qr($){return $.split("")}function J0($){return $.match(ue)||[]}function bi($,Ee,_e){var nt;return _e($,function(St,jt,xn){if(Ee(St,jt,xn))return nt=jt,!1}),nt}function Nc($,Ee,_e,nt){for(var St=$.length,jt=_e+(nt?1:-1);nt?jt--:++jt<St;)if(Ee($[jt],jt,$))return jt;return-1}function fi($,Ee,_e){return Ee===Ee?Q0($,Ee,_e):Nc($,yu,_e)}function Yb($,Ee,_e,nt){for(var St=_e-1,jt=$.length;++St<jt;)if(nt($[St],Ee))return St;return-1}function yu($){return $!==$}function bd($,Ee){var _e=$==null?0:$.length;return _e?xu($,Ee)/_e:ae}function wd($){return function(Ee){return Ee==null?t:Ee[$]}}function Sd($){return function(Ee){return $==null?t:$[Ee]}}function Md($,Ee,_e,nt,St){return St($,function(jt,xn,sn){_e=nt?(nt=!1,jt):Ee(_e,jt,xn,sn)}),_e}function Zb($,Ee){var _e=$.length;for($.sort(Ee);_e--;)$[_e]=$[_e].value;return $}function xu($,Ee){for(var _e,nt=-1,St=$.length;++nt<St;){var jt=Ee($[nt]);jt!==t&&(_e=_e===t?jt:_e+jt)}return _e}function Gl($,Ee){for(var _e=-1,nt=Array($);++_e<$;)nt[_e]=Ee(_e);return nt}function pf($,Ee){return cn(Ee,function(_e){return[_e,$[_e]]})}function ff($){return $&&$.slice(0,gf($)+1).replace(va,"")}function ir($){return function(Ee){return $(Ee)}}function vh($,Ee){return cn(Ee,function(_e){return $[_e]})}function Wa($,Ee){return $.has(Ee)}function Cd($,Ee){for(var _e=-1,nt=$.length;++_e<nt&&fi(Ee,$[_e],0)>-1;);return _e}function fv($,Ee){for(var _e=$.length;_e--&&fi(Ee,$[_e],0)>-1;);return _e}function mf($,Ee){for(var _e=$.length,nt=0;_e--;)$[_e]===Ee&&++nt;return nt}var gh=Sd($t),_h=Sd(Kn);function vf($){return"\\"+dn[$]}function Kb($,Ee){return $==null?t:$[Ee]}function Ga($){return dt.test($)}function Jb($){return on.test($)}function Qb($){for(var Ee,_e=[];!(Ee=$.next()).done;)_e.push(Ee.value);return _e}function Xa($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt,St){_e[++Ee]=[St,nt]}),_e}function mv($,Ee){return function(_e){return $(Ee(_e))}}function Xs($,Ee){for(var _e=-1,nt=$.length,St=0,jt=[];++_e<nt;){var xn=$[_e];(xn===Ee||xn===d)&&($[_e]=d,jt[St++]=_e)}return jt}function bu($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt){_e[++Ee]=nt}),_e}function $b($){var Ee=-1,_e=Array($.size);return $.forEach(function(nt){_e[++Ee]=[nt,nt]}),_e}function Q0($,Ee,_e){for(var nt=_e-1,St=$.length;++nt<St;)if($[nt]===Ee)return nt;return-1}function ew($,Ee,_e){for(var nt=_e+1;nt--;)if($[nt]===Ee)return nt;return nt}function qa($){return Ga($)?_f($):_u($)}function Er($){return Ga($)?nw($):qr($)}function gf($){for(var Ee=$.length;Ee--&&ei.test($.charAt(Ee)););return Ee}var tw=Sd(Mn);function _f($){for(var Ee=he.lastIndex=0;he.test($);)++Ee;return Ee}function nw($){return $.match(he)||[]}function $0($){return $.match(qe)||[]}var rw=function $(Ee){Ee=Ee==null?ln:xo.defaults(ln.Object(),Ee,xo.pick(ln,Gt));var _e=Ee.Array,nt=Ee.Date,St=Ee.Error,jt=Ee.Function,xn=Ee.Math,sn=Ee.Object,Ls=Ee.RegExp,iw=Ee.String,Yr=Ee.TypeError,kc=_e.prototype,e_=jt.prototype,_a=sn.prototype,zc=Ee["__core-js_shared__"],Bc=e_.toString,Yt=_a.hasOwnProperty,t_=0,yf=function(){var l=/[^.]+$/.exec(zc&&zc.keys&&zc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),Vc=_a.toString,sw=Bc.call(sn),n_=ln._,ow=Ls("^"+Bc.call(Yt).replace(Fo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fc=Os?Ee.Buffer:t,Ds=Ee.Symbol,Uc=Ee.Uint8Array,xf=Fc?Fc.allocUnsafe:t,wu=mv(sn.getPrototypeOf,sn),vv=sn.create,Ed=_a.propertyIsEnumerable,jc=kc.splice,gv=Ds?Ds.isConcatSpreadable:t,Ya=Ds?Ds.iterator:t,bo=Ds?Ds.toStringTag:t,Hc=function(){try{var l=$a(sn,"defineProperty");return l({},"",{}),l}catch{}}(),_v=Ee.clearTimeout!==ln.clearTimeout&&Ee.clearTimeout,r_=nt&&nt.now!==ln.Date.now&&nt.now,aw=Ee.setTimeout!==ln.setTimeout&&Ee.setTimeout,wl=xn.ceil,Su=xn.floor,Ad=sn.getOwnPropertySymbols,lw=Fc?Fc.isBuffer:t,bf=Ee.isFinite,cw=kc.join,i_=mv(sn.keys,sn),kn=xn.max,ar=xn.min,yv=nt.now,Pd=Ee.parseInt,xv=xn.random,uw=kc.reverse,Sl=$a(Ee,"DataView"),Xl=$a(Ee,"Map"),Td=$a(Ee,"Promise"),Za=$a(Ee,"Set"),ql=$a(Ee,"WeakMap"),Ka=$a(sn,"create"),Mu=ql&&new ql,Xo={},hw=el(Sl),dw=el(Xl),bv=el(Td),s_=el(Za),pw=el(ql),Cu=Ds?Ds.prototype:t,Yl=Cu?Cu.valueOf:t,Rd=Cu?Cu.toString:t;function I(l){if(Cn(l)&&!Et(l)&&!(l instanceof Bt)){if(l instanceof ri)return l;if(Yt.call(l,"__wrapped__"))return A1(l)}return new ri(l)}var Ja=function(){function l(){}return function(h){if(!bn(h))return{};if(vv)return vv(h);l.prototype=h;var m=new l;return l.prototype=t,m}}();function Zl(){}function ri(l,h){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=t}I.templateSettings={escape:zr,evaluate:qt,interpolate:xr,variable:"",imports:{_:I}},I.prototype=Zl.prototype,I.prototype.constructor=I,ri.prototype=Ja(Zl.prototype),ri.prototype.constructor=ri;function Bt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Le,this.__views__=[]}function fw(){var l=new Bt(this.__wrapped__);return l.__actions__=Ur(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Ur(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Ur(this.__views__),l}function mw(){if(this.__filtered__){var l=new Bt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function vw(){var l=this.__wrapped__.value(),h=this.__dir__,m=Et(l),w=h<0,R=m?l.length:0,V=aI(0,R,this.__views__),G=V.start,J=V.end,ie=J-G,Ie=w?J:G-1,Ne=this.__iteratees__,Be=Ne.length,et=0,ct=ar(ie,this.__takeCount__);if(!m||!w&&R==ie&&ct==ie)return Kw(l,this.__actions__);var mt=[];e:for(;ie--&&et<ct;){Ie+=h;for(var Ot=-1,vt=l[Ie];++Ot<Be;){var Vt=Ne[Ot],Ht=Vt.iteratee,si=Vt.type,Pr=Ht(vt);if(si==fe)vt=Pr;else if(!Pr){if(si==te)continue e;break e}}mt[et++]=vt}return mt}Bt.prototype=Ja(Zl.prototype),Bt.prototype.constructor=Bt;function qo(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function gw(){this.__data__=Ka?Ka(null):{},this.size=0}function _w(l){var h=this.has(l)&&delete this.__data__[l];return this.size-=h?1:0,h}function yw(l){var h=this.__data__;if(Ka){var m=h[l];return m===c?t:m}return Yt.call(h,l)?h[l]:t}function xw(l){var h=this.__data__;return Ka?h[l]!==t:Yt.call(h,l)}function bw(l,h){var m=this.__data__;return this.size+=this.has(l)?0:1,m[l]=Ka&&h===t?c:h,this}qo.prototype.clear=gw,qo.prototype.delete=_w,qo.prototype.get=yw,qo.prototype.has=xw,qo.prototype.set=bw;function ms(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function wv(){this.__data__=[],this.size=0}function ww(l){var h=this.__data__,m=Gc(h,l);if(m<0)return!1;var w=h.length-1;return m==w?h.pop():jc.call(h,m,1),--this.size,!0}function Sw(l){var h=this.__data__,m=Gc(h,l);return m<0?t:h[m][1]}function Mw(l){return Gc(this.__data__,l)>-1}function Cw(l,h){var m=this.__data__,w=Gc(m,l);return w<0?(++this.size,m.push([l,h])):m[w][1]=h,this}ms.prototype.clear=wv,ms.prototype.delete=ww,ms.prototype.get=Sw,ms.prototype.has=Mw,ms.prototype.set=Cw;function vs(l){var h=-1,m=l==null?0:l.length;for(this.clear();++h<m;){var w=l[h];this.set(w[0],w[1])}}function Ew(){this.size=0,this.__data__={hash:new qo,map:new(Xl||ms),string:new qo}}function Aw(l){var h=qd(this,l).delete(l);return this.size-=h?1:0,h}function Pw(l){return qd(this,l).get(l)}function Wc(l){return qd(this,l).has(l)}function o_(l,h){var m=qd(this,l),w=m.size;return m.set(l,h),this.size+=m.size==w?0:1,this}vs.prototype.clear=Ew,vs.prototype.delete=Aw,vs.prototype.get=Pw,vs.prototype.has=Wc,vs.prototype.set=o_;function Yo(l){var h=-1,m=l==null?0:l.length;for(this.__data__=new vs;++h<m;)this.add(l[h])}function Tw(l){return this.__data__.set(l,c),this}function Sv(l){return this.__data__.has(l)}Yo.prototype.add=Yo.prototype.push=Tw,Yo.prototype.has=Sv;function mi(l){var h=this.__data__=new ms(l);this.size=h.size}function a_(){this.__data__=new ms,this.size=0}function Rw(l){var h=this.__data__,m=h.delete(l);return this.size=h.size,m}function Ow(l){return this.__data__.get(l)}function Lw(l){return this.__data__.has(l)}function Dw(l,h){var m=this.__data__;if(m instanceof ms){var w=m.__data__;if(!Xl||w.length<i-1)return w.push([l,h]),this.size=++m.size,this;m=this.__data__=new vs(w)}return m.set(l,h),this.size=m.size,this}mi.prototype.clear=a_,mi.prototype.delete=Rw,mi.prototype.get=Ow,mi.prototype.has=Lw,mi.prototype.set=Dw;function Ml(l,h){var m=Et(l),w=!m&&tl(l),R=!m&&!w&&ea(l),V=!m&&!w&&!R&&rc(l),G=m||w||R||V,J=G?Gl(l.length,iw):[],ie=J.length;for(var Ie in l)(h||Yt.call(l,Ie))&&!(G&&(Ie=="length"||R&&(Ie=="offset"||Ie=="parent")||V&&(Ie=="buffer"||Ie=="byteLength"||Ie=="byteOffset")||Zs(Ie,ie)))&&J.push(Ie);return J}function wf(l){var h=l.length;return h?l[Fd(0,h-1)]:t}function yh(l,h){return Yd(Ur(l),Ko(h,0,l.length))}function Iw(l){return Yd(Ur(l))}function ya(l,h,m){(m!==t&&!Ui(l[h],m)||m===t&&!(h in l))&&gs(l,h,m)}function Kl(l,h,m){var w=l[h];(!(Yt.call(l,h)&&Ui(w,m))||m===t&&!(h in l))&&gs(l,h,m)}function Gc(l,h){for(var m=l.length;m--;)if(Ui(l[m][0],h))return m;return-1}function Nw(l,h,m,w){return Di(l,function(R,V,G){h(w,R,m(R),G)}),w}function Mv(l,h){return l&&_s(h,$n(h),l)}function kw(l,h){return l&&_s(h,Hr(h),l)}function gs(l,h,m){h=="__proto__"&&Hc?Hc(l,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):l[h]=m}function Zo(l,h){for(var m=-1,w=h.length,R=_e(w),V=l==null;++m<w;)R[m]=V?t:rg(l,h[m]);return R}function Ko(l,h,m){return l===l&&(m!==t&&(l=l<=m?l:m),h!==t&&(l=l>=h?l:h)),l}function Zr(l,h,m,w,R,V){var G,J=h&p,ie=h&f,Ie=h&v;if(m&&(G=R?m(l,w,R,V):m(l)),G!==t)return G;if(!bn(l))return l;var Ne=Et(l);if(Ne){if(G=cI(l),!J)return Ur(l,G)}else{var Be=_r(l),et=Be==Y||Be==K;if(ea(l))return $w(l,J);if(Be==je||Be==st||et&&!R){if(G=ie||et?{}:_1(l),!J)return ie?Q4(l,kw(G,l)):J4(l,Mv(G,l))}else{if(!ht[Be])return R?l:{};G=uI(l,Be,J)}}V||(V=new mi);var ct=V.get(l);if(ct)return ct;V.set(l,G),q1(l)?l.forEach(function(vt){G.add(Zr(vt,h,m,vt,l,V))}):G1(l)&&l.forEach(function(vt,Vt){G.set(Vt,Zr(vt,h,m,Vt,l,V))});var mt=Ie?ie?Hv:jv:ie?Hr:$n,Ot=Ne?t:mt(l);return vr(Ot||l,function(vt,Vt){Ot&&(Vt=vt,vt=l[Vt]),Kl(G,Vt,Zr(vt,h,m,Vt,l,V))}),G}function zw(l){var h=$n(l);return function(m){return Sf(m,l,h)}}function Sf(l,h,m){var w=m.length;if(l==null)return!w;for(l=sn(l);w--;){var R=m[w],V=h[R],G=l[R];if(G===t&&!(R in l)||!V(G))return!1}return!0}function Cv(l,h,m){if(typeof l!="function")throw new Yr(o);return Lu(function(){l.apply(t,m)},h)}function Jl(l,h,m,w){var R=-1,V=Ha,G=!0,J=l.length,ie=[],Ie=h.length;if(!J)return ie;m&&(h=cn(h,ir(m))),w?(V=ns,G=!1):h.length>=i&&(V=Wa,G=!1,h=new Yo(h));e:for(;++R<J;){var Ne=l[R],Be=m==null?Ne:m(Ne);if(Ne=w||Ne!==0?Ne:0,G&&Be===Be){for(var et=Ie;et--;)if(h[et]===Be)continue e;ie.push(Ne)}else V(h,Be,w)||ie.push(Ne)}return ie}var Di=i1(Fi),Mf=i1(Ld,!0);function Bw(l,h){var m=!0;return Di(l,function(w,R,V){return m=!!h(w,R,V),m}),m}function Eu(l,h,m){for(var w=-1,R=l.length;++w<R;){var V=l[w],G=h(V);if(G!=null&&(J===t?G===G&&!ii(G):m(G,J)))var J=G,ie=V}return ie}function Vw(l,h,m,w){var R=l.length;for(m=Tt(m),m<0&&(m=-m>R?0:R+m),w=w===t||w>R?R:Tt(w),w<0&&(w+=R),w=m>w?0:Z1(w);m<w;)l[m++]=h;return l}function Od(l,h){var m=[];return Di(l,function(w,R,V){h(w,R,V)&&m.push(w)}),m}function Qn(l,h,m,w,R){var V=-1,G=l.length;for(m||(m=dI),R||(R=[]);++V<G;){var J=l[V];h>0&&m(J)?h>1?Qn(J,h-1,m,w,R):ni(R,J):w||(R[R.length]=J)}return R}var Cl=s1(),Cf=s1(!0);function Fi(l,h){return l&&Cl(l,h,$n)}function Ld(l,h){return l&&Cf(l,h,$n)}function Au(l,h){return Gs(h,function(m){return Ks(l[m])})}function Jo(l,h){h=Qo(h,l);for(var m=0,w=h.length;l!=null&&m<w;)l=l[ys(h[m++])];return m&&m==w?l:t}function Ev(l,h,m){var w=h(l);return Et(l)?w:ni(w,m(l))}function gr(l){return l==null?l===t?F:De:bo&&bo in sn(l)?oI(l):yI(l)}function Dd(l,h){return l>h}function Id(l,h){return l!=null&&Yt.call(l,h)}function l_(l,h){return l!=null&&h in sn(l)}function Fw(l,h,m){return l>=ar(h,m)&&l<kn(h,m)}function Pu(l,h,m){for(var w=m?ns:Ha,R=l[0].length,V=l.length,G=V,J=_e(V),ie=1/0,Ie=[];G--;){var Ne=l[G];G&&h&&(Ne=cn(Ne,ir(h))),ie=ar(Ne.length,ie),J[G]=!m&&(h||R>=120&&Ne.length>=120)?new Yo(G&&Ne):t}Ne=l[0];var Be=-1,et=J[0];e:for(;++Be<R&&Ie.length<ie;){var ct=Ne[Be],mt=h?h(ct):ct;if(ct=m||ct!==0?ct:0,!(et?Wa(et,mt):w(Ie,mt,m))){for(G=V;--G;){var Ot=J[G];if(!(Ot?Wa(Ot,mt):w(l[G],mt,m)))continue e}et&&et.push(mt),Ie.push(ct)}}return Ie}function c_(l,h,m,w){return Fi(l,function(R,V,G){h(w,m(R),V,G)}),w}function Ql(l,h,m){h=Qo(h,l),l=w1(l,h);var w=l==null?l:l[ys(wi(h))];return w==null?t:Jn(w,l,m)}function Nd(l){return Cn(l)&&gr(l)==st}function Uw(l){return Cn(l)&&gr(l)==de}function Xc(l){return Cn(l)&&gr(l)==it}function $l(l,h,m,w,R){return l===h?!0:l==null||h==null||!Cn(l)&&!Cn(h)?l!==l&&h!==h:jw(l,h,m,w,$l,R)}function jw(l,h,m,w,R,V){var G=Et(l),J=Et(h),ie=G?we:_r(l),Ie=J?we:_r(h);ie=ie==st?je:ie,Ie=Ie==st?je:Ie;var Ne=ie==je,Be=Ie==je,et=ie==Ie;if(et&&ea(l)){if(!ea(h))return!1;G=!0,Ne=!1}if(et&&!Ne)return V||(V=new mi),G||rc(l)?m1(l,h,m,w,R,V):iI(l,h,ie,m,w,R,V);if(!(m&x)){var ct=Ne&&Yt.call(l,"__wrapped__"),mt=Be&&Yt.call(h,"__wrapped__");if(ct||mt){var Ot=ct?l.value():l,vt=mt?h.value():h;return V||(V=new mi),R(Ot,vt,m,w,V)}}return et?(V||(V=new mi),sI(l,h,m,w,R,V)):!1}function Av(l){return Cn(l)&&_r(l)==ve}function kd(l,h,m,w){var R=m.length,V=R,G=!w;if(l==null)return!V;for(l=sn(l);R--;){var J=m[R];if(G&&J[2]?J[1]!==l[J[0]]:!(J[0]in l))return!1}for(;++R<V;){J=m[R];var ie=J[0],Ie=l[ie],Ne=J[1];if(G&&J[2]){if(Ie===t&&!(ie in l))return!1}else{var Be=new mi;if(w)var et=w(Ie,Ne,ie,l,h,Be);if(!(et===t?$l(Ne,Ie,x|y,w,Be):et))return!1}}return!0}function Pv(l){if(!bn(l)||fI(l))return!1;var h=Ks(l)?ow:kt;return h.test(el(l))}function u_(l){return Cn(l)&&gr(l)==ne}function Hw(l){return Cn(l)&&_r(l)==W}function Ww(l){return Cn(l)&&ep(l.length)&&!!gt[gr(l)]}function Tv(l){return typeof l=="function"?l:l==null?Wr:typeof l=="object"?Et(l)?Lv(l[0],l[1]):Ov(l):oS(l)}function zd(l){if(!Ou(l))return i_(l);var h=[];for(var m in sn(l))Yt.call(l,m)&&m!="constructor"&&h.push(m);return h}function Gw(l){if(!bn(l))return _I(l);var h=Ou(l),m=[];for(var w in l)w=="constructor"&&(h||!Yt.call(l,w))||m.push(w);return m}function Bd(l,h){return l<h}function Rv(l,h){var m=-1,w=jr(l)?_e(l.length):[];return Di(l,function(R,V,G){w[++m]=h(R,V,G)}),w}function Ov(l){var h=Gv(l);return h.length==1&&h[0][2]?x1(h[0][0],h[0][1]):function(m){return m===l||kd(m,l,h)}}function Lv(l,h){return qv(l)&&y1(h)?x1(ys(l),h):function(m){var w=rg(m,l);return w===t&&w===h?ig(m,l):$l(h,w,x|y)}}function qc(l,h,m,w,R){l!==h&&Cl(h,function(V,G){if(R||(R=new mi),bn(V))h_(l,h,G,m,qc,w,R);else{var J=w?w(Zv(l,G),V,G+"",l,h,R):t;J===t&&(J=V),ya(l,G,J)}},Hr)}function h_(l,h,m,w,R,V,G){var J=Zv(l,m),ie=Zv(h,m),Ie=G.get(ie);if(Ie){ya(l,m,Ie);return}var Ne=V?V(J,ie,m+"",l,h,G):t,Be=Ne===t;if(Be){var et=Et(ie),ct=!et&&ea(ie),mt=!et&&!ct&&rc(ie);Ne=ie,et||ct||mt?Et(J)?Ne=J:En(J)?Ne=Ur(J):ct?(Be=!1,Ne=$w(ie,!0)):mt?(Be=!1,Ne=e1(ie,!0)):Ne=[]:Du(ie)||tl(ie)?(Ne=J,tl(J)?Ne=K1(J):(!bn(J)||Ks(J))&&(Ne=_1(ie))):Be=!1}Be&&(G.set(ie,Ne),R(Ne,ie,w,V,G),G.delete(ie)),ya(l,m,Ne)}function Ef(l,h){var m=l.length;if(!!m)return h+=h<0?m:0,Zs(h,m)?l[h]:t}function Dv(l,h,m){h.length?h=cn(h,function(V){return Et(V)?function(G){return Jo(G,V.length===1?V[0]:V)}:V}):h=[Wr];var w=-1;h=cn(h,ir(ft()));var R=Rv(l,function(V,G,J){var ie=cn(h,function(Ie){return Ie(V)});return{criteria:ie,index:++w,value:V}});return Zb(R,function(V,G){return K4(V,G,m)})}function Xw(l,h){return Iv(l,h,function(m,w){return ig(l,w)})}function Iv(l,h,m){for(var w=-1,R=h.length,V={};++w<R;){var G=h[w],J=Jo(l,G);m(J,G)&&g(V,Qo(G,l),J)}return V}function qw(l){return function(h){return Jo(h,l)}}function Vd(l,h,m,w){var R=w?Yb:fi,V=-1,G=h.length,J=l;for(l===h&&(h=Ur(h)),m&&(J=cn(l,ir(m)));++V<G;)for(var ie=0,Ie=h[V],Ne=m?m(Ie):Ie;(ie=R(J,Ne,ie,w))>-1;)J!==l&&jc.call(J,ie,1),jc.call(l,ie,1);return l}function Nv(l,h){for(var m=l?h.length:0,w=m-1;m--;){var R=h[m];if(m==w||R!==V){var V=R;Zs(R)?jc.call(l,R,1):Qa(l,R)}}return l}function Fd(l,h){return l+Su(xv()*(h-l+1))}function Yw(l,h,m,w){for(var R=-1,V=kn(wl((h-l)/(m||1)),0),G=_e(V);V--;)G[w?V:++R]=l,l+=m;return G}function xh(l,h){var m="";if(!l||h<1||h>pe)return m;do h%2&&(m+=l),h=Su(h/2),h&&(l+=l);while(h);return m}function Rt(l,h){return Kv(b1(l,h,Wr),l+"")}function Zw(l){return wf(ic(l))}function M(l,h){var m=ic(l);return Yd(m,Ko(h,0,m.length))}function g(l,h,m,w){if(!bn(l))return l;h=Qo(h,l);for(var R=-1,V=h.length,G=V-1,J=l;J!=null&&++R<V;){var ie=ys(h[R]),Ie=m;if(ie==="__proto__"||ie==="constructor"||ie==="prototype")return l;if(R!=G){var Ne=J[ie];Ie=w?w(Ne,ie,J):t,Ie===t&&(Ie=bn(Ne)?Ne:Zs(h[R+1])?[]:{})}Kl(J,ie,Ie),J=J[ie]}return l}var b=Mu?function(l,h){return Mu.set(l,h),l}:Wr,L=Hc?function(l,h){return Hc(l,"toString",{configurable:!0,enumerable:!1,value:og(h),writable:!0})}:Wr;function Q(l){return Yd(ic(l))}function Pe(l,h,m){var w=-1,R=l.length;h<0&&(h=-h>R?0:R+h),m=m>R?R:m,m<0&&(m+=R),R=h>m?0:m-h>>>0,h>>>=0;for(var V=_e(R);++w<R;)V[w]=l[w+h];return V}function Ye(l,h){var m;return Di(l,function(w,R,V){return m=h(w,R,V),!m}),!!m}function _t(l,h,m){var w=0,R=l==null?w:l.length;if(typeof h=="number"&&h===h&&R<=Ue){for(;w<R;){var V=w+R>>>1,G=l[V];G!==null&&!ii(G)&&(m?G<=h:G<h)?w=V+1:R=V}return R}return Kt(l,h,Wr,m)}function Kt(l,h,m,w){var R=0,V=l==null?0:l.length;if(V===0)return 0;h=m(h);for(var G=h!==h,J=h===null,ie=ii(h),Ie=h===t;R<V;){var Ne=Su((R+V)/2),Be=m(l[Ne]),et=Be!==t,ct=Be===null,mt=Be===Be,Ot=ii(Be);if(G)var vt=w||mt;else Ie?vt=mt&&(w||et):J?vt=mt&&et&&(w||!ct):ie?vt=mt&&et&&!ct&&(w||!Ot):ct||Ot?vt=!1:vt=w?Be<=h:Be<h;vt?R=Ne+1:V=Ne}return ar(V,Re)}function fn(l,h){for(var m=-1,w=l.length,R=0,V=[];++m<w;){var G=l[m],J=h?h(G):G;if(!m||!Ui(J,ie)){var ie=J;V[R++]=G===0?0:G}}return V}function Yn(l){return typeof l=="number"?l:ii(l)?ae:+l}function an(l){if(typeof l=="string")return l;if(Et(l))return cn(l,an)+"";if(ii(l))return Rd?Rd.call(l):"";var h=l+"";return h=="0"&&1/l==-Se?"-0":h}function vi(l,h,m){var w=-1,R=Ha,V=l.length,G=!0,J=[],ie=J;if(m)G=!1,R=ns;else if(V>=i){var Ie=h?null:nI(l);if(Ie)return bu(Ie);G=!1,R=Wa,ie=new Yo}else ie=h?[]:J;e:for(;++w<V;){var Ne=l[w],Be=h?h(Ne):Ne;if(Ne=m||Ne!==0?Ne:0,G&&Be===Be){for(var et=ie.length;et--;)if(ie[et]===Be)continue e;h&&ie.push(Be),J.push(Ne)}else R(ie,Be,m)||(ie!==J&&ie.push(Be),J.push(Ne))}return J}function Qa(l,h){return h=Qo(h,l),l=w1(l,h),l==null||delete l[ys(wi(h))]}function Yc(l,h,m,w){return g(l,h,m(Jo(l,h)),w)}function Tu(l,h,m,w){for(var R=l.length,V=w?R:-1;(w?V--:++V<R)&&h(l[V],V,l););return m?Pe(l,w?0:V,w?V+1:R):Pe(l,w?V+1:0,w?R:V)}function Kw(l,h){var m=l;return m instanceof Bt&&(m=m.value()),xd(h,function(w,R){return R.func.apply(R.thisArg,ni([w],R.args))},m)}function kv(l,h,m){var w=l.length;if(w<2)return w?vi(l[0]):[];for(var R=-1,V=_e(w);++R<w;)for(var G=l[R],J=-1;++J<w;)J!=R&&(V[R]=Jl(V[R]||G,l[J],h,m));return vi(Qn(V,1),h,m)}function Jw(l,h,m){for(var w=-1,R=l.length,V=h.length,G={};++w<R;){var J=w<V?h[w]:t;m(G,l[w],J)}return G}function zv(l){return En(l)?l:[]}function Bv(l){return typeof l=="function"?l:Wr}function Qo(l,h){return Et(l)?l:qv(l,h)?[l]:E1(Jt(l))}var X4=Rt;function $o(l,h,m){var w=l.length;return m=m===t?w:m,!h&&m>=w?l:Pe(l,h,m)}var Qw=_v||function(l){return ln.clearTimeout(l)};function $w(l,h){if(h)return l.slice();var m=l.length,w=xf?xf(m):new l.constructor(m);return l.copy(w),w}function Vv(l){var h=new l.constructor(l.byteLength);return new Uc(h).set(new Uc(l)),h}function q4(l,h){var m=h?Vv(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.byteLength)}function Y4(l){var h=new l.constructor(l.source,bt.exec(l));return h.lastIndex=l.lastIndex,h}function Z4(l){return Yl?sn(Yl.call(l)):{}}function e1(l,h){var m=h?Vv(l.buffer):l.buffer;return new l.constructor(m,l.byteOffset,l.length)}function t1(l,h){if(l!==h){var m=l!==t,w=l===null,R=l===l,V=ii(l),G=h!==t,J=h===null,ie=h===h,Ie=ii(h);if(!J&&!Ie&&!V&&l>h||V&&G&&ie&&!J&&!Ie||w&&G&&ie||!m&&ie||!R)return 1;if(!w&&!V&&!Ie&&l<h||Ie&&m&&R&&!w&&!V||J&&m&&R||!G&&R||!ie)return-1}return 0}function K4(l,h,m){for(var w=-1,R=l.criteria,V=h.criteria,G=R.length,J=m.length;++w<G;){var ie=t1(R[w],V[w]);if(ie){if(w>=J)return ie;var Ie=m[w];return ie*(Ie=="desc"?-1:1)}}return l.index-h.index}function n1(l,h,m,w){for(var R=-1,V=l.length,G=m.length,J=-1,ie=h.length,Ie=kn(V-G,0),Ne=_e(ie+Ie),Be=!w;++J<ie;)Ne[J]=h[J];for(;++R<G;)(Be||R<V)&&(Ne[m[R]]=l[R]);for(;Ie--;)Ne[J++]=l[R++];return Ne}function r1(l,h,m,w){for(var R=-1,V=l.length,G=-1,J=m.length,ie=-1,Ie=h.length,Ne=kn(V-J,0),Be=_e(Ne+Ie),et=!w;++R<Ne;)Be[R]=l[R];for(var ct=R;++ie<Ie;)Be[ct+ie]=h[ie];for(;++G<J;)(et||R<V)&&(Be[ct+m[G]]=l[R++]);return Be}function Ur(l,h){var m=-1,w=l.length;for(h||(h=_e(w));++m<w;)h[m]=l[m];return h}function _s(l,h,m,w){var R=!m;m||(m={});for(var V=-1,G=h.length;++V<G;){var J=h[V],ie=w?w(m[J],l[J],J,m,l):t;ie===t&&(ie=l[J]),R?gs(m,J,ie):Kl(m,J,ie)}return m}function J4(l,h){return _s(l,Xv(l),h)}function Q4(l,h){return _s(l,v1(l),h)}function Ud(l,h){return function(m,w){var R=Et(m)?yd:Nw,V=h?h():{};return R(m,l,ft(w,2),V)}}function ec(l){return Rt(function(h,m){var w=-1,R=m.length,V=R>1?m[R-1]:t,G=R>2?m[2]:t;for(V=l.length>3&&typeof V=="function"?(R--,V):t,G&&Ar(m[0],m[1],G)&&(V=R<3?t:V,R=1),h=sn(h);++w<R;){var J=m[w];J&&l(h,J,w,V)}return h})}function i1(l,h){return function(m,w){if(m==null)return m;if(!jr(m))return l(m,w);for(var R=m.length,V=h?R:-1,G=sn(m);(h?V--:++V<R)&&w(G[V],V,G)!==!1;);return m}}function s1(l){return function(h,m,w){for(var R=-1,V=sn(h),G=w(h),J=G.length;J--;){var ie=G[l?J:++R];if(m(V[ie],ie,V)===!1)break}return h}}function $4(l,h,m){var w=h&_,R=Ru(l);function V(){var G=this&&this!==ln&&this instanceof V?R:l;return G.apply(w?m:this,arguments)}return V}function o1(l){return function(h){h=Jt(h);var m=Ga(h)?Er(h):t,w=m?m[0]:h.charAt(0),R=m?$o(m,1).join(""):h.slice(1);return w[l]()+R}}function tc(l){return function(h){return xd(iS(rS(h).replace(B,"")),l,"")}}function Ru(l){return function(){var h=arguments;switch(h.length){case 0:return new l;case 1:return new l(h[0]);case 2:return new l(h[0],h[1]);case 3:return new l(h[0],h[1],h[2]);case 4:return new l(h[0],h[1],h[2],h[3]);case 5:return new l(h[0],h[1],h[2],h[3],h[4]);case 6:return new l(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new l(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=Ja(l.prototype),w=l.apply(m,h);return bn(w)?w:m}}function eI(l,h,m){var w=Ru(l);function R(){for(var V=arguments.length,G=_e(V),J=V,ie=nc(R);J--;)G[J]=arguments[J];var Ie=V<3&&G[0]!==ie&&G[V-1]!==ie?[]:Xs(G,ie);if(V-=Ie.length,V<m)return h1(l,h,jd,R.placeholder,t,G,Ie,t,t,m-V);var Ne=this&&this!==ln&&this instanceof R?w:l;return Jn(Ne,this,G)}return R}function a1(l){return function(h,m,w){var R=sn(h);if(!jr(h)){var V=ft(m,3);h=$n(h),m=function(J){return V(R[J],J,R)}}var G=l(h,m,w);return G>-1?R[V?h[G]:G]:t}}function l1(l){return Ys(function(h){var m=h.length,w=m,R=ri.prototype.thru;for(l&&h.reverse();w--;){var V=h[w];if(typeof V!="function")throw new Yr(o);if(R&&!G&&Xd(V)=="wrapper")var G=new ri([],!0)}for(w=G?w:m;++w<m;){V=h[w];var J=Xd(V),ie=J=="wrapper"?Wv(V):t;ie&&Yv(ie[0])&&ie[1]==(j|A|D|T)&&!ie[4].length&&ie[9]==1?G=G[Xd(ie[0])].apply(G,ie[3]):G=V.length==1&&Yv(V)?G[J]():G.thru(V)}return function(){var Ie=arguments,Ne=Ie[0];if(G&&Ie.length==1&&Et(Ne))return G.plant(Ne).value();for(var Be=0,et=m?h[Be].apply(this,Ie):Ne;++Be<m;)et=h[Be].call(this,et);return et}})}function jd(l,h,m,w,R,V,G,J,ie,Ie){var Ne=h&j,Be=h&_,et=h&S,ct=h&(A|P),mt=h&k,Ot=et?t:Ru(l);function vt(){for(var Vt=arguments.length,Ht=_e(Vt),si=Vt;si--;)Ht[si]=arguments[si];if(ct)var Pr=nc(vt),oi=mf(Ht,Pr);if(w&&(Ht=n1(Ht,w,R,ct)),V&&(Ht=r1(Ht,V,G,ct)),Vt-=oi,ct&&Vt<Ie){var An=Xs(Ht,Pr);return h1(l,h,jd,vt.placeholder,m,Ht,An,J,ie,Ie-Vt)}var ji=Be?m:this,Qs=et?ji[l]:l;return Vt=Ht.length,J?Ht=xI(Ht,J):mt&&Vt>1&&Ht.reverse(),Ne&&ie<Vt&&(Ht.length=ie),this&&this!==ln&&this instanceof vt&&(Qs=Ot||Ru(Qs)),Qs.apply(ji,Ht)}return vt}function c1(l,h){return function(m,w){return c_(m,l,h(w),{})}}function Hd(l,h){return function(m,w){var R;if(m===t&&w===t)return h;if(m!==t&&(R=m),w!==t){if(R===t)return w;typeof m=="string"||typeof w=="string"?(m=an(m),w=an(w)):(m=Yn(m),w=Yn(w)),R=l(m,w)}return R}}function Fv(l){return Ys(function(h){return h=cn(h,ir(ft())),Rt(function(m){var w=this;return l(h,function(R){return Jn(R,w,m)})})})}function Wd(l,h){h=h===t?" ":an(h);var m=h.length;if(m<2)return m?xh(h,l):h;var w=xh(h,wl(l/qa(h)));return Ga(h)?$o(Er(w),0,l).join(""):w.slice(0,l)}function tI(l,h,m,w){var R=h&_,V=Ru(l);function G(){for(var J=-1,ie=arguments.length,Ie=-1,Ne=w.length,Be=_e(Ne+ie),et=this&&this!==ln&&this instanceof G?V:l;++Ie<Ne;)Be[Ie]=w[Ie];for(;ie--;)Be[Ie++]=arguments[++J];return Jn(et,R?m:this,Be)}return G}function u1(l){return function(h,m,w){return w&&typeof w!="number"&&Ar(h,m,w)&&(m=w=t),h=Js(h),m===t?(m=h,h=0):m=Js(m),w=w===t?h<m?1:-1:Js(w),Yw(h,m,w,l)}}function Gd(l){return function(h,m){return typeof h=="string"&&typeof m=="string"||(h=Si(h),m=Si(m)),l(h,m)}}function h1(l,h,m,w,R,V,G,J,ie,Ie){var Ne=h&A,Be=Ne?G:t,et=Ne?t:G,ct=Ne?V:t,mt=Ne?t:V;h|=Ne?D:N,h&=~(Ne?N:D),h&C||(h&=~(_|S));var Ot=[l,h,R,ct,Be,mt,et,J,ie,Ie],vt=m.apply(t,Ot);return Yv(l)&&S1(vt,Ot),vt.placeholder=w,M1(vt,l,h)}function Uv(l){var h=xn[l];return function(m,w){if(m=Si(m),w=w==null?0:ar(Tt(w),292),w&&bf(m)){var R=(Jt(m)+"e").split("e"),V=h(R[0]+"e"+(+R[1]+w));return R=(Jt(V)+"e").split("e"),+(R[0]+"e"+(+R[1]-w))}return h(m)}}var nI=Za&&1/bu(new Za([,-0]))[1]==Se?function(l){return new Za(l)}:cg;function d1(l){return function(h){var m=_r(h);return m==ve?Xa(h):m==W?$b(h):pf(h,l(h))}}function qs(l,h,m,w,R,V,G,J){var ie=h&S;if(!ie&&typeof l!="function")throw new Yr(o);var Ie=w?w.length:0;if(Ie||(h&=~(D|N),w=R=t),G=G===t?G:kn(Tt(G),0),J=J===t?J:Tt(J),Ie-=R?R.length:0,h&N){var Ne=w,Be=R;w=R=t}var et=ie?t:Wv(l),ct=[l,h,m,w,R,Ne,Be,V,G,J];if(et&&gI(ct,et),l=ct[0],h=ct[1],m=ct[2],w=ct[3],R=ct[4],J=ct[9]=ct[9]===t?ie?0:l.length:kn(ct[9]-Ie,0),!J&&h&(A|P)&&(h&=~(A|P)),!h||h==_)var mt=$4(l,h,m);else h==A||h==P?mt=eI(l,h,J):(h==D||h==(_|D))&&!R.length?mt=tI(l,h,m,w):mt=jd.apply(t,ct);var Ot=et?b:S1;return M1(Ot(mt,ct),l,h)}function p1(l,h,m,w){return l===t||Ui(l,_a[m])&&!Yt.call(w,m)?h:l}function f1(l,h,m,w,R,V){return bn(l)&&bn(h)&&(V.set(h,l),qc(l,h,t,f1,V),V.delete(h)),l}function rI(l){return Du(l)?t:l}function m1(l,h,m,w,R,V){var G=m&x,J=l.length,ie=h.length;if(J!=ie&&!(G&&ie>J))return!1;var Ie=V.get(l),Ne=V.get(h);if(Ie&&Ne)return Ie==h&&Ne==l;var Be=-1,et=!0,ct=m&y?new Yo:t;for(V.set(l,h),V.set(h,l);++Be<J;){var mt=l[Be],Ot=h[Be];if(w)var vt=G?w(Ot,mt,Be,h,l,V):w(mt,Ot,Be,l,h,V);if(vt!==t){if(vt)continue;et=!1;break}if(ct){if(!gu(h,function(Vt,Ht){if(!Wa(ct,Ht)&&(mt===Vt||R(mt,Vt,m,w,V)))return ct.push(Ht)})){et=!1;break}}else if(!(mt===Ot||R(mt,Ot,m,w,V))){et=!1;break}}return V.delete(l),V.delete(h),et}function iI(l,h,m,w,R,V,G){switch(m){case be:if(l.byteLength!=h.byteLength||l.byteOffset!=h.byteOffset)return!1;l=l.buffer,h=h.buffer;case de:return!(l.byteLength!=h.byteLength||!V(new Uc(l),new Uc(h)));case rt:case it:case Ae:return Ui(+l,+h);case Qe:return l.name==h.name&&l.message==h.message;case ne:case O:return l==h+"";case ve:var J=Xa;case W:var ie=w&x;if(J||(J=bu),l.size!=h.size&&!ie)return!1;var Ie=G.get(l);if(Ie)return Ie==h;w|=y,G.set(l,h);var Ne=m1(J(l),J(h),w,R,V,G);return G.delete(l),Ne;case E:if(Yl)return Yl.call(l)==Yl.call(h)}return!1}function sI(l,h,m,w,R,V){var G=m&x,J=jv(l),ie=J.length,Ie=jv(h),Ne=Ie.length;if(ie!=Ne&&!G)return!1;for(var Be=ie;Be--;){var et=J[Be];if(!(G?et in h:Yt.call(h,et)))return!1}var ct=V.get(l),mt=V.get(h);if(ct&&mt)return ct==h&&mt==l;var Ot=!0;V.set(l,h),V.set(h,l);for(var vt=G;++Be<ie;){et=J[Be];var Vt=l[et],Ht=h[et];if(w)var si=G?w(Ht,Vt,et,h,l,V):w(Vt,Ht,et,l,h,V);if(!(si===t?Vt===Ht||R(Vt,Ht,m,w,V):si)){Ot=!1;break}vt||(vt=et=="constructor")}if(Ot&&!vt){var Pr=l.constructor,oi=h.constructor;Pr!=oi&&"constructor"in l&&"constructor"in h&&!(typeof Pr=="function"&&Pr instanceof Pr&&typeof oi=="function"&&oi instanceof oi)&&(Ot=!1)}return V.delete(l),V.delete(h),Ot}function Ys(l){return Kv(b1(l,t,R1),l+"")}function jv(l){return Ev(l,$n,Xv)}function Hv(l){return Ev(l,Hr,v1)}var Wv=Mu?function(l){return Mu.get(l)}:cg;function Xd(l){for(var h=l.name+"",m=Xo[h],w=Yt.call(Xo,h)?m.length:0;w--;){var R=m[w],V=R.func;if(V==null||V==l)return R.name}return h}function nc(l){var h=Yt.call(I,"placeholder")?I:l;return h.placeholder}function ft(){var l=I.iteratee||ag;return l=l===ag?Tv:l,arguments.length?l(arguments[0],arguments[1]):l}function qd(l,h){var m=l.__data__;return pI(h)?m[typeof h=="string"?"string":"hash"]:m.map}function Gv(l){for(var h=$n(l),m=h.length;m--;){var w=h[m],R=l[w];h[m]=[w,R,y1(R)]}return h}function $a(l,h){var m=Kb(l,h);return Pv(m)?m:t}function oI(l){var h=Yt.call(l,bo),m=l[bo];try{l[bo]=t;var w=!0}catch{}var R=Vc.call(l);return w&&(h?l[bo]=m:delete l[bo]),R}var Xv=Ad?function(l){return l==null?[]:(l=sn(l),Gs(Ad(l),function(h){return Ed.call(l,h)}))}:ug,v1=Ad?function(l){for(var h=[];l;)ni(h,Xv(l)),l=wu(l);return h}:ug,_r=gr;(Sl&&_r(new Sl(new ArrayBuffer(1)))!=be||Xl&&_r(new Xl)!=ve||Td&&_r(Td.resolve())!=Xe||Za&&_r(new Za)!=W||ql&&_r(new ql)!=z)&&(_r=function(l){var h=gr(l),m=h==je?l.constructor:t,w=m?el(m):"";if(w)switch(w){case hw:return be;case dw:return ve;case bv:return Xe;case s_:return W;case pw:return z}return h});function aI(l,h,m){for(var w=-1,R=m.length;++w<R;){var V=m[w],G=V.size;switch(V.type){case"drop":l+=G;break;case"dropRight":h-=G;break;case"take":h=ar(h,l+G);break;case"takeRight":l=kn(l,h-G);break}}return{start:l,end:h}}function lI(l){var h=l.match(me);return h?h[1].split(Ce):[]}function g1(l,h,m){h=Qo(h,l);for(var w=-1,R=h.length,V=!1;++w<R;){var G=ys(h[w]);if(!(V=l!=null&&m(l,G)))break;l=l[G]}return V||++w!=R?V:(R=l==null?0:l.length,!!R&&ep(R)&&Zs(G,R)&&(Et(l)||tl(l)))}function cI(l){var h=l.length,m=new l.constructor(h);return h&&typeof l[0]=="string"&&Yt.call(l,"index")&&(m.index=l.index,m.input=l.input),m}function _1(l){return typeof l.constructor=="function"&&!Ou(l)?Ja(wu(l)):{}}function uI(l,h,m){var w=l.constructor;switch(h){case de:return Vv(l);case rt:case it:return new w(+l);case be:return q4(l,m);case oe:case ze:case ke:case Fe:case Ge:case at:case pt:case Dt:case re:return e1(l,m);case ve:return new w;case Ae:case O:return new w(l);case ne:return Y4(l);case W:return new w;case E:return Z4(l)}}function hI(l,h){var m=h.length;if(!m)return l;var w=m-1;return h[w]=(m>1?"& ":"")+h[w],h=h.join(m>2?", ":" "),l.replace(H,`{
/* [wrapped with `+h+`] */
`)}function dI(l){return Et(l)||tl(l)||!!(gv&&l&&l[gv])}function Zs(l,h){var m=typeof l;return h=h==null?pe:h,!!h&&(m=="number"||m!="symbol"&&gn.test(l))&&l>-1&&l%1==0&&l<h}function Ar(l,h,m){if(!bn(m))return!1;var w=typeof h;return(w=="number"?jr(m)&&Zs(h,m.length):w=="string"&&h in m)?Ui(m[h],l):!1}function qv(l,h){if(Et(l))return!1;var m=typeof l;return m=="number"||m=="symbol"||m=="boolean"||l==null||ii(l)?!0:Ul.test(l)||!or.test(l)||h!=null&&l in sn(h)}function pI(l){var h=typeof l;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?l!=="__proto__":l===null}function Yv(l){var h=Xd(l),m=I[h];if(typeof m!="function"||!(h in Bt.prototype))return!1;if(l===m)return!0;var w=Wv(m);return!!w&&l===w[0]}function fI(l){return!!yf&&yf in l}var mI=zc?Ks:hg;function Ou(l){var h=l&&l.constructor,m=typeof h=="function"&&h.prototype||_a;return l===m}function y1(l){return l===l&&!bn(l)}function x1(l,h){return function(m){return m==null?!1:m[l]===h&&(h!==t||l in sn(m))}}function vI(l){var h=Qd(l,function(w){return m.size===u&&m.clear(),w}),m=h.cache;return h}function gI(l,h){var m=l[1],w=h[1],R=m|w,V=R<(_|S|j),G=w==j&&m==A||w==j&&m==T&&l[7].length<=h[8]||w==(j|T)&&h[7].length<=h[8]&&m==A;if(!(V||G))return l;w&_&&(l[2]=h[2],R|=m&_?0:C);var J=h[3];if(J){var ie=l[3];l[3]=ie?n1(ie,J,h[4]):J,l[4]=ie?Xs(l[3],d):h[4]}return J=h[5],J&&(ie=l[5],l[5]=ie?r1(ie,J,h[6]):J,l[6]=ie?Xs(l[5],d):h[6]),J=h[7],J&&(l[7]=J),w&j&&(l[8]=l[8]==null?h[8]:ar(l[8],h[8])),l[9]==null&&(l[9]=h[9]),l[0]=h[0],l[1]=R,l}function _I(l){var h=[];if(l!=null)for(var m in sn(l))h.push(m);return h}function yI(l){return Vc.call(l)}function b1(l,h,m){return h=kn(h===t?l.length-1:h,0),function(){for(var w=arguments,R=-1,V=kn(w.length-h,0),G=_e(V);++R<V;)G[R]=w[h+R];R=-1;for(var J=_e(h+1);++R<h;)J[R]=w[R];return J[h]=m(G),Jn(l,this,J)}}function w1(l,h){return h.length<2?l:Jo(l,Pe(h,0,-1))}function xI(l,h){for(var m=l.length,w=ar(h.length,m),R=Ur(l);w--;){var V=h[w];l[w]=Zs(V,m)?R[V]:t}return l}function Zv(l,h){if(!(h==="constructor"&&typeof l[h]=="function")&&h!="__proto__")return l[h]}var S1=C1(b),Lu=aw||function(l,h){return ln.setTimeout(l,h)},Kv=C1(L);function M1(l,h,m){var w=h+"";return Kv(l,hI(w,bI(lI(w),m)))}function C1(l){var h=0,m=0;return function(){var w=yv(),R=ce-(w-m);if(m=w,R>0){if(++h>=xe)return arguments[0]}else h=0;return l.apply(t,arguments)}}function Yd(l,h){var m=-1,w=l.length,R=w-1;for(h=h===t?w:h;++m<h;){var V=Fd(m,R),G=l[V];l[V]=l[m],l[m]=G}return l.length=h,l}var E1=vI(function(l){var h=[];return l.charCodeAt(0)===46&&h.push(""),l.replace(Vo,function(m,w,R,V){h.push(R?V.replace(lt,"$1"):w||m)}),h});function ys(l){if(typeof l=="string"||ii(l))return l;var h=l+"";return h=="0"&&1/l==-Se?"-0":h}function el(l){if(l!=null){try{return Bc.call(l)}catch{}try{return l+""}catch{}}return""}function bI(l,h){return vr(Ze,function(m){var w="_."+m[0];h&m[1]&&!Ha(l,w)&&l.push(w)}),l.sort()}function A1(l){if(l instanceof Bt)return l.clone();var h=new ri(l.__wrapped__,l.__chain__);return h.__actions__=Ur(l.__actions__),h.__index__=l.__index__,h.__values__=l.__values__,h}function wI(l,h,m){(m?Ar(l,h,m):h===t)?h=1:h=kn(Tt(h),0);var w=l==null?0:l.length;if(!w||h<1)return[];for(var R=0,V=0,G=_e(wl(w/h));R<w;)G[V++]=Pe(l,R,R+=h);return G}function SI(l){for(var h=-1,m=l==null?0:l.length,w=0,R=[];++h<m;){var V=l[h];V&&(R[w++]=V)}return R}function MI(){var l=arguments.length;if(!l)return[];for(var h=_e(l-1),m=arguments[0],w=l;w--;)h[w-1]=arguments[w];return ni(Et(m)?Ur(m):[m],Qn(h,1))}var CI=Rt(function(l,h){return En(l)?Jl(l,Qn(h,1,En,!0)):[]}),EI=Rt(function(l,h){var m=wi(h);return En(m)&&(m=t),En(l)?Jl(l,Qn(h,1,En,!0),ft(m,2)):[]}),AI=Rt(function(l,h){var m=wi(h);return En(m)&&(m=t),En(l)?Jl(l,Qn(h,1,En,!0),t,m):[]});function PI(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),Pe(l,h<0?0:h,w)):[]}function TI(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),h=w-h,Pe(l,0,h<0?0:h)):[]}function RI(l,h){return l&&l.length?Tu(l,ft(h,3),!0,!0):[]}function OI(l,h){return l&&l.length?Tu(l,ft(h,3),!0):[]}function LI(l,h,m,w){var R=l==null?0:l.length;return R?(m&&typeof m!="number"&&Ar(l,h,m)&&(m=0,w=R),Vw(l,h,m,w)):[]}function P1(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=m==null?0:Tt(m);return R<0&&(R=kn(w+R,0)),Nc(l,ft(h,3),R)}function T1(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=w-1;return m!==t&&(R=Tt(m),R=m<0?kn(w+R,0):ar(R,w-1)),Nc(l,ft(h,3),R,!0)}function R1(l){var h=l==null?0:l.length;return h?Qn(l,1):[]}function DI(l){var h=l==null?0:l.length;return h?Qn(l,Se):[]}function II(l,h){var m=l==null?0:l.length;return m?(h=h===t?1:Tt(h),Qn(l,h)):[]}function NI(l){for(var h=-1,m=l==null?0:l.length,w={};++h<m;){var R=l[h];w[R[0]]=R[1]}return w}function O1(l){return l&&l.length?l[0]:t}function kI(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=m==null?0:Tt(m);return R<0&&(R=kn(w+R,0)),fi(l,h,R)}function zI(l){var h=l==null?0:l.length;return h?Pe(l,0,-1):[]}var BI=Rt(function(l){var h=cn(l,zv);return h.length&&h[0]===l[0]?Pu(h):[]}),VI=Rt(function(l){var h=wi(l),m=cn(l,zv);return h===wi(m)?h=t:m.pop(),m.length&&m[0]===l[0]?Pu(m,ft(h,2)):[]}),FI=Rt(function(l){var h=wi(l),m=cn(l,zv);return h=typeof h=="function"?h:t,h&&m.pop(),m.length&&m[0]===l[0]?Pu(m,t,h):[]});function UI(l,h){return l==null?"":cw.call(l,h)}function wi(l){var h=l==null?0:l.length;return h?l[h-1]:t}function jI(l,h,m){var w=l==null?0:l.length;if(!w)return-1;var R=w;return m!==t&&(R=Tt(m),R=R<0?kn(w+R,0):ar(R,w-1)),h===h?ew(l,h,R):Nc(l,yu,R,!0)}function HI(l,h){return l&&l.length?Ef(l,Tt(h)):t}var WI=Rt(L1);function L1(l,h){return l&&l.length&&h&&h.length?Vd(l,h):l}function GI(l,h,m){return l&&l.length&&h&&h.length?Vd(l,h,ft(m,2)):l}function XI(l,h,m){return l&&l.length&&h&&h.length?Vd(l,h,t,m):l}var qI=Ys(function(l,h){var m=l==null?0:l.length,w=Zo(l,h);return Nv(l,cn(h,function(R){return Zs(R,m)?+R:R}).sort(t1)),w});function YI(l,h){var m=[];if(!(l&&l.length))return m;var w=-1,R=[],V=l.length;for(h=ft(h,3);++w<V;){var G=l[w];h(G,w,l)&&(m.push(G),R.push(w))}return Nv(l,R),m}function Jv(l){return l==null?l:uw.call(l)}function ZI(l,h,m){var w=l==null?0:l.length;return w?(m&&typeof m!="number"&&Ar(l,h,m)?(h=0,m=w):(h=h==null?0:Tt(h),m=m===t?w:Tt(m)),Pe(l,h,m)):[]}function KI(l,h){return _t(l,h)}function JI(l,h,m){return Kt(l,h,ft(m,2))}function QI(l,h){var m=l==null?0:l.length;if(m){var w=_t(l,h);if(w<m&&Ui(l[w],h))return w}return-1}function $I(l,h){return _t(l,h,!0)}function eN(l,h,m){return Kt(l,h,ft(m,2),!0)}function tN(l,h){var m=l==null?0:l.length;if(m){var w=_t(l,h,!0)-1;if(Ui(l[w],h))return w}return-1}function nN(l){return l&&l.length?fn(l):[]}function rN(l,h){return l&&l.length?fn(l,ft(h,2)):[]}function iN(l){var h=l==null?0:l.length;return h?Pe(l,1,h):[]}function sN(l,h,m){return l&&l.length?(h=m||h===t?1:Tt(h),Pe(l,0,h<0?0:h)):[]}function oN(l,h,m){var w=l==null?0:l.length;return w?(h=m||h===t?1:Tt(h),h=w-h,Pe(l,h<0?0:h,w)):[]}function aN(l,h){return l&&l.length?Tu(l,ft(h,3),!1,!0):[]}function lN(l,h){return l&&l.length?Tu(l,ft(h,3)):[]}var cN=Rt(function(l){return vi(Qn(l,1,En,!0))}),uN=Rt(function(l){var h=wi(l);return En(h)&&(h=t),vi(Qn(l,1,En,!0),ft(h,2))}),hN=Rt(function(l){var h=wi(l);return h=typeof h=="function"?h:t,vi(Qn(l,1,En,!0),t,h)});function dN(l){return l&&l.length?vi(l):[]}function pN(l,h){return l&&l.length?vi(l,ft(h,2)):[]}function fN(l,h){return h=typeof h=="function"?h:t,l&&l.length?vi(l,t,h):[]}function Qv(l){if(!(l&&l.length))return[];var h=0;return l=Gs(l,function(m){if(En(m))return h=kn(m.length,h),!0}),Gl(h,function(m){return cn(l,wd(m))})}function D1(l,h){if(!(l&&l.length))return[];var m=Qv(l);return h==null?m:cn(m,function(w){return Jn(h,t,w)})}var mN=Rt(function(l,h){return En(l)?Jl(l,h):[]}),vN=Rt(function(l){return kv(Gs(l,En))}),gN=Rt(function(l){var h=wi(l);return En(h)&&(h=t),kv(Gs(l,En),ft(h,2))}),_N=Rt(function(l){var h=wi(l);return h=typeof h=="function"?h:t,kv(Gs(l,En),t,h)}),yN=Rt(Qv);function xN(l,h){return Jw(l||[],h||[],Kl)}function bN(l,h){return Jw(l||[],h||[],g)}var wN=Rt(function(l){var h=l.length,m=h>1?l[h-1]:t;return m=typeof m=="function"?(l.pop(),m):t,D1(l,m)});function I1(l){var h=I(l);return h.__chain__=!0,h}function SN(l,h){return h(l),l}function Zd(l,h){return h(l)}var MN=Ys(function(l){var h=l.length,m=h?l[0]:0,w=this.__wrapped__,R=function(V){return Zo(V,l)};return h>1||this.__actions__.length||!(w instanceof Bt)||!Zs(m)?this.thru(R):(w=w.slice(m,+m+(h?1:0)),w.__actions__.push({func:Zd,args:[R],thisArg:t}),new ri(w,this.__chain__).thru(function(V){return h&&!V.length&&V.push(t),V}))});function CN(){return I1(this)}function EN(){return new ri(this.value(),this.__chain__)}function AN(){this.__values__===t&&(this.__values__=Y1(this.value()));var l=this.__index__>=this.__values__.length,h=l?t:this.__values__[this.__index__++];return{done:l,value:h}}function PN(){return this}function TN(l){for(var h,m=this;m instanceof Zl;){var w=A1(m);w.__index__=0,w.__values__=t,h?R.__wrapped__=w:h=w;var R=w;m=m.__wrapped__}return R.__wrapped__=l,h}function RN(){var l=this.__wrapped__;if(l instanceof Bt){var h=l;return this.__actions__.length&&(h=new Bt(this)),h=h.reverse(),h.__actions__.push({func:Zd,args:[Jv],thisArg:t}),new ri(h,this.__chain__)}return this.thru(Jv)}function ON(){return Kw(this.__wrapped__,this.__actions__)}var LN=Ud(function(l,h,m){Yt.call(l,m)?++l[m]:gs(l,m,1)});function DN(l,h,m){var w=Et(l)?pv:Bw;return m&&Ar(l,h,m)&&(h=t),w(l,ft(h,3))}function IN(l,h){var m=Et(l)?Gs:Od;return m(l,ft(h,3))}var NN=a1(P1),kN=a1(T1);function zN(l,h){return Qn(Kd(l,h),1)}function BN(l,h){return Qn(Kd(l,h),Se)}function VN(l,h,m){return m=m===t?1:Tt(m),Qn(Kd(l,h),m)}function N1(l,h){var m=Et(l)?vr:Di;return m(l,ft(h,3))}function k1(l,h){var m=Et(l)?qb:Mf;return m(l,ft(h,3))}var FN=Ud(function(l,h,m){Yt.call(l,m)?l[m].push(h):gs(l,m,[h])});function UN(l,h,m,w){l=jr(l)?l:ic(l),m=m&&!w?Tt(m):0;var R=l.length;return m<0&&(m=kn(R+m,0)),tp(l)?m<=R&&l.indexOf(h,m)>-1:!!R&&fi(l,h,m)>-1}var jN=Rt(function(l,h,m){var w=-1,R=typeof h=="function",V=jr(l)?_e(l.length):[];return Di(l,function(G){V[++w]=R?Jn(h,G,m):Ql(G,h,m)}),V}),HN=Ud(function(l,h,m){gs(l,m,h)});function Kd(l,h){var m=Et(l)?cn:Rv;return m(l,ft(h,3))}function WN(l,h,m,w){return l==null?[]:(Et(h)||(h=h==null?[]:[h]),m=w?t:m,Et(m)||(m=m==null?[]:[m]),Dv(l,h,m))}var GN=Ud(function(l,h,m){l[m?0:1].push(h)},function(){return[[],[]]});function XN(l,h,m){var w=Et(l)?xd:Md,R=arguments.length<3;return w(l,ft(h,4),m,R,Di)}function qN(l,h,m){var w=Et(l)?K0:Md,R=arguments.length<3;return w(l,ft(h,4),m,R,Mf)}function YN(l,h){var m=Et(l)?Gs:Od;return m(l,$d(ft(h,3)))}function ZN(l){var h=Et(l)?wf:Zw;return h(l)}function KN(l,h,m){(m?Ar(l,h,m):h===t)?h=1:h=Tt(h);var w=Et(l)?yh:M;return w(l,h)}function JN(l){var h=Et(l)?Iw:Q;return h(l)}function QN(l){if(l==null)return 0;if(jr(l))return tp(l)?qa(l):l.length;var h=_r(l);return h==ve||h==W?l.size:zd(l).length}function $N(l,h,m){var w=Et(l)?gu:Ye;return m&&Ar(l,h,m)&&(h=t),w(l,ft(h,3))}var ek=Rt(function(l,h){if(l==null)return[];var m=h.length;return m>1&&Ar(l,h[0],h[1])?h=[]:m>2&&Ar(h[0],h[1],h[2])&&(h=[h[0]]),Dv(l,Qn(h,1),[])}),Jd=r_||function(){return ln.Date.now()};function tk(l,h){if(typeof h!="function")throw new Yr(o);return l=Tt(l),function(){if(--l<1)return h.apply(this,arguments)}}function z1(l,h,m){return h=m?t:h,h=l&&h==null?l.length:h,qs(l,j,t,t,t,t,h)}function B1(l,h){var m;if(typeof h!="function")throw new Yr(o);return l=Tt(l),function(){return--l>0&&(m=h.apply(this,arguments)),l<=1&&(h=t),m}}var $v=Rt(function(l,h,m){var w=_;if(m.length){var R=Xs(m,nc($v));w|=D}return qs(l,w,h,m,R)}),V1=Rt(function(l,h,m){var w=_|S;if(m.length){var R=Xs(m,nc(V1));w|=D}return qs(h,w,l,m,R)});function F1(l,h,m){h=m?t:h;var w=qs(l,A,t,t,t,t,t,h);return w.placeholder=F1.placeholder,w}function U1(l,h,m){h=m?t:h;var w=qs(l,P,t,t,t,t,t,h);return w.placeholder=U1.placeholder,w}function j1(l,h,m){var w,R,V,G,J,ie,Ie=0,Ne=!1,Be=!1,et=!0;if(typeof l!="function")throw new Yr(o);h=Si(h)||0,bn(m)&&(Ne=!!m.leading,Be="maxWait"in m,V=Be?kn(Si(m.maxWait)||0,h):V,et="trailing"in m?!!m.trailing:et);function ct(An){var ji=w,Qs=R;return w=R=t,Ie=An,G=l.apply(Qs,ji),G}function mt(An){return Ie=An,J=Lu(Vt,h),Ne?ct(An):G}function Ot(An){var ji=An-ie,Qs=An-Ie,aS=h-ji;return Be?ar(aS,V-Qs):aS}function vt(An){var ji=An-ie,Qs=An-Ie;return ie===t||ji>=h||ji<0||Be&&Qs>=V}function Vt(){var An=Jd();if(vt(An))return Ht(An);J=Lu(Vt,Ot(An))}function Ht(An){return J=t,et&&w?ct(An):(w=R=t,G)}function si(){J!==t&&Qw(J),Ie=0,w=ie=R=J=t}function Pr(){return J===t?G:Ht(Jd())}function oi(){var An=Jd(),ji=vt(An);if(w=arguments,R=this,ie=An,ji){if(J===t)return mt(ie);if(Be)return Qw(J),J=Lu(Vt,h),ct(ie)}return J===t&&(J=Lu(Vt,h)),G}return oi.cancel=si,oi.flush=Pr,oi}var nk=Rt(function(l,h){return Cv(l,1,h)}),rk=Rt(function(l,h,m){return Cv(l,Si(h)||0,m)});function ik(l){return qs(l,k)}function Qd(l,h){if(typeof l!="function"||h!=null&&typeof h!="function")throw new Yr(o);var m=function(){var w=arguments,R=h?h.apply(this,w):w[0],V=m.cache;if(V.has(R))return V.get(R);var G=l.apply(this,w);return m.cache=V.set(R,G)||V,G};return m.cache=new(Qd.Cache||vs),m}Qd.Cache=vs;function $d(l){if(typeof l!="function")throw new Yr(o);return function(){var h=arguments;switch(h.length){case 0:return!l.call(this);case 1:return!l.call(this,h[0]);case 2:return!l.call(this,h[0],h[1]);case 3:return!l.call(this,h[0],h[1],h[2])}return!l.apply(this,h)}}function sk(l){return B1(2,l)}var ok=X4(function(l,h){h=h.length==1&&Et(h[0])?cn(h[0],ir(ft())):cn(Qn(h,1),ir(ft()));var m=h.length;return Rt(function(w){for(var R=-1,V=ar(w.length,m);++R<V;)w[R]=h[R].call(this,w[R]);return Jn(l,this,w)})}),eg=Rt(function(l,h){var m=Xs(h,nc(eg));return qs(l,D,t,h,m)}),H1=Rt(function(l,h){var m=Xs(h,nc(H1));return qs(l,N,t,h,m)}),ak=Ys(function(l,h){return qs(l,T,t,t,t,h)});function lk(l,h){if(typeof l!="function")throw new Yr(o);return h=h===t?h:Tt(h),Rt(l,h)}function ck(l,h){if(typeof l!="function")throw new Yr(o);return h=h==null?0:kn(Tt(h),0),Rt(function(m){var w=m[h],R=$o(m,0,h);return w&&ni(R,w),Jn(l,this,R)})}function uk(l,h,m){var w=!0,R=!0;if(typeof l!="function")throw new Yr(o);return bn(m)&&(w="leading"in m?!!m.leading:w,R="trailing"in m?!!m.trailing:R),j1(l,h,{leading:w,maxWait:h,trailing:R})}function hk(l){return z1(l,1)}function dk(l,h){return eg(Bv(h),l)}function pk(){if(!arguments.length)return[];var l=arguments[0];return Et(l)?l:[l]}function fk(l){return Zr(l,v)}function mk(l,h){return h=typeof h=="function"?h:t,Zr(l,v,h)}function vk(l){return Zr(l,p|v)}function gk(l,h){return h=typeof h=="function"?h:t,Zr(l,p|v,h)}function _k(l,h){return h==null||Sf(l,h,$n(h))}function Ui(l,h){return l===h||l!==l&&h!==h}var yk=Gd(Dd),xk=Gd(function(l,h){return l>=h}),tl=Nd(function(){return arguments}())?Nd:function(l){return Cn(l)&&Yt.call(l,"callee")&&!Ed.call(l,"callee")},Et=_e.isArray,bk=ur?ir(ur):Uw;function jr(l){return l!=null&&ep(l.length)&&!Ks(l)}function En(l){return Cn(l)&&jr(l)}function wk(l){return l===!0||l===!1||Cn(l)&&gr(l)==rt}var ea=lw||hg,Sk=ti?ir(ti):Xc;function Mk(l){return Cn(l)&&l.nodeType===1&&!Du(l)}function Ck(l){if(l==null)return!0;if(jr(l)&&(Et(l)||typeof l=="string"||typeof l.splice=="function"||ea(l)||rc(l)||tl(l)))return!l.length;var h=_r(l);if(h==ve||h==W)return!l.size;if(Ou(l))return!zd(l).length;for(var m in l)if(Yt.call(l,m))return!1;return!0}function Ek(l,h){return $l(l,h)}function Ak(l,h,m){m=typeof m=="function"?m:t;var w=m?m(l,h):t;return w===t?$l(l,h,t,m):!!w}function tg(l){if(!Cn(l))return!1;var h=gr(l);return h==Qe||h==Ke||typeof l.message=="string"&&typeof l.name=="string"&&!Du(l)}function Pk(l){return typeof l=="number"&&bf(l)}function Ks(l){if(!bn(l))return!1;var h=gr(l);return h==Y||h==K||h==Mt||h==He}function W1(l){return typeof l=="number"&&l==Tt(l)}function ep(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=pe}function bn(l){var h=typeof l;return l!=null&&(h=="object"||h=="function")}function Cn(l){return l!=null&&typeof l=="object"}var G1=vu?ir(vu):Av;function Tk(l,h){return l===h||kd(l,h,Gv(h))}function Rk(l,h,m){return m=typeof m=="function"?m:t,kd(l,h,Gv(h),m)}function Ok(l){return X1(l)&&l!=+l}function Lk(l){if(mI(l))throw new St(s);return Pv(l)}function Dk(l){return l===null}function Ik(l){return l==null}function X1(l){return typeof l=="number"||Cn(l)&&gr(l)==Ae}function Du(l){if(!Cn(l)||gr(l)!=je)return!1;var h=wu(l);if(h===null)return!0;var m=Yt.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&Bc.call(m)==sw}var ng=mr?ir(mr):u_;function Nk(l){return W1(l)&&l>=-pe&&l<=pe}var q1=Ic?ir(Ic):Hw;function tp(l){return typeof l=="string"||!Et(l)&&Cn(l)&&gr(l)==O}function ii(l){return typeof l=="symbol"||Cn(l)&&gr(l)==E}var rc=yo?ir(yo):Ww;function kk(l){return l===t}function zk(l){return Cn(l)&&_r(l)==z}function Bk(l){return Cn(l)&&gr(l)==Z}var Vk=Gd(Bd),Fk=Gd(function(l,h){return l<=h});function Y1(l){if(!l)return[];if(jr(l))return tp(l)?Er(l):Ur(l);if(Ya&&l[Ya])return Qb(l[Ya]());var h=_r(l),m=h==ve?Xa:h==W?bu:ic;return m(l)}function Js(l){if(!l)return l===0?l:0;if(l=Si(l),l===Se||l===-Se){var h=l<0?-1:1;return h*se}return l===l?l:0}function Tt(l){var h=Js(l),m=h%1;return h===h?m?h-m:h:0}function Z1(l){return l?Ko(Tt(l),0,Le):0}function Si(l){if(typeof l=="number")return l;if(ii(l))return ae;if(bn(l)){var h=typeof l.valueOf=="function"?l.valueOf():l;l=bn(h)?h+"":h}if(typeof l!="string")return l===0?l:+l;l=ff(l);var m=Zt.test(l);return m||It.test(l)?Xn(l.slice(2),m?2:8):wt.test(l)?ae:+l}function K1(l){return _s(l,Hr(l))}function Uk(l){return l?Ko(Tt(l),-pe,pe):l===0?l:0}function Jt(l){return l==null?"":an(l)}var jk=ec(function(l,h){if(Ou(h)||jr(h)){_s(h,$n(h),l);return}for(var m in h)Yt.call(h,m)&&Kl(l,m,h[m])}),J1=ec(function(l,h){_s(h,Hr(h),l)}),np=ec(function(l,h,m,w){_s(h,Hr(h),l,w)}),Hk=ec(function(l,h,m,w){_s(h,$n(h),l,w)}),Wk=Ys(Zo);function Gk(l,h){var m=Ja(l);return h==null?m:Mv(m,h)}var Xk=Rt(function(l,h){l=sn(l);var m=-1,w=h.length,R=w>2?h[2]:t;for(R&&Ar(h[0],h[1],R)&&(w=1);++m<w;)for(var V=h[m],G=Hr(V),J=-1,ie=G.length;++J<ie;){var Ie=G[J],Ne=l[Ie];(Ne===t||Ui(Ne,_a[Ie])&&!Yt.call(l,Ie))&&(l[Ie]=V[Ie])}return l}),qk=Rt(function(l){return l.push(t,f1),Jn(Q1,t,l)});function Yk(l,h){return bi(l,ft(h,3),Fi)}function Zk(l,h){return bi(l,ft(h,3),Ld)}function Kk(l,h){return l==null?l:Cl(l,ft(h,3),Hr)}function Jk(l,h){return l==null?l:Cf(l,ft(h,3),Hr)}function Qk(l,h){return l&&Fi(l,ft(h,3))}function $k(l,h){return l&&Ld(l,ft(h,3))}function ez(l){return l==null?[]:Au(l,$n(l))}function tz(l){return l==null?[]:Au(l,Hr(l))}function rg(l,h,m){var w=l==null?t:Jo(l,h);return w===t?m:w}function nz(l,h){return l!=null&&g1(l,h,Id)}function ig(l,h){return l!=null&&g1(l,h,l_)}var rz=c1(function(l,h,m){h!=null&&typeof h.toString!="function"&&(h=Vc.call(h)),l[h]=m},og(Wr)),iz=c1(function(l,h,m){h!=null&&typeof h.toString!="function"&&(h=Vc.call(h)),Yt.call(l,h)?l[h].push(m):l[h]=[m]},ft),sz=Rt(Ql);function $n(l){return jr(l)?Ml(l):zd(l)}function Hr(l){return jr(l)?Ml(l,!0):Gw(l)}function oz(l,h){var m={};return h=ft(h,3),Fi(l,function(w,R,V){gs(m,h(w,R,V),w)}),m}function az(l,h){var m={};return h=ft(h,3),Fi(l,function(w,R,V){gs(m,R,h(w,R,V))}),m}var lz=ec(function(l,h,m){qc(l,h,m)}),Q1=ec(function(l,h,m,w){qc(l,h,m,w)}),cz=Ys(function(l,h){var m={};if(l==null)return m;var w=!1;h=cn(h,function(V){return V=Qo(V,l),w||(w=V.length>1),V}),_s(l,Hv(l),m),w&&(m=Zr(m,p|f|v,rI));for(var R=h.length;R--;)Qa(m,h[R]);return m});function uz(l,h){return $1(l,$d(ft(h)))}var hz=Ys(function(l,h){return l==null?{}:Xw(l,h)});function $1(l,h){if(l==null)return{};var m=cn(Hv(l),function(w){return[w]});return h=ft(h),Iv(l,m,function(w,R){return h(w,R[0])})}function dz(l,h,m){h=Qo(h,l);var w=-1,R=h.length;for(R||(R=1,l=t);++w<R;){var V=l==null?t:l[ys(h[w])];V===t&&(w=R,V=m),l=Ks(V)?V.call(l):V}return l}function pz(l,h,m){return l==null?l:g(l,h,m)}function fz(l,h,m,w){return w=typeof w=="function"?w:t,l==null?l:g(l,h,m,w)}var eS=d1($n),tS=d1(Hr);function mz(l,h,m){var w=Et(l),R=w||ea(l)||rc(l);if(h=ft(h,4),m==null){var V=l&&l.constructor;R?m=w?new V:[]:bn(l)?m=Ks(V)?Ja(wu(l)):{}:m={}}return(R?vr:Fi)(l,function(G,J,ie){return h(m,G,J,ie)}),m}function vz(l,h){return l==null?!0:Qa(l,h)}function gz(l,h,m){return l==null?l:Yc(l,h,Bv(m))}function _z(l,h,m,w){return w=typeof w=="function"?w:t,l==null?l:Yc(l,h,Bv(m),w)}function ic(l){return l==null?[]:vh(l,$n(l))}function yz(l){return l==null?[]:vh(l,Hr(l))}function xz(l,h,m){return m===t&&(m=h,h=t),m!==t&&(m=Si(m),m=m===m?m:0),h!==t&&(h=Si(h),h=h===h?h:0),Ko(Si(l),h,m)}function bz(l,h,m){return h=Js(h),m===t?(m=h,h=0):m=Js(m),l=Si(l),Fw(l,h,m)}function wz(l,h,m){if(m&&typeof m!="boolean"&&Ar(l,h,m)&&(h=m=t),m===t&&(typeof h=="boolean"?(m=h,h=t):typeof l=="boolean"&&(m=l,l=t)),l===t&&h===t?(l=0,h=1):(l=Js(l),h===t?(h=l,l=0):h=Js(h)),l>h){var w=l;l=h,h=w}if(m||l%1||h%1){var R=xv();return ar(l+R*(h-l+wn("1e-"+((R+"").length-1))),h)}return Fd(l,h)}var Sz=tc(function(l,h,m){return h=h.toLowerCase(),l+(m?nS(h):h)});function nS(l){return sg(Jt(l).toLowerCase())}function rS(l){return l=Jt(l),l&&l.replace(Bi,gh).replace(q,"")}function Mz(l,h,m){l=Jt(l),h=an(h);var w=l.length;m=m===t?w:Ko(Tt(m),0,w);var R=m;return m-=h.length,m>=0&&l.slice(m,R)==h}function Cz(l){return l=Jt(l),l&&hn.test(l)?l.replace(Ft,_h):l}function Ez(l){return l=Jt(l),l&&Lc.test(l)?l.replace(Fo,"\\$&"):l}var Az=tc(function(l,h,m){return l+(m?"-":"")+h.toLowerCase()}),Pz=tc(function(l,h,m){return l+(m?" ":"")+h.toLowerCase()}),Tz=o1("toLowerCase");function Rz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;if(!h||w>=h)return l;var R=(h-w)/2;return Wd(Su(R),m)+l+Wd(wl(R),m)}function Oz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;return h&&w<h?l+Wd(h-w,m):l}function Lz(l,h,m){l=Jt(l),h=Tt(h);var w=h?qa(l):0;return h&&w<h?Wd(h-w,m)+l:l}function Dz(l,h,m){return m||h==null?h=0:h&&(h=+h),Pd(Jt(l).replace(va,""),h||0)}function Iz(l,h,m){return(m?Ar(l,h,m):h===t)?h=1:h=Tt(h),xh(Jt(l),h)}function Nz(){var l=arguments,h=Jt(l[0]);return l.length<3?h:h.replace(l[1],l[2])}var kz=tc(function(l,h,m){return l+(m?"_":"")+h.toLowerCase()});function zz(l,h,m){return m&&typeof m!="number"&&Ar(l,h,m)&&(h=m=t),m=m===t?Le:m>>>0,m?(l=Jt(l),l&&(typeof h=="string"||h!=null&&!ng(h))&&(h=an(h),!h&&Ga(l))?$o(Er(l),0,m):l.split(h,m)):[]}var Bz=tc(function(l,h,m){return l+(m?" ":"")+sg(h)});function Vz(l,h,m){return l=Jt(l),m=m==null?0:Ko(Tt(m),0,l.length),h=an(h),l.slice(m,m+h.length)==h}function Fz(l,h,m){var w=I.templateSettings;m&&Ar(l,h,m)&&(h=t),l=Jt(l),h=np({},h,w,p1);var R=np({},h.imports,w.imports,p1),V=$n(R),G=vh(R,V),J,ie,Ie=0,Ne=h.interpolate||Mr,Be="__p += '",et=Ls((h.escape||Mr).source+"|"+Ne.source+"|"+(Ne===xr?xt:Mr).source+"|"+(h.evaluate||Mr).source+"|$","g"),ct="//# sourceURL="+(Yt.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++In+"]")+`
`;l.replace(et,function(vt,Vt,Ht,si,Pr,oi){return Ht||(Ht=si),Be+=l.slice(Ie,oi).replace(Ln,vf),Vt&&(J=!0,Be+=`' +
__e(`+Vt+`) +
'`),Pr&&(ie=!0,Be+=`';
`+Pr+`;
__p += '`),Ht&&(Be+=`' +
((__t = (`+Ht+`)) == null ? '' : __t) +
'`),Ie=oi+vt.length,vt}),Be+=`';
`;var mt=Yt.call(h,"variable")&&h.variable;if(!mt)Be=`with (obj) {
`+Be+`
}
`;else if(Oe.test(mt))throw new St(a);Be=(ie?Be.replace($e,""):Be).replace(Me,"$1").replace(tt,"$1;"),Be="function("+(mt||"obj")+`) {
`+(mt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(J?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Be+`return __p
}`;var Ot=sS(function(){return jt(V,ct+"return "+Be).apply(t,G)});if(Ot.source=Be,tg(Ot))throw Ot;return Ot}function Uz(l){return Jt(l).toLowerCase()}function jz(l){return Jt(l).toUpperCase()}function Hz(l,h,m){if(l=Jt(l),l&&(m||h===t))return ff(l);if(!l||!(h=an(h)))return l;var w=Er(l),R=Er(h),V=Cd(w,R),G=fv(w,R)+1;return $o(w,V,G).join("")}function Wz(l,h,m){if(l=Jt(l),l&&(m||h===t))return l.slice(0,gf(l)+1);if(!l||!(h=an(h)))return l;var w=Er(l),R=fv(w,Er(h))+1;return $o(w,0,R).join("")}function Gz(l,h,m){if(l=Jt(l),l&&(m||h===t))return l.replace(va,"");if(!l||!(h=an(h)))return l;var w=Er(l),R=Cd(w,Er(h));return $o(w,R).join("")}function Xz(l,h){var m=U,w=ee;if(bn(h)){var R="separator"in h?h.separator:R;m="length"in h?Tt(h.length):m,w="omission"in h?an(h.omission):w}l=Jt(l);var V=l.length;if(Ga(l)){var G=Er(l);V=G.length}if(m>=V)return l;var J=m-qa(w);if(J<1)return w;var ie=G?$o(G,0,J).join(""):l.slice(0,J);if(R===t)return ie+w;if(G&&(J+=ie.length-J),ng(R)){if(l.slice(J).search(R)){var Ie,Ne=ie;for(R.global||(R=Ls(R.source,Jt(bt.exec(R))+"g")),R.lastIndex=0;Ie=R.exec(Ne);)var Be=Ie.index;ie=ie.slice(0,Be===t?J:Be)}}else if(l.indexOf(an(R),J)!=J){var et=ie.lastIndexOf(R);et>-1&&(ie=ie.slice(0,et))}return ie+w}function qz(l){return l=Jt(l),l&&vn.test(l)?l.replace(Je,tw):l}var Yz=tc(function(l,h,m){return l+(m?" ":"")+h.toUpperCase()}),sg=o1("toUpperCase");function iS(l,h,m){return l=Jt(l),h=m?t:h,h===t?Jb(l)?$0(l):J0(l):l.match(h)||[]}var sS=Rt(function(l,h){try{return Jn(l,t,h)}catch(m){return tg(m)?m:new St(m)}}),Zz=Ys(function(l,h){return vr(h,function(m){m=ys(m),gs(l,m,$v(l[m],l))}),l});function Kz(l){var h=l==null?0:l.length,m=ft();return l=h?cn(l,function(w){if(typeof w[1]!="function")throw new Yr(o);return[m(w[0]),w[1]]}):[],Rt(function(w){for(var R=-1;++R<h;){var V=l[R];if(Jn(V[0],this,w))return Jn(V[1],this,w)}})}function Jz(l){return zw(Zr(l,p))}function og(l){return function(){return l}}function Qz(l,h){return l==null||l!==l?h:l}var $z=l1(),eB=l1(!0);function Wr(l){return l}function ag(l){return Tv(typeof l=="function"?l:Zr(l,p))}function tB(l){return Ov(Zr(l,p))}function nB(l,h){return Lv(l,Zr(h,p))}var rB=Rt(function(l,h){return function(m){return Ql(m,l,h)}}),iB=Rt(function(l,h){return function(m){return Ql(l,m,h)}});function lg(l,h,m){var w=$n(h),R=Au(h,w);m==null&&!(bn(h)&&(R.length||!w.length))&&(m=h,h=l,l=this,R=Au(h,$n(h)));var V=!(bn(m)&&"chain"in m)||!!m.chain,G=Ks(l);return vr(R,function(J){var ie=h[J];l[J]=ie,G&&(l.prototype[J]=function(){var Ie=this.__chain__;if(V||Ie){var Ne=l(this.__wrapped__),Be=Ne.__actions__=Ur(this.__actions__);return Be.push({func:ie,args:arguments,thisArg:l}),Ne.__chain__=Ie,Ne}return ie.apply(l,ni([this.value()],arguments))})}),l}function sB(){return ln._===this&&(ln._=n_),this}function cg(){}function oB(l){return l=Tt(l),Rt(function(h){return Ef(h,l)})}var aB=Fv(cn),lB=Fv(pv),cB=Fv(gu);function oS(l){return qv(l)?wd(ys(l)):qw(l)}function uB(l){return function(h){return l==null?t:Jo(l,h)}}var hB=u1(),dB=u1(!0);function ug(){return[]}function hg(){return!1}function pB(){return{}}function fB(){return""}function mB(){return!0}function vB(l,h){if(l=Tt(l),l<1||l>pe)return[];var m=Le,w=ar(l,Le);h=ft(h),l-=Le;for(var R=Gl(w,h);++m<l;)h(m);return R}function gB(l){return Et(l)?cn(l,ys):ii(l)?[l]:Ur(E1(Jt(l)))}function _B(l){var h=++t_;return Jt(l)+h}var yB=Hd(function(l,h){return l+h},0),xB=Uv("ceil"),bB=Hd(function(l,h){return l/h},1),wB=Uv("floor");function SB(l){return l&&l.length?Eu(l,Wr,Dd):t}function MB(l,h){return l&&l.length?Eu(l,ft(h,2),Dd):t}function CB(l){return bd(l,Wr)}function EB(l,h){return bd(l,ft(h,2))}function AB(l){return l&&l.length?Eu(l,Wr,Bd):t}function PB(l,h){return l&&l.length?Eu(l,ft(h,2),Bd):t}var TB=Hd(function(l,h){return l*h},1),RB=Uv("round"),OB=Hd(function(l,h){return l-h},0);function LB(l){return l&&l.length?xu(l,Wr):0}function DB(l,h){return l&&l.length?xu(l,ft(h,2)):0}return I.after=tk,I.ary=z1,I.assign=jk,I.assignIn=J1,I.assignInWith=np,I.assignWith=Hk,I.at=Wk,I.before=B1,I.bind=$v,I.bindAll=Zz,I.bindKey=V1,I.castArray=pk,I.chain=I1,I.chunk=wI,I.compact=SI,I.concat=MI,I.cond=Kz,I.conforms=Jz,I.constant=og,I.countBy=LN,I.create=Gk,I.curry=F1,I.curryRight=U1,I.debounce=j1,I.defaults=Xk,I.defaultsDeep=qk,I.defer=nk,I.delay=rk,I.difference=CI,I.differenceBy=EI,I.differenceWith=AI,I.drop=PI,I.dropRight=TI,I.dropRightWhile=RI,I.dropWhile=OI,I.fill=LI,I.filter=IN,I.flatMap=zN,I.flatMapDeep=BN,I.flatMapDepth=VN,I.flatten=R1,I.flattenDeep=DI,I.flattenDepth=II,I.flip=ik,I.flow=$z,I.flowRight=eB,I.fromPairs=NI,I.functions=ez,I.functionsIn=tz,I.groupBy=FN,I.initial=zI,I.intersection=BI,I.intersectionBy=VI,I.intersectionWith=FI,I.invert=rz,I.invertBy=iz,I.invokeMap=jN,I.iteratee=ag,I.keyBy=HN,I.keys=$n,I.keysIn=Hr,I.map=Kd,I.mapKeys=oz,I.mapValues=az,I.matches=tB,I.matchesProperty=nB,I.memoize=Qd,I.merge=lz,I.mergeWith=Q1,I.method=rB,I.methodOf=iB,I.mixin=lg,I.negate=$d,I.nthArg=oB,I.omit=cz,I.omitBy=uz,I.once=sk,I.orderBy=WN,I.over=aB,I.overArgs=ok,I.overEvery=lB,I.overSome=cB,I.partial=eg,I.partialRight=H1,I.partition=GN,I.pick=hz,I.pickBy=$1,I.property=oS,I.propertyOf=uB,I.pull=WI,I.pullAll=L1,I.pullAllBy=GI,I.pullAllWith=XI,I.pullAt=qI,I.range=hB,I.rangeRight=dB,I.rearg=ak,I.reject=YN,I.remove=YI,I.rest=lk,I.reverse=Jv,I.sampleSize=KN,I.set=pz,I.setWith=fz,I.shuffle=JN,I.slice=ZI,I.sortBy=ek,I.sortedUniq=nN,I.sortedUniqBy=rN,I.split=zz,I.spread=ck,I.tail=iN,I.take=sN,I.takeRight=oN,I.takeRightWhile=aN,I.takeWhile=lN,I.tap=SN,I.throttle=uk,I.thru=Zd,I.toArray=Y1,I.toPairs=eS,I.toPairsIn=tS,I.toPath=gB,I.toPlainObject=K1,I.transform=mz,I.unary=hk,I.union=cN,I.unionBy=uN,I.unionWith=hN,I.uniq=dN,I.uniqBy=pN,I.uniqWith=fN,I.unset=vz,I.unzip=Qv,I.unzipWith=D1,I.update=gz,I.updateWith=_z,I.values=ic,I.valuesIn=yz,I.without=mN,I.words=iS,I.wrap=dk,I.xor=vN,I.xorBy=gN,I.xorWith=_N,I.zip=yN,I.zipObject=xN,I.zipObjectDeep=bN,I.zipWith=wN,I.entries=eS,I.entriesIn=tS,I.extend=J1,I.extendWith=np,lg(I,I),I.add=yB,I.attempt=sS,I.camelCase=Sz,I.capitalize=nS,I.ceil=xB,I.clamp=xz,I.clone=fk,I.cloneDeep=vk,I.cloneDeepWith=gk,I.cloneWith=mk,I.conformsTo=_k,I.deburr=rS,I.defaultTo=Qz,I.divide=bB,I.endsWith=Mz,I.eq=Ui,I.escape=Cz,I.escapeRegExp=Ez,I.every=DN,I.find=NN,I.findIndex=P1,I.findKey=Yk,I.findLast=kN,I.findLastIndex=T1,I.findLastKey=Zk,I.floor=wB,I.forEach=N1,I.forEachRight=k1,I.forIn=Kk,I.forInRight=Jk,I.forOwn=Qk,I.forOwnRight=$k,I.get=rg,I.gt=yk,I.gte=xk,I.has=nz,I.hasIn=ig,I.head=O1,I.identity=Wr,I.includes=UN,I.indexOf=kI,I.inRange=bz,I.invoke=sz,I.isArguments=tl,I.isArray=Et,I.isArrayBuffer=bk,I.isArrayLike=jr,I.isArrayLikeObject=En,I.isBoolean=wk,I.isBuffer=ea,I.isDate=Sk,I.isElement=Mk,I.isEmpty=Ck,I.isEqual=Ek,I.isEqualWith=Ak,I.isError=tg,I.isFinite=Pk,I.isFunction=Ks,I.isInteger=W1,I.isLength=ep,I.isMap=G1,I.isMatch=Tk,I.isMatchWith=Rk,I.isNaN=Ok,I.isNative=Lk,I.isNil=Ik,I.isNull=Dk,I.isNumber=X1,I.isObject=bn,I.isObjectLike=Cn,I.isPlainObject=Du,I.isRegExp=ng,I.isSafeInteger=Nk,I.isSet=q1,I.isString=tp,I.isSymbol=ii,I.isTypedArray=rc,I.isUndefined=kk,I.isWeakMap=zk,I.isWeakSet=Bk,I.join=UI,I.kebabCase=Az,I.last=wi,I.lastIndexOf=jI,I.lowerCase=Pz,I.lowerFirst=Tz,I.lt=Vk,I.lte=Fk,I.max=SB,I.maxBy=MB,I.mean=CB,I.meanBy=EB,I.min=AB,I.minBy=PB,I.stubArray=ug,I.stubFalse=hg,I.stubObject=pB,I.stubString=fB,I.stubTrue=mB,I.multiply=TB,I.nth=HI,I.noConflict=sB,I.noop=cg,I.now=Jd,I.pad=Rz,I.padEnd=Oz,I.padStart=Lz,I.parseInt=Dz,I.random=wz,I.reduce=XN,I.reduceRight=qN,I.repeat=Iz,I.replace=Nz,I.result=dz,I.round=RB,I.runInContext=$,I.sample=ZN,I.size=QN,I.snakeCase=kz,I.some=$N,I.sortedIndex=KI,I.sortedIndexBy=JI,I.sortedIndexOf=QI,I.sortedLastIndex=$I,I.sortedLastIndexBy=eN,I.sortedLastIndexOf=tN,I.startCase=Bz,I.startsWith=Vz,I.subtract=OB,I.sum=LB,I.sumBy=DB,I.template=Fz,I.times=vB,I.toFinite=Js,I.toInteger=Tt,I.toLength=Z1,I.toLower=Uz,I.toNumber=Si,I.toSafeInteger=Uk,I.toString=Jt,I.toUpper=jz,I.trim=Hz,I.trimEnd=Wz,I.trimStart=Gz,I.truncate=Xz,I.unescape=qz,I.uniqueId=_B,I.upperCase=Yz,I.upperFirst=sg,I.each=N1,I.eachRight=k1,I.first=O1,lg(I,function(){var l={};return Fi(I,function(h,m){Yt.call(I.prototype,m)||(l[m]=h)}),l}(),{chain:!1}),I.VERSION=r,vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){I[l].placeholder=I}),vr(["drop","take"],function(l,h){Bt.prototype[l]=function(m){m=m===t?1:kn(Tt(m),0);var w=this.__filtered__&&!h?new Bt(this):this.clone();return w.__filtered__?w.__takeCount__=ar(m,w.__takeCount__):w.__views__.push({size:ar(m,Le),type:l+(w.__dir__<0?"Right":"")}),w},Bt.prototype[l+"Right"]=function(m){return this.reverse()[l](m).reverse()}}),vr(["filter","map","takeWhile"],function(l,h){var m=h+1,w=m==te||m==ge;Bt.prototype[l]=function(R){var V=this.clone();return V.__iteratees__.push({iteratee:ft(R,3),type:m}),V.__filtered__=V.__filtered__||w,V}}),vr(["head","last"],function(l,h){var m="take"+(h?"Right":"");Bt.prototype[l]=function(){return this[m](1).value()[0]}}),vr(["initial","tail"],function(l,h){var m="drop"+(h?"":"Right");Bt.prototype[l]=function(){return this.__filtered__?new Bt(this):this[m](1)}}),Bt.prototype.compact=function(){return this.filter(Wr)},Bt.prototype.find=function(l){return this.filter(l).head()},Bt.prototype.findLast=function(l){return this.reverse().find(l)},Bt.prototype.invokeMap=Rt(function(l,h){return typeof l=="function"?new Bt(this):this.map(function(m){return Ql(m,l,h)})}),Bt.prototype.reject=function(l){return this.filter($d(ft(l)))},Bt.prototype.slice=function(l,h){l=Tt(l);var m=this;return m.__filtered__&&(l>0||h<0)?new Bt(m):(l<0?m=m.takeRight(-l):l&&(m=m.drop(l)),h!==t&&(h=Tt(h),m=h<0?m.dropRight(-h):m.take(h-l)),m)},Bt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Bt.prototype.toArray=function(){return this.take(Le)},Fi(Bt.prototype,function(l,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),w=/^(?:head|last)$/.test(h),R=I[w?"take"+(h=="last"?"Right":""):h],V=w||/^find/.test(h);!R||(I.prototype[h]=function(){var G=this.__wrapped__,J=w?[1]:arguments,ie=G instanceof Bt,Ie=J[0],Ne=ie||Et(G),Be=function(Vt){var Ht=R.apply(I,ni([Vt],J));return w&&et?Ht[0]:Ht};Ne&&m&&typeof Ie=="function"&&Ie.length!=1&&(ie=Ne=!1);var et=this.__chain__,ct=!!this.__actions__.length,mt=V&&!et,Ot=ie&&!ct;if(!V&&Ne){G=Ot?G:new Bt(this);var vt=l.apply(G,J);return vt.__actions__.push({func:Zd,args:[Be],thisArg:t}),new ri(vt,et)}return mt&&Ot?l.apply(this,J):(vt=this.thru(Be),mt?w?vt.value()[0]:vt.value():vt)})}),vr(["pop","push","shift","sort","splice","unshift"],function(l){var h=kc[l],m=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",w=/^(?:pop|shift)$/.test(l);I.prototype[l]=function(){var R=arguments;if(w&&!this.__chain__){var V=this.value();return h.apply(Et(V)?V:[],R)}return this[m](function(G){return h.apply(Et(G)?G:[],R)})}}),Fi(Bt.prototype,function(l,h){var m=I[h];if(m){var w=m.name+"";Yt.call(Xo,w)||(Xo[w]=[]),Xo[w].push({name:h,func:m})}}),Xo[jd(t,S).name]=[{name:"wrapper",func:t}],Bt.prototype.clone=fw,Bt.prototype.reverse=mw,Bt.prototype.value=vw,I.prototype.at=MN,I.prototype.chain=CN,I.prototype.commit=EN,I.prototype.next=AN,I.prototype.plant=TN,I.prototype.reverse=RN,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=ON,I.prototype.first=I.prototype.head,Ya&&(I.prototype[Ya]=PN),I},xo=rw();qn?((qn.exports=xo)._=xo,pn._=xo):ln._=xo}).call(Ct)})(zZ,zZ.exports);const ev=(n,e,t)=>{if(!n.has(e)){const r=t();return n.set(e,r),r}return n.get(e)},mIe=n=>{throw new Error("unexpected value: "+n)},QU=(n,e,t=new WeakSet)=>{if(Array.isArray(n)){if(t.has(n))return;t.add(n);for(let r=0;r<n.length;++r){const i=n[r];e(r,i,n),QU(i,e,t)}}else if(n&&typeof n=="object"){if(t.has(n))return;t.add(n);for(const[r,i]of Object.entries(n))e(r,i,n),QU(i,e,t)}},NH=(n,e)=>{const t=n.indexOf(e);return t===-1?!1:(n.splice(t,1),!0)},$2=(n,e=-1)=>n[n.length+e],vIe=n=>{const e=n.split(".");if(e.length===1)return e;const t=e.pop();return[e.join("."),t]},Sae=(n,e,t)=>{let r,i=!1,s,o,a=t==="trailingPromise"?new Promise(c=>o=c):void 0;return(...c)=>{if(s=c,i)return a!=null?a:r;i=!0,(t==="leading"||t==="both")&&(r=n(...s));const u=()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(r=n(...s),o==null||o(r),a=t==="trailingPromise"?new Promise(d=>o=d):void 0),i=!1};return e>0?setTimeout(u,e):queueMicrotask(u),a!=null?a:r}},Mae=n=>{let e=!0;return queueMicrotask(()=>e&&n()),()=>{e=!1}},Cae=(n,e)=>{if(e===0)return Mae(n);const t=setTimeout(n,e);return()=>clearTimeout(t)},tv=(n,e,t)=>{let r,i,s,o,a=t==="trailingPromise"?new Promise(c=>o=c):void 0;return(...c)=>(s=c,r?r():(t==="leading"||t==="both")&&(i=n(...s)),r=Cae(()=>{(t==="trailing"||t==="both"||t==="trailingPromise")&&(i=n(...s),o==null||o(i),a=t==="trailingPromise"?new Promise(u=>o=u):void 0),r=void 0},e),a!=null?a:i)},gIe=(n,e=0)=>{let t,r;return(...i)=>{r=i,t==null||t(),t=Cae(()=>{n(...r),t=void 0},e)}},Eae=n=>{const e=new WeakMap,t=new WeakMap;return(r,...i)=>{var s;t.set(r,i),(s=e.get(r))===null||s===void 0||s(),e.set(r,Mae(()=>{n(...t.get(r)),e.delete(r)}))}},VD=(n,e)=>{let t,r=!1,i=e==null?void 0:e();return(...s)=>{if(e){const o=e();i!==o&&(r=!1),i=o}return r?t:(r=!0,t=n(...s))}},eE=(n,e)=>{for(const t of e)for(const r of Object.getOwnPropertyNames(t.prototype))!(r in n.prototype)&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))};class kH{constructor(e=void 0){this._cb=e,this.done=void 0,this._value=void 0,this._callbacks=void 0,this._watched=void 0}then(e){var t;return this.done?(e(this._value),Pae):(((t=this._callbacks)!==null&&t!==void 0?t:this._callbacks=new Set).add(e),new di(()=>this._callbacks.delete(e)))}watch(e){var t;return this.done?e._resolve(this._value):(((t=this._watched)!==null&&t!==void 0?t:this._watched=new Set).add(e),e.then(()=>this._watched.delete(e)),e)}_resolve(e){var t;if(this.done)return this;if(this.done=!0,this._value=e,(t=this._cb)===null||t===void 0||t.call(this,e),this._callbacks)for(const r of this._callbacks)r(e);if(this._watched)for(const r of this._watched)r._resolve(e);return this}}class _Ie extends kH{constructor(e){super(e)}resolve(e){return this._resolve(e)}}class di extends kH{constructor(e){super(e)}cancel(){return this._resolve()}}class Aae extends kH{constructor(e){super(e)}_resolve(){return this.dispose(),this}dispose(){return super._resolve()}}const Pae=new di().cancel();class e$e{constructor(){this.queue=[],this.count=0}then(e){return this.count++===0?(e(),Pae):(this.queue.push(e),new di(()=>NH(this.queue,e)))}resolve(){var e;return this.count--,(e=this.queue.shift())===null||e===void 0||e(),this}}class Tae{constructor(){this.cbsMap=new Map}on(e,t){var r;if(Array.isArray(e)){const s=new di;for(const o of e)s.watch(this.on(o,t));return s}!((r=this.states)===null||r===void 0)&&r.has(e)&&t(this.states.get(e));const i=ev(this.cbsMap,e,()=>new Set);return i.add(t),new di(()=>i.delete(t))}once(e,t){const r=new di;return r.watch(this.on(e,i=>{r.cancel(),t(i)})),r}emit(e,t){if(this.cbsMap.has(e))for(const r of this.cbsMap.get(e))r(t)}hasState(e){var t;return!!(!((t=this.states)===null||t===void 0)&&t.has(e))}setState(e,t){var r;(r=this.states)!==null&&r!==void 0||(this.states=new Map),!(this.states.has(e)&&this.states.get(e)===t)&&(this.states.set(e,t),this.emit(e,t))}getState(e){var t;return(t=this.states)===null||t===void 0?void 0:t.get(e)}deleteState(e){var t;(t=this.states)===null||t===void 0||t.delete(e)}clear(){var e;this.cbsMap.clear(),(e=this.states)===null||e===void 0||e.clear()}}class yIe{constructor(){this.cbs=new Set}on(e){return"state"in this&&e(this.state),this.cbs.add(e),new di(()=>this.cbs.delete(e))}once(e){const t=new di;return t.watch(this.on(r=>{t.cancel(),e(r)})),t}emit(e){for(const t of this.cbs)t(e)}setState(e){"state"in this&&this.state===e||(this.state=e,this.emit(e))}getState(){return this.state}}const fa=()=>{const n=new yIe;return[s=>n.emit(s),(s,o)=>o?n.once(s):n.on(s),s=>n.setState(s),()=>n.getState()]},xIe=new WeakSet,Pt=n=>{const[,e,t,r]=fa();t(n);const i=s=>{if(s){const o=new di;return o.watch(e(a=>s(a,o))),o}return r()};return xIe.add(i),[t,i]},Mb=(n,e)=>t=>{const r=e();r&&n([...r,t])},Cb=(n,e)=>t=>{const r=e();r&&n(r.filter(i=>i!==t))},Rae=(n,e)=>()=>{const t=e();!t||(Array.isArray(t)?n([...t]):n({...t}))},bIe=(n,e)=>{const t=e();return t&&typeof t=="object"&&(QU(t,(r,i)=>Object.freeze(i)),Object.freeze(t)),()=>n(t)},vO=[],zH=()=>vO[vO.length-1],Oae=n=>{var e,t,r;const i=zH();return(e=(t=i.data)[r=i.position++])!==null&&e!==void 0?e:t[r]=n(i)},wIe=n=>{var e,t,r;const i=zH();return(e=(t=i.data)[r=i.position++])!==null&&e!==void 0?e:t[r]=n},Lae=(n,e,t,r,i,s)=>{vO.push({position:0,data:t,handle:n});const o=r.map(u=>typeof u=="function"?u():u),a=!i||o.some((u,d)=>u!==i[d]);a&&(e==null||e());const c=a?s():void 0;return vO.pop(),[c,o,a]},hC=(n,e)=>{const t=Oae(p=>p.handle.watch(new di(()=>{var f;return(f=i.current)===null||f===void 0?void 0:f.call(i)})));if(t.done)return t;const r=wIe({}),i=$U(),s=$U(),o=i.current,a=s.current;o&&typeof o!="function"&&(console.error("cleanup is not a function",o),console.log("context: ",zH()));const[c,u,d]=Lae(t,o,r,e,a,n);return d&&(i.current=typeof c=="function"?c:void 0),s.current=u,t},yn=(n,e)=>{const t=new di(()=>setTimeout(()=>i==null?void 0:i())),r={};let i,s;const o=gIe(()=>{if(t.done)return;const[a,c,u]=Lae(t,i,r,e,s,n);u&&(i=typeof a=="function"?a:void 0),s=c});o();for(const a of e)typeof a=="function"&&t.watch(a(o));return t},$U=n=>Oae(()=>({current:typeof n=="function"?n():n}));class tu{constructor(e){[this.set,this.get]=Pt(e)}}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const BH="144",SIe=0,BZ=1,MIe=2,Dae=1,Iae=2,oM=3,Ex=0,Sc=1,Uh=2,zs=0,jy=1,gO=2,VZ=3,FZ=4,e8=5,dm=100,CIe=101,EIe=102,UZ=103,jZ=104,t8=200,AIe=201,PIe=202,TIe=203,Nae=204,kae=205,zae=206,RIe=207,Bae=208,OIe=209,LIe=210,DIe=0,IIe=1,NIe=2,n8=3,kIe=4,zIe=5,BIe=6,VIe=7,Vae=0,FIe=1,UIe=2,Jh=0,Fae=1,jIe=2,HIe=3,WIe=4,GIe=5,Uae=300,Ax=301,Px=302,dC=303,r8=304,FD=306,Tx=1e3,vc=1001,i8=1002,ds=1003,HZ=1004,WZ=1005,Us=1006,XIe=1007,tE=1008,w0=1009,qIe=1010,YIe=1011,VH=1012,ZIe=1013,$g=1014,jh=1015,Ip=1016,KIe=1017,JIe=1018,Hy=1020,QIe=1021,$Ie=1022,Hh=1023,eNe=1024,tNe=1025,c0=1026,Rx=1027,nNe=1028,rNe=1029,iNe=1030,sNe=1031,oNe=1033,TV=33776,RV=33777,OV=33778,LV=33779,GZ=35840,XZ=35841,qZ=35842,YZ=35843,aNe=36196,ZZ=37492,KZ=37496,JZ=37808,QZ=37809,$Z=37810,eK=37811,tK=37812,nK=37813,rK=37814,iK=37815,sK=37816,oK=37817,aK=37818,lK=37819,cK=37820,uK=37821,hK=36492,s8=2200,o8=2201,lNe=2202,_O=2300,yO=2301,DV=2302,Sy=2400,My=2401,xO=2402,FH=2500,cNe=2501,Nm=3e3,os=3001,uNe=3200,UD=3201,nE=0,jae=1,Cp="srgb",e0="srgb-linear",IV=7680,hNe=519,a8=35044,dK="300 es",l8=1035;class V0{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const Sa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let pK=1234567;const IM=Math.PI/180,bO=180/Math.PI;function oh(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Sa[n&255]+Sa[n>>8&255]+Sa[n>>16&255]+Sa[n>>24&255]+"-"+Sa[e&255]+Sa[e>>8&255]+"-"+Sa[e>>16&15|64]+Sa[e>>24&255]+"-"+Sa[t&63|128]+Sa[t>>8&255]+"-"+Sa[t>>16&255]+Sa[t>>24&255]+Sa[r&255]+Sa[r>>8&255]+Sa[r>>16&255]+Sa[r>>24&255]).toLowerCase()}function Eo(n,e,t){return Math.max(e,Math.min(t,n))}function UH(n,e){return(n%e+e)%e}function dNe(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function pNe(n,e,t){return n!==e?(t-n)/(e-n):0}function NM(n,e,t){return(1-t)*n+t*e}function fNe(n,e,t,r){return NM(n,e,1-Math.exp(-t*r))}function mNe(n,e=1){return e-Math.abs(UH(n,e*2)-e)}function vNe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function gNe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function _Ne(n,e){return n+Math.floor(Math.random()*(e-n+1))}function yNe(n,e){return n+Math.random()*(e-n)}function xNe(n){return n*(.5-Math.random())}function bNe(n){n!==void 0&&(pK=n);let e=pK+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function wNe(n){return n*IM}function SNe(n){return n*bO}function c8(n){return(n&n-1)===0&&n!==0}function MNe(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function wO(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function CNe(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),u=s((e+r)/2),d=o((e+r)/2),p=s((e-r)/2),f=o((e-r)/2),v=s((r-e)/2),x=o((r-e)/2);switch(i){case"XYX":n.set(a*d,c*p,c*f,a*u);break;case"YZY":n.set(c*f,a*d,c*p,a*u);break;case"ZXZ":n.set(c*p,c*f,a*d,a*u);break;case"XZX":n.set(a*d,c*x,c*v,a*u);break;case"YXY":n.set(c*v,a*d,c*x,a*u);break;case"ZYZ":n.set(c*x,c*v,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Np(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ci(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var NV=Object.freeze({__proto__:null,DEG2RAD:IM,RAD2DEG:bO,generateUUID:oh,clamp:Eo,euclideanModulo:UH,mapLinear:dNe,inverseLerp:pNe,lerp:NM,damp:fNe,pingpong:mNe,smoothstep:vNe,smootherstep:gNe,randInt:_Ne,randFloat:yNe,randFloatSpread:xNe,seededRandom:bNe,degToRad:wNe,radToDeg:SNe,isPowerOfTwo:c8,ceilPowerOfTwo:MNe,floorPowerOfTwo:wO,setQuaternionFromProperEuler:CNe,normalize:ci,denormalize:Np});class ut{constructor(e=0,t=0){ut.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ua{constructor(){ua.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,s,o,a,c,u){const d=this.elements;return d[0]=e,d[1]=i,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=r,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],c=r[6],u=r[1],d=r[4],p=r[7],f=r[2],v=r[5],x=r[8],y=i[0],_=i[3],S=i[6],C=i[1],A=i[4],P=i[7],D=i[2],N=i[5],j=i[8];return s[0]=o*y+a*C+c*D,s[3]=o*_+a*A+c*N,s[6]=o*S+a*P+c*j,s[1]=u*y+d*C+p*D,s[4]=u*_+d*A+p*N,s[7]=u*S+d*P+p*j,s[2]=f*y+v*C+x*D,s[5]=f*_+v*A+x*N,s[8]=f*S+v*P+x*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-r*s*d+r*a*c+i*s*u-i*o*c}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=d*o-a*u,f=a*c-d*s,v=u*s-o*c,x=t*p+r*f+i*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return e[0]=p*y,e[1]=(i*u-d*r)*y,e[2]=(a*r-i*o)*y,e[3]=f*y,e[4]=(d*t-i*c)*y,e[5]=(i*s-a*t)*y,e[6]=v*y,e[7]=(r*c-u*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const c=Math.cos(s),u=Math.sin(s);return this.set(r*c,r*u,-r*(c*o+u*a)+o+e,-i*u,i*c,-i*(-u*o+c*a)+a+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],u=i[4],d=i[7];return i[0]=t*s+r*c,i[3]=t*o+r*u,i[6]=t*a+r*d,i[1]=-r*s+t*c,i[4]=-r*o+t*u,i[7]=-r*a+t*d,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}function Hae(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function pC(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function u0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function eR(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const kV={[Cp]:{[e0]:u0},[e0]:{[Cp]:eR}},Uu={legacyMode:!0,get workingColorSpace(){return e0},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(kV[e]&&kV[e][t]!==void 0){const r=kV[e][t];return n.r=r(n.r),n.g=r(n.g),n.b=r(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},Wae={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},to={r:0,g:0,b:0},ju={h:0,s:0,l:0},XP={h:0,s:0,l:0};function zV(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function qP(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class en{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Cp){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Uu.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=e0){return this.r=e,this.g=t,this.b=r,Uu.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=e0){if(e=UH(e,1),t=Eo(t,0,1),r=Eo(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=zV(o,s,e+1/3),this.g=zV(o,s,e),this.b=zV(o,s,e-1/3)}return Uu.toWorkingColorSpace(this,i),this}setStyle(e,t=Cp){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Uu.toWorkingColorSpace(this,t),r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Uu.toWorkingColorSpace(this,t),r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const c=parseFloat(s[1])/360,u=parseFloat(s[2])/100,d=parseFloat(s[3])/100;return r(s[4]),this.setHSL(c,u,d,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Uu.toWorkingColorSpace(this,t),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Uu.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Cp){const r=Wae[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=u0(e.r),this.g=u0(e.g),this.b=u0(e.b),this}copyLinearToSRGB(e){return this.r=eR(e.r),this.g=eR(e.g),this.b=eR(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Cp){return Uu.fromWorkingColorSpace(qP(this,to),e),Eo(to.r*255,0,255)<<16^Eo(to.g*255,0,255)<<8^Eo(to.b*255,0,255)<<0}getHexString(e=Cp){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=e0){Uu.fromWorkingColorSpace(qP(this,to),t);const r=to.r,i=to.g,s=to.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let c,u;const d=(a+o)/2;if(a===o)c=0,u=0;else{const p=o-a;switch(u=d<=.5?p/(o+a):p/(2-o-a),o){case r:c=(i-s)/p+(i<s?6:0);break;case i:c=(s-r)/p+2;break;case s:c=(r-i)/p+4;break}c/=6}return e.h=c,e.s=u,e.l=d,e}getRGB(e,t=e0){return Uu.fromWorkingColorSpace(qP(this,to),t),e.r=to.r,e.g=to.g,e.b=to.b,e}getStyle(e=Cp){return Uu.fromWorkingColorSpace(qP(this,to),e),e!==Cp?`color(${e} ${to.r} ${to.g} ${to.b})`:`rgb(${to.r*255|0},${to.g*255|0},${to.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(ju),ju.h+=e,ju.s+=t,ju.l+=r,this.setHSL(ju.h,ju.s,ju.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ju),e.getHSL(XP);const r=NM(ju.h,XP.h,t),i=NM(ju.s,XP.s,t),s=NM(ju.l,XP.l,t);return this.setHSL(r,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}en.NAMES=Wae;let V_;class Gae{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{V_===void 0&&(V_=pC("canvas")),V_.width=e.width,V_.height=e.height;const r=V_.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=V_}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=pC("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=u0(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(u0(t[r]/255)*255):t[r]=u0(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Xae{constructor(e=null){this.isSource=!0,this.uuid=oh(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(BV(i[o].image)):s.push(BV(i[o]))}else s=BV(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function BV(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Gae.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ENe=0;class ka extends V0{constructor(e=ka.DEFAULT_IMAGE,t=ka.DEFAULT_MAPPING,r=vc,i=vc,s=Us,o=tE,a=Hh,c=w0,u=1,d=Nm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ENe++}),this.uuid=oh(),this.name="",this.source=new Xae(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=c,this.offset=new ut(0,0),this.repeat=new ut(1,1),this.center=new ut(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ua,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Uae)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Tx:e.x=e.x-Math.floor(e.x);break;case vc:e.x=e.x<0?0:1;break;case i8:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Tx:e.y=e.y-Math.floor(e.y);break;case vc:e.y=e.y<0?0:1;break;case i8:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}ka.DEFAULT_IMAGE=null;ka.DEFAULT_MAPPING=Uae;class No{constructor(e=0,t=0,r=0,i=1){No.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const c=e.elements,u=c[0],d=c[4],p=c[8],f=c[1],v=c[5],x=c[9],y=c[2],_=c[6],S=c[10];if(Math.abs(d-f)<.01&&Math.abs(p-y)<.01&&Math.abs(x-_)<.01){if(Math.abs(d+f)<.1&&Math.abs(p+y)<.1&&Math.abs(x+_)<.1&&Math.abs(u+v+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const A=(u+1)/2,P=(v+1)/2,D=(S+1)/2,N=(d+f)/4,j=(p+y)/4,T=(x+_)/4;return A>P&&A>D?A<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(A),i=N/r,s=j/r):P>D?P<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(P),r=N/i,s=T/i):D<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(D),r=j/s,i=T/s),this.set(r,i,s,t),this}let C=Math.sqrt((_-x)*(_-x)+(p-y)*(p-y)+(f-d)*(f-d));return Math.abs(C)<.001&&(C=1),this.x=(_-x)/C,this.y=(p-y)/C,this.z=(f-d)/C,this.w=Math.acos((u+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ai extends V0{constructor(e,t,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new No(0,0,e,t),this.scissorTest=!1,this.viewport=new No(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new ka(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Us,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Xae(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class qae extends ka{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=ds,this.minFilter=ds,this.wrapR=vc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ANe extends ka{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=ds,this.minFilter=ds,this.wrapR=vc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Mc{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let c=r[i+0],u=r[i+1],d=r[i+2],p=r[i+3];const f=s[o+0],v=s[o+1],x=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p;return}if(a===1){e[t+0]=f,e[t+1]=v,e[t+2]=x,e[t+3]=y;return}if(p!==y||c!==f||u!==v||d!==x){let _=1-a;const S=c*f+u*v+d*x+p*y,C=S>=0?1:-1,A=1-S*S;if(A>Number.EPSILON){const D=Math.sqrt(A),N=Math.atan2(D,S*C);_=Math.sin(_*N)/D,a=Math.sin(a*N)/D}const P=a*C;if(c=c*_+f*P,u=u*_+v*P,d=d*_+x*P,p=p*_+y*P,_===1-a){const D=1/Math.sqrt(c*c+u*u+d*d+p*p);c*=D,u*=D,d*=D,p*=D}}e[t]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],c=r[i+1],u=r[i+2],d=r[i+3],p=s[o],f=s[o+1],v=s[o+2],x=s[o+3];return e[t]=a*x+d*p+c*v-u*f,e[t+1]=c*x+d*f+u*p-a*v,e[t+2]=u*x+d*v+a*f-c*p,e[t+3]=d*x-a*p-c*f-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,u=a(r/2),d=a(i/2),p=a(s/2),f=c(r/2),v=c(i/2),x=c(s/2);switch(o){case"XYZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"YXZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"ZXY":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"ZYX":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"YZX":this._x=f*d*p+u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p-f*v*x;break;case"XZY":this._x=f*d*p-u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p+f*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],c=t[9],u=t[2],d=t[6],p=t[10],f=r+a+p;if(f>0){const v=.5/Math.sqrt(f+1);this._w=.25/v,this._x=(d-c)*v,this._y=(s-u)*v,this._z=(o-i)*v}else if(r>a&&r>p){const v=2*Math.sqrt(1+r-a-p);this._w=(d-c)/v,this._x=.25*v,this._y=(i+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-r-p);this._w=(s-u)/v,this._x=(i+o)/v,this._y=.25*v,this._z=(c+d)/v}else{const v=2*Math.sqrt(1+p-r-a);this._w=(o-i)/v,this._x=(s+u)/v,this._y=(c+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Eo(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,c=t._y,u=t._z,d=t._w;return this._x=r*d+o*a+i*u-s*c,this._y=i*d+o*c+s*a-r*u,this._z=s*d+o*u+r*c-i*a,this._w=o*d-r*a-i*c-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*r+t*this._x,this._y=v*i+t*this._y,this._z=v*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(c),d=Math.atan2(u,a),p=Math.sin((1-t)*d)/u,f=Math.sin(t*d)/u;return this._w=o*p+this._w*f,this._x=r*p+this._x*f,this._y=i*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Te{constructor(e=0,t=0,r=0){Te.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(fK.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(fK.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,c=e.w,u=c*t+o*i-a*r,d=c*r+a*t-s*i,p=c*i+s*r-o*t,f=-s*t-o*r-a*i;return this.x=u*c+f*-s+d*-a-p*-o,this.y=d*c+f*-o+p*-s-u*-a,this.z=p*c+f*-a+u*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=i*c-s*a,this.y=s*o-r*c,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return VV.copy(this).projectOnVector(e),this.sub(VV)}reflect(e){return this.sub(VV.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Eo(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const VV=new Te,fK=new Mc;class nv{constructor(e=new Te(1/0,1/0,1/0),t=new Te(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,u=e.length;c<u;c+=3){const d=e[c],p=e[c+1],f=e[c+2];d<t&&(t=d),p<r&&(r=p),f<i&&(i=f),d>s&&(s=d),p>o&&(o=p),f>a&&(a=f)}return this.min.set(t,r,i),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,u=e.count;c<u;c++){const d=e.getX(c),p=e.getY(c),f=e.getZ(c);d<t&&(t=d),p<r&&(r=p),f<i&&(i=f),d>s&&(s=d),p>o&&(o=p),f>a&&(a=f)}return this.min.set(t,r,i),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ag.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Ag.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Ag)}else r.boundingBox===null&&r.computeBoundingBox(),FV.copy(r.boundingBox),FV.applyMatrix4(e.matrixWorld),this.union(FV);const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ag),Ag.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(TS),YP.subVectors(this.max,TS),F_.subVectors(e.a,TS),U_.subVectors(e.b,TS),j_.subVectors(e.c,TS),Uf.subVectors(U_,F_),jf.subVectors(j_,U_),Pg.subVectors(F_,j_);let t=[0,-Uf.z,Uf.y,0,-jf.z,jf.y,0,-Pg.z,Pg.y,Uf.z,0,-Uf.x,jf.z,0,-jf.x,Pg.z,0,-Pg.x,-Uf.y,Uf.x,0,-jf.y,jf.x,0,-Pg.y,Pg.x,0];return!UV(t,F_,U_,j_,YP)||(t=[1,0,0,0,1,0,0,0,1],!UV(t,F_,U_,j_,YP))?!1:(ZP.crossVectors(Uf,jf),t=[ZP.x,ZP.y,ZP.z],UV(t,F_,U_,j_,YP))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ag.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Ag).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(pp[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),pp[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),pp[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),pp[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),pp[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),pp[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),pp[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),pp[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(pp),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const pp=[new Te,new Te,new Te,new Te,new Te,new Te,new Te,new Te],Ag=new Te,FV=new nv,F_=new Te,U_=new Te,j_=new Te,Uf=new Te,jf=new Te,Pg=new Te,TS=new Te,YP=new Te,ZP=new Te,Tg=new Te;function UV(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){Tg.fromArray(n,s);const a=i.x*Math.abs(Tg.x)+i.y*Math.abs(Tg.y)+i.z*Math.abs(Tg.z),c=e.dot(Tg),u=t.dot(Tg),d=r.dot(Tg);if(Math.max(-Math.max(c,u,d),Math.min(c,u,d))>a)return!1}return!0}const PNe=new nv,mK=new Te,KP=new Te,jV=new Te;class jD{constructor(e=new Te,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):PNe.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){jV.subVectors(e,this.center);const t=jV.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.add(jV.multiplyScalar(i/r)),this.radius+=i}return this}union(e){return this.center.equals(e.center)===!0?KP.set(0,0,1).multiplyScalar(e.radius):KP.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(mK.copy(e.center).add(KP)),this.expandByPoint(mK.copy(e.center).sub(KP)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const fp=new Te,HV=new Te,JP=new Te,Hf=new Te,WV=new Te,QP=new Te,GV=new Te;class rE{constructor(e=new Te,t=new Te(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fp)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fp.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fp.copy(this.direction).multiplyScalar(t).add(this.origin),fp.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){HV.copy(e).add(t).multiplyScalar(.5),JP.copy(t).sub(e).normalize(),Hf.copy(this.origin).sub(HV);const s=e.distanceTo(t)*.5,o=-this.direction.dot(JP),a=Hf.dot(this.direction),c=-Hf.dot(JP),u=Hf.lengthSq(),d=Math.abs(1-o*o);let p,f,v,x;if(d>0)if(p=o*c-a,f=o*a-c,x=s*d,p>=0)if(f>=-x)if(f<=x){const y=1/d;p*=y,f*=y,v=p*(p+o*f+2*a)+f*(o*p+f+2*c)+u}else f=s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;else f=-s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;else f<=-x?(p=Math.max(0,-(-o*s+a)),f=p>0?-s:Math.min(Math.max(-s,-c),s),v=-p*p+f*(f+2*c)+u):f<=x?(p=0,f=Math.min(Math.max(-s,-c),s),v=f*(f+2*c)+u):(p=Math.max(0,-(o*s+a)),f=p>0?s:Math.min(Math.max(-s,-c),s),v=-p*p+f*(f+2*c)+u);else f=o>0?-s:s,p=Math.max(0,-(o*f+a)),v=-p*p+f*(f+2*c)+u;return r&&r.copy(this.direction).multiplyScalar(p).add(this.origin),i&&i.copy(JP).multiplyScalar(f).add(HV),v}intersectSphere(e,t){fp.subVectors(e.center,this.origin);const r=fp.dot(this.direction),i=fp.dot(fp)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,c=r+o;return a<0&&c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,c;const u=1/this.direction.x,d=1/this.direction.y,p=1/this.direction.z,f=this.origin;return u>=0?(r=(e.min.x-f.x)*u,i=(e.max.x-f.x)*u):(r=(e.max.x-f.x)*u,i=(e.min.x-f.x)*u),d>=0?(s=(e.min.y-f.y)*d,o=(e.max.y-f.y)*d):(s=(e.max.y-f.y)*d,o=(e.min.y-f.y)*d),r>o||s>i||((s>r||r!==r)&&(r=s),(o<i||i!==i)&&(i=o),p>=0?(a=(e.min.z-f.z)*p,c=(e.max.z-f.z)*p):(a=(e.max.z-f.z)*p,c=(e.min.z-f.z)*p),r>c||a>i)||((a>r||r!==r)&&(r=a),(c<i||i!==i)&&(i=c),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,fp)!==null}intersectTriangle(e,t,r,i,s){WV.subVectors(t,e),QP.subVectors(r,e),GV.crossVectors(WV,QP);let o=this.direction.dot(GV),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Hf.subVectors(this.origin,e);const c=a*this.direction.dot(QP.crossVectors(Hf,QP));if(c<0)return null;const u=a*this.direction.dot(WV.cross(Hf));if(u<0||c+u>o)return null;const d=-a*Hf.dot(GV);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Vr{constructor(){Vr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,s,o,a,c,u,d,p,f,v,x,y,_){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=i,S[1]=s,S[5]=o,S[9]=a,S[13]=c,S[2]=u,S[6]=d,S[10]=p,S[14]=f,S[3]=v,S[7]=x,S[11]=y,S[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Vr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/H_.setFromMatrixColumn(e,0).length(),s=1/H_.setFromMatrixColumn(e,1).length(),o=1/H_.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),c=Math.cos(i),u=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=-c*p,t[8]=u,t[1]=v+x*u,t[5]=f-y*u,t[9]=-a*c,t[2]=y-f*u,t[6]=x+v*u,t[10]=o*c}else if(e.order==="YXZ"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f+y*a,t[4]=x*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*d,t[9]=-a,t[2]=v*a-x,t[6]=y+f*a,t[10]=o*c}else if(e.order==="ZXY"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f-y*a,t[4]=-o*p,t[8]=x+v*a,t[1]=v+x*a,t[5]=o*d,t[9]=y-f*a,t[2]=-o*u,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=x*u-v,t[8]=f*u+y,t[1]=c*p,t[5]=y*u+f,t[9]=v*u-x,t[2]=-u,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=y-f*p,t[8]=x*p+v,t[1]=p,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=v*p+x,t[10]=f-y*p}else if(e.order==="XZY"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=-p,t[8]=u*d,t[1]=f*p+y,t[5]=o*d,t[9]=v*p-x,t[2]=x*p-v,t[6]=a*d,t[10]=y*p+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(TNe,e,RNe)}lookAt(e,t,r){const i=this.elements;return uc.subVectors(e,t),uc.lengthSq()===0&&(uc.z=1),uc.normalize(),Wf.crossVectors(r,uc),Wf.lengthSq()===0&&(Math.abs(r.z)===1?uc.x+=1e-4:uc.z+=1e-4,uc.normalize(),Wf.crossVectors(r,uc)),Wf.normalize(),$P.crossVectors(uc,Wf),i[0]=Wf.x,i[4]=$P.x,i[8]=uc.x,i[1]=Wf.y,i[5]=$P.y,i[9]=uc.y,i[2]=Wf.z,i[6]=$P.z,i[10]=uc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],c=r[8],u=r[12],d=r[1],p=r[5],f=r[9],v=r[13],x=r[2],y=r[6],_=r[10],S=r[14],C=r[3],A=r[7],P=r[11],D=r[15],N=i[0],j=i[4],T=i[8],k=i[12],U=i[1],ee=i[5],xe=i[9],ce=i[13],te=i[2],fe=i[6],ge=i[10],Se=i[14],pe=i[3],se=i[7],ae=i[11],Le=i[15];return s[0]=o*N+a*U+c*te+u*pe,s[4]=o*j+a*ee+c*fe+u*se,s[8]=o*T+a*xe+c*ge+u*ae,s[12]=o*k+a*ce+c*Se+u*Le,s[1]=d*N+p*U+f*te+v*pe,s[5]=d*j+p*ee+f*fe+v*se,s[9]=d*T+p*xe+f*ge+v*ae,s[13]=d*k+p*ce+f*Se+v*Le,s[2]=x*N+y*U+_*te+S*pe,s[6]=x*j+y*ee+_*fe+S*se,s[10]=x*T+y*xe+_*ge+S*ae,s[14]=x*k+y*ce+_*Se+S*Le,s[3]=C*N+A*U+P*te+D*pe,s[7]=C*j+A*ee+P*fe+D*se,s[11]=C*T+A*xe+P*ge+D*ae,s[15]=C*k+A*ce+P*Se+D*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],c=e[9],u=e[13],d=e[2],p=e[6],f=e[10],v=e[14],x=e[3],y=e[7],_=e[11],S=e[15];return x*(+s*c*p-i*u*p-s*a*f+r*u*f+i*a*v-r*c*v)+y*(+t*c*v-t*u*f+s*o*f-i*o*v+i*u*d-s*c*d)+_*(+t*u*p-t*a*v-s*o*p+r*o*v+s*a*d-r*u*d)+S*(-i*a*d-t*c*p+t*a*f+i*o*p-r*o*f+r*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=e[9],f=e[10],v=e[11],x=e[12],y=e[13],_=e[14],S=e[15],C=p*_*u-y*f*u+y*c*v-a*_*v-p*c*S+a*f*S,A=x*f*u-d*_*u-x*c*v+o*_*v+d*c*S-o*f*S,P=d*y*u-x*p*u+x*a*v-o*y*v-d*a*S+o*p*S,D=x*p*c-d*y*c-x*a*f+o*y*f+d*a*_-o*p*_,N=t*C+r*A+i*P+s*D;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const j=1/N;return e[0]=C*j,e[1]=(y*f*s-p*_*s-y*i*v+r*_*v+p*i*S-r*f*S)*j,e[2]=(a*_*s-y*c*s+y*i*u-r*_*u-a*i*S+r*c*S)*j,e[3]=(p*c*s-a*f*s-p*i*u+r*f*u+a*i*v-r*c*v)*j,e[4]=A*j,e[5]=(d*_*s-x*f*s+x*i*v-t*_*v-d*i*S+t*f*S)*j,e[6]=(x*c*s-o*_*s-x*i*u+t*_*u+o*i*S-t*c*S)*j,e[7]=(o*f*s-d*c*s+d*i*u-t*f*u-o*i*v+t*c*v)*j,e[8]=P*j,e[9]=(x*p*s-d*y*s-x*r*v+t*y*v+d*r*S-t*p*S)*j,e[10]=(o*y*s-x*a*s+x*r*u-t*y*u-o*r*S+t*a*S)*j,e[11]=(d*a*s-o*p*s-d*r*u+t*p*u+o*r*v-t*a*v)*j,e[12]=D*j,e[13]=(d*y*i-x*p*i+x*r*f-t*y*f-d*r*_+t*p*_)*j,e[14]=(x*a*i-o*y*i-x*r*c+t*y*c+o*r*_-t*a*_)*j,e[15]=(o*p*i-d*a*i+d*r*c-t*p*c-o*r*f+t*a*f)*j,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,c=e.z,u=s*o,d=s*a;return this.set(u*o+r,u*a-i*c,u*c+i*a,0,u*a+i*c,d*a+r,d*c-i*o,0,u*c-i*a,d*c+i*o,s*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,u=s+s,d=o+o,p=a+a,f=s*u,v=s*d,x=s*p,y=o*d,_=o*p,S=a*p,C=c*u,A=c*d,P=c*p,D=r.x,N=r.y,j=r.z;return i[0]=(1-(y+S))*D,i[1]=(v+P)*D,i[2]=(x-A)*D,i[3]=0,i[4]=(v-P)*N,i[5]=(1-(f+S))*N,i[6]=(_+C)*N,i[7]=0,i[8]=(x+A)*j,i[9]=(_-C)*j,i[10]=(1-(f+y))*j,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=H_.set(i[0],i[1],i[2]).length();const o=H_.set(i[4],i[5],i[6]).length(),a=H_.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Hu.copy(this);const u=1/s,d=1/o,p=1/a;return Hu.elements[0]*=u,Hu.elements[1]*=u,Hu.elements[2]*=u,Hu.elements[4]*=d,Hu.elements[5]*=d,Hu.elements[6]*=d,Hu.elements[8]*=p,Hu.elements[9]*=p,Hu.elements[10]*=p,t.setFromRotationMatrix(Hu),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o){const a=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),p=(r+i)/(r-i),f=-(o+s)/(o-s),v=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=u,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=v,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,s,o){const a=this.elements,c=1/(t-e),u=1/(r-i),d=1/(o-s),p=(t+e)*c,f=(r+i)*u,v=(o+s)*d;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-v,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const H_=new Te,Hu=new Vr,TNe=new Te(0,0,0),RNe=new Te(1,1,1),Wf=new Te,$P=new Te,uc=new Te,vK=new Vr,gK=new Mc;class Eb{constructor(e=0,t=0,r=0,i=Eb.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],c=i[1],u=i[5],d=i[9],p=i[2],f=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(Eo(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Eo(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(Eo(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Eo(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(f,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Eo(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-Eo(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return vK.makeRotationFromQuaternion(e),this.setFromRotationMatrix(vK,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return gK.setFromEuler(this),this.setFromQuaternion(gK,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Eb.DefaultOrder="XYZ";Eb.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class jH{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ONe=0;const _K=new Te,W_=new Mc,mp=new Vr,eT=new Te,RS=new Te,LNe=new Te,DNe=new Mc,yK=new Te(1,0,0),xK=new Te(0,1,0),bK=new Te(0,0,1),INe={type:"added"},wK={type:"removed"};class Qi extends V0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ONe++}),this.uuid=oh(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qi.DefaultUp.clone();const e=new Te,t=new Eb,r=new Mc,i=new Te(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Vr},normalMatrix:{value:new ua}}),this.matrix=new Vr,this.matrixWorld=new Vr,this.matrixAutoUpdate=Qi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Qi.DefaultMatrixWorldAutoUpdate,this.layers=new jH,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return W_.setFromAxisAngle(e,t),this.quaternion.multiply(W_),this}rotateOnWorldAxis(e,t){return W_.setFromAxisAngle(e,t),this.quaternion.premultiply(W_),this}rotateX(e){return this.rotateOnAxis(yK,e)}rotateY(e){return this.rotateOnAxis(xK,e)}rotateZ(e){return this.rotateOnAxis(bK,e)}translateOnAxis(e,t){return _K.copy(e).applyQuaternion(this.quaternion),this.position.add(_K.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(yK,e)}translateY(e){return this.translateOnAxis(xK,e)}translateZ(e){return this.translateOnAxis(bK,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(mp.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?eT.copy(e):eT.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),RS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mp.lookAt(RS,eT,this.up):mp.lookAt(eT,RS,this.up),this.quaternion.setFromRotationMatrix(mp),i&&(mp.extractRotation(i.matrixWorld),W_.setFromRotationMatrix(mp),this.quaternion.premultiply(W_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(INe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wK)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(wK)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),mp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mp.multiply(e.parent.matrixWorld)),e.applyMatrix4(mp),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(RS,e,LNe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(RS,DNe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const p=c[u];s(e.shapes,p)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,u=this.material.length;c<u;c++)a.push(s(e.materials,this.material[c]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];i.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),u=o(e.textures),d=o(e.images),p=o(e.shapes),f=o(e.skeletons),v=o(e.animations),x=o(e.nodes);a.length>0&&(r.geometries=a),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),f.length>0&&(r.skeletons=f),v.length>0&&(r.animations=v),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(a){const c=[];for(const u in a){const d=a[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Qi.DefaultUp=new Te(0,1,0);Qi.DefaultMatrixAutoUpdate=!0;Qi.DefaultMatrixWorldAutoUpdate=!0;const Wu=new Te,vp=new Te,XV=new Te,gp=new Te,G_=new Te,X_=new Te,SK=new Te,qV=new Te,YV=new Te,ZV=new Te;class kh{constructor(e=new Te,t=new Te,r=new Te){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Wu.subVectors(e,t),i.cross(Wu);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Wu.subVectors(i,t),vp.subVectors(r,t),XV.subVectors(e,t);const o=Wu.dot(Wu),a=Wu.dot(vp),c=Wu.dot(XV),u=vp.dot(vp),d=vp.dot(XV),p=o*u-a*a;if(p===0)return s.set(-2,-1,-1);const f=1/p,v=(u*c-a*d)*f,x=(o*d-a*c)*f;return s.set(1-v-x,x,v)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,gp),gp.x>=0&&gp.y>=0&&gp.x+gp.y<=1}static getUV(e,t,r,i,s,o,a,c){return this.getBarycoord(e,t,r,i,gp),c.set(0,0),c.addScaledVector(s,gp.x),c.addScaledVector(o,gp.y),c.addScaledVector(a,gp.z),c}static isFrontFacing(e,t,r,i){return Wu.subVectors(r,t),vp.subVectors(e,t),Wu.cross(vp).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Wu.subVectors(this.c,this.b),vp.subVectors(this.a,this.b),Wu.cross(vp).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return kh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return kh.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return kh.getUV(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return kh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return kh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;G_.subVectors(i,r),X_.subVectors(s,r),qV.subVectors(e,r);const c=G_.dot(qV),u=X_.dot(qV);if(c<=0&&u<=0)return t.copy(r);YV.subVectors(e,i);const d=G_.dot(YV),p=X_.dot(YV);if(d>=0&&p<=d)return t.copy(i);const f=c*p-d*u;if(f<=0&&c>=0&&d<=0)return o=c/(c-d),t.copy(r).addScaledVector(G_,o);ZV.subVectors(e,s);const v=G_.dot(ZV),x=X_.dot(ZV);if(x>=0&&v<=x)return t.copy(s);const y=v*u-c*x;if(y<=0&&u>=0&&x<=0)return a=u/(u-x),t.copy(r).addScaledVector(X_,a);const _=d*x-v*p;if(_<=0&&p-d>=0&&v-x>=0)return SK.subVectors(s,i),a=(p-d)/(p-d+(v-x)),t.copy(i).addScaledVector(SK,a);const S=1/(_+y+f);return o=y*S,a=f*S,t.copy(r).addScaledVector(G_,o).addScaledVector(X_,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let NNe=0;class of extends V0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:NNe++}),this.uuid=oh(),this.name="",this.type="Material",this.blending=jy,this.side=Ex,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Nae,this.blendDst=kae,this.blendEquation=dm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=n8,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=hNe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=IV,this.stencilZFail=IV,this.stencilZPass=IV,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==jy&&(r.blending=this.blending),this.side!==Ex&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class iE extends of{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new en(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Vae,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ns=new Te,tT=new ut;class Cc{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=a8,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)tT.fromBufferAttribute(this,t),tT.applyMatrix3(e),this.setXY(t,tT.x,tT.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyMatrix3(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyMatrix4(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyNormalMatrix(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.transformDirection(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Np(t,this.array)),t}setX(e,t){return this.normalized&&(t=ci(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Np(t,this.array)),t}setY(e,t){return this.normalized&&(t=ci(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Np(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ci(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Np(t,this.array)),t}setW(e,t){return this.normalized&&(t=ci(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array),i=ci(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array),i=ci(i,this.array),s=ci(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==a8&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Yae extends Cc{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Zae extends Cc{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class sr extends Cc{constructor(e,t,r){super(new Float32Array(e),t,r)}}let kNe=0;const Qc=new Vr,KV=new Qi,q_=new Te,hc=new nv,OS=new nv,Mo=new Te;class As extends V0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:kNe++}),this.uuid=oh(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Hae(e)?Zae:Yae)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new ua().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Qc.makeRotationFromQuaternion(e),this.applyMatrix4(Qc),this}rotateX(e){return Qc.makeRotationX(e),this.applyMatrix4(Qc),this}rotateY(e){return Qc.makeRotationY(e),this.applyMatrix4(Qc),this}rotateZ(e){return Qc.makeRotationZ(e),this.applyMatrix4(Qc),this}translate(e,t,r){return Qc.makeTranslation(e,t,r),this.applyMatrix4(Qc),this}scale(e,t,r){return Qc.makeScale(e,t,r),this.applyMatrix4(Qc),this}lookAt(e){return KV.lookAt(e),KV.updateMatrix(),this.applyMatrix4(KV.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(q_).negate(),this.translate(q_.x,q_.y,q_.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new sr(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new nv);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Te(-1/0,-1/0,-1/0),new Te(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];hc.setFromBufferAttribute(s),this.morphTargetsRelative?(Mo.addVectors(this.boundingBox.min,hc.min),this.boundingBox.expandByPoint(Mo),Mo.addVectors(this.boundingBox.max,hc.max),this.boundingBox.expandByPoint(Mo)):(this.boundingBox.expandByPoint(hc.min),this.boundingBox.expandByPoint(hc.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jD);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Te,1/0);return}if(e){const r=this.boundingSphere.center;if(hc.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];OS.setFromBufferAttribute(a),this.morphTargetsRelative?(Mo.addVectors(hc.min,OS.min),hc.expandByPoint(Mo),Mo.addVectors(hc.max,OS.max),hc.expandByPoint(Mo)):(hc.expandByPoint(OS.min),hc.expandByPoint(OS.max))}hc.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)Mo.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(Mo));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)Mo.fromBufferAttribute(a,u),c&&(q_.fromBufferAttribute(e,u),Mo.add(q_)),i=Math.max(i,r.distanceToSquared(Mo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Cc(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,u=[],d=[];for(let U=0;U<a;U++)u[U]=new Te,d[U]=new Te;const p=new Te,f=new Te,v=new Te,x=new ut,y=new ut,_=new ut,S=new Te,C=new Te;function A(U,ee,xe){p.fromArray(i,U*3),f.fromArray(i,ee*3),v.fromArray(i,xe*3),x.fromArray(o,U*2),y.fromArray(o,ee*2),_.fromArray(o,xe*2),f.sub(p),v.sub(p),y.sub(x),_.sub(x);const ce=1/(y.x*_.y-_.x*y.y);!isFinite(ce)||(S.copy(f).multiplyScalar(_.y).addScaledVector(v,-y.y).multiplyScalar(ce),C.copy(v).multiplyScalar(y.x).addScaledVector(f,-_.x).multiplyScalar(ce),u[U].add(S),u[ee].add(S),u[xe].add(S),d[U].add(C),d[ee].add(C),d[xe].add(C))}let P=this.groups;P.length===0&&(P=[{start:0,count:r.length}]);for(let U=0,ee=P.length;U<ee;++U){const xe=P[U],ce=xe.start,te=xe.count;for(let fe=ce,ge=ce+te;fe<ge;fe+=3)A(r[fe+0],r[fe+1],r[fe+2])}const D=new Te,N=new Te,j=new Te,T=new Te;function k(U){j.fromArray(s,U*3),T.copy(j);const ee=u[U];D.copy(ee),D.sub(j.multiplyScalar(j.dot(ee))).normalize(),N.crossVectors(T,ee);const ce=N.dot(d[U])<0?-1:1;c[U*4]=D.x,c[U*4+1]=D.y,c[U*4+2]=D.z,c[U*4+3]=ce}for(let U=0,ee=P.length;U<ee;++U){const xe=P[U],ce=xe.start,te=xe.count;for(let fe=ce,ge=ce+te;fe<ge;fe+=3)k(r[fe+0]),k(r[fe+1]),k(r[fe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Cc(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let f=0,v=r.count;f<v;f++)r.setXYZ(f,0,0,0);const i=new Te,s=new Te,o=new Te,a=new Te,c=new Te,u=new Te,d=new Te,p=new Te;if(e)for(let f=0,v=e.count;f<v;f+=3){const x=e.getX(f+0),y=e.getX(f+1),_=e.getX(f+2);i.fromBufferAttribute(t,x),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,_),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),a.fromBufferAttribute(r,x),c.fromBufferAttribute(r,y),u.fromBufferAttribute(r,_),a.add(d),c.add(d),u.add(d),r.setXYZ(x,a.x,a.y,a.z),r.setXYZ(y,c.x,c.y,c.z),r.setXYZ(_,u.x,u.y,u.z)}else for(let f=0,v=t.count;f<v;f+=3)i.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),r.setXYZ(f+0,d.x,d.y,d.z),r.setXYZ(f+1,d.x,d.y,d.z),r.setXYZ(f+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Mo.fromBufferAttribute(e,t),Mo.normalize(),e.setXYZ(t,Mo.x,Mo.y,Mo.z)}toNonIndexed(){function e(a,c){const u=a.array,d=a.itemSize,p=a.normalized,f=new u.constructor(c.length*d);let v=0,x=0;for(let y=0,_=c.length;y<_;y++){a.isInterleavedBufferAttribute?v=c[y]*a.data.stride+a.offset:v=c[y]*d;for(let S=0;S<d;S++)f[x++]=u[v++]}return new Cc(f,d,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new As,r=this.index.array,i=this.attributes;for(const a in i){const c=i[a],u=e(c,r);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const c=[],u=s[a];for(let d=0,p=u.length;d<p;d++){const f=u[d],v=e(f,r);c.push(v)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const c in r){const u=r[c];e.data.attributes[c]=u.toJSON(e.data)}const i={};let s=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],d=[];for(let p=0,f=u.length;p<f;p++){const v=u[p];d.push(v.toJSON(e.data))}d.length>0&&(i[c]=d,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const u in i){const d=i[u];this.setAttribute(u,d.clone(t))}const s=e.morphAttributes;for(const u in s){const d=[],p=s[u];for(let f=0,v=p.length;f<v;f++)d.push(p[f].clone(t));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const MK=new Vr,Y_=new rE,JV=new jD,Gf=new Te,Xf=new Te,qf=new Te,QV=new Te,$V=new Te,eF=new Te,nT=new Te,rT=new Te,iT=new Te,sT=new ut,oT=new ut,aT=new ut,tF=new Te,lT=new Te;class ul extends Qi{constructor(e=new As,t=new iE){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),JV.copy(r.boundingSphere),JV.applyMatrix4(s),e.ray.intersectsSphere(JV)===!1)||(MK.copy(s).invert(),Y_.copy(e.ray).applyMatrix4(MK),r.boundingBox!==null&&Y_.intersectsBox(r.boundingBox)===!1))return;let o;const a=r.index,c=r.attributes.position,u=r.morphAttributes.position,d=r.morphTargetsRelative,p=r.attributes.uv,f=r.attributes.uv2,v=r.groups,x=r.drawRange;if(a!==null)if(Array.isArray(i))for(let y=0,_=v.length;y<_;y++){const S=v[y],C=i[S.materialIndex],A=Math.max(S.start,x.start),P=Math.min(a.count,Math.min(S.start+S.count,x.start+x.count));for(let D=A,N=P;D<N;D+=3){const j=a.getX(D),T=a.getX(D+1),k=a.getX(D+2);o=cT(this,C,e,Y_,c,u,d,p,f,j,T,k),o&&(o.faceIndex=Math.floor(D/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const y=Math.max(0,x.start),_=Math.min(a.count,x.start+x.count);for(let S=y,C=_;S<C;S+=3){const A=a.getX(S),P=a.getX(S+1),D=a.getX(S+2);o=cT(this,i,e,Y_,c,u,d,p,f,A,P,D),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}else if(c!==void 0)if(Array.isArray(i))for(let y=0,_=v.length;y<_;y++){const S=v[y],C=i[S.materialIndex],A=Math.max(S.start,x.start),P=Math.min(c.count,Math.min(S.start+S.count,x.start+x.count));for(let D=A,N=P;D<N;D+=3){const j=D,T=D+1,k=D+2;o=cT(this,C,e,Y_,c,u,d,p,f,j,T,k),o&&(o.faceIndex=Math.floor(D/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const y=Math.max(0,x.start),_=Math.min(c.count,x.start+x.count);for(let S=y,C=_;S<C;S+=3){const A=S,P=S+1,D=S+2;o=cT(this,i,e,Y_,c,u,d,p,f,A,P,D),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}}}function zNe(n,e,t,r,i,s,o,a){let c;if(e.side===Sc?c=r.intersectTriangle(o,s,i,!0,a):c=r.intersectTriangle(i,s,o,e.side!==Uh,a),c===null)return null;lT.copy(a),lT.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(lT);return u<t.near||u>t.far?null:{distance:u,point:lT.clone(),object:n}}function cT(n,e,t,r,i,s,o,a,c,u,d,p){Gf.fromBufferAttribute(i,u),Xf.fromBufferAttribute(i,d),qf.fromBufferAttribute(i,p);const f=n.morphTargetInfluences;if(s&&f){nT.set(0,0,0),rT.set(0,0,0),iT.set(0,0,0);for(let x=0,y=s.length;x<y;x++){const _=f[x],S=s[x];_!==0&&(QV.fromBufferAttribute(S,u),$V.fromBufferAttribute(S,d),eF.fromBufferAttribute(S,p),o?(nT.addScaledVector(QV,_),rT.addScaledVector($V,_),iT.addScaledVector(eF,_)):(nT.addScaledVector(QV.sub(Gf),_),rT.addScaledVector($V.sub(Xf),_),iT.addScaledVector(eF.sub(qf),_)))}Gf.add(nT),Xf.add(rT),qf.add(iT)}n.isSkinnedMesh&&(n.boneTransform(u,Gf),n.boneTransform(d,Xf),n.boneTransform(p,qf));const v=zNe(n,e,t,r,Gf,Xf,qf,tF);if(v){a&&(sT.fromBufferAttribute(a,u),oT.fromBufferAttribute(a,d),aT.fromBufferAttribute(a,p),v.uv=kh.getUV(tF,Gf,Xf,qf,sT,oT,aT,new ut)),c&&(sT.fromBufferAttribute(c,u),oT.fromBufferAttribute(c,d),aT.fromBufferAttribute(c,p),v.uv2=kh.getUV(tF,Gf,Xf,qf,sT,oT,aT,new ut));const x={a:u,b:d,c:p,normal:new Te,materialIndex:0};kh.getNormal(Gf,Xf,qf,x.normal),v.face=x}return v}class F0 extends As{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const c=[],u=[],d=[],p=[];let f=0,v=0;x("z","y","x",-1,-1,r,t,e,o,s,0),x("z","y","x",1,-1,r,t,-e,o,s,1),x("x","z","y",1,1,e,r,t,i,o,2),x("x","z","y",1,-1,e,r,-t,i,o,3),x("x","y","z",1,-1,e,t,r,i,s,4),x("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(c),this.setAttribute("position",new sr(u,3)),this.setAttribute("normal",new sr(d,3)),this.setAttribute("uv",new sr(p,2));function x(y,_,S,C,A,P,D,N,j,T,k){const U=P/j,ee=D/T,xe=P/2,ce=D/2,te=N/2,fe=j+1,ge=T+1;let Se=0,pe=0;const se=new Te;for(let ae=0;ae<ge;ae++){const Le=ae*ee-ce;for(let Re=0;Re<fe;Re++){const Ue=Re*U-xe;se[y]=Ue*C,se[_]=Le*A,se[S]=te,u.push(se.x,se.y,se.z),se[y]=0,se[_]=0,se[S]=N>0?1:-1,d.push(se.x,se.y,se.z),p.push(Re/j),p.push(1-ae/T),Se+=1}}for(let ae=0;ae<T;ae++)for(let Le=0;Le<j;Le++){const Re=f+Le+fe*ae,Ue=f+Le+fe*(ae+1),Ze=f+(Le+1)+fe*(ae+1),st=f+(Le+1)+fe*ae;c.push(Re,Ue,st),c.push(Ue,Ze,st),pe+=6}a.addGroup(v,pe,k),v+=pe,f+=Se}}static fromJSON(e){return new F0(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ox(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Ea(n){const e={};for(let t=0;t<n.length;t++){const r=Ox(n[t]);for(const i in r)e[i]=r[i]}return e}function BNe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}const Ra={clone:Ox,merge:Ea};var VNe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,FNe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class kr extends of{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=VNe,this.fragmentShader=FNe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ox(e.uniforms),this.uniformsGroups=BNe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class HH extends Qi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Vr,this.projectionMatrix=new Vr,this.projectionMatrixInverse=new Vr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class al extends HH{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=bO*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(IM*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return bO*2*Math.atan(Math.tan(IM*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(IM*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,u=o.fullHeight;s+=o.offsetX*i/c,t-=o.offsetY*r/u,i*=o.width/c,r*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Z_=90,K_=1;class WH extends Qi{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;const i=new al(Z_,K_,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Te(1,0,0)),this.add(i);const s=new al(Z_,K_,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Te(-1,0,0)),this.add(s);const o=new al(Z_,K_,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Te(0,1,0)),this.add(o);const a=new al(Z_,K_,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Te(0,-1,0)),this.add(a);const c=new al(Z_,K_,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Te(0,0,1)),this.add(c);const u=new al(Z_,K_,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Te(0,0,-1)),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[i,s,o,a,c,u]=this.children,d=e.getRenderTarget(),p=e.toneMapping,f=e.xr.enabled;e.toneMapping=Jh,e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,s),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=v,e.setRenderTarget(r,5),e.render(t,u),e.setRenderTarget(d),e.toneMapping=p,e.xr.enabled=f,r.texture.needsPMREMUpdate=!0}}class GH extends ka{constructor(e,t,r,i,s,o,a,c,u,d){e=e!==void 0?e:[],t=t!==void 0?t:Ax,super(e,t,r,i,s,o,a,c,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class XH extends Ai{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new GH(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Us}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new F0(5,5,5),s=new kr({name:"CubemapFromEquirect",uniforms:Ox(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Sc,blending:zs});s.uniforms.tEquirect.value=t;const o=new ul(i,s),a=t.minFilter;return t.minFilter===tE&&(t.minFilter=Us),new WH(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const nF=new Te,UNe=new Te,jNe=new ua;class Fg{constructor(e=new Te(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=nF.subVectors(r,t).cross(UNe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(nF),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(r).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||jNe.getNormalMatrix(e),i=this.coplanarPoint(nF).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const J_=new jD,uT=new Te;class HD{constructor(e=new Fg,t=new Fg,r=new Fg,i=new Fg,s=new Fg,o=new Fg){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],d=r[6],p=r[7],f=r[8],v=r[9],x=r[10],y=r[11],_=r[12],S=r[13],C=r[14],A=r[15];return t[0].setComponents(a-i,p-c,y-f,A-_).normalize(),t[1].setComponents(a+i,p+c,y+f,A+_).normalize(),t[2].setComponents(a+s,p+u,y+v,A+S).normalize(),t[3].setComponents(a-s,p-u,y-v,A-S).normalize(),t[4].setComponents(a-o,p-d,y-x,A-C).normalize(),t[5].setComponents(a+o,p+d,y+x,A+C).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),J_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(J_)}intersectsSprite(e){return J_.center.set(0,0,0),J_.radius=.7071067811865476,J_.applyMatrix4(e.matrixWorld),this.intersectsSphere(J_)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(uT.x=i.normal.x>0?e.max.x:e.min.x,uT.y=i.normal.y>0?e.max.y:e.min.y,uT.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(uT)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Kae(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function HNe(n,e){const t=e.isWebGL2,r=new WeakMap;function i(u,d){const p=u.array,f=u.usage,v=n.createBuffer();n.bindBuffer(d,v),n.bufferData(d,p,f),u.onUploadCallback();let x;if(p instanceof Float32Array)x=5126;else if(p instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)x=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=5123;else if(p instanceof Int16Array)x=5122;else if(p instanceof Uint32Array)x=5125;else if(p instanceof Int32Array)x=5124;else if(p instanceof Int8Array)x=5120;else if(p instanceof Uint8Array)x=5121;else if(p instanceof Uint8ClampedArray)x=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version}}function s(u,d,p){const f=d.array,v=d.updateRange;n.bindBuffer(p,u),v.count===-1?n.bufferSubData(p,0,f):(t?n.bufferSubData(p,v.offset*f.BYTES_PER_ELEMENT,f,v.offset,v.count):n.bufferSubData(p,v.offset*f.BYTES_PER_ELEMENT,f.subarray(v.offset,v.offset+v.count)),v.count=-1)}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=r.get(u);d&&(n.deleteBuffer(d.buffer),r.delete(u))}function c(u,d){if(u.isGLBufferAttribute){const f=r.get(u);(!f||f.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const p=r.get(u);p===void 0?r.set(u,i(u,d)):p.version<u.version&&(s(p.buffer,u,d),p.version=u.version)}return{get:o,remove:a,update:c}}class sE extends As{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),c=Math.floor(i),u=a+1,d=c+1,p=e/a,f=t/c,v=[],x=[],y=[],_=[];for(let S=0;S<d;S++){const C=S*f-o;for(let A=0;A<u;A++){const P=A*p-s;x.push(P,-C,0),y.push(0,0,1),_.push(A/a),_.push(1-S/c)}}for(let S=0;S<c;S++)for(let C=0;C<a;C++){const A=C+u*S,P=C+u*(S+1),D=C+1+u*(S+1),N=C+1+u*S;v.push(A,P,N),v.push(P,D,N)}this.setIndex(v),this.setAttribute("position",new sr(x,3)),this.setAttribute("normal",new sr(y,3)),this.setAttribute("uv",new sr(_,2))}static fromJSON(e){return new sE(e.width,e.height,e.widthSegments,e.heightSegments)}}var WNe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,GNe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,XNe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,qNe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,YNe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,ZNe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,KNe="vec3 transformed = vec3( position );",JNe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,QNe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,$Ne=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,eke=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,tke=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,nke=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,rke=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ike=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ske=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,oke=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,ake=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,lke=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,cke=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,uke=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,hke=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,dke=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,pke=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,fke=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,mke=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,vke="gl_FragColor = linearToOutputTexel( gl_FragColor );",gke=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,_ke=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,yke=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,xke=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,bke=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,wke=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Ske=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Mke=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Cke=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Eke=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ake=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Pke=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Tke=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Rke=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Oke=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
#define Material_LightProbeLOD( material )	(0)`,Lke=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Dke=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Ike=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Nke=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,kke=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,zke=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,Bke=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Vke=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Fke=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Uke=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,jke=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Hke=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Wke=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Gke=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Xke=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,qke=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Yke=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Zke=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Kke=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Jke=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Qke=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$ke=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,eze=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,tze=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,nze=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,rze=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,ize=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,sze=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oze=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,aze=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,lze=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,cze=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,uze=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,hze=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,dze=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,pze=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,fze=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,mze=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,vze=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,gze=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,_ze=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,yze=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,xze=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,bze=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,wze=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Sze=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Mze=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Cze=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Eze=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,Aze=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Pze=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Tze=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Rze=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Oze=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Lze=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Dze=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,Ize=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Nze=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,kze=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,zze=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Bze=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Vze=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Fze=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Uze=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const jze=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Hze=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Wze=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Gze=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Xze=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,qze=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Yze=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Zze=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Kze=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Jze=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Qze=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$ze=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eBe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,tBe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nBe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rBe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iBe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,sBe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oBe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,aBe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,lBe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cBe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uBe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,hBe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dBe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pBe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fBe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,mBe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vBe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gBe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,_Be=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yBe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,tr={alphamap_fragment:WNe,alphamap_pars_fragment:GNe,alphatest_fragment:XNe,alphatest_pars_fragment:qNe,aomap_fragment:YNe,aomap_pars_fragment:ZNe,begin_vertex:KNe,beginnormal_vertex:JNe,bsdfs:QNe,iridescence_fragment:$Ne,bumpmap_pars_fragment:eke,clipping_planes_fragment:tke,clipping_planes_pars_fragment:nke,clipping_planes_pars_vertex:rke,clipping_planes_vertex:ike,color_fragment:ske,color_pars_fragment:oke,color_pars_vertex:ake,color_vertex:lke,common:cke,cube_uv_reflection_fragment:uke,defaultnormal_vertex:hke,displacementmap_pars_vertex:dke,displacementmap_vertex:pke,emissivemap_fragment:fke,emissivemap_pars_fragment:mke,encodings_fragment:vke,encodings_pars_fragment:gke,envmap_fragment:_ke,envmap_common_pars_fragment:yke,envmap_pars_fragment:xke,envmap_pars_vertex:bke,envmap_physical_pars_fragment:Dke,envmap_vertex:wke,fog_vertex:Ske,fog_pars_vertex:Mke,fog_fragment:Cke,fog_pars_fragment:Eke,gradientmap_pars_fragment:Ake,lightmap_fragment:Pke,lightmap_pars_fragment:Tke,lights_lambert_fragment:Rke,lights_lambert_pars_fragment:Oke,lights_pars_begin:Lke,lights_toon_fragment:Ike,lights_toon_pars_fragment:Nke,lights_phong_fragment:kke,lights_phong_pars_fragment:zke,lights_physical_fragment:Bke,lights_physical_pars_fragment:Vke,lights_fragment_begin:Fke,lights_fragment_maps:Uke,lights_fragment_end:jke,logdepthbuf_fragment:Hke,logdepthbuf_pars_fragment:Wke,logdepthbuf_pars_vertex:Gke,logdepthbuf_vertex:Xke,map_fragment:qke,map_pars_fragment:Yke,map_particle_fragment:Zke,map_particle_pars_fragment:Kke,metalnessmap_fragment:Jke,metalnessmap_pars_fragment:Qke,morphcolor_vertex:$ke,morphnormal_vertex:eze,morphtarget_pars_vertex:tze,morphtarget_vertex:nze,normal_fragment_begin:rze,normal_fragment_maps:ize,normal_pars_fragment:sze,normal_pars_vertex:oze,normal_vertex:aze,normalmap_pars_fragment:lze,clearcoat_normal_fragment_begin:cze,clearcoat_normal_fragment_maps:uze,clearcoat_pars_fragment:hze,iridescence_pars_fragment:dze,output_fragment:pze,packing:fze,premultiplied_alpha_fragment:mze,project_vertex:vze,dithering_fragment:gze,dithering_pars_fragment:_ze,roughnessmap_fragment:yze,roughnessmap_pars_fragment:xze,shadowmap_pars_fragment:bze,shadowmap_pars_vertex:wze,shadowmap_vertex:Sze,shadowmask_pars_fragment:Mze,skinbase_vertex:Cze,skinning_pars_vertex:Eze,skinning_vertex:Aze,skinnormal_vertex:Pze,specularmap_fragment:Tze,specularmap_pars_fragment:Rze,tonemapping_fragment:Oze,tonemapping_pars_fragment:Lze,transmission_fragment:Dze,transmission_pars_fragment:Ize,uv_pars_fragment:Nze,uv_pars_vertex:kze,uv_vertex:zze,uv2_pars_fragment:Bze,uv2_pars_vertex:Vze,uv2_vertex:Fze,worldpos_vertex:Uze,background_vert:jze,background_frag:Hze,cube_vert:Wze,cube_frag:Gze,depth_vert:Xze,depth_frag:qze,distanceRGBA_vert:Yze,distanceRGBA_frag:Zze,equirect_vert:Kze,equirect_frag:Jze,linedashed_vert:Qze,linedashed_frag:$ze,meshbasic_vert:eBe,meshbasic_frag:tBe,meshlambert_vert:nBe,meshlambert_frag:rBe,meshmatcap_vert:iBe,meshmatcap_frag:sBe,meshnormal_vert:oBe,meshnormal_frag:aBe,meshphong_vert:lBe,meshphong_frag:cBe,meshphysical_vert:uBe,meshphysical_frag:hBe,meshtoon_vert:dBe,meshtoon_frag:pBe,points_vert:fBe,points_frag:mBe,shadow_vert:vBe,shadow_frag:gBe,sprite_vert:_Be,sprite_frag:yBe},Nt={common:{diffuse:{value:new en(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ua},uv2Transform:{value:new ua},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ut(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new en(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new en(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ua}},sprite:{diffuse:{value:new en(16777215)},opacity:{value:1},center:{value:new ut(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ua}}},Oh={basic:{uniforms:Ea([Nt.common,Nt.specularmap,Nt.envmap,Nt.aomap,Nt.lightmap,Nt.fog]),vertexShader:tr.meshbasic_vert,fragmentShader:tr.meshbasic_frag},lambert:{uniforms:Ea([Nt.common,Nt.specularmap,Nt.envmap,Nt.aomap,Nt.lightmap,Nt.emissivemap,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,Nt.fog,Nt.lights,{emissive:{value:new en(0)}}]),vertexShader:tr.meshlambert_vert,fragmentShader:tr.meshlambert_frag},phong:{uniforms:Ea([Nt.common,Nt.specularmap,Nt.envmap,Nt.aomap,Nt.lightmap,Nt.emissivemap,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,Nt.fog,Nt.lights,{emissive:{value:new en(0)},specular:{value:new en(1118481)},shininess:{value:30}}]),vertexShader:tr.meshphong_vert,fragmentShader:tr.meshphong_frag},standard:{uniforms:Ea([Nt.common,Nt.envmap,Nt.aomap,Nt.lightmap,Nt.emissivemap,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,Nt.roughnessmap,Nt.metalnessmap,Nt.fog,Nt.lights,{emissive:{value:new en(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tr.meshphysical_vert,fragmentShader:tr.meshphysical_frag},toon:{uniforms:Ea([Nt.common,Nt.aomap,Nt.lightmap,Nt.emissivemap,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,Nt.gradientmap,Nt.fog,Nt.lights,{emissive:{value:new en(0)}}]),vertexShader:tr.meshtoon_vert,fragmentShader:tr.meshtoon_frag},matcap:{uniforms:Ea([Nt.common,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,Nt.fog,{matcap:{value:null}}]),vertexShader:tr.meshmatcap_vert,fragmentShader:tr.meshmatcap_frag},points:{uniforms:Ea([Nt.points,Nt.fog]),vertexShader:tr.points_vert,fragmentShader:tr.points_frag},dashed:{uniforms:Ea([Nt.common,Nt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tr.linedashed_vert,fragmentShader:tr.linedashed_frag},depth:{uniforms:Ea([Nt.common,Nt.displacementmap]),vertexShader:tr.depth_vert,fragmentShader:tr.depth_frag},normal:{uniforms:Ea([Nt.common,Nt.bumpmap,Nt.normalmap,Nt.displacementmap,{opacity:{value:1}}]),vertexShader:tr.meshnormal_vert,fragmentShader:tr.meshnormal_frag},sprite:{uniforms:Ea([Nt.sprite,Nt.fog]),vertexShader:tr.sprite_vert,fragmentShader:tr.sprite_frag},background:{uniforms:{uvTransform:{value:new ua},t2D:{value:null}},vertexShader:tr.background_vert,fragmentShader:tr.background_frag},cube:{uniforms:Ea([Nt.envmap,{opacity:{value:1}}]),vertexShader:tr.cube_vert,fragmentShader:tr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tr.equirect_vert,fragmentShader:tr.equirect_frag},distanceRGBA:{uniforms:Ea([Nt.common,Nt.displacementmap,{referencePosition:{value:new Te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tr.distanceRGBA_vert,fragmentShader:tr.distanceRGBA_frag},shadow:{uniforms:Ea([Nt.lights,Nt.fog,{color:{value:new en(0)},opacity:{value:1}}]),vertexShader:tr.shadow_vert,fragmentShader:tr.shadow_frag}};Oh.physical={uniforms:Ea([Oh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ut(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new en(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ut},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new en(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new en(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tr.meshphysical_vert,fragmentShader:tr.meshphysical_frag};function xBe(n,e,t,r,i,s){const o=new en(0);let a=i===!0?0:1,c,u,d=null,p=0,f=null;function v(y,_){let S=!1,C=_.isScene===!0?_.background:null;C&&C.isTexture&&(C=e.get(C));const A=n.xr,P=A.getSession&&A.getSession();P&&P.environmentBlendMode==="additive"&&(C=null),C===null?x(o,a):C&&C.isColor&&(x(C,1),S=!0),(n.autoClear||S)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),C&&(C.isCubeTexture||C.mapping===FD)?(u===void 0&&(u=new ul(new F0(1,1,1),new kr({name:"BackgroundCubeMaterial",uniforms:Ox(Oh.cube.uniforms),vertexShader:Oh.cube.vertexShader,fragmentShader:Oh.cube.fragmentShader,side:Sc,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(D,N,j){this.matrixWorld.copyPosition(j.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=C,u.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,(d!==C||p!==C.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=C,p=C.version,f=n.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null)):C&&C.isTexture&&(c===void 0&&(c=new ul(new sE(2,2),new kr({name:"BackgroundMaterial",uniforms:Ox(Oh.background.uniforms),vertexShader:Oh.background.vertexShader,fragmentShader:Oh.background.fragmentShader,side:Ex,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=C,C.matrixAutoUpdate===!0&&C.updateMatrix(),c.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||p!==C.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=C,p=C.version,f=n.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null))}function x(y,_){t.buffers.color.setClear(y.r,y.g,y.b,_,s)}return{getClearColor:function(){return o},setClearColor:function(y,_=1){o.set(y),a=_,x(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(y){a=y,x(o,a)},render:v}}function bBe(n,e,t,r){const i=n.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},c=_(null);let u=c,d=!1;function p(te,fe,ge,Se,pe){let se=!1;if(o){const ae=y(Se,ge,fe);u!==ae&&(u=ae,v(u.object)),se=S(te,Se,ge,pe),se&&C(te,Se,ge,pe)}else{const ae=fe.wireframe===!0;(u.geometry!==Se.id||u.program!==ge.id||u.wireframe!==ae)&&(u.geometry=Se.id,u.program=ge.id,u.wireframe=ae,se=!0)}pe!==null&&t.update(pe,34963),(se||d)&&(d=!1,T(te,fe,ge,Se),pe!==null&&n.bindBuffer(34963,t.get(pe).buffer))}function f(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function v(te){return r.isWebGL2?n.bindVertexArray(te):s.bindVertexArrayOES(te)}function x(te){return r.isWebGL2?n.deleteVertexArray(te):s.deleteVertexArrayOES(te)}function y(te,fe,ge){const Se=ge.wireframe===!0;let pe=a[te.id];pe===void 0&&(pe={},a[te.id]=pe);let se=pe[fe.id];se===void 0&&(se={},pe[fe.id]=se);let ae=se[Se];return ae===void 0&&(ae=_(f()),se[Se]=ae),ae}function _(te){const fe=[],ge=[],Se=[];for(let pe=0;pe<i;pe++)fe[pe]=0,ge[pe]=0,Se[pe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:ge,attributeDivisors:Se,object:te,attributes:{},index:null}}function S(te,fe,ge,Se){const pe=u.attributes,se=fe.attributes;let ae=0;const Le=ge.getAttributes();for(const Re in Le)if(Le[Re].location>=0){const Ze=pe[Re];let st=se[Re];if(st===void 0&&(Re==="instanceMatrix"&&te.instanceMatrix&&(st=te.instanceMatrix),Re==="instanceColor"&&te.instanceColor&&(st=te.instanceColor)),Ze===void 0||Ze.attribute!==st||st&&Ze.data!==st.data)return!0;ae++}return u.attributesNum!==ae||u.index!==Se}function C(te,fe,ge,Se){const pe={},se=fe.attributes;let ae=0;const Le=ge.getAttributes();for(const Re in Le)if(Le[Re].location>=0){let Ze=se[Re];Ze===void 0&&(Re==="instanceMatrix"&&te.instanceMatrix&&(Ze=te.instanceMatrix),Re==="instanceColor"&&te.instanceColor&&(Ze=te.instanceColor));const st={};st.attribute=Ze,Ze&&Ze.data&&(st.data=Ze.data),pe[Re]=st,ae++}u.attributes=pe,u.attributesNum=ae,u.index=Se}function A(){const te=u.newAttributes;for(let fe=0,ge=te.length;fe<ge;fe++)te[fe]=0}function P(te){D(te,0)}function D(te,fe){const ge=u.newAttributes,Se=u.enabledAttributes,pe=u.attributeDivisors;ge[te]=1,Se[te]===0&&(n.enableVertexAttribArray(te),Se[te]=1),pe[te]!==fe&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](te,fe),pe[te]=fe)}function N(){const te=u.newAttributes,fe=u.enabledAttributes;for(let ge=0,Se=fe.length;ge<Se;ge++)fe[ge]!==te[ge]&&(n.disableVertexAttribArray(ge),fe[ge]=0)}function j(te,fe,ge,Se,pe,se){r.isWebGL2===!0&&(ge===5124||ge===5125)?n.vertexAttribIPointer(te,fe,ge,pe,se):n.vertexAttribPointer(te,fe,ge,Se,pe,se)}function T(te,fe,ge,Se){if(r.isWebGL2===!1&&(te.isInstancedMesh||Se.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;A();const pe=Se.attributes,se=ge.getAttributes(),ae=fe.defaultAttributeValues;for(const Le in se){const Re=se[Le];if(Re.location>=0){let Ue=pe[Le];if(Ue===void 0&&(Le==="instanceMatrix"&&te.instanceMatrix&&(Ue=te.instanceMatrix),Le==="instanceColor"&&te.instanceColor&&(Ue=te.instanceColor)),Ue!==void 0){const Ze=Ue.normalized,st=Ue.itemSize,we=t.get(Ue);if(we===void 0)continue;const Mt=we.buffer,rt=we.type,it=we.bytesPerElement;if(Ue.isInterleavedBufferAttribute){const Ke=Ue.data,Qe=Ke.stride,Y=Ue.offset;if(Ke.isInstancedInterleavedBuffer){for(let K=0;K<Re.locationSize;K++)D(Re.location+K,Ke.meshPerAttribute);te.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Ke.meshPerAttribute*Ke.count)}else for(let K=0;K<Re.locationSize;K++)P(Re.location+K);n.bindBuffer(34962,Mt);for(let K=0;K<Re.locationSize;K++)j(Re.location+K,st/Re.locationSize,rt,Ze,Qe*it,(Y+st/Re.locationSize*K)*it)}else{if(Ue.isInstancedBufferAttribute){for(let Ke=0;Ke<Re.locationSize;Ke++)D(Re.location+Ke,Ue.meshPerAttribute);te.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Ue.meshPerAttribute*Ue.count)}else for(let Ke=0;Ke<Re.locationSize;Ke++)P(Re.location+Ke);n.bindBuffer(34962,Mt);for(let Ke=0;Ke<Re.locationSize;Ke++)j(Re.location+Ke,st/Re.locationSize,rt,Ze,st*it,st/Re.locationSize*Ke*it)}}else if(ae!==void 0){const Ze=ae[Le];if(Ze!==void 0)switch(Ze.length){case 2:n.vertexAttrib2fv(Re.location,Ze);break;case 3:n.vertexAttrib3fv(Re.location,Ze);break;case 4:n.vertexAttrib4fv(Re.location,Ze);break;default:n.vertexAttrib1fv(Re.location,Ze)}}}}N()}function k(){xe();for(const te in a){const fe=a[te];for(const ge in fe){const Se=fe[ge];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete fe[ge]}delete a[te]}}function U(te){if(a[te.id]===void 0)return;const fe=a[te.id];for(const ge in fe){const Se=fe[ge];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete fe[ge]}delete a[te.id]}function ee(te){for(const fe in a){const ge=a[fe];if(ge[te.id]===void 0)continue;const Se=ge[te.id];for(const pe in Se)x(Se[pe].object),delete Se[pe];delete ge[te.id]}}function xe(){ce(),d=!0,u!==c&&(u=c,v(u.object))}function ce(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:p,reset:xe,resetDefaultState:ce,dispose:k,releaseStatesOfGeometry:U,releaseStatesOfProgram:ee,initAttributes:A,enableAttribute:P,disableUnusedAttributes:N}}function wBe(n,e,t,r){const i=r.isWebGL2;let s;function o(u){s=u}function a(u,d){n.drawArrays(s,u,d),t.update(d,s,1)}function c(u,d,p){if(p===0)return;let f,v;if(i)f=n,v="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[v](s,u,d,p),t.update(d,s,p)}this.setMode=o,this.render=a,this.renderInstances=c}function SBe(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const j=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(j.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(j){if(j==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";j="mediump"}return j==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const u=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,p=n.getParameter(34930),f=n.getParameter(35660),v=n.getParameter(3379),x=n.getParameter(34076),y=n.getParameter(34921),_=n.getParameter(36347),S=n.getParameter(36348),C=n.getParameter(36349),A=f>0,P=o||e.has("OES_texture_float"),D=A&&P,N=o?n.getParameter(36183):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:p,maxVertexTextures:f,maxTextureSize:v,maxCubemapSize:x,maxAttributes:y,maxVertexUniforms:_,maxVaryings:S,maxFragmentUniforms:C,vertexTextures:A,floatFragmentTextures:P,floatVertexTextures:D,maxSamples:N}}function MBe(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new Fg,a=new ua,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(p,f,v){const x=p.length!==0||f||r!==0||i;return i=f,t=d(p,v,0),r=p.length,x},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,u()},this.setState=function(p,f,v){const x=p.clippingPlanes,y=p.clipIntersection,_=p.clipShadows,S=n.get(p);if(!i||x===null||x.length===0||s&&!_)s?d(null):u();else{const C=s?0:r,A=C*4;let P=S.clippingState||null;c.value=P,P=d(x,f,A,v);for(let D=0;D!==A;++D)P[D]=t[D];S.clippingState=P,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=C}};function u(){c.value!==t&&(c.value=t,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(p,f,v,x){const y=p!==null?p.length:0;let _=null;if(y!==0){if(_=c.value,x!==!0||_===null){const S=v+y*4,C=f.matrixWorldInverse;a.getNormalMatrix(C),(_===null||_.length<S)&&(_=new Float32Array(S));for(let A=0,P=v;A!==y;++A,P+=4)o.copy(p[A]).applyMatrix4(C,a),o.normal.toArray(_,P),_[P+3]=o.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,_}}function CBe(n){let e=new WeakMap;function t(o,a){return a===dC?o.mapping=Ax:a===r8&&(o.mapping=Px),o}function r(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===dC||a===r8)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const u=new XH(c.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class oE extends HH{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,c=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,c=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Cy=4,CK=[.125,.215,.35,.446,.526,.582],Yg=20,rF=new oE,EK=new en;let iF=null;const Ug=(1+Math.sqrt(5))/2,Q_=1/Ug,AK=[new Te(1,1,1),new Te(-1,1,1),new Te(1,1,-1),new Te(-1,1,-1),new Te(0,Ug,Q_),new Te(0,Ug,-Q_),new Te(Q_,0,Ug),new Te(-Q_,0,Ug),new Te(Ug,Q_,0),new Te(-Ug,Q_,0)];class PK{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){iF=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=OK(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=RK(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(iF),e.scissorTest=!1,hT(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ax||e.mapping===Px?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),iF=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Us,minFilter:Us,generateMipmaps:!1,type:Ip,format:Hh,encoding:Nm,depthBuffer:!1},i=TK(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=TK(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=EBe(s)),this._blurMaterial=ABe(s,e,t)}return i}_compileMaterial(e){const t=new ul(this._lodPlanes[0],e);this._renderer.compile(t,rF)}_sceneToCubeUV(e,t,r,i){const a=new al(90,1,t,r),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,p=d.autoClear,f=d.toneMapping;d.getClearColor(EK),d.toneMapping=Jh,d.autoClear=!1;const v=new iE({name:"PMREM.Background",side:Sc,depthWrite:!1,depthTest:!1}),x=new ul(new F0,v);let y=!1;const _=e.background;_?_.isColor&&(v.color.copy(_),e.background=null,y=!0):(v.color.copy(EK),y=!0);for(let S=0;S<6;S++){const C=S%3;C===0?(a.up.set(0,c[S],0),a.lookAt(u[S],0,0)):C===1?(a.up.set(0,0,c[S]),a.lookAt(0,u[S],0)):(a.up.set(0,c[S],0),a.lookAt(0,0,u[S]));const A=this._cubeSize;hT(i,C*A,S>2?A:0,A,A),d.setRenderTarget(i),y&&d.render(x,a),d.render(e,a)}x.geometry.dispose(),x.material.dispose(),d.toneMapping=f,d.autoClear=p,e.background=_}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Ax||e.mapping===Px;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=OK()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=RK());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new ul(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;hT(t,0,0,3*c,2*c),r.setRenderTarget(t),r.render(o,rF)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=AK[(i-1)%AK.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const c=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,p=new ul(this._lodPlanes[i],u),f=u.uniforms,v=this._sizeLods[r]-1,x=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Yg-1),y=s/x,_=isFinite(s)?1+Math.floor(d*y):Yg;_>Yg&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${Yg}`);const S=[];let C=0;for(let j=0;j<Yg;++j){const T=j/y,k=Math.exp(-T*T/2);S.push(k),j===0?C+=k:j<_&&(C+=2*k)}for(let j=0;j<S.length;j++)S[j]=S[j]/C;f.envMap.value=e.texture,f.samples.value=_,f.weights.value=S,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a);const{_lodMax:A}=this;f.dTheta.value=x,f.mipInt.value=A-r;const P=this._sizeLods[i],D=3*P*(i>A-Cy?i-A+Cy:0),N=4*(this._cubeSize-P);hT(t,D,N,3*P,2*P),c.setRenderTarget(t),c.render(p,rF)}}function EBe(n){const e=[],t=[],r=[];let i=n;const s=n-Cy+1+CK.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let c=1/a;o>n-Cy?c=CK[o-n+Cy-1]:o===0&&(c=0),r.push(c);const u=1/(a-2),d=-u,p=1+u,f=[d,d,p,d,p,p,d,d,p,p,d,p],v=6,x=6,y=3,_=2,S=1,C=new Float32Array(y*x*v),A=new Float32Array(_*x*v),P=new Float32Array(S*x*v);for(let N=0;N<v;N++){const j=N%3*2/3-1,T=N>2?0:-1,k=[j,T,0,j+2/3,T,0,j+2/3,T+1,0,j,T,0,j+2/3,T+1,0,j,T+1,0];C.set(k,y*x*N),A.set(f,_*x*N);const U=[N,N,N,N,N,N];P.set(U,S*x*N)}const D=new As;D.setAttribute("position",new Cc(C,y)),D.setAttribute("uv",new Cc(A,_)),D.setAttribute("faceIndex",new Cc(P,S)),e.push(D),i>Cy&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function TK(n,e,t){const r=new Ai(n,e,t);return r.texture.mapping=FD,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function hT(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function ABe(n,e,t){const r=new Float32Array(Yg),i=new Te(0,1,0);return new kr({name:"SphericalGaussianBlur",defines:{n:Yg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:qH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:zs,depthTest:!1,depthWrite:!1})}function RK(){return new kr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:qH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:zs,depthTest:!1,depthWrite:!1})}function OK(){return new kr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:qH(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:zs,depthTest:!1,depthWrite:!1})}function qH(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function PBe(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const c=a.mapping,u=c===dC||c===r8,d=c===Ax||c===Px;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let p=e.get(a);return t===null&&(t=new PK(n)),p=u?t.fromEquirectangular(a,p):t.fromCubemap(a,p),e.set(a,p),p.texture}else{if(e.has(a))return e.get(a).texture;{const p=a.image;if(u&&p&&p.height>0||d&&p&&i(p)){t===null&&(t=new PK(n));const f=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,f),a.addEventListener("dispose",s),f.texture}else return null}}}return a}function i(a){let c=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&c++;return c===u}function s(a){const c=a.target;c.removeEventListener("dispose",s);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function TBe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function RBe(n,e,t,r){const i={},s=new WeakMap;function o(p){const f=p.target;f.index!==null&&e.remove(f.index);for(const x in f.attributes)e.remove(f.attributes[x]);f.removeEventListener("dispose",o),delete i[f.id];const v=s.get(f);v&&(e.remove(v),s.delete(f)),r.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function a(p,f){return i[f.id]===!0||(f.addEventListener("dispose",o),i[f.id]=!0,t.memory.geometries++),f}function c(p){const f=p.attributes;for(const x in f)e.update(f[x],34962);const v=p.morphAttributes;for(const x in v){const y=v[x];for(let _=0,S=y.length;_<S;_++)e.update(y[_],34962)}}function u(p){const f=[],v=p.index,x=p.attributes.position;let y=0;if(v!==null){const C=v.array;y=v.version;for(let A=0,P=C.length;A<P;A+=3){const D=C[A+0],N=C[A+1],j=C[A+2];f.push(D,N,N,j,j,D)}}else{const C=x.array;y=x.version;for(let A=0,P=C.length/3-1;A<P;A+=3){const D=A+0,N=A+1,j=A+2;f.push(D,N,N,j,j,D)}}const _=new(Hae(f)?Zae:Yae)(f,1);_.version=y;const S=s.get(p);S&&e.remove(S),s.set(p,_)}function d(p){const f=s.get(p);if(f){const v=p.index;v!==null&&f.version<v.version&&u(p)}else u(p);return s.get(p)}return{get:a,update:c,getWireframeAttribute:d}}function OBe(n,e,t,r){const i=r.isWebGL2;let s;function o(f){s=f}let a,c;function u(f){a=f.type,c=f.bytesPerElement}function d(f,v){n.drawElements(s,v,a,f*c),t.update(v,s,1)}function p(f,v,x){if(x===0)return;let y,_;if(i)y=n,_="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[_](s,v,a,f*c,x),t.update(v,s,x)}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=p}function LBe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function DBe(n,e){return n[0]-e[0]}function IBe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function NBe(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new No,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function c(u,d,p,f){const v=u.morphTargetInfluences;if(e.isWebGL2===!0){const x=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,y=x!==void 0?x.length:0;let _=s.get(d);if(_===void 0||_.count!==y){let fe=function(){ce.dispose(),s.delete(d),d.removeEventListener("dispose",fe)};_!==void 0&&_.texture.dispose();const A=d.morphAttributes.position!==void 0,P=d.morphAttributes.normal!==void 0,D=d.morphAttributes.color!==void 0,N=d.morphAttributes.position||[],j=d.morphAttributes.normal||[],T=d.morphAttributes.color||[];let k=0;A===!0&&(k=1),P===!0&&(k=2),D===!0&&(k=3);let U=d.attributes.position.count*k,ee=1;U>e.maxTextureSize&&(ee=Math.ceil(U/e.maxTextureSize),U=e.maxTextureSize);const xe=new Float32Array(U*ee*4*y),ce=new qae(xe,U,ee,y);ce.type=jh,ce.needsUpdate=!0;const te=k*4;for(let ge=0;ge<y;ge++){const Se=N[ge],pe=j[ge],se=T[ge],ae=U*ee*4*ge;for(let Le=0;Le<Se.count;Le++){const Re=Le*te;A===!0&&(o.fromBufferAttribute(Se,Le),xe[ae+Re+0]=o.x,xe[ae+Re+1]=o.y,xe[ae+Re+2]=o.z,xe[ae+Re+3]=0),P===!0&&(o.fromBufferAttribute(pe,Le),xe[ae+Re+4]=o.x,xe[ae+Re+5]=o.y,xe[ae+Re+6]=o.z,xe[ae+Re+7]=0),D===!0&&(o.fromBufferAttribute(se,Le),xe[ae+Re+8]=o.x,xe[ae+Re+9]=o.y,xe[ae+Re+10]=o.z,xe[ae+Re+11]=se.itemSize===4?o.w:1)}}_={count:y,texture:ce,size:new ut(U,ee)},s.set(d,_),d.addEventListener("dispose",fe)}let S=0;for(let A=0;A<v.length;A++)S+=v[A];const C=d.morphTargetsRelative?1:1-S;f.getUniforms().setValue(n,"morphTargetBaseInfluence",C),f.getUniforms().setValue(n,"morphTargetInfluences",v),f.getUniforms().setValue(n,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",_.size)}else{const x=v===void 0?0:v.length;let y=r[d.id];if(y===void 0||y.length!==x){y=[];for(let P=0;P<x;P++)y[P]=[P,0];r[d.id]=y}for(let P=0;P<x;P++){const D=y[P];D[0]=P,D[1]=v[P]}y.sort(IBe);for(let P=0;P<8;P++)P<x&&y[P][1]?(a[P][0]=y[P][0],a[P][1]=y[P][1]):(a[P][0]=Number.MAX_SAFE_INTEGER,a[P][1]=0);a.sort(DBe);const _=d.morphAttributes.position,S=d.morphAttributes.normal;let C=0;for(let P=0;P<8;P++){const D=a[P],N=D[0],j=D[1];N!==Number.MAX_SAFE_INTEGER&&j?(_&&d.getAttribute("morphTarget"+P)!==_[N]&&d.setAttribute("morphTarget"+P,_[N]),S&&d.getAttribute("morphNormal"+P)!==S[N]&&d.setAttribute("morphNormal"+P,S[N]),i[P]=j,C+=j):(_&&d.hasAttribute("morphTarget"+P)===!0&&d.deleteAttribute("morphTarget"+P),S&&d.hasAttribute("morphNormal"+P)===!0&&d.deleteAttribute("morphNormal"+P),i[P]=0)}const A=d.morphTargetsRelative?1:1-C;f.getUniforms().setValue(n,"morphTargetBaseInfluence",A),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:c}}function kBe(n,e,t,r){let i=new WeakMap;function s(c){const u=r.render.frame,d=c.geometry,p=e.get(c,d);return i.get(p)!==u&&(e.update(p),i.set(p,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),c.instanceColor!==null&&t.update(c.instanceColor,34962)),p}function o(){i=new WeakMap}function a(c){const u=c.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const Jae=new ka,Qae=new qae,$ae=new ANe,ele=new GH,LK=[],DK=[],IK=new Float32Array(16),NK=new Float32Array(9),kK=new Float32Array(4);function Ab(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=LK[i];if(s===void 0&&(s=new Float32Array(i),LK[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function ml(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function vl(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function WD(n,e){let t=DK[e];t===void 0&&(t=new Int32Array(e),DK[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function zBe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function BBe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ml(t,e))return;n.uniform2fv(this.addr,e),vl(t,e)}}function VBe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ml(t,e))return;n.uniform3fv(this.addr,e),vl(t,e)}}function FBe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ml(t,e))return;n.uniform4fv(this.addr,e),vl(t,e)}}function UBe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ml(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),vl(t,e)}else{if(ml(t,r))return;kK.set(r),n.uniformMatrix2fv(this.addr,!1,kK),vl(t,r)}}function jBe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ml(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),vl(t,e)}else{if(ml(t,r))return;NK.set(r),n.uniformMatrix3fv(this.addr,!1,NK),vl(t,r)}}function HBe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ml(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),vl(t,e)}else{if(ml(t,r))return;IK.set(r),n.uniformMatrix4fv(this.addr,!1,IK),vl(t,r)}}function WBe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function GBe(n,e){const t=this.cache;ml(t,e)||(n.uniform2iv(this.addr,e),vl(t,e))}function XBe(n,e){const t=this.cache;ml(t,e)||(n.uniform3iv(this.addr,e),vl(t,e))}function qBe(n,e){const t=this.cache;ml(t,e)||(n.uniform4iv(this.addr,e),vl(t,e))}function YBe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function ZBe(n,e){const t=this.cache;ml(t,e)||(n.uniform2uiv(this.addr,e),vl(t,e))}function KBe(n,e){const t=this.cache;ml(t,e)||(n.uniform3uiv(this.addr,e),vl(t,e))}function JBe(n,e){const t=this.cache;ml(t,e)||(n.uniform4uiv(this.addr,e),vl(t,e))}function QBe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2D(e||Jae,i)}function $Be(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||$ae,i)}function e5e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||ele,i)}function t5e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Qae,i)}function n5e(n){switch(n){case 5126:return zBe;case 35664:return BBe;case 35665:return VBe;case 35666:return FBe;case 35674:return UBe;case 35675:return jBe;case 35676:return HBe;case 5124:case 35670:return WBe;case 35667:case 35671:return GBe;case 35668:case 35672:return XBe;case 35669:case 35673:return qBe;case 5125:return YBe;case 36294:return ZBe;case 36295:return KBe;case 36296:return JBe;case 35678:case 36198:case 36298:case 36306:case 35682:return QBe;case 35679:case 36299:case 36307:return $Be;case 35680:case 36300:case 36308:case 36293:return e5e;case 36289:case 36303:case 36311:case 36292:return t5e}}function r5e(n,e){n.uniform1fv(this.addr,e)}function i5e(n,e){const t=Ab(e,this.size,2);n.uniform2fv(this.addr,t)}function s5e(n,e){const t=Ab(e,this.size,3);n.uniform3fv(this.addr,t)}function o5e(n,e){const t=Ab(e,this.size,4);n.uniform4fv(this.addr,t)}function a5e(n,e){const t=Ab(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function l5e(n,e){const t=Ab(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function c5e(n,e){const t=Ab(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function u5e(n,e){n.uniform1iv(this.addr,e)}function h5e(n,e){n.uniform2iv(this.addr,e)}function d5e(n,e){n.uniform3iv(this.addr,e)}function p5e(n,e){n.uniform4iv(this.addr,e)}function f5e(n,e){n.uniform1uiv(this.addr,e)}function m5e(n,e){n.uniform2uiv(this.addr,e)}function v5e(n,e){n.uniform3uiv(this.addr,e)}function g5e(n,e){n.uniform4uiv(this.addr,e)}function _5e(n,e,t){const r=e.length,i=WD(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture2D(e[s]||Jae,i[s])}function y5e(n,e,t){const r=e.length,i=WD(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture3D(e[s]||$ae,i[s])}function x5e(n,e,t){const r=e.length,i=WD(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTextureCube(e[s]||ele,i[s])}function b5e(n,e,t){const r=e.length,i=WD(t,r);n.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||Qae,i[s])}function w5e(n){switch(n){case 5126:return r5e;case 35664:return i5e;case 35665:return s5e;case 35666:return o5e;case 35674:return a5e;case 35675:return l5e;case 35676:return c5e;case 5124:case 35670:return u5e;case 35667:case 35671:return h5e;case 35668:case 35672:return d5e;case 35669:case 35673:return p5e;case 5125:return f5e;case 36294:return m5e;case 36295:return v5e;case 36296:return g5e;case 35678:case 36198:case 36298:case 36306:case 35682:return _5e;case 35679:case 36299:case 36307:return y5e;case 35680:case 36300:case 36308:case 36293:return x5e;case 36289:case 36303:case 36311:case 36292:return b5e}}class S5e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=n5e(t.type)}}class M5e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=w5e(t.type)}}class C5e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const sF=/(\w+)(\])?(\[|\.)?/g;function zK(n,e){n.seq.push(e),n.map[e.id]=e}function E5e(n,e,t){const r=n.name,i=r.length;for(sF.lastIndex=0;;){const s=sF.exec(r),o=sF.lastIndex;let a=s[1];const c=s[2]==="]",u=s[3];if(c&&(a=a|0),u===void 0||u==="["&&o+2===i){zK(t,u===void 0?new S5e(a,n,e):new M5e(a,n,e));break}else{let p=t.map[a];p===void 0&&(p=new C5e(a),zK(t,p)),t=p}}}class tR{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);E5e(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=r[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function BK(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}let A5e=0;function P5e(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function T5e(n){switch(n){case Nm:return["Linear","( value )"];case os:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function VK(n,e,t){const r=n.getShaderParameter(e,35713),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+P5e(n.getShaderSource(e),o)}else return i}function R5e(n,e){const t=T5e(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function O5e(n,e){let t;switch(e){case Fae:t="Linear";break;case jIe:t="Reinhard";break;case HIe:t="OptimizedCineon";break;case WIe:t="ACESFilmic";break;case GIe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function L5e(n){return[n.extensionDerivatives||!!n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(aM).join(`
`)}function D5e(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function I5e(n,e){const t={},r=n.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function aM(n){return n!==""}function FK(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function UK(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const N5e=/^[ \t]*#include +<([\w\d./]+)>/gm;function u8(n){return n.replace(N5e,k5e)}function k5e(n,e){const t=tr[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return u8(t)}const z5e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jK(n){return n.replace(z5e,B5e)}function B5e(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function HK(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function V5e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Dae?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Iae?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===oM&&(e="SHADOWMAP_TYPE_VSM"),e}function F5e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ax:case Px:e="ENVMAP_TYPE_CUBE";break;case FD:e="ENVMAP_TYPE_CUBE_UV";break}return e}function U5e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Px:e="ENVMAP_MODE_REFRACTION";break}return e}function j5e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Vae:e="ENVMAP_BLENDING_MULTIPLY";break;case FIe:e="ENVMAP_BLENDING_MIX";break;case UIe:e="ENVMAP_BLENDING_ADD";break}return e}function H5e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function W5e(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=V5e(t),u=F5e(t),d=U5e(t),p=j5e(t),f=H5e(t),v=t.isWebGL2?"":L5e(t),x=D5e(s),y=i.createProgram();let _,S,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(_=[x].filter(aM).join(`
`),_.length>0&&(_+=`
`),S=[v,x].filter(aM).join(`
`),S.length>0&&(S+=`
`)):(_=[HK(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(aM).join(`
`),S=[v,HK(t),"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",t.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Jh?"#define TONE_MAPPING":"",t.toneMapping!==Jh?tr.tonemapping_pars_fragment:"",t.toneMapping!==Jh?O5e("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",tr.encodings_pars_fragment,R5e("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(aM).join(`
`)),o=u8(o),o=FK(o,t),o=UK(o,t),a=u8(a),a=FK(a,t),a=UK(a,t),o=jK(o),a=jK(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,S=["#define varying in",t.glslVersion===dK?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===dK?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const A=C+_+o,P=C+S+a,D=BK(i,35633,A),N=BK(i,35632,P);if(i.attachShader(y,D),i.attachShader(y,N),t.index0AttributeName!==void 0?i.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),n.debug.checkShaderErrors){const k=i.getProgramInfoLog(y).trim(),U=i.getShaderInfoLog(D).trim(),ee=i.getShaderInfoLog(N).trim();let xe=!0,ce=!0;if(i.getProgramParameter(y,35714)===!1){xe=!1;const te=VK(i,D,"vertex"),fe=VK(i,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(y,35715)+`

Program Info Log: `+k+`
`+te+`
`+fe)}else k!==""?console.warn("THREE.WebGLProgram: Program Info Log:",k):(U===""||ee==="")&&(ce=!1);ce&&(this.diagnostics={runnable:xe,programLog:k,vertexShader:{log:U,prefix:_},fragmentShader:{log:ee,prefix:S}})}i.deleteShader(D),i.deleteShader(N);let j;this.getUniforms=function(){return j===void 0&&(j=new tR(i,y)),j};let T;return this.getAttributes=function(){return T===void 0&&(T=I5e(i,y)),T},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=A5e++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=D,this.fragmentShader=N,this}let G5e=0;class X5e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new q5e(e),t.set(e,r)),r}}class q5e{constructor(e){this.id=G5e++,this.code=e,this.usedTimes=0}}function Y5e(n,e,t,r,i,s,o){const a=new jH,c=new X5e,u=[],d=i.isWebGL2,p=i.logarithmicDepthBuffer,f=i.vertexTextures;let v=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(T,k,U,ee,xe){const ce=ee.fog,te=xe.geometry,fe=T.isMeshStandardMaterial?ee.environment:null,ge=(T.isMeshStandardMaterial?t:e).get(T.envMap||fe),Se=!!ge&&ge.mapping===FD?ge.image.height:null,pe=x[T.type];T.precision!==null&&(v=i.getMaxPrecision(T.precision),v!==T.precision&&console.warn("THREE.WebGLProgram.getParameters:",T.precision,"not supported, using",v,"instead."));const se=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,ae=se!==void 0?se.length:0;let Le=0;te.morphAttributes.position!==void 0&&(Le=1),te.morphAttributes.normal!==void 0&&(Le=2),te.morphAttributes.color!==void 0&&(Le=3);let Re,Ue,Ze,st;if(pe){const Qe=Oh[pe];Re=Qe.vertexShader,Ue=Qe.fragmentShader}else Re=T.vertexShader,Ue=T.fragmentShader,c.update(T),Ze=c.getVertexShaderID(T),st=c.getFragmentShaderID(T);const we=n.getRenderTarget(),Mt=T.alphaTest>0,rt=T.clearcoat>0,it=T.iridescence>0;return{isWebGL2:d,shaderID:pe,shaderName:T.type,vertexShader:Re,fragmentShader:Ue,defines:T.defines,customVertexShaderID:Ze,customFragmentShaderID:st,isRawShaderMaterial:T.isRawShaderMaterial===!0,glslVersion:T.glslVersion,precision:v,instancing:xe.isInstancedMesh===!0,instancingColor:xe.isInstancedMesh===!0&&xe.instanceColor!==null,supportsVertexTextures:f,outputEncoding:we===null?n.outputEncoding:we.isXRRenderTarget===!0?we.texture.encoding:Nm,map:!!T.map,matcap:!!T.matcap,envMap:!!ge,envMapMode:ge&&ge.mapping,envMapCubeUVHeight:Se,lightMap:!!T.lightMap,aoMap:!!T.aoMap,emissiveMap:!!T.emissiveMap,bumpMap:!!T.bumpMap,normalMap:!!T.normalMap,objectSpaceNormalMap:T.normalMapType===jae,tangentSpaceNormalMap:T.normalMapType===nE,decodeVideoTexture:!!T.map&&T.map.isVideoTexture===!0&&T.map.encoding===os,clearcoat:rt,clearcoatMap:rt&&!!T.clearcoatMap,clearcoatRoughnessMap:rt&&!!T.clearcoatRoughnessMap,clearcoatNormalMap:rt&&!!T.clearcoatNormalMap,iridescence:it,iridescenceMap:it&&!!T.iridescenceMap,iridescenceThicknessMap:it&&!!T.iridescenceThicknessMap,displacementMap:!!T.displacementMap,roughnessMap:!!T.roughnessMap,metalnessMap:!!T.metalnessMap,specularMap:!!T.specularMap,specularIntensityMap:!!T.specularIntensityMap,specularColorMap:!!T.specularColorMap,opaque:T.transparent===!1&&T.blending===jy,alphaMap:!!T.alphaMap,alphaTest:Mt,gradientMap:!!T.gradientMap,sheen:T.sheen>0,sheenColorMap:!!T.sheenColorMap,sheenRoughnessMap:!!T.sheenRoughnessMap,transmission:T.transmission>0,transmissionMap:!!T.transmissionMap,thicknessMap:!!T.thicknessMap,combine:T.combine,vertexTangents:!!T.normalMap&&!!te.attributes.tangent,vertexColors:T.vertexColors,vertexAlphas:T.vertexColors===!0&&!!te.attributes.color&&te.attributes.color.itemSize===4,vertexUvs:!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatMap||!!T.clearcoatRoughnessMap||!!T.clearcoatNormalMap||!!T.iridescenceMap||!!T.iridescenceThicknessMap||!!T.displacementMap||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularColorMap||!!T.sheenColorMap||!!T.sheenRoughnessMap,uvsVertexOnly:!(!!T.map||!!T.bumpMap||!!T.normalMap||!!T.specularMap||!!T.alphaMap||!!T.emissiveMap||!!T.roughnessMap||!!T.metalnessMap||!!T.clearcoatNormalMap||!!T.iridescenceMap||!!T.iridescenceThicknessMap||T.transmission>0||!!T.transmissionMap||!!T.thicknessMap||!!T.specularIntensityMap||!!T.specularColorMap||T.sheen>0||!!T.sheenColorMap||!!T.sheenRoughnessMap)&&!!T.displacementMap,fog:!!ce,useFog:T.fog===!0,fogExp2:ce&&ce.isFogExp2,flatShading:!!T.flatShading,sizeAttenuation:T.sizeAttenuation,logarithmicDepthBuffer:p,skinning:xe.isSkinnedMesh===!0,morphTargets:te.morphAttributes.position!==void 0,morphNormals:te.morphAttributes.normal!==void 0,morphColors:te.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:Le,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:T.dithering,shadowMapEnabled:n.shadowMap.enabled&&U.length>0,shadowMapType:n.shadowMap.type,toneMapping:T.toneMapped?n.toneMapping:Jh,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:T.premultipliedAlpha,doubleSided:T.side===Uh,flipSided:T.side===Sc,useDepthPacking:!!T.depthPacking,depthPacking:T.depthPacking||0,index0AttributeName:T.index0AttributeName,extensionDerivatives:T.extensions&&T.extensions.derivatives,extensionFragDepth:T.extensions&&T.extensions.fragDepth,extensionDrawBuffers:T.extensions&&T.extensions.drawBuffers,extensionShaderTextureLOD:T.extensions&&T.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),customProgramCacheKey:T.customProgramCacheKey()}}function _(T){const k=[];if(T.shaderID?k.push(T.shaderID):(k.push(T.customVertexShaderID),k.push(T.customFragmentShaderID)),T.defines!==void 0)for(const U in T.defines)k.push(U),k.push(T.defines[U]);return T.isRawShaderMaterial===!1&&(S(k,T),C(k,T),k.push(n.outputEncoding)),k.push(T.customProgramCacheKey),k.join()}function S(T,k){T.push(k.precision),T.push(k.outputEncoding),T.push(k.envMapMode),T.push(k.envMapCubeUVHeight),T.push(k.combine),T.push(k.vertexUvs),T.push(k.fogExp2),T.push(k.sizeAttenuation),T.push(k.morphTargetsCount),T.push(k.morphAttributeCount),T.push(k.numDirLights),T.push(k.numPointLights),T.push(k.numSpotLights),T.push(k.numSpotLightMaps),T.push(k.numHemiLights),T.push(k.numRectAreaLights),T.push(k.numDirLightShadows),T.push(k.numPointLightShadows),T.push(k.numSpotLightShadows),T.push(k.numSpotLightShadowsWithMaps),T.push(k.shadowMapType),T.push(k.toneMapping),T.push(k.numClippingPlanes),T.push(k.numClipIntersection),T.push(k.depthPacking)}function C(T,k){a.disableAll(),k.isWebGL2&&a.enable(0),k.supportsVertexTextures&&a.enable(1),k.instancing&&a.enable(2),k.instancingColor&&a.enable(3),k.map&&a.enable(4),k.matcap&&a.enable(5),k.envMap&&a.enable(6),k.lightMap&&a.enable(7),k.aoMap&&a.enable(8),k.emissiveMap&&a.enable(9),k.bumpMap&&a.enable(10),k.normalMap&&a.enable(11),k.objectSpaceNormalMap&&a.enable(12),k.tangentSpaceNormalMap&&a.enable(13),k.clearcoat&&a.enable(14),k.clearcoatMap&&a.enable(15),k.clearcoatRoughnessMap&&a.enable(16),k.clearcoatNormalMap&&a.enable(17),k.iridescence&&a.enable(18),k.iridescenceMap&&a.enable(19),k.iridescenceThicknessMap&&a.enable(20),k.displacementMap&&a.enable(21),k.specularMap&&a.enable(22),k.roughnessMap&&a.enable(23),k.metalnessMap&&a.enable(24),k.gradientMap&&a.enable(25),k.alphaMap&&a.enable(26),k.alphaTest&&a.enable(27),k.vertexColors&&a.enable(28),k.vertexAlphas&&a.enable(29),k.vertexUvs&&a.enable(30),k.vertexTangents&&a.enable(31),k.uvsVertexOnly&&a.enable(32),T.push(a.mask),a.disableAll(),k.fog&&a.enable(0),k.useFog&&a.enable(1),k.flatShading&&a.enable(2),k.logarithmicDepthBuffer&&a.enable(3),k.skinning&&a.enable(4),k.morphTargets&&a.enable(5),k.morphNormals&&a.enable(6),k.morphColors&&a.enable(7),k.premultipliedAlpha&&a.enable(8),k.shadowMapEnabled&&a.enable(9),k.physicallyCorrectLights&&a.enable(10),k.doubleSided&&a.enable(11),k.flipSided&&a.enable(12),k.useDepthPacking&&a.enable(13),k.dithering&&a.enable(14),k.specularIntensityMap&&a.enable(15),k.specularColorMap&&a.enable(16),k.transmission&&a.enable(17),k.transmissionMap&&a.enable(18),k.thicknessMap&&a.enable(19),k.sheen&&a.enable(20),k.sheenColorMap&&a.enable(21),k.sheenRoughnessMap&&a.enable(22),k.decodeVideoTexture&&a.enable(23),k.opaque&&a.enable(24),T.push(a.mask)}function A(T){const k=x[T.type];let U;if(k){const ee=Oh[k];U=Ra.clone(ee.uniforms)}else U=T.uniforms;return U}function P(T,k){let U;for(let ee=0,xe=u.length;ee<xe;ee++){const ce=u[ee];if(ce.cacheKey===k){U=ce,++U.usedTimes;break}}return U===void 0&&(U=new W5e(n,k,T,s),u.push(U)),U}function D(T){if(--T.usedTimes===0){const k=u.indexOf(T);u[k]=u[u.length-1],u.pop(),T.destroy()}}function N(T){c.remove(T)}function j(){c.dispose()}return{getParameters:y,getProgramCacheKey:_,getUniforms:A,acquireProgram:P,releaseProgram:D,releaseShaderCache:N,programs:u,dispose:j}}function Z5e(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function K5e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function WK(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function GK(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(p,f,v,x,y,_){let S=n[e];return S===void 0?(S={id:p.id,object:p,geometry:f,material:v,groupOrder:x,renderOrder:p.renderOrder,z:y,group:_},n[e]=S):(S.id=p.id,S.object=p,S.geometry=f,S.material=v,S.groupOrder=x,S.renderOrder=p.renderOrder,S.z=y,S.group=_),e++,S}function a(p,f,v,x,y,_){const S=o(p,f,v,x,y,_);v.transmission>0?r.push(S):v.transparent===!0?i.push(S):t.push(S)}function c(p,f,v,x,y,_){const S=o(p,f,v,x,y,_);v.transmission>0?r.unshift(S):v.transparent===!0?i.unshift(S):t.unshift(S)}function u(p,f){t.length>1&&t.sort(p||K5e),r.length>1&&r.sort(f||WK),i.length>1&&i.sort(f||WK)}function d(){for(let p=e,f=n.length;p<f;p++){const v=n[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:c,finish:d,sort:u}}function J5e(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new GK,n.set(r,[o])):i>=s.length?(o=new GK,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Q5e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Te,color:new en};break;case"SpotLight":t={position:new Te,direction:new Te,color:new en,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Te,color:new en,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Te,skyColor:new en,groundColor:new en};break;case"RectAreaLight":t={color:new en,position:new Te,halfWidth:new Te,halfHeight:new Te};break}return n[e.id]=t,t}}}function $5e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ut};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ut};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ut,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let eVe=0;function tVe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function nVe(n,e){const t=new Q5e,r=$5e(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)i.probe.push(new Te);const s=new Te,o=new Vr,a=new Vr;function c(d,p){let f=0,v=0,x=0;for(let ee=0;ee<9;ee++)i.probe[ee].set(0,0,0);let y=0,_=0,S=0,C=0,A=0,P=0,D=0,N=0,j=0,T=0;d.sort(tVe);const k=p!==!0?Math.PI:1;for(let ee=0,xe=d.length;ee<xe;ee++){const ce=d[ee],te=ce.color,fe=ce.intensity,ge=ce.distance,Se=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)f+=te.r*fe*k,v+=te.g*fe*k,x+=te.b*fe*k;else if(ce.isLightProbe)for(let pe=0;pe<9;pe++)i.probe[pe].addScaledVector(ce.sh.coefficients[pe],fe);else if(ce.isDirectionalLight){const pe=t.get(ce);if(pe.color.copy(ce.color).multiplyScalar(ce.intensity*k),ce.castShadow){const se=ce.shadow,ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,i.directionalShadow[y]=ae,i.directionalShadowMap[y]=Se,i.directionalShadowMatrix[y]=ce.shadow.matrix,P++}i.directional[y]=pe,y++}else if(ce.isSpotLight){const pe=t.get(ce);pe.position.setFromMatrixPosition(ce.matrixWorld),pe.color.copy(te).multiplyScalar(fe*k),pe.distance=ge,pe.coneCos=Math.cos(ce.angle),pe.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),pe.decay=ce.decay,i.spot[S]=pe;const se=ce.shadow;if(ce.map&&(i.spotLightMap[j]=ce.map,j++,se.updateMatrices(ce),ce.castShadow&&T++),i.spotLightMatrix[S]=se.matrix,ce.castShadow){const ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,i.spotShadow[S]=ae,i.spotShadowMap[S]=Se,N++}S++}else if(ce.isRectAreaLight){const pe=t.get(ce);pe.color.copy(te).multiplyScalar(fe),pe.halfWidth.set(ce.width*.5,0,0),pe.halfHeight.set(0,ce.height*.5,0),i.rectArea[C]=pe,C++}else if(ce.isPointLight){const pe=t.get(ce);if(pe.color.copy(ce.color).multiplyScalar(ce.intensity*k),pe.distance=ce.distance,pe.decay=ce.decay,ce.castShadow){const se=ce.shadow,ae=r.get(ce);ae.shadowBias=se.bias,ae.shadowNormalBias=se.normalBias,ae.shadowRadius=se.radius,ae.shadowMapSize=se.mapSize,ae.shadowCameraNear=se.camera.near,ae.shadowCameraFar=se.camera.far,i.pointShadow[_]=ae,i.pointShadowMap[_]=Se,i.pointShadowMatrix[_]=ce.shadow.matrix,D++}i.point[_]=pe,_++}else if(ce.isHemisphereLight){const pe=t.get(ce);pe.skyColor.copy(ce.color).multiplyScalar(fe*k),pe.groundColor.copy(ce.groundColor).multiplyScalar(fe*k),i.hemi[A]=pe,A++}}C>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Nt.LTC_FLOAT_1,i.rectAreaLTC2=Nt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Nt.LTC_HALF_1,i.rectAreaLTC2=Nt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=f,i.ambient[1]=v,i.ambient[2]=x;const U=i.hash;(U.directionalLength!==y||U.pointLength!==_||U.spotLength!==S||U.rectAreaLength!==C||U.hemiLength!==A||U.numDirectionalShadows!==P||U.numPointShadows!==D||U.numSpotShadows!==N||U.numSpotMaps!==j)&&(i.directional.length=y,i.spot.length=S,i.rectArea.length=C,i.point.length=_,i.hemi.length=A,i.directionalShadow.length=P,i.directionalShadowMap.length=P,i.pointShadow.length=D,i.pointShadowMap.length=D,i.spotShadow.length=N,i.spotShadowMap.length=N,i.directionalShadowMatrix.length=P,i.pointShadowMatrix.length=D,i.spotLightMatrix.length=N+j-T,i.spotLightMap.length=j,i.numSpotLightShadowsWithMaps=T,U.directionalLength=y,U.pointLength=_,U.spotLength=S,U.rectAreaLength=C,U.hemiLength=A,U.numDirectionalShadows=P,U.numPointShadows=D,U.numSpotShadows=N,U.numSpotMaps=j,i.version=eVe++)}function u(d,p){let f=0,v=0,x=0,y=0,_=0;const S=p.matrixWorldInverse;for(let C=0,A=d.length;C<A;C++){const P=d[C];if(P.isDirectionalLight){const D=i.directional[f];D.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),D.direction.sub(s),D.direction.transformDirection(S),f++}else if(P.isSpotLight){const D=i.spot[x];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),D.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),D.direction.sub(s),D.direction.transformDirection(S),x++}else if(P.isRectAreaLight){const D=i.rectArea[y];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),a.identity(),o.copy(P.matrixWorld),o.premultiply(S),a.extractRotation(o),D.halfWidth.set(P.width*.5,0,0),D.halfHeight.set(0,P.height*.5,0),D.halfWidth.applyMatrix4(a),D.halfHeight.applyMatrix4(a),y++}else if(P.isPointLight){const D=i.point[v];D.position.setFromMatrixPosition(P.matrixWorld),D.position.applyMatrix4(S),v++}else if(P.isHemisphereLight){const D=i.hemi[_];D.direction.setFromMatrixPosition(P.matrixWorld),D.direction.transformDirection(S),_++}}}return{setup:c,setupView:u,state:i}}function XK(n,e){const t=new nVe(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(p){r.push(p)}function a(p){i.push(p)}function c(p){t.setup(r,p)}function u(p){t.setupView(r,p)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:c,setupLightsView:u,pushLight:o,pushShadow:a}}function rVe(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let c;return a===void 0?(c=new XK(n,e),t.set(s,[c])):o>=a.length?(c=new XK(n,e),a.push(c)):c=a[o],c}function i(){t=new WeakMap}return{get:r,dispose:i}}class GD extends of{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=uNe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class iVe extends of{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Te,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const sVe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,oVe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function aVe(n,e,t){let r=new HD;const i=new ut,s=new ut,o=new No,a=new GD({depthPacking:UD}),c=new iVe,u={},d=t.maxTextureSize,p={0:Sc,1:Ex,2:Uh},f=new kr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ut},radius:{value:4}},vertexShader:sVe,fragmentShader:oVe}),v=f.clone();v.defines.HORIZONTAL_PASS=1;const x=new As;x.setAttribute("position",new Cc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new ul(x,f),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Dae,this.render=function(P,D,N){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||P.length===0)return;const j=n.getRenderTarget(),T=n.getActiveCubeFace(),k=n.getActiveMipmapLevel(),U=n.state;U.setBlending(zs),U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);for(let ee=0,xe=P.length;ee<xe;ee++){const ce=P[ee],te=ce.shadow;if(te===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(te.autoUpdate===!1&&te.needsUpdate===!1)continue;i.copy(te.mapSize);const fe=te.getFrameExtents();if(i.multiply(fe),s.copy(te.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/fe.x),i.x=s.x*fe.x,te.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/fe.y),i.y=s.y*fe.y,te.mapSize.y=s.y)),te.map===null){const Se=this.type!==oM?{minFilter:ds,magFilter:ds}:{};te.map=new Ai(i.x,i.y,Se),te.map.texture.name=ce.name+".shadowMap",te.camera.updateProjectionMatrix()}n.setRenderTarget(te.map),n.clear();const ge=te.getViewportCount();for(let Se=0;Se<ge;Se++){const pe=te.getViewport(Se);o.set(s.x*pe.x,s.y*pe.y,s.x*pe.z,s.y*pe.w),U.viewport(o),te.updateMatrices(ce,Se),r=te.getFrustum(),A(D,N,te.camera,ce,this.type)}te.isPointLightShadow!==!0&&this.type===oM&&S(te,N),te.needsUpdate=!1}_.needsUpdate=!1,n.setRenderTarget(j,T,k)};function S(P,D){const N=e.update(y);f.defines.VSM_SAMPLES!==P.blurSamples&&(f.defines.VSM_SAMPLES=P.blurSamples,v.defines.VSM_SAMPLES=P.blurSamples,f.needsUpdate=!0,v.needsUpdate=!0),P.mapPass===null&&(P.mapPass=new Ai(i.x,i.y)),f.uniforms.shadow_pass.value=P.map.texture,f.uniforms.resolution.value=P.mapSize,f.uniforms.radius.value=P.radius,n.setRenderTarget(P.mapPass),n.clear(),n.renderBufferDirect(D,null,N,f,y,null),v.uniforms.shadow_pass.value=P.mapPass.texture,v.uniforms.resolution.value=P.mapSize,v.uniforms.radius.value=P.radius,n.setRenderTarget(P.map),n.clear(),n.renderBufferDirect(D,null,N,v,y,null)}function C(P,D,N,j,T,k){let U=null;const ee=N.isPointLight===!0?P.customDistanceMaterial:P.customDepthMaterial;if(ee!==void 0?U=ee:U=N.isPointLight===!0?c:a,n.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0){const xe=U.uuid,ce=D.uuid;let te=u[xe];te===void 0&&(te={},u[xe]=te);let fe=te[ce];fe===void 0&&(fe=U.clone(),te[ce]=fe),U=fe}return U.visible=D.visible,U.wireframe=D.wireframe,k===oM?U.side=D.shadowSide!==null?D.shadowSide:D.side:U.side=D.shadowSide!==null?D.shadowSide:p[D.side],U.alphaMap=D.alphaMap,U.alphaTest=D.alphaTest,U.clipShadows=D.clipShadows,U.clippingPlanes=D.clippingPlanes,U.clipIntersection=D.clipIntersection,U.displacementMap=D.displacementMap,U.displacementScale=D.displacementScale,U.displacementBias=D.displacementBias,U.wireframeLinewidth=D.wireframeLinewidth,U.linewidth=D.linewidth,N.isPointLight===!0&&U.isMeshDistanceMaterial===!0&&(U.referencePosition.setFromMatrixPosition(N.matrixWorld),U.nearDistance=j,U.farDistance=T),U}function A(P,D,N,j,T){if(P.visible===!1)return;if(P.layers.test(D.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&T===oM)&&(!P.frustumCulled||r.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,P.matrixWorld);const ee=e.update(P),xe=P.material;if(Array.isArray(xe)){const ce=ee.groups;for(let te=0,fe=ce.length;te<fe;te++){const ge=ce[te],Se=xe[ge.materialIndex];if(Se&&Se.visible){const pe=C(P,Se,j,N.near,N.far,T);n.renderBufferDirect(N,null,ee,pe,P,ge)}}}else if(xe.visible){const ce=C(P,xe,j,N.near,N.far,T);n.renderBufferDirect(N,null,ee,ce,P,null)}}const U=P.children;for(let ee=0,xe=U.length;ee<xe;ee++)A(U[ee],D,N,j,T)}}function lVe(n,e,t){const r=t.isWebGL2;function i(){let re=!1;const $e=new No;let Me=null;const tt=new No(0,0,0,0);return{setMask:function(Je){Me!==Je&&!re&&(n.colorMask(Je,Je,Je,Je),Me=Je)},setLocked:function(Je){re=Je},setClear:function(Je,Ft,vn,hn,zr){zr===!0&&(Je*=hn,Ft*=hn,vn*=hn),$e.set(Je,Ft,vn,hn),tt.equals($e)===!1&&(n.clearColor(Je,Ft,vn,hn),tt.copy($e))},reset:function(){re=!1,Me=null,tt.set(-1,0,0,0)}}}function s(){let re=!1,$e=null,Me=null,tt=null;return{setTest:function(Je){Je?Mt(2929):rt(2929)},setMask:function(Je){$e!==Je&&!re&&(n.depthMask(Je),$e=Je)},setFunc:function(Je){if(Me!==Je){if(Je)switch(Je){case DIe:n.depthFunc(512);break;case IIe:n.depthFunc(519);break;case NIe:n.depthFunc(513);break;case n8:n.depthFunc(515);break;case kIe:n.depthFunc(514);break;case zIe:n.depthFunc(518);break;case BIe:n.depthFunc(516);break;case VIe:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);Me=Je}},setLocked:function(Je){re=Je},setClear:function(Je){tt!==Je&&(n.clearDepth(Je),tt=Je)},reset:function(){re=!1,$e=null,Me=null,tt=null}}}function o(){let re=!1,$e=null,Me=null,tt=null,Je=null,Ft=null,vn=null,hn=null,zr=null;return{setTest:function(qt){re||(qt?Mt(2960):rt(2960))},setMask:function(qt){$e!==qt&&!re&&(n.stencilMask(qt),$e=qt)},setFunc:function(qt,xr,or){(Me!==qt||tt!==xr||Je!==or)&&(n.stencilFunc(qt,xr,or),Me=qt,tt=xr,Je=or)},setOp:function(qt,xr,or){(Ft!==qt||vn!==xr||hn!==or)&&(n.stencilOp(qt,xr,or),Ft=qt,vn=xr,hn=or)},setLocked:function(qt){re=qt},setClear:function(qt){zr!==qt&&(n.clearStencil(qt),zr=qt)},reset:function(){re=!1,$e=null,Me=null,tt=null,Je=null,Ft=null,vn=null,hn=null,zr=null}}}const a=new i,c=new s,u=new o,d=new WeakMap,p=new WeakMap;let f={},v={},x=new WeakMap,y=[],_=null,S=!1,C=null,A=null,P=null,D=null,N=null,j=null,T=null,k=!1,U=null,ee=null,xe=null,ce=null,te=null;const fe=n.getParameter(35661);let ge=!1,Se=0;const pe=n.getParameter(7938);pe.indexOf("WebGL")!==-1?(Se=parseFloat(/^WebGL (\d)/.exec(pe)[1]),ge=Se>=1):pe.indexOf("OpenGL ES")!==-1&&(Se=parseFloat(/^OpenGL ES (\d)/.exec(pe)[1]),ge=Se>=2);let se=null,ae={};const Le=n.getParameter(3088),Re=n.getParameter(2978),Ue=new No().fromArray(Le),Ze=new No().fromArray(Re);function st(re,$e,Me){const tt=new Uint8Array(4),Je=n.createTexture();n.bindTexture(re,Je),n.texParameteri(re,10241,9728),n.texParameteri(re,10240,9728);for(let Ft=0;Ft<Me;Ft++)n.texImage2D($e+Ft,0,6408,1,1,0,6408,5121,tt);return Je}const we={};we[3553]=st(3553,3553,1),we[34067]=st(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),u.setClear(0),Mt(2929),c.setFunc(n8),De(!1),je(BZ),Mt(2884),ve(zs);function Mt(re){f[re]!==!0&&(n.enable(re),f[re]=!0)}function rt(re){f[re]!==!1&&(n.disable(re),f[re]=!1)}function it(re,$e){return v[re]!==$e?(n.bindFramebuffer(re,$e),v[re]=$e,r&&(re===36009&&(v[36160]=$e),re===36160&&(v[36009]=$e)),!0):!1}function Ke(re,$e){let Me=y,tt=!1;if(re)if(Me=x.get($e),Me===void 0&&(Me=[],x.set($e,Me)),re.isWebGLMultipleRenderTargets){const Je=re.texture;if(Me.length!==Je.length||Me[0]!==36064){for(let Ft=0,vn=Je.length;Ft<vn;Ft++)Me[Ft]=36064+Ft;Me.length=Je.length,tt=!0}}else Me[0]!==36064&&(Me[0]=36064,tt=!0);else Me[0]!==1029&&(Me[0]=1029,tt=!0);tt&&(t.isWebGL2?n.drawBuffers(Me):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Me))}function Qe(re){return _!==re?(n.useProgram(re),_=re,!0):!1}const Y={[dm]:32774,[CIe]:32778,[EIe]:32779};if(r)Y[UZ]=32775,Y[jZ]=32776;else{const re=e.get("EXT_blend_minmax");re!==null&&(Y[UZ]=re.MIN_EXT,Y[jZ]=re.MAX_EXT)}const K={[t8]:0,[AIe]:1,[PIe]:768,[Nae]:770,[LIe]:776,[Bae]:774,[zae]:772,[TIe]:769,[kae]:771,[OIe]:775,[RIe]:773};function ve(re,$e,Me,tt,Je,Ft,vn,hn){if(re===zs){S===!0&&(rt(3042),S=!1);return}if(S===!1&&(Mt(3042),S=!0),re!==e8){if(re!==C||hn!==k){if((A!==dm||N!==dm)&&(n.blendEquation(32774),A=dm,N=dm),hn)switch(re){case jy:n.blendFuncSeparate(1,771,1,771);break;case gO:n.blendFunc(1,1);break;case VZ:n.blendFuncSeparate(0,769,0,1);break;case FZ:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case jy:n.blendFuncSeparate(770,771,1,771);break;case gO:n.blendFunc(770,1);break;case VZ:n.blendFuncSeparate(0,769,0,1);break;case FZ:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}P=null,D=null,j=null,T=null,C=re,k=hn}return}Je=Je||$e,Ft=Ft||Me,vn=vn||tt,($e!==A||Je!==N)&&(n.blendEquationSeparate(Y[$e],Y[Je]),A=$e,N=Je),(Me!==P||tt!==D||Ft!==j||vn!==T)&&(n.blendFuncSeparate(K[Me],K[tt],K[Ft],K[vn]),P=Me,D=tt,j=Ft,T=vn),C=re,k=null}function Ae(re,$e){re.side===Uh?rt(2884):Mt(2884);let Me=re.side===Sc;$e&&(Me=!Me),De(Me),re.blending===jy&&re.transparent===!1?ve(zs):ve(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.premultipliedAlpha),c.setFunc(re.depthFunc),c.setTest(re.depthTest),c.setMask(re.depthWrite),a.setMask(re.colorWrite);const tt=re.stencilWrite;u.setTest(tt),tt&&(u.setMask(re.stencilWriteMask),u.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),u.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),He(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?Mt(32926):rt(32926)}function De(re){U!==re&&(re?n.frontFace(2304):n.frontFace(2305),U=re)}function je(re){re!==SIe?(Mt(2884),re!==ee&&(re===BZ?n.cullFace(1029):re===MIe?n.cullFace(1028):n.cullFace(1032))):rt(2884),ee=re}function Xe(re){re!==xe&&(ge&&n.lineWidth(re),xe=re)}function He(re,$e,Me){re?(Mt(32823),(ce!==$e||te!==Me)&&(n.polygonOffset($e,Me),ce=$e,te=Me)):rt(32823)}function ne(re){re?Mt(3089):rt(3089)}function W(re){re===void 0&&(re=33984+fe-1),se!==re&&(n.activeTexture(re),se=re)}function O(re,$e){se===null&&W();let Me=ae[se];Me===void 0&&(Me={type:void 0,texture:void 0},ae[se]=Me),(Me.type!==re||Me.texture!==$e)&&(n.bindTexture(re,$e||we[re]),Me.type=re,Me.texture=$e)}function E(){const re=ae[se];re!==void 0&&re.type!==void 0&&(n.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function F(){try{n.compressedTexImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function z(){try{n.texSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Z(){try{n.texSubImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function de(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function be(){try{n.texStorage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function oe(){try{n.texStorage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ze(){try{n.texImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ke(){try{n.texImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Fe(re){Ue.equals(re)===!1&&(n.scissor(re.x,re.y,re.z,re.w),Ue.copy(re))}function Ge(re){Ze.equals(re)===!1&&(n.viewport(re.x,re.y,re.z,re.w),Ze.copy(re))}function at(re,$e){let Me=p.get($e);Me===void 0&&(Me=new WeakMap,p.set($e,Me));let tt=Me.get(re);tt===void 0&&(tt=n.getUniformBlockIndex($e,re.name),Me.set(re,tt))}function pt(re,$e){const tt=p.get($e).get(re);d.get(re)!==tt&&(n.uniformBlockBinding($e,tt,re.__bindingPointIndex),d.set(re,tt))}function Dt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),r===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),f={},se=null,ae={},v={},x=new WeakMap,y=[],_=null,S=!1,C=null,A=null,P=null,D=null,N=null,j=null,T=null,k=!1,U=null,ee=null,xe=null,ce=null,te=null,Ue.set(0,0,n.canvas.width,n.canvas.height),Ze.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),u.reset()}return{buffers:{color:a,depth:c,stencil:u},enable:Mt,disable:rt,bindFramebuffer:it,drawBuffers:Ke,useProgram:Qe,setBlending:ve,setMaterial:Ae,setFlipSided:De,setCullFace:je,setLineWidth:Xe,setPolygonOffset:He,setScissorTest:ne,activeTexture:W,bindTexture:O,unbindTexture:E,compressedTexImage2D:F,texImage2D:ze,texImage3D:ke,updateUBOMapping:at,uniformBlockBinding:pt,texStorage2D:be,texStorage3D:oe,texSubImage2D:z,texSubImage3D:Z,compressedTexSubImage2D:de,scissor:Fe,viewport:Ge,reset:Dt}}function cVe(n,e,t,r,i,s,o){const a=i.isWebGL2,c=i.maxTextures,u=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let y;const _=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function C(O,E){return S?new OffscreenCanvas(O,E):pC("canvas")}function A(O,E,F,z){let Z=1;if((O.width>z||O.height>z)&&(Z=z/Math.max(O.width,O.height)),Z<1||E===!0)if(typeof HTMLImageElement<"u"&&O instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&O instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&O instanceof ImageBitmap){const de=E?wO:Math.floor,be=de(Z*O.width),oe=de(Z*O.height);y===void 0&&(y=C(be,oe));const ze=F?C(be,oe):y;return ze.width=be,ze.height=oe,ze.getContext("2d").drawImage(O,0,0,be,oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+O.width+"x"+O.height+") to ("+be+"x"+oe+")."),ze}else return"data"in O&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+O.width+"x"+O.height+")."),O;return O}function P(O){return c8(O.width)&&c8(O.height)}function D(O){return a?!1:O.wrapS!==vc||O.wrapT!==vc||O.minFilter!==ds&&O.minFilter!==Us}function N(O,E){return O.generateMipmaps&&E&&O.minFilter!==ds&&O.minFilter!==Us}function j(O){n.generateMipmap(O)}function T(O,E,F,z,Z=!1){if(a===!1)return E;if(O!==null){if(n[O]!==void 0)return n[O];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+O+"'")}let de=E;return E===6403&&(F===5126&&(de=33326),F===5131&&(de=33325),F===5121&&(de=33321)),E===33319&&(F===5126&&(de=33328),F===5131&&(de=33327),F===5121&&(de=33323)),E===6408&&(F===5126&&(de=34836),F===5131&&(de=34842),F===5121&&(de=z===os&&Z===!1?35907:32856),F===32819&&(de=32854),F===32820&&(de=32855)),(de===33325||de===33326||de===33327||de===33328||de===34842||de===34836)&&e.get("EXT_color_buffer_float"),de}function k(O,E,F){return N(O,F)===!0||O.isFramebufferTexture&&O.minFilter!==ds&&O.minFilter!==Us?Math.log2(Math.max(E.width,E.height))+1:O.mipmaps!==void 0&&O.mipmaps.length>0?O.mipmaps.length:O.isCompressedTexture&&Array.isArray(O.image)?E.mipmaps.length:1}function U(O){return O===ds||O===HZ||O===WZ?9728:9729}function ee(O){const E=O.target;E.removeEventListener("dispose",ee),ce(E),E.isVideoTexture&&x.delete(E)}function xe(O){const E=O.target;E.removeEventListener("dispose",xe),fe(E)}function ce(O){const E=r.get(O);if(E.__webglInit===void 0)return;const F=O.source,z=_.get(F);if(z){const Z=z[E.__cacheKey];Z.usedTimes--,Z.usedTimes===0&&te(O),Object.keys(z).length===0&&_.delete(F)}r.remove(O)}function te(O){const E=r.get(O);n.deleteTexture(E.__webglTexture);const F=O.source,z=_.get(F);delete z[E.__cacheKey],o.memory.textures--}function fe(O){const E=O.texture,F=r.get(O),z=r.get(E);if(z.__webglTexture!==void 0&&(n.deleteTexture(z.__webglTexture),o.memory.textures--),O.depthTexture&&O.depthTexture.dispose(),O.isWebGLCubeRenderTarget)for(let Z=0;Z<6;Z++)n.deleteFramebuffer(F.__webglFramebuffer[Z]),F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer[Z]);else{if(n.deleteFramebuffer(F.__webglFramebuffer),F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer),F.__webglMultisampledFramebuffer&&n.deleteFramebuffer(F.__webglMultisampledFramebuffer),F.__webglColorRenderbuffer)for(let Z=0;Z<F.__webglColorRenderbuffer.length;Z++)F.__webglColorRenderbuffer[Z]&&n.deleteRenderbuffer(F.__webglColorRenderbuffer[Z]);F.__webglDepthRenderbuffer&&n.deleteRenderbuffer(F.__webglDepthRenderbuffer)}if(O.isWebGLMultipleRenderTargets)for(let Z=0,de=E.length;Z<de;Z++){const be=r.get(E[Z]);be.__webglTexture&&(n.deleteTexture(be.__webglTexture),o.memory.textures--),r.remove(E[Z])}r.remove(E),r.remove(O)}let ge=0;function Se(){ge=0}function pe(){const O=ge;return O>=c&&console.warn("THREE.WebGLTextures: Trying to use "+O+" texture units while this GPU supports only "+c),ge+=1,O}function se(O){const E=[];return E.push(O.wrapS),E.push(O.wrapT),E.push(O.magFilter),E.push(O.minFilter),E.push(O.anisotropy),E.push(O.internalFormat),E.push(O.format),E.push(O.type),E.push(O.generateMipmaps),E.push(O.premultiplyAlpha),E.push(O.flipY),E.push(O.unpackAlignment),E.push(O.encoding),E.join()}function ae(O,E){const F=r.get(O);if(O.isVideoTexture&&ne(O),O.isRenderTargetTexture===!1&&O.version>0&&F.__version!==O.version){const z=O.image;if(z===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(z.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{rt(F,O,E);return}}t.activeTexture(33984+E),t.bindTexture(3553,F.__webglTexture)}function Le(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){rt(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(35866,F.__webglTexture)}function Re(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){rt(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(32879,F.__webglTexture)}function Ue(O,E){const F=r.get(O);if(O.version>0&&F.__version!==O.version){it(F,O,E);return}t.activeTexture(33984+E),t.bindTexture(34067,F.__webglTexture)}const Ze={[Tx]:10497,[vc]:33071,[i8]:33648},st={[ds]:9728,[HZ]:9984,[WZ]:9986,[Us]:9729,[XIe]:9985,[tE]:9987};function we(O,E,F){if(F?(n.texParameteri(O,10242,Ze[E.wrapS]),n.texParameteri(O,10243,Ze[E.wrapT]),(O===32879||O===35866)&&n.texParameteri(O,32882,Ze[E.wrapR]),n.texParameteri(O,10240,st[E.magFilter]),n.texParameteri(O,10241,st[E.minFilter])):(n.texParameteri(O,10242,33071),n.texParameteri(O,10243,33071),(O===32879||O===35866)&&n.texParameteri(O,32882,33071),(E.wrapS!==vc||E.wrapT!==vc)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(O,10240,U(E.magFilter)),n.texParameteri(O,10241,U(E.minFilter)),E.minFilter!==ds&&E.minFilter!==Us&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");if(E.type===jh&&e.has("OES_texture_float_linear")===!1||a===!1&&E.type===Ip&&e.has("OES_texture_half_float_linear")===!1)return;(E.anisotropy>1||r.get(E).__currentAnisotropy)&&(n.texParameterf(O,z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,i.getMaxAnisotropy())),r.get(E).__currentAnisotropy=E.anisotropy)}}function Mt(O,E){let F=!1;O.__webglInit===void 0&&(O.__webglInit=!0,E.addEventListener("dispose",ee));const z=E.source;let Z=_.get(z);Z===void 0&&(Z={},_.set(z,Z));const de=se(E);if(de!==O.__cacheKey){Z[de]===void 0&&(Z[de]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,F=!0),Z[de].usedTimes++;const be=Z[O.__cacheKey];be!==void 0&&(Z[O.__cacheKey].usedTimes--,be.usedTimes===0&&te(E)),O.__cacheKey=de,O.__webglTexture=Z[de].texture}return F}function rt(O,E,F){let z=3553;E.isDataArrayTexture&&(z=35866),E.isData3DTexture&&(z=32879);const Z=Mt(O,E),de=E.source;if(t.activeTexture(33984+F),t.bindTexture(z,O.__webglTexture),de.version!==de.__currentVersion||Z===!0){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const be=D(E)&&P(E.image)===!1;let oe=A(E.image,be,!1,d);oe=W(E,oe);const ze=P(oe)||a,ke=s.convert(E.format,E.encoding);let Fe=s.convert(E.type),Ge=T(E.internalFormat,ke,Fe,E.encoding,E.isVideoTexture);we(z,E,ze);let at;const pt=E.mipmaps,Dt=a&&E.isVideoTexture!==!0,re=de.__currentVersion===void 0||Z===!0,$e=k(E,oe,ze);if(E.isDepthTexture)Ge=6402,a?E.type===jh?Ge=36012:E.type===$g?Ge=33190:E.type===Hy?Ge=35056:Ge=33189:E.type===jh&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===c0&&Ge===6402&&E.type!==VH&&E.type!==$g&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=$g,Fe=s.convert(E.type)),E.format===Rx&&Ge===6402&&(Ge=34041,E.type!==Hy&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=Hy,Fe=s.convert(E.type))),re&&(Dt?t.texStorage2D(3553,1,Ge,oe.width,oe.height):t.texImage2D(3553,0,Ge,oe.width,oe.height,0,ke,Fe,null));else if(E.isDataTexture)if(pt.length>0&&ze){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],Dt?t.texSubImage2D(3553,Me,0,0,at.width,at.height,ke,Fe,at.data):t.texImage2D(3553,Me,Ge,at.width,at.height,0,ke,Fe,at.data);E.generateMipmaps=!1}else Dt?(re&&t.texStorage2D(3553,$e,Ge,oe.width,oe.height),t.texSubImage2D(3553,0,0,0,oe.width,oe.height,ke,Fe,oe.data)):t.texImage2D(3553,0,Ge,oe.width,oe.height,0,ke,Fe,oe.data);else if(E.isCompressedTexture){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],E.format!==Hh?ke!==null?Dt?t.compressedTexSubImage2D(3553,Me,0,0,at.width,at.height,ke,at.data):t.compressedTexImage2D(3553,Me,Ge,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Dt?t.texSubImage2D(3553,Me,0,0,at.width,at.height,ke,Fe,at.data):t.texImage2D(3553,Me,Ge,at.width,at.height,0,ke,Fe,at.data)}else if(E.isDataArrayTexture)Dt?(re&&t.texStorage3D(35866,$e,Ge,oe.width,oe.height,oe.depth),t.texSubImage3D(35866,0,0,0,0,oe.width,oe.height,oe.depth,ke,Fe,oe.data)):t.texImage3D(35866,0,Ge,oe.width,oe.height,oe.depth,0,ke,Fe,oe.data);else if(E.isData3DTexture)Dt?(re&&t.texStorage3D(32879,$e,Ge,oe.width,oe.height,oe.depth),t.texSubImage3D(32879,0,0,0,0,oe.width,oe.height,oe.depth,ke,Fe,oe.data)):t.texImage3D(32879,0,Ge,oe.width,oe.height,oe.depth,0,ke,Fe,oe.data);else if(E.isFramebufferTexture){if(re)if(Dt)t.texStorage2D(3553,$e,Ge,oe.width,oe.height);else{let Me=oe.width,tt=oe.height;for(let Je=0;Je<$e;Je++)t.texImage2D(3553,Je,Ge,Me,tt,0,ke,Fe,null),Me>>=1,tt>>=1}}else if(pt.length>0&&ze){Dt&&re&&t.texStorage2D(3553,$e,Ge,pt[0].width,pt[0].height);for(let Me=0,tt=pt.length;Me<tt;Me++)at=pt[Me],Dt?t.texSubImage2D(3553,Me,0,0,ke,Fe,at):t.texImage2D(3553,Me,Ge,ke,Fe,at);E.generateMipmaps=!1}else Dt?(re&&t.texStorage2D(3553,$e,Ge,oe.width,oe.height),t.texSubImage2D(3553,0,0,0,ke,Fe,oe)):t.texImage2D(3553,0,Ge,ke,Fe,oe);N(E,ze)&&j(z),de.__currentVersion=de.version,E.onUpdate&&E.onUpdate(E)}O.__version=E.version}function it(O,E,F){if(E.image.length!==6)return;const z=Mt(O,E),Z=E.source;if(t.activeTexture(33984+F),t.bindTexture(34067,O.__webglTexture),Z.version!==Z.__currentVersion||z===!0){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const de=E.isCompressedTexture||E.image[0].isCompressedTexture,be=E.image[0]&&E.image[0].isDataTexture,oe=[];for(let Me=0;Me<6;Me++)!de&&!be?oe[Me]=A(E.image[Me],!1,!0,u):oe[Me]=be?E.image[Me].image:E.image[Me],oe[Me]=W(E,oe[Me]);const ze=oe[0],ke=P(ze)||a,Fe=s.convert(E.format,E.encoding),Ge=s.convert(E.type),at=T(E.internalFormat,Fe,Ge,E.encoding),pt=a&&E.isVideoTexture!==!0,Dt=Z.__currentVersion===void 0||z===!0;let re=k(E,ze,ke);we(34067,E,ke);let $e;if(de){pt&&Dt&&t.texStorage2D(34067,re,at,ze.width,ze.height);for(let Me=0;Me<6;Me++){$e=oe[Me].mipmaps;for(let tt=0;tt<$e.length;tt++){const Je=$e[tt];E.format!==Hh?Fe!==null?pt?t.compressedTexSubImage2D(34069+Me,tt,0,0,Je.width,Je.height,Fe,Je.data):t.compressedTexImage2D(34069+Me,tt,at,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?t.texSubImage2D(34069+Me,tt,0,0,Je.width,Je.height,Fe,Ge,Je.data):t.texImage2D(34069+Me,tt,at,Je.width,Je.height,0,Fe,Ge,Je.data)}}}else{$e=E.mipmaps,pt&&Dt&&($e.length>0&&re++,t.texStorage2D(34067,re,at,oe[0].width,oe[0].height));for(let Me=0;Me<6;Me++)if(be){pt?t.texSubImage2D(34069+Me,0,0,0,oe[Me].width,oe[Me].height,Fe,Ge,oe[Me].data):t.texImage2D(34069+Me,0,at,oe[Me].width,oe[Me].height,0,Fe,Ge,oe[Me].data);for(let tt=0;tt<$e.length;tt++){const Ft=$e[tt].image[Me].image;pt?t.texSubImage2D(34069+Me,tt+1,0,0,Ft.width,Ft.height,Fe,Ge,Ft.data):t.texImage2D(34069+Me,tt+1,at,Ft.width,Ft.height,0,Fe,Ge,Ft.data)}}else{pt?t.texSubImage2D(34069+Me,0,0,0,Fe,Ge,oe[Me]):t.texImage2D(34069+Me,0,at,Fe,Ge,oe[Me]);for(let tt=0;tt<$e.length;tt++){const Je=$e[tt];pt?t.texSubImage2D(34069+Me,tt+1,0,0,Fe,Ge,Je.image[Me]):t.texImage2D(34069+Me,tt+1,at,Fe,Ge,Je.image[Me])}}}N(E,ke)&&j(34067),Z.__currentVersion=Z.version,E.onUpdate&&E.onUpdate(E)}O.__version=E.version}function Ke(O,E,F,z,Z){const de=s.convert(F.format,F.encoding),be=s.convert(F.type),oe=T(F.internalFormat,de,be,F.encoding);r.get(E).__hasExternalTextures||(Z===32879||Z===35866?t.texImage3D(Z,0,oe,E.width,E.height,E.depth,0,de,be,null):t.texImage2D(Z,0,oe,E.width,E.height,0,de,be,null)),t.bindFramebuffer(36160,O),He(E)?f.framebufferTexture2DMultisampleEXT(36160,z,Z,r.get(F).__webglTexture,0,Xe(E)):n.framebufferTexture2D(36160,z,Z,r.get(F).__webglTexture,0),t.bindFramebuffer(36160,null)}function Qe(O,E,F){if(n.bindRenderbuffer(36161,O),E.depthBuffer&&!E.stencilBuffer){let z=33189;if(F||He(E)){const Z=E.depthTexture;Z&&Z.isDepthTexture&&(Z.type===jh?z=36012:Z.type===$g&&(z=33190));const de=Xe(E);He(E)?f.renderbufferStorageMultisampleEXT(36161,de,z,E.width,E.height):n.renderbufferStorageMultisample(36161,de,z,E.width,E.height)}else n.renderbufferStorage(36161,z,E.width,E.height);n.framebufferRenderbuffer(36160,36096,36161,O)}else if(E.depthBuffer&&E.stencilBuffer){const z=Xe(E);F&&He(E)===!1?n.renderbufferStorageMultisample(36161,z,35056,E.width,E.height):He(E)?f.renderbufferStorageMultisampleEXT(36161,z,35056,E.width,E.height):n.renderbufferStorage(36161,34041,E.width,E.height),n.framebufferRenderbuffer(36160,33306,36161,O)}else{const z=E.isWebGLMultipleRenderTargets===!0?E.texture:[E.texture];for(let Z=0;Z<z.length;Z++){const de=z[Z],be=s.convert(de.format,de.encoding),oe=s.convert(de.type),ze=T(de.internalFormat,be,oe,de.encoding),ke=Xe(E);F&&He(E)===!1?n.renderbufferStorageMultisample(36161,ke,ze,E.width,E.height):He(E)?f.renderbufferStorageMultisampleEXT(36161,ke,ze,E.width,E.height):n.renderbufferStorage(36161,ze,E.width,E.height)}}n.bindRenderbuffer(36161,null)}function Y(O,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,O),!(E.depthTexture&&E.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),ae(E.depthTexture,0);const z=r.get(E.depthTexture).__webglTexture,Z=Xe(E);if(E.depthTexture.format===c0)He(E)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,z,0,Z):n.framebufferTexture2D(36160,36096,3553,z,0);else if(E.depthTexture.format===Rx)He(E)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,z,0,Z):n.framebufferTexture2D(36160,33306,3553,z,0);else throw new Error("Unknown depthTexture format")}function K(O){const E=r.get(O),F=O.isWebGLCubeRenderTarget===!0;if(O.depthTexture&&!E.__autoAllocateDepthBuffer){if(F)throw new Error("target.depthTexture not supported in Cube render targets");Y(E.__webglFramebuffer,O)}else if(F){E.__webglDepthbuffer=[];for(let z=0;z<6;z++)t.bindFramebuffer(36160,E.__webglFramebuffer[z]),E.__webglDepthbuffer[z]=n.createRenderbuffer(),Qe(E.__webglDepthbuffer[z],O,!1)}else t.bindFramebuffer(36160,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),Qe(E.__webglDepthbuffer,O,!1);t.bindFramebuffer(36160,null)}function ve(O,E,F){const z=r.get(O);E!==void 0&&Ke(z.__webglFramebuffer,O,O.texture,36064,3553),F!==void 0&&K(O)}function Ae(O){const E=O.texture,F=r.get(O),z=r.get(E);O.addEventListener("dispose",xe),O.isWebGLMultipleRenderTargets!==!0&&(z.__webglTexture===void 0&&(z.__webglTexture=n.createTexture()),z.__version=E.version,o.memory.textures++);const Z=O.isWebGLCubeRenderTarget===!0,de=O.isWebGLMultipleRenderTargets===!0,be=P(O)||a;if(Z){F.__webglFramebuffer=[];for(let oe=0;oe<6;oe++)F.__webglFramebuffer[oe]=n.createFramebuffer()}else{if(F.__webglFramebuffer=n.createFramebuffer(),de)if(i.drawBuffers){const oe=O.texture;for(let ze=0,ke=oe.length;ze<ke;ze++){const Fe=r.get(oe[ze]);Fe.__webglTexture===void 0&&(Fe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&O.samples>0&&He(O)===!1){const oe=de?E:[E];F.__webglMultisampledFramebuffer=n.createFramebuffer(),F.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,F.__webglMultisampledFramebuffer);for(let ze=0;ze<oe.length;ze++){const ke=oe[ze];F.__webglColorRenderbuffer[ze]=n.createRenderbuffer(),n.bindRenderbuffer(36161,F.__webglColorRenderbuffer[ze]);const Fe=s.convert(ke.format,ke.encoding),Ge=s.convert(ke.type),at=T(ke.internalFormat,Fe,Ge,ke.encoding),pt=Xe(O);n.renderbufferStorageMultisample(36161,pt,at,O.width,O.height),n.framebufferRenderbuffer(36160,36064+ze,36161,F.__webglColorRenderbuffer[ze])}n.bindRenderbuffer(36161,null),O.depthBuffer&&(F.__webglDepthRenderbuffer=n.createRenderbuffer(),Qe(F.__webglDepthRenderbuffer,O,!0)),t.bindFramebuffer(36160,null)}}if(Z){t.bindTexture(34067,z.__webglTexture),we(34067,E,be);for(let oe=0;oe<6;oe++)Ke(F.__webglFramebuffer[oe],O,E,36064,34069+oe);N(E,be)&&j(34067),t.unbindTexture()}else if(de){const oe=O.texture;for(let ze=0,ke=oe.length;ze<ke;ze++){const Fe=oe[ze],Ge=r.get(Fe);t.bindTexture(3553,Ge.__webglTexture),we(3553,Fe,be),Ke(F.__webglFramebuffer,O,Fe,36064+ze,3553),N(Fe,be)&&j(3553)}t.unbindTexture()}else{let oe=3553;(O.isWebGL3DRenderTarget||O.isWebGLArrayRenderTarget)&&(a?oe=O.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(oe,z.__webglTexture),we(oe,E,be),Ke(F.__webglFramebuffer,O,E,36064,oe),N(E,be)&&j(oe),t.unbindTexture()}O.depthBuffer&&K(O)}function De(O){const E=P(O)||a,F=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let z=0,Z=F.length;z<Z;z++){const de=F[z];if(N(de,E)){const be=O.isWebGLCubeRenderTarget?34067:3553,oe=r.get(de).__webglTexture;t.bindTexture(be,oe),j(be),t.unbindTexture()}}}function je(O){if(a&&O.samples>0&&He(O)===!1){const E=O.isWebGLMultipleRenderTargets?O.texture:[O.texture],F=O.width,z=O.height;let Z=16384;const de=[],be=O.stencilBuffer?33306:36096,oe=r.get(O),ze=O.isWebGLMultipleRenderTargets===!0;if(ze)for(let ke=0;ke<E.length;ke++)t.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ke,36161,null),t.bindFramebuffer(36160,oe.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ke,3553,null,0);t.bindFramebuffer(36008,oe.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,oe.__webglFramebuffer);for(let ke=0;ke<E.length;ke++){de.push(36064+ke),O.depthBuffer&&de.push(be);const Fe=oe.__ignoreDepthValues!==void 0?oe.__ignoreDepthValues:!1;if(Fe===!1&&(O.depthBuffer&&(Z|=256),O.stencilBuffer&&(Z|=1024)),ze&&n.framebufferRenderbuffer(36008,36064,36161,oe.__webglColorRenderbuffer[ke]),Fe===!0&&(n.invalidateFramebuffer(36008,[be]),n.invalidateFramebuffer(36009,[be])),ze){const Ge=r.get(E[ke]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ge,0)}n.blitFramebuffer(0,0,F,z,0,0,F,z,Z,9728),v&&n.invalidateFramebuffer(36008,de)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ze)for(let ke=0;ke<E.length;ke++){t.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ke,36161,oe.__webglColorRenderbuffer[ke]);const Fe=r.get(E[ke]).__webglTexture;t.bindFramebuffer(36160,oe.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ke,3553,Fe,0)}t.bindFramebuffer(36009,oe.__webglMultisampledFramebuffer)}}function Xe(O){return Math.min(p,O.samples)}function He(O){const E=r.get(O);return a&&O.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&E.__useRenderToTexture!==!1}function ne(O){const E=o.render.frame;x.get(O)!==E&&(x.set(O,E),O.update())}function W(O,E){const F=O.encoding,z=O.format,Z=O.type;return O.isCompressedTexture===!0||O.isVideoTexture===!0||O.format===l8||F!==Nm&&(F===os?a===!1?e.has("EXT_sRGB")===!0&&z===Hh?(O.format=l8,O.minFilter=Us,O.generateMipmaps=!1):E=Gae.sRGBToLinear(E):(z!==Hh||Z!==w0)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",F)),E}this.allocateTextureUnit=pe,this.resetTextureUnits=Se,this.setTexture2D=ae,this.setTexture2DArray=Le,this.setTexture3D=Re,this.setTextureCube=Ue,this.rebindTextures=ve,this.setupRenderTarget=Ae,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=je,this.setupDepthRenderbuffer=K,this.setupFrameBufferTexture=Ke,this.useMultisampledRTT=He}function uVe(n,e,t){const r=t.isWebGL2;function i(s,o=null){let a;if(s===w0)return 5121;if(s===KIe)return 32819;if(s===JIe)return 32820;if(s===qIe)return 5120;if(s===YIe)return 5122;if(s===VH)return 5123;if(s===ZIe)return 5124;if(s===$g)return 5125;if(s===jh)return 5126;if(s===Ip)return r?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===QIe)return 6406;if(s===Hh)return 6408;if(s===eNe)return 6409;if(s===tNe)return 6410;if(s===c0)return 6402;if(s===Rx)return 34041;if(s===nNe)return 6403;if(s===$Ie)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===l8)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===rNe)return 36244;if(s===iNe)return 33319;if(s===sNe)return 33320;if(s===oNe)return 36249;if(s===TV||s===RV||s===OV||s===LV)if(o===os)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===TV)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===RV)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===OV)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===LV)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===TV)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===RV)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===OV)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===LV)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===GZ||s===XZ||s===qZ||s===YZ)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===GZ)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===XZ)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===qZ)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===YZ)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===aNe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===ZZ||s===KZ)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===ZZ)return o===os?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===KZ)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===JZ||s===QZ||s===$Z||s===eK||s===tK||s===nK||s===rK||s===iK||s===sK||s===oK||s===aK||s===lK||s===cK||s===uK)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===JZ)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===QZ)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===$Z)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===eK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===tK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===nK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===rK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===iK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===sK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===oK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===aK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===lK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===cK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===uK)return o===os?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===hK)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===hK)return o===os?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===Hy?r?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class hVe extends al{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class kp extends Qi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const dVe={type:"move"};class oF{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new kp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new kp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Te),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new kp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Te),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,c=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const y of e.hand.values()){const _=t.getJointPose(y,r);if(u.joints[y.jointName]===void 0){const C=new kp;C.matrixAutoUpdate=!1,C.visible=!1,u.joints[y.jointName]=C,u.add(C)}const S=u.joints[y.jointName];_!==null&&(S.matrix.fromArray(_.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=_.radius),S.visible=_!==null}const d=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],f=d.position.distanceTo(p.position),v=.02,x=.005;u.inputState.pinching&&f>v+x?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&f<=v-x&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(dVe)))}return a!==null&&(a.visible=i!==null),c!==null&&(c.visible=s!==null),u!==null&&(u.visible=o!==null),this}}class tle extends ka{constructor(e,t,r,i,s,o,a,c,u,d){if(d=d!==void 0?d:c0,d!==c0&&d!==Rx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===c0&&(r=$g),r===void 0&&d===Rx&&(r=Hy),super(null,i,s,o,a,c,d,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ds,this.minFilter=c!==void 0?c:ds,this.flipY=!1,this.generateMipmaps=!1}}class pVe extends V0{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",c=null,u=null,d=null,p=null,f=null,v=null;const x=t.getContextAttributes();let y=null,_=null;const S=[],C=[],A=new al;A.layers.enable(1),A.viewport=new No;const P=new al;P.layers.enable(2),P.viewport=new No;const D=[A,P],N=new hVe;N.layers.enable(1),N.layers.enable(2);let j=null,T=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let ae=S[se];return ae===void 0&&(ae=new oF,S[se]=ae),ae.getTargetRaySpace()},this.getControllerGrip=function(se){let ae=S[se];return ae===void 0&&(ae=new oF,S[se]=ae),ae.getGripSpace()},this.getHand=function(se){let ae=S[se];return ae===void 0&&(ae=new oF,S[se]=ae),ae.getHandSpace()};function k(se){const ae=C.indexOf(se.inputSource);if(ae===-1)return;const Le=S[ae];Le!==void 0&&Le.dispatchEvent({type:se.type,data:se.inputSource})}function U(){i.removeEventListener("select",k),i.removeEventListener("selectstart",k),i.removeEventListener("selectend",k),i.removeEventListener("squeeze",k),i.removeEventListener("squeezestart",k),i.removeEventListener("squeezeend",k),i.removeEventListener("end",U),i.removeEventListener("inputsourceschange",ee);for(let se=0;se<S.length;se++){const ae=C[se];ae!==null&&(C[se]=null,S[se].disconnect(ae))}j=null,T=null,e.setRenderTarget(y),f=null,p=null,d=null,i=null,_=null,pe.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){s=se,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){a=se,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(se){c=se},this.getBaseLayer=function(){return p!==null?p:f},this.getBinding=function(){return d},this.getFrame=function(){return v},this.getSession=function(){return i},this.setSession=async function(se){if(i=se,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",k),i.addEventListener("selectstart",k),i.addEventListener("selectend",k),i.addEventListener("squeeze",k),i.addEventListener("squeezestart",k),i.addEventListener("squeezeend",k),i.addEventListener("end",U),i.addEventListener("inputsourceschange",ee),x.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ae={antialias:i.renderState.layers===void 0?x.antialias:!0,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,ae),i.updateRenderState({baseLayer:f}),_=new Ai(f.framebufferWidth,f.framebufferHeight,{format:Hh,type:w0,encoding:e.outputEncoding,stencilBuffer:x.stencil})}else{let ae=null,Le=null,Re=null;x.depth&&(Re=x.stencil?35056:33190,ae=x.stencil?Rx:c0,Le=x.stencil?Hy:$g);const Ue={colorFormat:32856,depthFormat:Re,scaleFactor:s};d=new XRWebGLBinding(i,t),p=d.createProjectionLayer(Ue),i.updateRenderState({layers:[p]}),_=new Ai(p.textureWidth,p.textureHeight,{format:Hh,type:w0,depthTexture:new tle(p.textureWidth,p.textureHeight,Le,void 0,void 0,void 0,void 0,void 0,void 0,ae),stencilBuffer:x.stencil,encoding:e.outputEncoding,samples:x.antialias?4:0});const Ze=e.properties.get(_);Ze.__ignoreDepthValues=p.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(1),c=null,o=await i.requestReferenceSpace(a),pe.setContext(i),pe.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function ee(se){for(let ae=0;ae<se.removed.length;ae++){const Le=se.removed[ae],Re=C.indexOf(Le);Re>=0&&(C[Re]=null,S[Re].dispatchEvent({type:"disconnected",data:Le}))}for(let ae=0;ae<se.added.length;ae++){const Le=se.added[ae];let Re=C.indexOf(Le);if(Re===-1){for(let Ze=0;Ze<S.length;Ze++)if(Ze>=C.length){C.push(Le),Re=Ze;break}else if(C[Ze]===null){C[Ze]=Le,Re=Ze;break}if(Re===-1)break}const Ue=S[Re];Ue&&Ue.dispatchEvent({type:"connected",data:Le})}}const xe=new Te,ce=new Te;function te(se,ae,Le){xe.setFromMatrixPosition(ae.matrixWorld),ce.setFromMatrixPosition(Le.matrixWorld);const Re=xe.distanceTo(ce),Ue=ae.projectionMatrix.elements,Ze=Le.projectionMatrix.elements,st=Ue[14]/(Ue[10]-1),we=Ue[14]/(Ue[10]+1),Mt=(Ue[9]+1)/Ue[5],rt=(Ue[9]-1)/Ue[5],it=(Ue[8]-1)/Ue[0],Ke=(Ze[8]+1)/Ze[0],Qe=st*it,Y=st*Ke,K=Re/(-it+Ke),ve=K*-it;ae.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(ve),se.translateZ(K),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert();const Ae=st+K,De=we+K,je=Qe-ve,Xe=Y+(Re-ve),He=Mt*we/De*Ae,ne=rt*we/De*Ae;se.projectionMatrix.makePerspective(je,Xe,He,ne,Ae,De)}function fe(se,ae){ae===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(ae.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(i===null)return;N.near=P.near=A.near=se.near,N.far=P.far=A.far=se.far,(j!==N.near||T!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),j=N.near,T=N.far);const ae=se.parent,Le=N.cameras;fe(N,ae);for(let Ue=0;Ue<Le.length;Ue++)fe(Le[Ue],ae);N.matrixWorld.decompose(N.position,N.quaternion,N.scale),se.matrix.copy(N.matrix),se.matrix.decompose(se.position,se.quaternion,se.scale);const Re=se.children;for(let Ue=0,Ze=Re.length;Ue<Ze;Ue++)Re[Ue].updateMatrixWorld(!0);Le.length===2?te(N,A,P):N.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return N},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(f!==null)return f.fixedFoveation},this.setFoveation=function(se){p!==null&&(p.fixedFoveation=se),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=se)};let ge=null;function Se(se,ae){if(u=ae.getViewerPose(c||o),v=ae,u!==null){const Le=u.views;f!==null&&(e.setRenderTargetFramebuffer(_,f.framebuffer),e.setRenderTarget(_));let Re=!1;Le.length!==N.cameras.length&&(N.cameras.length=0,Re=!0);for(let Ue=0;Ue<Le.length;Ue++){const Ze=Le[Ue];let st=null;if(f!==null)st=f.getViewport(Ze);else{const Mt=d.getViewSubImage(p,Ze);st=Mt.viewport,Ue===0&&(e.setRenderTargetTextures(_,Mt.colorTexture,p.ignoreDepthValues?void 0:Mt.depthStencilTexture),e.setRenderTarget(_))}let we=D[Ue];we===void 0&&(we=new al,we.layers.enable(Ue),we.viewport=new No,D[Ue]=we),we.matrix.fromArray(Ze.transform.matrix),we.projectionMatrix.fromArray(Ze.projectionMatrix),we.viewport.set(st.x,st.y,st.width,st.height),Ue===0&&N.matrix.copy(we.matrix),Re===!0&&N.cameras.push(we)}}for(let Le=0;Le<S.length;Le++){const Re=C[Le],Ue=S[Le];Re!==null&&Ue!==void 0&&Ue.update(Re,ae,c||o)}ge&&ge(se,ae),v=null}const pe=new Kae;pe.setAnimationLoop(Se),this.setAnimationLoop=function(se){ge=se},this.dispose=function(){}}}function fVe(n,e){function t(y,_){y.fogColor.value.copy(_.color),_.isFog?(y.fogNear.value=_.near,y.fogFar.value=_.far):_.isFogExp2&&(y.fogDensity.value=_.density)}function r(y,_,S,C,A){_.isMeshBasicMaterial||_.isMeshLambertMaterial?i(y,_):_.isMeshToonMaterial?(i(y,_),d(y,_)):_.isMeshPhongMaterial?(i(y,_),u(y,_)):_.isMeshStandardMaterial?(i(y,_),p(y,_),_.isMeshPhysicalMaterial&&f(y,_,A)):_.isMeshMatcapMaterial?(i(y,_),v(y,_)):_.isMeshDepthMaterial?i(y,_):_.isMeshDistanceMaterial?(i(y,_),x(y,_)):_.isMeshNormalMaterial?i(y,_):_.isLineBasicMaterial?(s(y,_),_.isLineDashedMaterial&&o(y,_)):_.isPointsMaterial?a(y,_,S,C):_.isSpriteMaterial?c(y,_):_.isShadowMaterial?(y.color.value.copy(_.color),y.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function i(y,_){y.opacity.value=_.opacity,_.color&&y.diffuse.value.copy(_.color),_.emissive&&y.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.bumpMap&&(y.bumpMap.value=_.bumpMap,y.bumpScale.value=_.bumpScale,_.side===Sc&&(y.bumpScale.value*=-1)),_.displacementMap&&(y.displacementMap.value=_.displacementMap,y.displacementScale.value=_.displacementScale,y.displacementBias.value=_.displacementBias),_.emissiveMap&&(y.emissiveMap.value=_.emissiveMap),_.normalMap&&(y.normalMap.value=_.normalMap,y.normalScale.value.copy(_.normalScale),_.side===Sc&&y.normalScale.value.negate()),_.specularMap&&(y.specularMap.value=_.specularMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);const S=e.get(_).envMap;if(S&&(y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=_.reflectivity,y.ior.value=_.ior,y.refractionRatio.value=_.refractionRatio),_.lightMap){y.lightMap.value=_.lightMap;const P=n.physicallyCorrectLights!==!0?Math.PI:1;y.lightMapIntensity.value=_.lightMapIntensity*P}_.aoMap&&(y.aoMap.value=_.aoMap,y.aoMapIntensity.value=_.aoMapIntensity);let C;_.map?C=_.map:_.specularMap?C=_.specularMap:_.displacementMap?C=_.displacementMap:_.normalMap?C=_.normalMap:_.bumpMap?C=_.bumpMap:_.roughnessMap?C=_.roughnessMap:_.metalnessMap?C=_.metalnessMap:_.alphaMap?C=_.alphaMap:_.emissiveMap?C=_.emissiveMap:_.clearcoatMap?C=_.clearcoatMap:_.clearcoatNormalMap?C=_.clearcoatNormalMap:_.clearcoatRoughnessMap?C=_.clearcoatRoughnessMap:_.iridescenceMap?C=_.iridescenceMap:_.iridescenceThicknessMap?C=_.iridescenceThicknessMap:_.specularIntensityMap?C=_.specularIntensityMap:_.specularColorMap?C=_.specularColorMap:_.transmissionMap?C=_.transmissionMap:_.thicknessMap?C=_.thicknessMap:_.sheenColorMap?C=_.sheenColorMap:_.sheenRoughnessMap&&(C=_.sheenRoughnessMap),C!==void 0&&(C.isWebGLRenderTarget&&(C=C.texture),C.matrixAutoUpdate===!0&&C.updateMatrix(),y.uvTransform.value.copy(C.matrix));let A;_.aoMap?A=_.aoMap:_.lightMap&&(A=_.lightMap),A!==void 0&&(A.isWebGLRenderTarget&&(A=A.texture),A.matrixAutoUpdate===!0&&A.updateMatrix(),y.uv2Transform.value.copy(A.matrix))}function s(y,_){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity}function o(y,_){y.dashSize.value=_.dashSize,y.totalSize.value=_.dashSize+_.gapSize,y.scale.value=_.scale}function a(y,_,S,C){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity,y.size.value=_.size*S,y.scale.value=C*.5,_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);let A;_.map?A=_.map:_.alphaMap&&(A=_.alphaMap),A!==void 0&&(A.matrixAutoUpdate===!0&&A.updateMatrix(),y.uvTransform.value.copy(A.matrix))}function c(y,_){y.diffuse.value.copy(_.color),y.opacity.value=_.opacity,y.rotation.value=_.rotation,_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);let S;_.map?S=_.map:_.alphaMap&&(S=_.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function u(y,_){y.specular.value.copy(_.specular),y.shininess.value=Math.max(_.shininess,1e-4)}function d(y,_){_.gradientMap&&(y.gradientMap.value=_.gradientMap)}function p(y,_){y.roughness.value=_.roughness,y.metalness.value=_.metalness,_.roughnessMap&&(y.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(y.metalnessMap.value=_.metalnessMap),e.get(_).envMap&&(y.envMapIntensity.value=_.envMapIntensity)}function f(y,_,S){y.ior.value=_.ior,_.sheen>0&&(y.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),y.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(y.sheenColorMap.value=_.sheenColorMap),_.sheenRoughnessMap&&(y.sheenRoughnessMap.value=_.sheenRoughnessMap)),_.clearcoat>0&&(y.clearcoat.value=_.clearcoat,y.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(y.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),y.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===Sc&&y.clearcoatNormalScale.value.negate())),_.iridescence>0&&(y.iridescence.value=_.iridescence,y.iridescenceIOR.value=_.iridescenceIOR,y.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(y.iridescenceMap.value=_.iridescenceMap),_.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=_.iridescenceThicknessMap)),_.transmission>0&&(y.transmission.value=_.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),_.transmissionMap&&(y.transmissionMap.value=_.transmissionMap),y.thickness.value=_.thickness,_.thicknessMap&&(y.thicknessMap.value=_.thicknessMap),y.attenuationDistance.value=_.attenuationDistance,y.attenuationColor.value.copy(_.attenuationColor)),y.specularIntensity.value=_.specularIntensity,y.specularColor.value.copy(_.specularColor),_.specularIntensityMap&&(y.specularIntensityMap.value=_.specularIntensityMap),_.specularColorMap&&(y.specularColorMap.value=_.specularColorMap)}function v(y,_){_.matcap&&(y.matcap.value=_.matcap)}function x(y,_){y.referencePosition.value.copy(_.referencePosition),y.nearDistance.value=_.nearDistance,y.farDistance.value=_.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:r}}function mVe(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function c(C,A){const P=A.program;r.uniformBlockBinding(C,P)}function u(C,A){let P=i[C.id];P===void 0&&(x(C),P=d(C),i[C.id]=P,C.addEventListener("dispose",_));const D=A.program;r.updateUBOMapping(C,D);const N=e.render.frame;s[C.id]!==N&&(f(C),s[C.id]=N)}function d(C){const A=p();C.__bindingPointIndex=A;const P=n.createBuffer(),D=C.__size,N=C.usage;return n.bindBuffer(35345,P),n.bufferData(35345,D,N),n.bindBuffer(35345,null),n.bindBufferBase(35345,A,P),P}function p(){for(let C=0;C<a;C++)if(o.indexOf(C)===-1)return o.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(C){const A=i[C.id],P=C.uniforms,D=C.__cache;n.bindBuffer(35345,A);for(let N=0,j=P.length;N<j;N++){const T=P[N];if(v(T,N,D)===!0){const k=T.value,U=T.__offset;typeof k=="number"?(T.__data[0]=k,n.bufferSubData(35345,U,T.__data)):(T.value.isMatrix3?(T.__data[0]=T.value.elements[0],T.__data[1]=T.value.elements[1],T.__data[2]=T.value.elements[2],T.__data[3]=T.value.elements[0],T.__data[4]=T.value.elements[3],T.__data[5]=T.value.elements[4],T.__data[6]=T.value.elements[5],T.__data[7]=T.value.elements[0],T.__data[8]=T.value.elements[6],T.__data[9]=T.value.elements[7],T.__data[10]=T.value.elements[8],T.__data[11]=T.value.elements[0]):k.toArray(T.__data),n.bufferSubData(35345,U,T.__data))}}n.bindBuffer(35345,null)}function v(C,A,P){const D=C.value;if(P[A]===void 0)return typeof D=="number"?P[A]=D:P[A]=D.clone(),!0;if(typeof D=="number"){if(P[A]!==D)return P[A]=D,!0}else{const N=P[A];if(N.equals(D)===!1)return N.copy(D),!0}return!1}function x(C){const A=C.uniforms;let P=0;const D=16;let N=0;for(let j=0,T=A.length;j<T;j++){const k=A[j],U=y(k);if(k.__data=new Float32Array(U.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=P,j>0){N=P%D;const ee=D-N;N!==0&&ee-U.boundary<0&&(P+=D-N,k.__offset=P)}P+=U.storage}return N=P%D,N>0&&(P+=D-N),C.__size=P,C.__cache={},this}function y(C){const A=C.value,P={boundary:0,storage:0};return typeof A=="number"?(P.boundary=4,P.storage=4):A.isVector2?(P.boundary=8,P.storage=8):A.isVector3||A.isColor?(P.boundary=16,P.storage=12):A.isVector4?(P.boundary=16,P.storage=16):A.isMatrix3?(P.boundary=48,P.storage=48):A.isMatrix4?(P.boundary=64,P.storage=64):A.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",A),P}function _(C){const A=C.target;A.removeEventListener("dispose",_);const P=o.indexOf(A.__bindingPointIndex);o.splice(P,1),n.deleteBuffer(i[A.id]),delete i[A.id],delete s[A.id]}function S(){for(const C in i)n.deleteBuffer(i[C]);o=[],i={},s={}}return{bind:c,update:u,dispose:S}}function vVe(){const n=pC("canvas");return n.style.display="block",n}function nle(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:vVe(),t=n.context!==void 0?n.context:null,r=n.depth!==void 0?n.depth:!0,i=n.stencil!==void 0?n.stencil:!0,s=n.antialias!==void 0?n.antialias:!1,o=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,a=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,c=n.powerPreference!==void 0?n.powerPreference:"default",u=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let d;t!==null?d=t.getContextAttributes().alpha:d=n.alpha!==void 0?n.alpha:!1;let p=null,f=null;const v=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Nm,this.physicallyCorrectLights=!1,this.toneMapping=Jh,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const y=this;let _=!1,S=0,C=0,A=null,P=-1,D=null;const N=new No,j=new No;let T=null,k=e.width,U=e.height,ee=1,xe=null,ce=null;const te=new No(0,0,k,U),fe=new No(0,0,k,U);let ge=!1;const Se=new HD;let pe=!1,se=!1,ae=null;const Le=new Vr,Re=new ut,Ue=new Te,Ze={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function st(){return A===null?ee:1}let we=t;function Mt(H,me){for(let Ce=0;Ce<H.length;Ce++){const ue=H[Ce],Oe=e.getContext(ue,me);if(Oe!==null)return Oe}return null}try{const H={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${BH}`),e.addEventListener("webglcontextlost",at,!1),e.addEventListener("webglcontextrestored",pt,!1),e.addEventListener("webglcontextcreationerror",Dt,!1),we===null){const me=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&me.shift(),we=Mt(me,H),we===null)throw Mt(me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}we.getShaderPrecisionFormat===void 0&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H}let rt,it,Ke,Qe,Y,K,ve,Ae,De,je,Xe,He,ne,W,O,E,F,z,Z,de,be,oe,ze,ke;function Fe(){rt=new TBe(we),it=new SBe(we,rt,n),rt.init(it),oe=new uVe(we,rt,it),Ke=new lVe(we,rt,it),Qe=new LBe,Y=new Z5e,K=new cVe(we,rt,Ke,Y,it,oe,Qe),ve=new CBe(y),Ae=new PBe(y),De=new HNe(we,it),ze=new bBe(we,rt,De,it),je=new RBe(we,De,Qe,ze),Xe=new kBe(we,je,De,Qe),Z=new NBe(we,it,K),E=new MBe(Y),He=new Y5e(y,ve,Ae,rt,it,ze,E),ne=new fVe(y,Y),W=new J5e,O=new rVe(rt,it),z=new xBe(y,ve,Ke,Xe,d,o),F=new aVe(y,Xe,it),ke=new mVe(we,Qe,it,Ke),de=new wBe(we,rt,Qe,it),be=new OBe(we,rt,Qe,it),Qe.programs=He.programs,y.capabilities=it,y.extensions=rt,y.properties=Y,y.renderLists=W,y.shadowMap=F,y.state=Ke,y.info=Qe}Fe();const Ge=new pVe(y,we);this.xr=Ge,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const H=rt.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){const H=rt.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(H){H!==void 0&&(ee=H,this.setSize(k,U,!1))},this.getSize=function(H){return H.set(k,U)},this.setSize=function(H,me,Ce){if(Ge.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}k=H,U=me,e.width=Math.floor(H*ee),e.height=Math.floor(me*ee),Ce!==!1&&(e.style.width=H+"px",e.style.height=me+"px"),this.setViewport(0,0,H,me)},this.getDrawingBufferSize=function(H){return H.set(k*ee,U*ee).floor()},this.setDrawingBufferSize=function(H,me,Ce){k=H,U=me,ee=Ce,e.width=Math.floor(H*Ce),e.height=Math.floor(me*Ce),this.setViewport(0,0,H,me)},this.getCurrentViewport=function(H){return H.copy(N)},this.getViewport=function(H){return H.copy(te)},this.setViewport=function(H,me,Ce,ue){H.isVector4?te.set(H.x,H.y,H.z,H.w):te.set(H,me,Ce,ue),Ke.viewport(N.copy(te).multiplyScalar(ee).floor())},this.getScissor=function(H){return H.copy(fe)},this.setScissor=function(H,me,Ce,ue){H.isVector4?fe.set(H.x,H.y,H.z,H.w):fe.set(H,me,Ce,ue),Ke.scissor(j.copy(fe).multiplyScalar(ee).floor())},this.getScissorTest=function(){return ge},this.setScissorTest=function(H){Ke.setScissorTest(ge=H)},this.setOpaqueSort=function(H){xe=H},this.setTransparentSort=function(H){ce=H},this.getClearColor=function(H){return H.copy(z.getClearColor())},this.setClearColor=function(){z.setClearColor.apply(z,arguments)},this.getClearAlpha=function(){return z.getClearAlpha()},this.setClearAlpha=function(){z.setClearAlpha.apply(z,arguments)},this.clear=function(H=!0,me=!0,Ce=!0){let ue=0;H&&(ue|=16384),me&&(ue|=256),Ce&&(ue|=1024),we.clear(ue)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",at,!1),e.removeEventListener("webglcontextrestored",pt,!1),e.removeEventListener("webglcontextcreationerror",Dt,!1),W.dispose(),O.dispose(),Y.dispose(),ve.dispose(),Ae.dispose(),Xe.dispose(),ze.dispose(),ke.dispose(),He.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",Ft),Ge.removeEventListener("sessionend",vn),ae&&(ae.dispose(),ae=null),hn.stop()};function at(H){H.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const H=Qe.autoReset,me=F.enabled,Ce=F.autoUpdate,ue=F.needsUpdate,Oe=F.type;Fe(),Qe.autoReset=H,F.enabled=me,F.autoUpdate=Ce,F.needsUpdate=ue,F.type=Oe}function Dt(H){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function re(H){const me=H.target;me.removeEventListener("dispose",re),$e(me)}function $e(H){Me(H),Y.remove(H)}function Me(H){const me=Y.get(H).programs;me!==void 0&&(me.forEach(function(Ce){He.releaseProgram(Ce)}),H.isShaderMaterial&&He.releaseShaderCache(H))}this.renderBufferDirect=function(H,me,Ce,ue,Oe,lt){me===null&&(me=Ze);const xt=Oe.isMesh&&Oe.matrixWorld.determinant()<0,bt=Lc(H,me,Ce,ue,Oe);Ke.setMaterial(ue,xt);let wt=Ce.index;const Zt=Ce.attributes.position;if(wt===null){if(Zt===void 0||Zt.count===0)return}else if(wt.count===0)return;let kt=1;ue.wireframe===!0&&(wt=je.getWireframeAttribute(Ce),kt=2),ze.setup(Oe,ue,bt,Ce,wt);let It,gn=de;wt!==null&&(It=De.get(wt),gn=be,gn.setIndex(It));const Bi=wt!==null?wt.count:Zt.count,Mr=Ce.drawRange.start*kt,Ln=Ce.drawRange.count*kt,Dn=lt!==null?lt.start*kt:0,Wt=lt!==null?lt.count*kt:1/0,ts=Math.max(Mr,Dn),Fn=Math.min(Bi,Mr+Ln,Dn+Wt)-1,Zn=Math.max(0,Fn-ts+1);if(Zn!==0){if(Oe.isMesh)ue.wireframe===!0?(Ke.setLineWidth(ue.wireframeLinewidth*st()),gn.setMode(1)):gn.setMode(4);else if(Oe.isLine){let Cr=ue.linewidth;Cr===void 0&&(Cr=1),Ke.setLineWidth(Cr*st()),Oe.isLineSegments?gn.setMode(1):Oe.isLineLoop?gn.setMode(2):gn.setMode(3)}else Oe.isPoints?gn.setMode(0):Oe.isSprite&&gn.setMode(4);if(Oe.isInstancedMesh)gn.renderInstances(ts,Zn,Oe.count);else if(Ce.isInstancedBufferGeometry){const Cr=Math.min(Ce.instanceCount,Ce._maxInstanceCount);gn.renderInstances(ts,Zn,Cr)}else gn.render(ts,Zn)}},this.compile=function(H,me){function Ce(ue,Oe,lt){ue.transparent===!0&&ue.side===Uh?(ue.side=Sc,ue.needsUpdate=!0,Vo(ue,Oe,lt),ue.side=Ex,ue.needsUpdate=!0,Vo(ue,Oe,lt),ue.side=Uh):Vo(ue,Oe,lt)}f=O.get(H),f.init(),x.push(f),H.traverseVisible(function(ue){ue.isLight&&ue.layers.test(me.layers)&&(f.pushLight(ue),ue.castShadow&&f.pushShadow(ue))}),f.setupLights(y.physicallyCorrectLights),H.traverse(function(ue){const Oe=ue.material;if(Oe)if(Array.isArray(Oe))for(let lt=0;lt<Oe.length;lt++){const xt=Oe[lt];Ce(xt,H,ue)}else Ce(Oe,H,ue)}),x.pop(),f=null};let tt=null;function Je(H){tt&&tt(H)}function Ft(){hn.stop()}function vn(){hn.start()}const hn=new Kae;hn.setAnimationLoop(Je),typeof self<"u"&&hn.setContext(self),this.setAnimationLoop=function(H){tt=H,Ge.setAnimationLoop(H),H===null?hn.stop():hn.start()},Ge.addEventListener("sessionstart",Ft),Ge.addEventListener("sessionend",vn),this.render=function(H,me){if(me!==void 0&&me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),me.parent===null&&me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(me),me=Ge.getCamera()),H.isScene===!0&&H.onBeforeRender(y,H,me,A),f=O.get(H,x.length),f.init(),x.push(f),Le.multiplyMatrices(me.projectionMatrix,me.matrixWorldInverse),Se.setFromProjectionMatrix(Le),se=this.localClippingEnabled,pe=E.init(this.clippingPlanes,se,me),p=W.get(H,v.length),p.init(),v.push(p),zr(H,me,0,y.sortObjects),p.finish(),y.sortObjects===!0&&p.sort(xe,ce),pe===!0&&E.beginShadows();const Ce=f.state.shadowsArray;if(F.render(Ce,H,me),pe===!0&&E.endShadows(),this.info.autoReset===!0&&this.info.reset(),z.render(p,H),f.setupLights(y.physicallyCorrectLights),me.isArrayCamera){const ue=me.cameras;for(let Oe=0,lt=ue.length;Oe<lt;Oe++){const xt=ue[Oe];qt(p,H,xt,xt.viewport)}}else qt(p,H,me);A!==null&&(K.updateMultisampleRenderTarget(A),K.updateRenderTargetMipmap(A)),H.isScene===!0&&H.onAfterRender(y,H,me),ze.resetDefaultState(),P=-1,D=null,x.pop(),x.length>0?f=x[x.length-1]:f=null,v.pop(),v.length>0?p=v[v.length-1]:p=null};function zr(H,me,Ce,ue){if(H.visible===!1)return;if(H.layers.test(me.layers)){if(H.isGroup)Ce=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(me);else if(H.isLight)f.pushLight(H),H.castShadow&&f.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||Se.intersectsSprite(H)){ue&&Ue.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Le);const xt=Xe.update(H),bt=H.material;bt.visible&&p.push(H,xt,bt,Ce,Ue.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(H.isSkinnedMesh&&H.skeleton.frame!==Qe.render.frame&&(H.skeleton.update(),H.skeleton.frame=Qe.render.frame),!H.frustumCulled||Se.intersectsObject(H))){ue&&Ue.setFromMatrixPosition(H.matrixWorld).applyMatrix4(Le);const xt=Xe.update(H),bt=H.material;if(Array.isArray(bt)){const wt=xt.groups;for(let Zt=0,kt=wt.length;Zt<kt;Zt++){const It=wt[Zt],gn=bt[It.materialIndex];gn&&gn.visible&&p.push(H,xt,gn,Ce,Ue.z,It)}}else bt.visible&&p.push(H,xt,bt,Ce,Ue.z,null)}}const lt=H.children;for(let xt=0,bt=lt.length;xt<bt;xt++)zr(lt[xt],me,Ce,ue)}function qt(H,me,Ce,ue){const Oe=H.opaque,lt=H.transmissive,xt=H.transparent;f.setupLightsView(Ce),lt.length>0&&xr(Oe,me,Ce),ue&&Ke.viewport(N.copy(ue)),Oe.length>0&&or(Oe,me,Ce),lt.length>0&&or(lt,me,Ce),xt.length>0&&or(xt,me,Ce),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1)}function xr(H,me,Ce){const ue=it.isWebGL2;ae===null&&(ae=new Ai(1,1,{generateMipmaps:!0,type:rt.has("EXT_color_buffer_half_float")?Ip:w0,minFilter:tE,samples:ue&&s===!0?4:0})),y.getDrawingBufferSize(Re),ue?ae.setSize(Re.x,Re.y):ae.setSize(wO(Re.x),wO(Re.y));const Oe=y.getRenderTarget();y.setRenderTarget(ae),y.clear();const lt=y.toneMapping;y.toneMapping=Jh,or(H,me,Ce),y.toneMapping=lt,K.updateMultisampleRenderTarget(ae),K.updateRenderTargetMipmap(ae),y.setRenderTarget(Oe)}function or(H,me,Ce){const ue=me.isScene===!0?me.overrideMaterial:null;for(let Oe=0,lt=H.length;Oe<lt;Oe++){const xt=H[Oe],bt=xt.object,wt=xt.geometry,Zt=ue===null?xt.material:ue,kt=xt.group;bt.layers.test(Ce.layers)&&Ul(bt,me,Ce,wt,Zt,kt)}}function Ul(H,me,Ce,ue,Oe,lt){H.onBeforeRender(y,me,Ce,ue,Oe,lt),H.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),Oe.onBeforeRender(y,me,Ce,ue,H,lt),Oe.transparent===!0&&Oe.side===Uh?(Oe.side=Sc,Oe.needsUpdate=!0,y.renderBufferDirect(Ce,me,ue,Oe,H,lt),Oe.side=Ex,Oe.needsUpdate=!0,y.renderBufferDirect(Ce,me,ue,Oe,H,lt),Oe.side=Uh):y.renderBufferDirect(Ce,me,ue,Oe,H,lt),H.onAfterRender(y,me,Ce,ue,Oe,lt)}function Vo(H,me,Ce){me.isScene!==!0&&(me=Ze);const ue=Y.get(H),Oe=f.state.lights,lt=f.state.shadowsArray,xt=Oe.state.version,bt=He.getParameters(H,Oe.state,lt,me,Ce),wt=He.getProgramCacheKey(bt);let Zt=ue.programs;ue.environment=H.isMeshStandardMaterial?me.environment:null,ue.fog=me.fog,ue.envMap=(H.isMeshStandardMaterial?Ae:ve).get(H.envMap||ue.environment),Zt===void 0&&(H.addEventListener("dispose",re),Zt=new Map,ue.programs=Zt);let kt=Zt.get(wt);if(kt!==void 0){if(ue.currentProgram===kt&&ue.lightsStateVersion===xt)return Fo(H,bt),kt}else bt.uniforms=He.getUniforms(H),H.onBuild(Ce,bt,y),H.onBeforeCompile(bt,y),kt=He.acquireProgram(bt,wt),Zt.set(wt,kt),ue.uniforms=bt.uniforms;const It=ue.uniforms;(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(It.clippingPlanes=E.uniform),Fo(H,bt),ue.needsLights=ei(H),ue.lightsStateVersion=xt,ue.needsLights&&(It.ambientLightColor.value=Oe.state.ambient,It.lightProbe.value=Oe.state.probe,It.directionalLights.value=Oe.state.directional,It.directionalLightShadows.value=Oe.state.directionalShadow,It.spotLights.value=Oe.state.spot,It.spotLightShadows.value=Oe.state.spotShadow,It.rectAreaLights.value=Oe.state.rectArea,It.ltc_1.value=Oe.state.rectAreaLTC1,It.ltc_2.value=Oe.state.rectAreaLTC2,It.pointLights.value=Oe.state.point,It.pointLightShadows.value=Oe.state.pointShadow,It.hemisphereLights.value=Oe.state.hemi,It.directionalShadowMap.value=Oe.state.directionalShadowMap,It.directionalShadowMatrix.value=Oe.state.directionalShadowMatrix,It.spotShadowMap.value=Oe.state.spotShadowMap,It.spotLightMatrix.value=Oe.state.spotLightMatrix,It.spotLightMap.value=Oe.state.spotLightMap,It.pointShadowMap.value=Oe.state.pointShadowMap,It.pointShadowMatrix.value=Oe.state.pointShadowMatrix);const gn=kt.getUniforms(),Bi=tR.seqWithValue(gn.seq,It);return ue.currentProgram=kt,ue.uniformsList=Bi,kt}function Fo(H,me){const Ce=Y.get(H);Ce.outputEncoding=me.outputEncoding,Ce.instancing=me.instancing,Ce.skinning=me.skinning,Ce.morphTargets=me.morphTargets,Ce.morphNormals=me.morphNormals,Ce.morphColors=me.morphColors,Ce.morphTargetsCount=me.morphTargetsCount,Ce.numClippingPlanes=me.numClippingPlanes,Ce.numIntersection=me.numClipIntersection,Ce.vertexAlphas=me.vertexAlphas,Ce.vertexTangents=me.vertexTangents,Ce.toneMapping=me.toneMapping}function Lc(H,me,Ce,ue,Oe){me.isScene!==!0&&(me=Ze),K.resetTextureUnits();const lt=me.fog,xt=ue.isMeshStandardMaterial?me.environment:null,bt=A===null?y.outputEncoding:A.isXRRenderTarget===!0?A.texture.encoding:Nm,wt=(ue.isMeshStandardMaterial?Ae:ve).get(ue.envMap||xt),Zt=ue.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,kt=!!ue.normalMap&&!!Ce.attributes.tangent,It=!!Ce.morphAttributes.position,gn=!!Ce.morphAttributes.normal,Bi=!!Ce.morphAttributes.color,Mr=ue.toneMapped?y.toneMapping:Jh,Ln=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,Dn=Ln!==void 0?Ln.length:0,Wt=Y.get(ue),ts=f.state.lights;if(pe===!0&&(se===!0||H!==D)){const Un=H===D&&ue.id===P;E.setState(ue,H,Un)}let Fn=!1;ue.version===Wt.__version?(Wt.needsLights&&Wt.lightsStateVersion!==ts.state.version||Wt.outputEncoding!==bt||Oe.isInstancedMesh&&Wt.instancing===!1||!Oe.isInstancedMesh&&Wt.instancing===!0||Oe.isSkinnedMesh&&Wt.skinning===!1||!Oe.isSkinnedMesh&&Wt.skinning===!0||Wt.envMap!==wt||ue.fog===!0&&Wt.fog!==lt||Wt.numClippingPlanes!==void 0&&(Wt.numClippingPlanes!==E.numPlanes||Wt.numIntersection!==E.numIntersection)||Wt.vertexAlphas!==Zt||Wt.vertexTangents!==kt||Wt.morphTargets!==It||Wt.morphNormals!==gn||Wt.morphColors!==Bi||Wt.toneMapping!==Mr||it.isWebGL2===!0&&Wt.morphTargetsCount!==Dn)&&(Fn=!0):(Fn=!0,Wt.__version=ue.version);let Zn=Wt.currentProgram;Fn===!0&&(Zn=Vo(ue,me,Oe));let Cr=!1,Xr=!1,Ts=!1;const Rn=Zn.getUniforms(),Vi=Wt.uniforms;if(Ke.useProgram(Zn.program)&&(Cr=!0,Xr=!0,Ts=!0),ue.id!==P&&(P=ue.id,Xr=!0),Cr||D!==H){if(Rn.setValue(we,"projectionMatrix",H.projectionMatrix),it.logarithmicDepthBuffer&&Rn.setValue(we,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),D!==H&&(D=H,Xr=!0,Ts=!0),ue.isShaderMaterial||ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshStandardMaterial||ue.envMap){const Un=Rn.map.cameraPosition;Un!==void 0&&Un.setValue(we,Ue.setFromMatrixPosition(H.matrixWorld))}(ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshLambertMaterial||ue.isMeshBasicMaterial||ue.isMeshStandardMaterial||ue.isShaderMaterial)&&Rn.setValue(we,"isOrthographic",H.isOrthographicCamera===!0),(ue.isMeshPhongMaterial||ue.isMeshToonMaterial||ue.isMeshLambertMaterial||ue.isMeshBasicMaterial||ue.isMeshStandardMaterial||ue.isShaderMaterial||ue.isShadowMaterial||Oe.isSkinnedMesh)&&Rn.setValue(we,"viewMatrix",H.matrixWorldInverse)}if(Oe.isSkinnedMesh){Rn.setOptional(we,Oe,"bindMatrix"),Rn.setOptional(we,Oe,"bindMatrixInverse");const Un=Oe.skeleton;Un&&(it.floatVertexTextures?(Un.boneTexture===null&&Un.computeBoneTexture(),Rn.setValue(we,"boneTexture",Un.boneTexture,K),Rn.setValue(we,"boneTextureSize",Un.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Uo=Ce.morphAttributes;if((Uo.position!==void 0||Uo.normal!==void 0||Uo.color!==void 0&&it.isWebGL2===!0)&&Z.update(Oe,Ce,ue,Zn),(Xr||Wt.receiveShadow!==Oe.receiveShadow)&&(Wt.receiveShadow=Oe.receiveShadow,Rn.setValue(we,"receiveShadow",Oe.receiveShadow)),ue.isMeshGouraudMaterial&&ue.envMap!==null&&(Vi.envMap.value=wt,Vi.flipEnvMap.value=wt.isCubeTexture&&wt.isRenderTargetTexture===!1?-1:1),Xr&&(Rn.setValue(we,"toneMappingExposure",y.toneMappingExposure),Wt.needsLights&&va(Vi,Ts),lt&&ue.fog===!0&&ne.refreshFogUniforms(Vi,lt),ne.refreshMaterialUniforms(Vi,ue,ee,U,ae),tR.upload(we,Wt.uniformsList,Vi,K)),ue.isShaderMaterial&&ue.uniformsNeedUpdate===!0&&(tR.upload(we,Wt.uniformsList,Vi,K),ue.uniformsNeedUpdate=!1),ue.isSpriteMaterial&&Rn.setValue(we,"center",Oe.center),Rn.setValue(we,"modelViewMatrix",Oe.modelViewMatrix),Rn.setValue(we,"normalMatrix",Oe.normalMatrix),Rn.setValue(we,"modelMatrix",Oe.matrixWorld),ue.isShaderMaterial||ue.isRawShaderMaterial){const Un=ue.uniformsGroups;for(let fs=0,jl=Un.length;fs<jl;fs++)if(it.isWebGL2){const jo=Un[fs];ke.update(jo,Zn),ke.bind(jo,Zn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Zn}function va(H,me){H.ambientLightColor.needsUpdate=me,H.lightProbe.needsUpdate=me,H.directionalLights.needsUpdate=me,H.directionalLightShadows.needsUpdate=me,H.pointLights.needsUpdate=me,H.pointLightShadows.needsUpdate=me,H.spotLights.needsUpdate=me,H.spotLightShadows.needsUpdate=me,H.rectAreaLights.needsUpdate=me,H.hemisphereLights.needsUpdate=me}function ei(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(H,me,Ce){Y.get(H.texture).__webglTexture=me,Y.get(H.depthTexture).__webglTexture=Ce;const ue=Y.get(H);ue.__hasExternalTextures=!0,ue.__hasExternalTextures&&(ue.__autoAllocateDepthBuffer=Ce===void 0,ue.__autoAllocateDepthBuffer||rt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ue.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(H,me){const Ce=Y.get(H);Ce.__webglFramebuffer=me,Ce.__useDefaultFramebuffer=me===void 0},this.setRenderTarget=function(H,me=0,Ce=0){A=H,S=me,C=Ce;let ue=!0;if(H){const wt=Y.get(H);wt.__useDefaultFramebuffer!==void 0?(Ke.bindFramebuffer(36160,null),ue=!1):wt.__webglFramebuffer===void 0?K.setupRenderTarget(H):wt.__hasExternalTextures&&K.rebindTextures(H,Y.get(H.texture).__webglTexture,Y.get(H.depthTexture).__webglTexture)}let Oe=null,lt=!1,xt=!1;if(H){const wt=H.texture;(wt.isData3DTexture||wt.isDataArrayTexture)&&(xt=!0);const Zt=Y.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Oe=Zt[me],lt=!0):it.isWebGL2&&H.samples>0&&K.useMultisampledRTT(H)===!1?Oe=Y.get(H).__webglMultisampledFramebuffer:Oe=Zt,N.copy(H.viewport),j.copy(H.scissor),T=H.scissorTest}else N.copy(te).multiplyScalar(ee).floor(),j.copy(fe).multiplyScalar(ee).floor(),T=ge;if(Ke.bindFramebuffer(36160,Oe)&&it.drawBuffers&&ue&&Ke.drawBuffers(H,Oe),Ke.viewport(N),Ke.scissor(j),Ke.setScissorTest(T),lt){const wt=Y.get(H.texture);we.framebufferTexture2D(36160,36064,34069+me,wt.__webglTexture,Ce)}else if(xt){const wt=Y.get(H.texture),Zt=me||0;we.framebufferTextureLayer(36160,36064,wt.__webglTexture,Ce||0,Zt)}P=-1},this.readRenderTargetPixels=function(H,me,Ce,ue,Oe,lt,xt){if(!(H&&H.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let bt=Y.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&xt!==void 0&&(bt=bt[xt]),bt){Ke.bindFramebuffer(36160,bt);try{const wt=H.texture,Zt=wt.format,kt=wt.type;if(Zt!==Hh&&oe.convert(Zt)!==we.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const It=kt===Ip&&(rt.has("EXT_color_buffer_half_float")||it.isWebGL2&&rt.has("EXT_color_buffer_float"));if(kt!==w0&&oe.convert(kt)!==we.getParameter(35738)&&!(kt===jh&&(it.isWebGL2||rt.has("OES_texture_float")||rt.has("WEBGL_color_buffer_float")))&&!It){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}me>=0&&me<=H.width-ue&&Ce>=0&&Ce<=H.height-Oe&&we.readPixels(me,Ce,ue,Oe,oe.convert(Zt),oe.convert(kt),lt)}finally{const wt=A!==null?Y.get(A).__webglFramebuffer:null;Ke.bindFramebuffer(36160,wt)}}},this.copyFramebufferToTexture=function(H,me,Ce=0){const ue=Math.pow(2,-Ce),Oe=Math.floor(me.image.width*ue),lt=Math.floor(me.image.height*ue);K.setTexture2D(me,0),we.copyTexSubImage2D(3553,Ce,0,0,H.x,H.y,Oe,lt),Ke.unbindTexture()},this.copyTextureToTexture=function(H,me,Ce,ue=0){const Oe=me.image.width,lt=me.image.height,xt=oe.convert(Ce.format),bt=oe.convert(Ce.type);K.setTexture2D(Ce,0),we.pixelStorei(37440,Ce.flipY),we.pixelStorei(37441,Ce.premultiplyAlpha),we.pixelStorei(3317,Ce.unpackAlignment),me.isDataTexture?we.texSubImage2D(3553,ue,H.x,H.y,Oe,lt,xt,bt,me.image.data):me.isCompressedTexture?we.compressedTexSubImage2D(3553,ue,H.x,H.y,me.mipmaps[0].width,me.mipmaps[0].height,xt,me.mipmaps[0].data):we.texSubImage2D(3553,ue,H.x,H.y,xt,bt,me.image),ue===0&&Ce.generateMipmaps&&we.generateMipmap(3553),Ke.unbindTexture()},this.copyTextureToTexture3D=function(H,me,Ce,ue,Oe=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const lt=H.max.x-H.min.x+1,xt=H.max.y-H.min.y+1,bt=H.max.z-H.min.z+1,wt=oe.convert(ue.format),Zt=oe.convert(ue.type);let kt;if(ue.isData3DTexture)K.setTexture3D(ue,0),kt=32879;else if(ue.isDataArrayTexture)K.setTexture2DArray(ue,0),kt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}we.pixelStorei(37440,ue.flipY),we.pixelStorei(37441,ue.premultiplyAlpha),we.pixelStorei(3317,ue.unpackAlignment);const It=we.getParameter(3314),gn=we.getParameter(32878),Bi=we.getParameter(3316),Mr=we.getParameter(3315),Ln=we.getParameter(32877),Dn=Ce.isCompressedTexture?Ce.mipmaps[0]:Ce.image;we.pixelStorei(3314,Dn.width),we.pixelStorei(32878,Dn.height),we.pixelStorei(3316,H.min.x),we.pixelStorei(3315,H.min.y),we.pixelStorei(32877,H.min.z),Ce.isDataTexture||Ce.isData3DTexture?we.texSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Zt,Dn.data):Ce.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),we.compressedTexSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Dn.data)):we.texSubImage3D(kt,Oe,me.x,me.y,me.z,lt,xt,bt,wt,Zt,Dn),we.pixelStorei(3314,It),we.pixelStorei(32878,gn),we.pixelStorei(3316,Bi),we.pixelStorei(3315,Mr),we.pixelStorei(32877,Ln),Oe===0&&ue.generateMipmaps&&we.generateMipmap(kt),Ke.unbindTexture()},this.initTexture=function(H){H.isCubeTexture?K.setTextureCube(H,0):H.isData3DTexture?K.setTexture3D(H,0):H.isDataArrayTexture?K.setTexture2DArray(H,0):K.setTexture2D(H,0),Ke.unbindTexture()},this.resetState=function(){S=0,C=0,A=null,Ke.reset(),ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class gVe extends nle{}gVe.prototype.isWebGL1Renderer=!0;class _Ve extends Qi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class yVe{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=a8,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=oh()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=oh()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=oh()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const il=new Te;class SO{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)il.fromBufferAttribute(this,t),il.applyMatrix4(e),this.setXYZ(t,il.x,il.y,il.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)il.fromBufferAttribute(this,t),il.applyNormalMatrix(e),this.setXYZ(t,il.x,il.y,il.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)il.fromBufferAttribute(this,t),il.transformDirection(e),this.setXYZ(t,il.x,il.y,il.z);return this}setX(e,t){return this.normalized&&(t=ci(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ci(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Np(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Np(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Np(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Np(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array),i=ci(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ci(t,this.array),r=ci(r,this.array),i=ci(i,this.array),s=ci(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Cc(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new SO(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class rle extends of{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new en(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let $_;const LS=new Te,ey=new Te,ty=new Te,ny=new ut,DS=new ut,ile=new Vr,dT=new Te,IS=new Te,pT=new Te,qK=new ut,aF=new ut,YK=new ut;class xVe extends Qi{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",$_===void 0){$_=new As;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new yVe(t,5);$_.setIndex([0,1,2,0,2,3]),$_.setAttribute("position",new SO(r,3,0,!1)),$_.setAttribute("uv",new SO(r,2,3,!1))}this.geometry=$_,this.material=e!==void 0?e:new rle,this.center=new ut(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ey.setFromMatrixScale(this.matrixWorld),ile.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ty.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ey.multiplyScalar(-ty.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;fT(dT.set(-.5,-.5,0),ty,o,ey,i,s),fT(IS.set(.5,-.5,0),ty,o,ey,i,s),fT(pT.set(.5,.5,0),ty,o,ey,i,s),qK.set(0,0),aF.set(1,0),YK.set(1,1);let a=e.ray.intersectTriangle(dT,IS,pT,!1,LS);if(a===null&&(fT(IS.set(-.5,.5,0),ty,o,ey,i,s),aF.set(0,1),a=e.ray.intersectTriangle(dT,pT,IS,!1,LS),a===null))return;const c=e.ray.origin.distanceTo(LS);c<e.near||c>e.far||t.push({distance:c,point:LS.clone(),uv:kh.getUV(LS,dT,IS,pT,qK,aF,YK,new ut),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function fT(n,e,t,r,i,s){ny.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(DS.x=s*ny.x-i*ny.y,DS.y=i*ny.x+s*ny.y):DS.copy(ny),n.copy(e),n.x+=DS.x,n.y+=DS.y,n.applyMatrix4(ile)}class bVe extends Qi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class wVe extends ka{constructor(e=null,t=1,r=1,i,s,o,a,c,u=ds,d=ds,p,f){super(null,o,a,c,u,d,i,s,p,f),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class aE extends of{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new en(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ZK=new Te,KK=new Te,JK=new Vr,lF=new rE,mT=new jD;class SVe extends Qi{constructor(e=new As,t=new aE){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)ZK.fromBufferAttribute(t,i-1),KK.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=ZK.distanceTo(KK);e.setAttribute("lineDistance",new sr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),mT.copy(r.boundingSphere),mT.applyMatrix4(i),mT.radius+=s,e.ray.intersectsSphere(mT)===!1)return;JK.copy(i).invert(),lF.copy(e.ray).applyMatrix4(JK);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,u=new Te,d=new Te,p=new Te,f=new Te,v=this.isLineSegments?2:1,x=r.index,_=r.attributes.position;if(x!==null){const S=Math.max(0,o.start),C=Math.min(x.count,o.start+o.count);for(let A=S,P=C-1;A<P;A+=v){const D=x.getX(A),N=x.getX(A+1);if(u.fromBufferAttribute(_,D),d.fromBufferAttribute(_,N),lF.distanceSqToSegment(u,d,f,p)>c)continue;f.applyMatrix4(this.matrixWorld);const T=e.ray.origin.distanceTo(f);T<e.near||T>e.far||t.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else{const S=Math.max(0,o.start),C=Math.min(_.count,o.start+o.count);for(let A=S,P=C-1;A<P;A+=v){if(u.fromBufferAttribute(_,A),d.fromBufferAttribute(_,A+1),lF.distanceSqToSegment(u,d,f,p)>c)continue;f.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(f);N<e.near||N>e.far||t.push({distance:N,point:p.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const QK=new Te,$K=new Te;class XD extends SVe{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)QK.fromBufferAttribute(t,i),$K.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+QK.distanceTo($K);e.setAttribute("lineDistance",new sr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class MVe extends ka{constructor(e,t,r,i,s,o,a,c,u){super(e,t,r,i,s,o,a,c,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Us,this.magFilter=s!==void 0?s:Us,this.generateMipmaps=!1;const d=this;function p(){d.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class hd{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,c=s-1,u;for(;a<=c;)if(i=Math.floor(a+(c-a)/2),u=r[i]-o,u<0)a=i+1;else if(u>0)c=i-1;else{c=i;break}if(i=c,r[i]===o)return i/(s-1);const d=r[i],f=r[i+1]-d,v=(o-d)/f;return(i+v)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),c=t||(o.isVector2?new ut:new Te);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Te,i=[],s=[],o=[],a=new Te,c=new Vr;for(let v=0;v<=e;v++){const x=v/e;i[v]=this.getTangentAt(x,new Te)}s[0]=new Te,o[0]=new Te;let u=Number.MAX_VALUE;const d=Math.abs(i[0].x),p=Math.abs(i[0].y),f=Math.abs(i[0].z);d<=u&&(u=d,r.set(1,0,0)),p<=u&&(u=p,r.set(0,1,0)),f<=u&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(i[v-1],i[v]),a.length()>Number.EPSILON){a.normalize();const x=Math.acos(Eo(i[v-1].dot(i[v]),-1,1));s[v].applyMatrix4(c.makeRotationAxis(a,x))}o[v].crossVectors(i[v],s[v])}if(t===!0){let v=Math.acos(Eo(s[0].dot(s[e]),-1,1));v/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let x=1;x<=e;x++)s[x].applyMatrix4(c.makeRotationAxis(i[x],v*x)),o[x].crossVectors(i[x],s[x])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class YH extends hd{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const r=t||new ut,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),p=Math.sin(this.aRotation),f=c-this.aX,v=u-this.aY;c=f*d-v*p+this.aX,u=f*p+v*d+this.aY}return r.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class CVe extends YH{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function ZH(){let n=0,e=0,t=0,r=0;function i(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,r=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,u){i(o,a,u*(a-s),u*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,u,d,p){let f=(o-s)/u-(a-s)/(u+d)+(a-o)/d,v=(a-o)/d-(c-o)/(d+p)+(c-a)/p;f*=d,v*=d,i(o,a,f,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const vT=new Te,cF=new ZH,uF=new ZH,hF=new ZH;class EVe extends hd{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Te){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let u,d;this.closed||a>0?u=i[(a-1)%s]:(vT.subVectors(i[0],i[1]).add(i[0]),u=vT);const p=i[a%s],f=i[(a+1)%s];if(this.closed||a+2<s?d=i[(a+2)%s]:(vT.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=vT),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let x=Math.pow(u.distanceToSquared(p),v),y=Math.pow(p.distanceToSquared(f),v),_=Math.pow(f.distanceToSquared(d),v);y<1e-4&&(y=1),x<1e-4&&(x=y),_<1e-4&&(_=y),cF.initNonuniformCatmullRom(u.x,p.x,f.x,d.x,x,y,_),uF.initNonuniformCatmullRom(u.y,p.y,f.y,d.y,x,y,_),hF.initNonuniformCatmullRom(u.z,p.z,f.z,d.z,x,y,_)}else this.curveType==="catmullrom"&&(cF.initCatmullRom(u.x,p.x,f.x,d.x,this.tension),uF.initCatmullRom(u.y,p.y,f.y,d.y,this.tension),hF.initCatmullRom(u.z,p.z,f.z,d.z,this.tension));return r.set(cF.calc(c),uF.calc(c),hF.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Te().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function eJ(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,c=n*a;return(2*t-2*r+s+o)*c+(-3*t+3*r-2*s-o)*a+s*n+t}function AVe(n,e){const t=1-n;return t*t*e}function PVe(n,e){return 2*(1-n)*n*e}function TVe(n,e){return n*n*e}function kM(n,e,t,r){return AVe(n,e)+PVe(n,t)+TVe(n,r)}function RVe(n,e){const t=1-n;return t*t*t*e}function OVe(n,e){const t=1-n;return 3*t*t*n*e}function LVe(n,e){return 3*(1-n)*n*n*e}function DVe(n,e){return n*n*n*e}function zM(n,e,t,r,i){return RVe(n,e)+OVe(n,t)+LVe(n,r)+DVe(n,i)}class sle extends hd{constructor(e=new ut,t=new ut,r=new ut,i=new ut){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(zM(e,i.x,s.x,o.x,a.x),zM(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class IVe extends hd{constructor(e=new Te,t=new Te,r=new Te,i=new Te){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Te){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(zM(e,i.x,s.x,o.x,a.x),zM(e,i.y,s.y,o.y,a.y),zM(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class KH extends hd{constructor(e=new ut,t=new ut){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ut){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const r=t||new ut;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class NVe extends hd{constructor(e=new Te,t=new Te){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Te){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ole extends hd{constructor(e=new ut,t=new ut,r=new ut){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(kM(e,i.x,s.x,o.x),kM(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kVe extends hd{constructor(e=new Te,t=new Te,r=new Te){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Te){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(kM(e,i.x,s.x,o.x),kM(e,i.y,s.y,o.y),kM(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ale extends hd{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ut){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,c=i[o===0?o:o-1],u=i[o],d=i[o>i.length-2?i.length-1:o+1],p=i[o>i.length-3?i.length-1:o+2];return r.set(eJ(a,c.x,u.x,d.x,p.x),eJ(a,c.y,u.y,d.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ut().fromArray(i))}return this}}var lle=Object.freeze({__proto__:null,ArcCurve:CVe,CatmullRomCurve3:EVe,CubicBezierCurve:sle,CubicBezierCurve3:IVe,EllipseCurve:YH,LineCurve:KH,LineCurve3:NVe,QuadraticBezierCurve:ole,QuadraticBezierCurve3:kVe,SplineCurve:ale});class zVe extends hd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new KH(t,e))}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],c=a.getLength(),u=c===0?0:1-o/c;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let u=0;u<c.length;u++){const d=c[u];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new lle[i.type]().fromJSON(i))}return this}}class h8 extends zVe{constructor(e){super(),this.type="Path",this.currentPoint=new ut,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new KH(this.currentPoint.clone(),new ut(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new ole(this.currentPoint.clone(),new ut(e,t),new ut(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new sle(this.currentPoint.clone(),new ut(e,t),new ut(r,i),new ut(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new ale(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,c){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+u,t+d,r,i,s,o,a,c),this}absellipse(e,t,r,i,s,o,a,c){const u=new YH(e,t,r,i,s,o,a,c);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const d=u.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class JH extends As{constructor(e=1,t=8,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],c=[],u=new Te,d=new ut;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let p=0,f=3;p<=t;p++,f+=3){const v=r+p/t*i;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),a.push(0,0,1),d.x=(o[f]/e+1)/2,d.y=(o[f+1]/e+1)/2,c.push(d.x,d.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new sr(o,3)),this.setAttribute("normal",new sr(a,3)),this.setAttribute("uv",new sr(c,2))}static fromJSON(e){return new JH(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class qD extends As{constructor(e=1,t=1,r=1,i=8,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const u=this;i=Math.floor(i),s=Math.floor(s);const d=[],p=[],f=[],v=[];let x=0;const y=[],_=r/2;let S=0;C(),o===!1&&(e>0&&A(!0),t>0&&A(!1)),this.setIndex(d),this.setAttribute("position",new sr(p,3)),this.setAttribute("normal",new sr(f,3)),this.setAttribute("uv",new sr(v,2));function C(){const P=new Te,D=new Te;let N=0;const j=(t-e)/r;for(let T=0;T<=s;T++){const k=[],U=T/s,ee=U*(t-e)+e;for(let xe=0;xe<=i;xe++){const ce=xe/i,te=ce*c+a,fe=Math.sin(te),ge=Math.cos(te);D.x=ee*fe,D.y=-U*r+_,D.z=ee*ge,p.push(D.x,D.y,D.z),P.set(fe,j,ge).normalize(),f.push(P.x,P.y,P.z),v.push(ce,1-U),k.push(x++)}y.push(k)}for(let T=0;T<i;T++)for(let k=0;k<s;k++){const U=y[k][T],ee=y[k+1][T],xe=y[k+1][T+1],ce=y[k][T+1];d.push(U,ee,ce),d.push(ee,xe,ce),N+=6}u.addGroup(S,N,0),S+=N}function A(P){const D=x,N=new ut,j=new Te;let T=0;const k=P===!0?e:t,U=P===!0?1:-1;for(let xe=1;xe<=i;xe++)p.push(0,_*U,0),f.push(0,U,0),v.push(.5,.5),x++;const ee=x;for(let xe=0;xe<=i;xe++){const te=xe/i*c+a,fe=Math.cos(te),ge=Math.sin(te);j.x=k*ge,j.y=_*U,j.z=k*fe,p.push(j.x,j.y,j.z),f.push(0,U,0),N.x=fe*.5+.5,N.y=ge*.5*U+.5,v.push(N.x,N.y),x++}for(let xe=0;xe<i;xe++){const ce=D+xe,te=ee+xe;P===!0?d.push(te,te+1,ce):d.push(te+1,te,ce),T+=3}u.addGroup(S,T,P===!0?1:2),S+=T}}static fromJSON(e){return new qD(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class QH extends qD{constructor(e=1,t=1,r=8,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new QH(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class YD extends As{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),u(r),d(),this.setAttribute("position",new sr(s,3)),this.setAttribute("normal",new sr(s.slice(),3)),this.setAttribute("uv",new sr(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(C){const A=new Te,P=new Te,D=new Te;for(let N=0;N<t.length;N+=3)v(t[N+0],A),v(t[N+1],P),v(t[N+2],D),c(A,P,D,C)}function c(C,A,P,D){const N=D+1,j=[];for(let T=0;T<=N;T++){j[T]=[];const k=C.clone().lerp(P,T/N),U=A.clone().lerp(P,T/N),ee=N-T;for(let xe=0;xe<=ee;xe++)xe===0&&T===N?j[T][xe]=k:j[T][xe]=k.clone().lerp(U,xe/ee)}for(let T=0;T<N;T++)for(let k=0;k<2*(N-T)-1;k++){const U=Math.floor(k/2);k%2===0?(f(j[T][U+1]),f(j[T+1][U]),f(j[T][U])):(f(j[T][U+1]),f(j[T+1][U+1]),f(j[T+1][U]))}}function u(C){const A=new Te;for(let P=0;P<s.length;P+=3)A.x=s[P+0],A.y=s[P+1],A.z=s[P+2],A.normalize().multiplyScalar(C),s[P+0]=A.x,s[P+1]=A.y,s[P+2]=A.z}function d(){const C=new Te;for(let A=0;A<s.length;A+=3){C.x=s[A+0],C.y=s[A+1],C.z=s[A+2];const P=_(C)/2/Math.PI+.5,D=S(C)/Math.PI+.5;o.push(P,1-D)}x(),p()}function p(){for(let C=0;C<o.length;C+=6){const A=o[C+0],P=o[C+2],D=o[C+4],N=Math.max(A,P,D),j=Math.min(A,P,D);N>.9&&j<.1&&(A<.2&&(o[C+0]+=1),P<.2&&(o[C+2]+=1),D<.2&&(o[C+4]+=1))}}function f(C){s.push(C.x,C.y,C.z)}function v(C,A){const P=C*3;A.x=e[P+0],A.y=e[P+1],A.z=e[P+2]}function x(){const C=new Te,A=new Te,P=new Te,D=new Te,N=new ut,j=new ut,T=new ut;for(let k=0,U=0;k<s.length;k+=9,U+=6){C.set(s[k+0],s[k+1],s[k+2]),A.set(s[k+3],s[k+4],s[k+5]),P.set(s[k+6],s[k+7],s[k+8]),N.set(o[U+0],o[U+1]),j.set(o[U+2],o[U+3]),T.set(o[U+4],o[U+5]),D.copy(C).add(A).add(P).divideScalar(3);const ee=_(D);y(N,U+0,C,ee),y(j,U+2,A,ee),y(T,U+4,P,ee)}}function y(C,A,P,D){D<0&&C.x===1&&(o[A]=C.x-1),P.x===0&&P.z===0&&(o[A]=D/2/Math.PI+.5)}function _(C){return Math.atan2(C.z,-C.x)}function S(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}static fromJSON(e){return new YD(e.vertices,e.indices,e.radius,e.details)}}class nR extends h8{constructor(e){super(e),this.uuid=oh(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new h8().fromJSON(i))}return this}}const BVe={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=cle(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,u,d,p,f,v;if(r&&(s=HVe(n,e,s,t)),n.length>80*t){a=u=n[0],c=d=n[1];for(let x=t;x<i;x+=t)p=n[x],f=n[x+1],p<a&&(a=p),f<c&&(c=f),p>u&&(u=p),f>d&&(d=f);v=Math.max(u-a,d-c),v=v!==0?1/v:0}return fC(s,o,t,a,c,v),o}};function cle(n,e,t,r,i){let s,o;if(i===eFe(n,e,t,r)>0)for(s=e;s<t;s+=r)o=tJ(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=tJ(s,n[s],n[s+1],o);return o&&ZD(o,o.next)&&(vC(o),o=o.next),o}function km(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(ZD(t,t.next)||Zi(t.prev,t,t.next)===0)){if(vC(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function fC(n,e,t,r,i,s,o){if(!n)return;!o&&s&&YVe(n,r,i,s);let a=n,c,u;for(;n.prev!==n.next;){if(c=n.prev,u=n.next,s?FVe(n,r,i,s):VVe(n)){e.push(c.i/t),e.push(n.i/t),e.push(u.i/t),vC(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=UVe(km(n),e,t),fC(n,e,t,r,i,s,2)):o===2&&jVe(n,e,t,r,i,s):fC(km(n),e,t,r,i,s,1);break}}}function VVe(n){const e=n.prev,t=n,r=n.next;if(Zi(e,t,r)>=0)return!1;let i=n.next.next;for(;i!==n.prev;){if(Ey(e.x,e.y,t.x,t.y,r.x,r.y,i.x,i.y)&&Zi(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function FVe(n,e,t,r){const i=n.prev,s=n,o=n.next;if(Zi(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,c=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,u=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,d=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,p=d8(a,c,e,t,r),f=d8(u,d,e,t,r);let v=n.prevZ,x=n.nextZ;for(;v&&v.z>=p&&x&&x.z<=f;){if(v!==n.prev&&v!==n.next&&Ey(i.x,i.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Zi(v.prev,v,v.next)>=0||(v=v.prevZ,x!==n.prev&&x!==n.next&&Ey(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&Zi(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;v&&v.z>=p;){if(v!==n.prev&&v!==n.next&&Ey(i.x,i.y,s.x,s.y,o.x,o.y,v.x,v.y)&&Zi(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=f;){if(x!==n.prev&&x!==n.next&&Ey(i.x,i.y,s.x,s.y,o.x,o.y,x.x,x.y)&&Zi(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function UVe(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!ZD(i,s)&&ule(i,r,r.next,s)&&mC(i,s)&&mC(s,i)&&(e.push(i.i/t),e.push(r.i/t),e.push(s.i/t),vC(r),vC(r.next),r=n=s),r=r.next}while(r!==n);return km(r)}function jVe(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&JVe(o,a)){let c=hle(o,a);o=km(o,o.next),c=km(c,c.next),fC(o,e,t,r,i,s),fC(c,e,t,r,i,s);return}a=a.next}o=o.next}while(o!==n)}function HVe(n,e,t,r){const i=[];let s,o,a,c,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,c=s<o-1?e[s+1]*r:n.length,u=cle(n,a,c,r,!1),u===u.next&&(u.steiner=!0),i.push(KVe(u));for(i.sort(WVe),s=0;s<i.length;s++)GVe(i[s],t),t=km(t,t.next);return t}function WVe(n,e){return n.x-e.x}function GVe(n,e){if(e=XVe(n,e),e){const t=hle(e,n);km(e,e.next),km(t,t.next)}}function XVe(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=r&&f>s){if(s=f,f===r){if(i===t.y)return t;if(i===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(r===s)return o;const a=o,c=o.x,u=o.y;let d=1/0,p;t=o;do r>=t.x&&t.x>=c&&r!==t.x&&Ey(i<u?r:s,i,c,u,i<u?s:r,i,t.x,t.y)&&(p=Math.abs(i-t.y)/(r-t.x),mC(t,n)&&(p<d||p===d&&(t.x>o.x||t.x===o.x&&qVe(o,t)))&&(o=t,d=p)),t=t.next;while(t!==a);return o}function qVe(n,e){return Zi(n.prev,n,e.prev)<0&&Zi(e.next,n,n.next)<0}function YVe(n,e,t,r){let i=n;do i.z===null&&(i.z=d8(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,ZVe(i)}function ZVe(n){let e,t,r,i,s,o,a,c,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(c=u;a>0||c>0&&r;)a!==0&&(c===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,c--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,u*=2}while(o>1);return n}function d8(n,e,t,r,i){return n=32767*(n-t)*i,e=32767*(e-r)*i,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function KVe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Ey(n,e,t,r,i,s,o,a){return(i-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(r-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(i-o)*(r-a)>=0}function JVe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!QVe(n,e)&&(mC(n,e)&&mC(e,n)&&$Ve(n,e)&&(Zi(n.prev,n,e.prev)||Zi(n,e.prev,e))||ZD(n,e)&&Zi(n.prev,n,n.next)>0&&Zi(e.prev,e,e.next)>0)}function Zi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ZD(n,e){return n.x===e.x&&n.y===e.y}function ule(n,e,t,r){const i=_T(Zi(n,e,t)),s=_T(Zi(n,e,r)),o=_T(Zi(t,r,n)),a=_T(Zi(t,r,e));return!!(i!==s&&o!==a||i===0&&gT(n,t,e)||s===0&&gT(n,r,e)||o===0&&gT(t,n,r)||a===0&&gT(t,e,r))}function gT(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function _T(n){return n>0?1:n<0?-1:0}function QVe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&ule(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function mC(n,e){return Zi(n.prev,n,n.next)<0?Zi(n,e,n.next)>=0&&Zi(n,n.prev,e)>=0:Zi(n,e,n.prev)<0||Zi(n,n.next,e)<0}function $Ve(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function hle(n,e){const t=new p8(n.i,n.x,n.y),r=new p8(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function tJ(n,e,t,r){const i=new p8(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function vC(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function p8(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function eFe(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class Wy{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return Wy.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];nJ(e),rJ(r,e);let o=e.length;t.forEach(nJ);for(let c=0;c<t.length;c++)i.push(o),o+=t[c].length,rJ(r,t[c]);const a=BVe.triangulate(r,i);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function nJ(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function rJ(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class MO extends As{constructor(e=new nR([new ut(.5,.5),new ut(-.5,.5),new ut(-.5,-.5),new ut(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,c=e.length;a<c;a++){const u=e[a];o(u)}this.setAttribute("position",new sr(i,3)),this.setAttribute("uv",new sr(s,2)),this.computeVertexNormals();function o(a){const c=[],u=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:v-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,_=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:tFe;let A,P=!1,D,N,j,T;S&&(A=S.getSpacedPoints(d),P=!0,f=!1,D=S.computeFrenetFrames(d,!1),N=new Te,j=new Te,T=new Te),f||(_=0,v=0,x=0,y=0);const k=a.extractPoints(u);let U=k.shape;const ee=k.holes;if(!Wy.isClockWise(U)){U=U.reverse();for(let Y=0,K=ee.length;Y<K;Y++){const ve=ee[Y];Wy.isClockWise(ve)&&(ee[Y]=ve.reverse())}}const ce=Wy.triangulateShape(U,ee),te=U;for(let Y=0,K=ee.length;Y<K;Y++){const ve=ee[Y];U=U.concat(ve)}function fe(Y,K,ve){return K||console.error("THREE.ExtrudeGeometry: vec does not exist"),K.clone().multiplyScalar(ve).add(Y)}const ge=U.length,Se=ce.length;function pe(Y,K,ve){let Ae,De,je;const Xe=Y.x-K.x,He=Y.y-K.y,ne=ve.x-Y.x,W=ve.y-Y.y,O=Xe*Xe+He*He,E=Xe*W-He*ne;if(Math.abs(E)>Number.EPSILON){const F=Math.sqrt(O),z=Math.sqrt(ne*ne+W*W),Z=K.x-He/F,de=K.y+Xe/F,be=ve.x-W/z,oe=ve.y+ne/z,ze=((be-Z)*W-(oe-de)*ne)/(Xe*W-He*ne);Ae=Z+Xe*ze-Y.x,De=de+He*ze-Y.y;const ke=Ae*Ae+De*De;if(ke<=2)return new ut(Ae,De);je=Math.sqrt(ke/2)}else{let F=!1;Xe>Number.EPSILON?ne>Number.EPSILON&&(F=!0):Xe<-Number.EPSILON?ne<-Number.EPSILON&&(F=!0):Math.sign(He)===Math.sign(W)&&(F=!0),F?(Ae=-He,De=Xe,je=Math.sqrt(O)):(Ae=Xe,De=He,je=Math.sqrt(O/2))}return new ut(Ae/je,De/je)}const se=[];for(let Y=0,K=te.length,ve=K-1,Ae=Y+1;Y<K;Y++,ve++,Ae++)ve===K&&(ve=0),Ae===K&&(Ae=0),se[Y]=pe(te[Y],te[ve],te[Ae]);const ae=[];let Le,Re=se.concat();for(let Y=0,K=ee.length;Y<K;Y++){const ve=ee[Y];Le=[];for(let Ae=0,De=ve.length,je=De-1,Xe=Ae+1;Ae<De;Ae++,je++,Xe++)je===De&&(je=0),Xe===De&&(Xe=0),Le[Ae]=pe(ve[Ae],ve[je],ve[Xe]);ae.push(Le),Re=Re.concat(Le)}for(let Y=0;Y<_;Y++){const K=Y/_,ve=v*Math.cos(K*Math.PI/2),Ae=x*Math.sin(K*Math.PI/2)+y;for(let De=0,je=te.length;De<je;De++){const Xe=fe(te[De],se[De],Ae);Mt(Xe.x,Xe.y,-ve)}for(let De=0,je=ee.length;De<je;De++){const Xe=ee[De];Le=ae[De];for(let He=0,ne=Xe.length;He<ne;He++){const W=fe(Xe[He],Le[He],Ae);Mt(W.x,W.y,-ve)}}}const Ue=x+y;for(let Y=0;Y<ge;Y++){const K=f?fe(U[Y],Re[Y],Ue):U[Y];P?(j.copy(D.normals[0]).multiplyScalar(K.x),N.copy(D.binormals[0]).multiplyScalar(K.y),T.copy(A[0]).add(j).add(N),Mt(T.x,T.y,T.z)):Mt(K.x,K.y,0)}for(let Y=1;Y<=d;Y++)for(let K=0;K<ge;K++){const ve=f?fe(U[K],Re[K],Ue):U[K];P?(j.copy(D.normals[Y]).multiplyScalar(ve.x),N.copy(D.binormals[Y]).multiplyScalar(ve.y),T.copy(A[Y]).add(j).add(N),Mt(T.x,T.y,T.z)):Mt(ve.x,ve.y,p/d*Y)}for(let Y=_-1;Y>=0;Y--){const K=Y/_,ve=v*Math.cos(K*Math.PI/2),Ae=x*Math.sin(K*Math.PI/2)+y;for(let De=0,je=te.length;De<je;De++){const Xe=fe(te[De],se[De],Ae);Mt(Xe.x,Xe.y,p+ve)}for(let De=0,je=ee.length;De<je;De++){const Xe=ee[De];Le=ae[De];for(let He=0,ne=Xe.length;He<ne;He++){const W=fe(Xe[He],Le[He],Ae);P?Mt(W.x,W.y+A[d-1].y,A[d-1].x+ve):Mt(W.x,W.y,p+ve)}}}Ze(),st();function Ze(){const Y=i.length/3;if(f){let K=0,ve=ge*K;for(let Ae=0;Ae<Se;Ae++){const De=ce[Ae];rt(De[2]+ve,De[1]+ve,De[0]+ve)}K=d+_*2,ve=ge*K;for(let Ae=0;Ae<Se;Ae++){const De=ce[Ae];rt(De[0]+ve,De[1]+ve,De[2]+ve)}}else{for(let K=0;K<Se;K++){const ve=ce[K];rt(ve[2],ve[1],ve[0])}for(let K=0;K<Se;K++){const ve=ce[K];rt(ve[0]+ge*d,ve[1]+ge*d,ve[2]+ge*d)}}r.addGroup(Y,i.length/3-Y,0)}function st(){const Y=i.length/3;let K=0;we(te,K),K+=te.length;for(let ve=0,Ae=ee.length;ve<Ae;ve++){const De=ee[ve];we(De,K),K+=De.length}r.addGroup(Y,i.length/3-Y,1)}function we(Y,K){let ve=Y.length;for(;--ve>=0;){const Ae=ve;let De=ve-1;De<0&&(De=Y.length-1);for(let je=0,Xe=d+_*2;je<Xe;je++){const He=ge*je,ne=ge*(je+1),W=K+Ae+He,O=K+De+He,E=K+De+ne,F=K+Ae+ne;it(W,O,E,F)}}}function Mt(Y,K,ve){c.push(Y),c.push(K),c.push(ve)}function rt(Y,K,ve){Ke(Y),Ke(K),Ke(ve);const Ae=i.length/3,De=C.generateTopUV(r,i,Ae-3,Ae-2,Ae-1);Qe(De[0]),Qe(De[1]),Qe(De[2])}function it(Y,K,ve,Ae){Ke(Y),Ke(K),Ke(Ae),Ke(K),Ke(ve),Ke(Ae);const De=i.length/3,je=C.generateSideWallUV(r,i,De-6,De-3,De-2,De-1);Qe(je[0]),Qe(je[1]),Qe(je[3]),Qe(je[1]),Qe(je[2]),Qe(je[3])}function Ke(Y){i.push(c[Y*3+0]),i.push(c[Y*3+1]),i.push(c[Y*3+2])}function Qe(Y){s.push(Y.x),s.push(Y.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return nFe(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new lle[i.type]().fromJSON(i)),new MO(r,e.options)}}const tFe={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],c=e[r*3+1],u=e[i*3],d=e[i*3+1];return[new ut(s,o),new ut(a,c),new ut(u,d)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],u=e[r*3],d=e[r*3+1],p=e[r*3+2],f=e[i*3],v=e[i*3+1],x=e[i*3+2],y=e[s*3],_=e[s*3+1],S=e[s*3+2];return Math.abs(a-d)<Math.abs(o-u)?[new ut(o,1-c),new ut(u,1-p),new ut(f,1-x),new ut(y,1-S)]:[new ut(a,1-c),new ut(d,1-p),new ut(v,1-x),new ut(_,1-S)]}};function nFe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class $H extends YD{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $H(e.radius,e.detail)}}class e7 extends As{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const c=Math.min(o+a,Math.PI);let u=0;const d=[],p=new Te,f=new Te,v=[],x=[],y=[],_=[];for(let S=0;S<=r;S++){const C=[],A=S/r;let P=0;S==0&&o==0?P=.5/t:S==r&&c==Math.PI&&(P=-.5/t);for(let D=0;D<=t;D++){const N=D/t;p.x=-e*Math.cos(i+N*s)*Math.sin(o+A*a),p.y=e*Math.cos(o+A*a),p.z=e*Math.sin(i+N*s)*Math.sin(o+A*a),x.push(p.x,p.y,p.z),f.copy(p).normalize(),y.push(f.x,f.y,f.z),_.push(N+P,1-A),C.push(u++)}d.push(C)}for(let S=0;S<r;S++)for(let C=0;C<t;C++){const A=d[S][C+1],P=d[S][C],D=d[S+1][C],N=d[S+1][C+1];(S!==0||o>0)&&v.push(A,P,N),(S!==r-1||c<Math.PI)&&v.push(P,D,N)}this.setIndex(v),this.setAttribute("position",new sr(x,3)),this.setAttribute("normal",new sr(y,3)),this.setAttribute("uv",new sr(_,2))}static fromJSON(e){return new e7(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class t7 extends YD{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new t7(e.radius,e.detail)}}class n7 extends As{constructor(e=1,t=.4,r=8,i=6,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],c=[],u=[],d=new Te,p=new Te,f=new Te;for(let v=0;v<=r;v++)for(let x=0;x<=i;x++){const y=x/i*s,_=v/r*Math.PI*2;p.x=(e+t*Math.cos(_))*Math.cos(y),p.y=(e+t*Math.cos(_))*Math.sin(y),p.z=t*Math.sin(_),a.push(p.x,p.y,p.z),d.x=e*Math.cos(y),d.y=e*Math.sin(y),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),u.push(x/i),u.push(v/r)}for(let v=1;v<=r;v++)for(let x=1;x<=i;x++){const y=(i+1)*v+x-1,_=(i+1)*(v-1)+x-1,S=(i+1)*(v-1)+x,C=(i+1)*v+x;o.push(y,_,C),o.push(_,S,C)}this.setIndex(o),this.setAttribute("position",new sr(a,3)),this.setAttribute("normal",new sr(c,3)),this.setAttribute("uv",new sr(u,2))}static fromJSON(e){return new n7(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class rFe extends of{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new en(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new en(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nE,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iFe extends of{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new en(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new en(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nE,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class sFe extends of{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nE,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Yf(n,e,t){return dle(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function yT(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function dle(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function oFe(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function iJ(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let c=0;c!==e;++c)i[o++]=n[a+c]}return i}function ple(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}class KD{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let c=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===c)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class aFe extends KD{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Sy,endingEnd:Sy}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],c=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case My:s=e,a=2*t-r;break;case xO:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(c===void 0)switch(this.getSettings_().endingEnd){case My:o=e,c=2*r-t;break;case xO:o=1,c=r+i[1]-i[0];break;default:o=e-1,c=t}const u=(r-t)*.5,d=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(c-r),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,d=this._offsetPrev,p=this._offsetNext,f=this._weightPrev,v=this._weightNext,x=(r-t)/(i-t),y=x*x,_=y*x,S=-f*_+2*f*y-f*x,C=(1+f)*_+(-1.5-2*f)*y+(-.5+f)*x+1,A=(-1-v)*_+(1.5+v)*y+.5*x,P=v*_-v*y;for(let D=0;D!==a;++D)s[D]=S*o[d+D]+C*o[u+D]+A*o[c+D]+P*o[p+D];return s}}class fle extends KD{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,d=(r-t)/(i-t),p=1-d;for(let f=0;f!==a;++f)s[f]=o[u+f]*p+o[c+f]*d;return s}}class lFe extends KD{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class dd{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=yT(t,this.TimeBufferType),this.values=yT(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:yT(e.times,Array),values:yT(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new lFe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new fle(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new aFe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case _O:t=this.InterpolantFactoryMethodDiscrete;break;case yO:t=this.InterpolantFactoryMethodLinear;break;case DV:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return _O;case this.InterpolantFactoryMethodLinear:return yO;case this.InterpolantFactoryMethodSmooth:return DV}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Yf(r,s,o),this.values=Yf(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=r[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(i!==void 0&&dle(i))for(let a=0,c=i.length;a!==c;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=Yf(this.times),t=Yf(this.values),r=this.getValueSize(),i=this.getInterpolation()===DV,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(i)c=!0;else{const p=a*r,f=p-r,v=p+r;for(let x=0;x!==r;++x){const y=t[p+x];if(y!==t[f+x]||y!==t[v+x]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const p=a*r,f=o*r;for(let v=0;v!==r;++v)t[f+v]=t[p+v]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,c=o*r,u=0;u!==r;++u)t[c+u]=t[a+u];++o}return o!==e.length?(this.times=Yf(e,0,o),this.values=Yf(t,0,o*r)):(this.times=e,this.values=t),this}clone(){const e=Yf(this.times,0),t=Yf(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}dd.prototype.TimeBufferType=Float32Array;dd.prototype.ValueBufferType=Float32Array;dd.prototype.DefaultInterpolation=yO;class Pb extends dd{}Pb.prototype.ValueTypeName="bool";Pb.prototype.ValueBufferType=Array;Pb.prototype.DefaultInterpolation=_O;Pb.prototype.InterpolantFactoryMethodLinear=void 0;Pb.prototype.InterpolantFactoryMethodSmooth=void 0;class mle extends dd{}mle.prototype.ValueTypeName="color";class gC extends dd{}gC.prototype.ValueTypeName="number";class cFe extends KD{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(r-t)/(i-t);let u=e*a;for(let d=u+a;u!==d;u+=4)Mc.slerpFlat(s,0,o,u-a,o,u,c);return s}}class lE extends dd{InterpolantFactoryMethodLinear(e){return new cFe(this.times,this.values,this.getValueSize(),e)}}lE.prototype.ValueTypeName="quaternion";lE.prototype.DefaultInterpolation=yO;lE.prototype.InterpolantFactoryMethodSmooth=void 0;class Tb extends dd{}Tb.prototype.ValueTypeName="string";Tb.prototype.ValueBufferType=Array;Tb.prototype.DefaultInterpolation=_O;Tb.prototype.InterpolantFactoryMethodLinear=void 0;Tb.prototype.InterpolantFactoryMethodSmooth=void 0;class CO extends dd{}CO.prototype.ValueTypeName="vector";class f8{constructor(e,t=-1,r,i=FH){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=oh(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(hFe(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(dd.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],u=[];c.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=oFe(c);c=iJ(c,1,d),u=iJ(u,1,d),!i&&c[0]===0&&(c.push(s),u.push(u[0])),o.push(new gC(".morphTargetInfluences["+t[a].name+"]",c,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const p=d[1];let f=i[p];f||(i[p]=f=[]),f.push(u)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(p,f,v,x,y){if(v.length!==0){const _=[],S=[];ple(v,_,S,x),_.length!==0&&y.push(new p(f,_,S))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let p=0;p<u.length;p++){const f=u[p].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const v={};let x;for(x=0;x<f.length;x++)if(f[x].morphTargets)for(let y=0;y<f[x].morphTargets.length;y++)v[f[x].morphTargets[y]]=-1;for(const y in v){const _=[],S=[];for(let C=0;C!==f[x].morphTargets.length;++C){const A=f[x];_.push(A.time),S.push(A.morphTarget===y?1:0)}i.push(new gC(".morphTargetInfluence["+y+"]",_,S))}c=v.length*o}else{const v=".bones["+t[p].name+"]";r(CO,v+".position",f,"pos",i),r(lE,v+".quaternion",f,"rot",i),r(CO,v+".scale",f,"scl",i)}}return i.length===0?null:new this(s,c,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function uFe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return gC;case"vector":case"vector2":case"vector3":case"vector4":return CO;case"color":return mle;case"quaternion":return lE;case"bool":case"boolean":return Pb;case"string":return Tb}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function hFe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=uFe(n.type);if(n.times===void 0){const t=[],r=[];ple(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const EO={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class dFe{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(d){a++,s===!1&&i.onStart!==void 0&&i.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,i.onProgress!==void 0&&i.onProgress(d,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,p){return u.push(d,p),this},this.removeHandler=function(d){const p=u.indexOf(d);return p!==-1&&u.splice(p,2),this},this.getHandler=function(d){for(let p=0,f=u.length;p<f;p+=2){const v=u[p],x=u[p+1];if(v.global&&(v.lastIndex=0),v.test(d))return x}return null}}}const vle=new dFe;class Rb{constructor(e){this.manager=e!==void 0?e:vle,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const _p={};class pFe extends Error{constructor(e,t){super(e),this.response=t}}class gle extends Rb{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=EO.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(_p[e]!==void 0){_p[e].push({onLoad:t,onProgress:r,onError:i});return}_p[e]=[],_p[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=_p[e],p=u.body.getReader(),f=u.headers.get("Content-Length"),v=f?parseInt(f):0,x=v!==0;let y=0;const _=new ReadableStream({start(S){C();function C(){p.read().then(({done:A,value:P})=>{if(A)S.close();else{y+=P.byteLength;const D=new ProgressEvent("progress",{lengthComputable:x,loaded:y,total:v});for(let N=0,j=d.length;N<j;N++){const T=d[N];T.onProgress&&T.onProgress(D)}S.enqueue(P),C()}})}}});return new Response(_)}else throw new pFe(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const p=/charset="?([^;"\s]*)"?/i.exec(a),f=p&&p[1]?p[1].toLowerCase():void 0,v=new TextDecoder(f);return u.arrayBuffer().then(x=>v.decode(x))}}}).then(u=>{EO.add(e,u);const d=_p[e];delete _p[e];for(let p=0,f=d.length;p<f;p++){const v=d[p];v.onLoad&&v.onLoad(u)}}).catch(u=>{const d=_p[e];if(d===void 0)throw this.manager.itemError(e),u;delete _p[e];for(let p=0,f=d.length;p<f;p++){const v=d[p];v.onError&&v.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class _le extends Rb{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=EO.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=pC("img");function c(){d(),EO.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(p){d(),i&&i(p),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",c,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class fFe extends Rb{constructor(e){super(e)}load(e,t,r,i){const s=new GH,o=new _le(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(u){o.load(e[u],function(d){s.images[u]=d,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)c(u);return s}}class mFe extends Rb{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new wVe,a=new gle(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){const u=s.parse(c);!u||(u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:vc,o.wrapT=u.wrapT!==void 0?u.wrapT:vc,o.magFilter=u.magFilter!==void 0?u.magFilter:Us,o.minFilter=u.minFilter!==void 0?u.minFilter:Us,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=tE),u.mipmapCount===1&&(o.minFilter=Us),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,t&&t(o,u))},r,i),o}}class vFe extends Rb{constructor(e){super(e)}load(e,t,r,i){const s=new ka,o=new _le(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class yle extends Qi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new en(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class t$e extends yle{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Qi.DefaultUp),this.updateMatrix(),this.groundColor=new en(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const sJ=new Vr,oJ=new Te,aJ=new Te;class gFe{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ut(512,512),this.map=null,this.mapPass=null,this.matrix=new Vr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new HD,this._frameExtents=new ut(1,1),this._viewportCount=1,this._viewports=[new No(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;oJ.setFromMatrixPosition(e.matrixWorld),t.position.copy(oJ),aJ.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(aJ),t.updateMatrixWorld(),sJ.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sJ),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class _Fe extends gFe{constructor(){super(new oE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class n$e extends yle{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Qi.DefaultUp),this.updateMatrix(),this.target=new Qi,this.shadow=new _Fe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}let xT;const yFe={getContext:function(){return xT===void 0&&(xT=new(window.AudioContext||window.webkitAudioContext)),xT},setContext:function(n){xT=n}};class xFe extends Rb{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new gle(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const c=a.slice(0);yFe.getContext().decodeAudioData(c,function(d){t(d)})}catch(c){i?i(c):console.error(c),s.manager.itemError(e)}},r,i)}}class xle{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=lJ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=lJ();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function lJ(){return(typeof performance>"u"?Date:performance).now()}class bFe{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(r,i,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let c=t,u=t+t;c!==u;++c)if(r[c]!==r[c+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Mc.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Mc.multiplyQuaternionsFlat(e,o,e,t,e,r),Mc.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const r7="\\[\\]\\.:\\/",wFe=new RegExp("["+r7+"]","g"),i7="[^"+r7+"]",SFe="[^"+r7.replace("\\.","")+"]",MFe=/((?:WC+[\/:])*)/.source.replace("WC",i7),CFe=/(WCOD+)?/.source.replace("WCOD",SFe),EFe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",i7),AFe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",i7),PFe=new RegExp("^"+MFe+CFe+EFe+AFe+"$"),TFe=["material","materials","bones","map"];class RFe{constructor(e,t,r){const i=r||Dr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class Dr{constructor(e,t,r){this.path=t,this.parsedPath=r||Dr.parseTrackName(t),this.node=Dr.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Dr.Composite(e,t,r):new Dr(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(wFe,"")}static parseTrackName(e){const t=PFe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);TFe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=r(a.children);if(c)return c}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Dr.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[i];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Dr.Composite=RFe;Dr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Dr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Dr.prototype.GetterByBindingType=[Dr.prototype._getValue_direct,Dr.prototype._getValue_array,Dr.prototype._getValue_arrayElement,Dr.prototype._getValue_toArray];Dr.prototype.SetterByBindingTypeAndVersioning=[[Dr.prototype._setValue_direct,Dr.prototype._setValue_direct_setNeedsUpdate,Dr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Dr.prototype._setValue_array,Dr.prototype._setValue_array_setNeedsUpdate,Dr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Dr.prototype._setValue_arrayElement,Dr.prototype._setValue_arrayElement_setNeedsUpdate,Dr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Dr.prototype._setValue_fromArray,Dr.prototype._setValue_fromArray_setNeedsUpdate,Dr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class OFe{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:Sy,endingEnd:Sy};for(let u=0;u!==o;++u){const d=s[u].createInterpolant(null);a[u]=d,d.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=o8,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,u=a.sampleValues;return c[0]=s,c[1]=s+r,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*r;c<0||r===0?t=0:(this._startTime=null,t=r*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case cNe:for(let d=0,p=c.length;d!==p;++d)c[d].evaluate(o),u[d].accumulateAdditive(a);break;case FH:default:for(let d=0,p=c.length;d!==p;++d)c[d].evaluate(o),u[d].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===lNe;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===s8){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=My,i.endingEnd=My):(e?i.endingStart=this.zeroSlopeAtStart?My:Sy:i.endingStart=xO,t?i.endingEnd=this.zeroSlopeAtEnd?My:Sy:i.endingEnd=xO)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=r,this}}const LFe=new Float32Array(1);class DFe extends V0{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,c=r.uuid,u=this._bindingsByRootAndName;let d=u[c];d===void 0&&(d={},u[c]=d);for(let p=0;p!==s;++p){const f=i[p],v=f.name;let x=d[v];if(x!==void 0)++x.referenceCount,o[p]=x;else{if(x=o[p],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,c,v));continue}const y=t&&t._propertyBindings[p].binding.parsedPath;x=new bFe(Dr.create(r,v,y),f.ValueTypeName,f.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,c,v),o[p]=x}a[p].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,u=c[c.length-1],d=e._byClipCacheIndex;u._byClipCacheIndex=d,c[d]=u,c.pop(),e._byClipCacheIndex=null;const p=a.actionByRoot,f=(e._localRoot||this._root).uuid;delete p[f],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],c=t[t.length-1],u=e._cacheIndex;c._cacheIndex=u,t[u]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new fle(new Float32Array(2),new Float32Array(2),1,LFe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?f8.findByName(i,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let u=null;if(r===void 0&&(o!==null?r=o.blendMode:r=FH),c!==void 0){const p=c.actionByRoot[s];if(p!==void 0&&p.blendMode===r)return p;u=c.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const d=new OFe(this,o,t,r);return this._bindAction(d,u),this._addInactiveAction(d,a,s),d}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?f8.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==r;++u)t[u]._update(i,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let u=0;u!==c;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const u=o[a];this._deactivateAction(u);const d=u._cacheIndex,p=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,p._cacheIndex=d,t[d]=p,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class IFe{constructor(e,t,r=0,i=1/0){this.ray=new rE(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new jH,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return m8(e,this,r,t),r.sort(cJ),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)m8(e[i],this,r,t);return r.sort(cJ),r}}function cJ(n,e){return n.distance-e.distance}function m8(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)m8(i[s],e,t,!0)}}const uJ=new ut;class r$e{constructor(e=new ut(1/0,1/0),t=new ut(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=uJ.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return uJ.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hJ=new Te,bT=new Te;class NFe{constructor(e=new Te,t=new Te){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){hJ.subVectors(e,this.start),bT.subVectors(this.end,this.start);const r=bT.dot(bT);let s=bT.dot(hJ)/r;return t&&(s=Eo(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Zf=new Te,wT=new Vr,dF=new Vr;class kFe extends XD{constructor(e){const t=ble(e),r=new As,i=[],s=[],o=new en(0,0,1),a=new en(0,1,0);for(let u=0;u<t.length;u++){const d=t[u];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new sr(i,3)),r.setAttribute("color",new sr(s,3));const c=new aE({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");dF.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(wT.multiplyMatrices(dF,a.matrixWorld),Zf.setFromMatrixPosition(wT),i.setXYZ(o,Zf.x,Zf.y,Zf.z),wT.multiplyMatrices(dF,a.parent.matrixWorld),Zf.setFromMatrixPosition(wT),i.setXYZ(o+1,Zf.x,Zf.y,Zf.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function ble(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,ble(n.children[t]));return e}class zFe extends XD{constructor(e=10,t=10,r=4473924,i=8947848){r=new en(r),i=new en(i);const s=t/2,o=e/t,a=e/2,c=[],u=[];for(let f=0,v=0,x=-a;f<=t;f++,x+=o){c.push(-a,0,x,a,0,x),c.push(x,0,-a,x,0,a);const y=f===s?r:i;y.toArray(u,v),v+=3,y.toArray(u,v),v+=3,y.toArray(u,v),v+=3,y.toArray(u,v),v+=3}const d=new As;d.setAttribute("position",new sr(c,3)),d.setAttribute("color",new sr(u,3));const p=new aE({vertexColors:!0,toneMapped:!1});super(d,p),this.type="GridHelper"}}const ST=new Te,is=new HH;class BFe extends XD{constructor(e){const t=new As,r=new aE({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(x,y){c(x),c(y)}function c(x){i.push(0,0,0),s.push(0,0,0),o[x]===void 0&&(o[x]=[]),o[x].push(i.length/3-1)}t.setAttribute("position",new sr(i,3)),t.setAttribute("color",new sr(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new en(16755200),d=new en(16711680),p=new en(43775),f=new en(16777215),v=new en(3355443);this.setColors(u,d,p,f,v)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;is.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),bs("c",t,e,is,0,0,-1),bs("t",t,e,is,0,0,1),bs("n1",t,e,is,-r,-i,-1),bs("n2",t,e,is,r,-i,-1),bs("n3",t,e,is,-r,i,-1),bs("n4",t,e,is,r,i,-1),bs("f1",t,e,is,-r,-i,1),bs("f2",t,e,is,r,-i,1),bs("f3",t,e,is,-r,i,1),bs("f4",t,e,is,r,i,1),bs("u1",t,e,is,r*.7,i*1.1,-1),bs("u2",t,e,is,-r*.7,i*1.1,-1),bs("u3",t,e,is,0,i*2,-1),bs("cf1",t,e,is,-r,0,1),bs("cf2",t,e,is,r,0,1),bs("cf3",t,e,is,0,-i,1),bs("cf4",t,e,is,0,i,1),bs("cn1",t,e,is,-r,0,-1),bs("cn2",t,e,is,r,0,-1),bs("cn3",t,e,is,0,-i,-1),bs("cn4",t,e,is,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function bs(n,e,t,r,i,s,o){ST.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const c=t.getAttribute("position");for(let u=0,d=a.length;u<d;u++)c.setXYZ(a[u],ST.x,ST.y,ST.z)}}const MT=new nv;class wle extends XD{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new As;s.setIndex(new Cc(r,1)),s.setAttribute("position",new Cc(i,3)),super(s,new aE({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&MT.setFromObject(this.object),MT.isEmpty())return;const t=MT.min,r=MT.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}}class i$e{constructor(){this.type="ShapePath",this.color=new en,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new h8,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const C=[];for(let A=0,P=S.length;A<P;A++){const D=S[A],N=new nR;N.curves=D.curves,C.push(N)}return C}function r(S,C){const A=C.length;let P=!1;for(let D=A-1,N=0;N<A;D=N++){let j=C[D],T=C[N],k=T.x-j.x,U=T.y-j.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(j=C[N],k=-k,T=C[D],U=-U),S.y<j.y||S.y>T.y)continue;if(S.y===j.y){if(S.x===j.x)return!0}else{const ee=U*(S.x-j.x)-k*(S.y-j.y);if(ee===0)return!0;if(ee<0)continue;P=!P}}else{if(S.y!==j.y)continue;if(T.x<=S.x&&S.x<=j.x||j.x<=S.x&&S.x<=T.x)return!0}}return P}const i=Wy.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,c;const u=[];if(s.length===1)return a=s[0],c=new nR,c.curves=a.curves,u.push(c),u;let d=!i(s[0].getPoints());d=e?!d:d;const p=[],f=[];let v=[],x=0,y;f[x]=void 0,v[x]=[];for(let S=0,C=s.length;S<C;S++)a=s[S],y=a.getPoints(),o=i(y),o=e?!o:o,o?(!d&&f[x]&&x++,f[x]={s:new nR,p:y},f[x].s.curves=a.curves,d&&x++,v[x]=[]):v[x].push({h:a,p:y[0]});if(!f[0])return t(s);if(f.length>1){let S=!1,C=0;for(let A=0,P=f.length;A<P;A++)p[A]=[];for(let A=0,P=f.length;A<P;A++){const D=v[A];for(let N=0;N<D.length;N++){const j=D[N];let T=!0;for(let k=0;k<f.length;k++)r(j.p,f[k].p)&&(A!==k&&C++,T?(T=!1,p[k].push(j)):S=!0);T&&p[A].push(j)}}C>0&&S===!1&&(v=p)}let _;for(let S=0,C=f.length;S<C;S++){c=f[S].s,u.push(c),_=v[S];for(let A=0,P=_.length;A<P;A++)c.holes.push(_[A].h)}return u}}const Tp=VFe();function VFe(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(r[c]=0,r[c|256]=32768,i[c]=24,i[c|256]=24):u<-14?(r[c]=1024>>-u-14,r[c|256]=1024>>-u-14|32768,i[c]=-u-1,i[c|256]=-u-1):u<=15?(r[c]=u+15<<10,r[c|256]=u+15<<10|32768,i[c]=13,i[c|256]=13):u<128?(r[c]=31744,r[c|256]=64512,i[c]=24,i[c|256]=24):(r[c]=31744,r[c|256]=64512,i[c]=13,i[c|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,d=0;for(;(u&8388608)===0;)u<<=1,d-=8388608;u&=-8388609,d+=947912704,s[c]=u|d}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function FFe(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Eo(n,-65504,65504),Tp.floatView[0]=n;const e=Tp.uint32View[0],t=e>>23&511;return Tp.baseTable[t]+((e&8388607)>>Tp.shiftTable[t])}function UFe(n){const e=n>>10;return Tp.uint32View[0]=Tp.mantissaTable[Tp.offsetTable[e]+(n&1023)]+Tp.exponentTable[e],Tp.floatView[0]}var CT=Object.freeze({__proto__:null,toHalfFloat:FFe,fromHalfFloat:UFe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:BH}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=BH);const[pF,ha]=fa(),[s7,zm]=Pt([]),dJ=Mb(s7,zm),jFe=Cb(s7,zm),o7=bIe(s7,zm),HFe=new WeakSet,[s$e,Sle]=Pt(!1),[WFe,Oc]=Pt(void 0),_C=n=>{!Sle()&&WFe(n)},Sn=new _Ve;yn(()=>{const n=Oc();if(!n)return;const e=new wle(n.nativeObject3d),t=requestAnimationFrame(()=>Sn.add(e)),r=ha(()=>e.update());return()=>{cancelAnimationFrame(t),Sn.remove(e),r.cancel()}},[Oc]);yn(()=>{const n=zm();if(!n.length)return;const e=[];for(const r of n){const i=new wle(r.outerObject3d);Sn.add(i),e.push(i)}const t=ha(()=>{for(const r of e)r.update()});return()=>{for(const r of e)Sn.remove(r);t.cancel()}},[zm]);const Mle=100,Qr=1/Mle,js=Mle,Ec=100*Qr,Fp=Ec*.5;class fy{constructor(e,t){this.x=e,this.y=t}}class h0{constructor(e,t,r){this.x=e,this.y=t,this.z=r}}const d0=180/Math.PI,Co=Math.PI/180,fF=(n,e,t,r)=>Math.sqrt((n-t)**2+(e-r)**2),Cle=(n,e,t,r,i,s)=>Math.sqrt((n-r)**2+(e-i)**2+(t-s)**2),GFe=(n,e,t,r)=>{const i=fF(n.x,n.y,e.x,e.y),s=fF(n.x,n.y,t.x,t.y),o=fF(e.x,e.y,t.x,t.y),a=Math.acos((i*i+s*s-o*o)/(2*i*s))*d0;return r?360-a:a},XFe=(n,e,t)=>{const r=t*Co,i=n.x-e.x,s=n.y-e.y,o=i*Math.cos(r)-s*Math.sin(r),a=i*Math.sin(r)+s*Math.cos(r);return new fy(o+e.x,a+e.y)},qFe=(n,e,t,r)=>n>=t&&e<=r?1:n<=t&&e<=r?2:n<=t&&e>=r?3:4,YFe=new Set,cE=n=>{for(const e of n)YFe.add(e)},uE={onLoop:Function,proxy:Object};cE(["proxy"]);const hE={onLoop:void 0,proxy:void 0},om=()=>{};class ki{constructor(e){We(this,"value");this.value=e}}const ZFe={...uE,onClick:Function,onMouseDown:Function,onMouseUp:Function,onMouseOver:Function,onMouseOut:Function,onMouseMove:Function,onLookToEnd:Function,lookAt:[Function,Array],lookTo:[Function,Array],name:String,id:String,bloom:Boolean,outline:Boolean,visible:Boolean,frustumCulled:Boolean,castShadow:Boolean,receiveShadow:Boolean,metalnessFactor:Number,roughnessFactor:Number,opacityFactor:Number,envFactor:Number,adjustColor:String,reflection:Boolean,illumination:Boolean,toon:Boolean};cE(["lookAt","lookTo"]);const KFe={...hE,onClick:void 0,onMouseDown:void 0,onMouseUp:void 0,onMouseOver:void 0,onMouseOut:void 0,onMouseMove:void 0,onLookToEnd:void 0,lookAt:om,lookTo:om,name:"",id:void 0,bloom:!1,outline:!1,visible:!0,frustumCulled:!0,castShadow:!0,receiveShadow:!0,metalnessFactor:new ki(0),roughnessFactor:new ki(1),opacityFactor:new ki(1),envFactor:new ki(1),adjustColor:new ki("#ffffff"),reflection:!1,illumination:!1,toon:!1},JFe={...ZFe,animations:Object,animation:[String,Number,Array,Boolean,Object],animationPaused:Boolean,animationRepeat:Boolean,onAnimationFinish:Function},QFe={...KFe,animations:{},animation:void 0,animationPaused:new ki(!1),animationRepeat:new ki(!0),onAnimationFinish:void 0},Ele={...uE,x:Number,y:Number,z:Number},Ale={...hE,x:0,y:0,z:0},Ple={...JFe,...Ele,onIntersect:Function,onIntersectOut:Function,onMoveToEnd:Function,moveTo:[Function,Array],lerpTo:[Function,Array],placeAt:[Function,Array],translateX:[Function,Array],translateY:[Function,Array],translateZ:[Function,Array],intersectIds:Array,scaleX:Number,scaleY:Number,scaleZ:Number,scale:Number,rotationX:Number,rotationY:Number,rotationZ:Number,rotation:Number};cE(["intersectIds","moveTo","lerpTo"]);const Tle={...QFe,...Ale,onIntersect:void 0,onIntersectOut:void 0,onMoveToEnd:void 0,moveTo:om,lerpTo:om,placeAt:om,translateX:om,translateY:om,translateZ:om,intersectIds:void 0,scaleX:1,scaleY:1,scaleZ:1,scale:1,rotationX:0,rotationY:0,rotationZ:0,rotation:0},JD={color:String,fog:Boolean,opacity:Number,texture:[String,Object],videoTexture:[String,Object],alphaMap:String,textureRepeat:[Object,Number],textureFlipY:Boolean,textureRotation:Number},QD={color:"#ffffff",fog:!0,opacity:1,texture:void 0,videoTexture:void 0,alphaMap:void 0,textureRepeat:new ki({x:1,y:1}),textureFlipY:new ki(!1),textureRotation:new ki(0)},a7={color:String,wireframe:Boolean,envMap:String,aoMap:String,aoMapIntensity:Number,bumpMap:String,bumpScale:Number,displacementMap:String,displacementScale:Number,displacementBias:Number,emissive:Boolean,emissiveColor:String,emissiveMap:String,emissiveIntensity:Number,lightMap:String,lightMapIntensity:Number,metalnessMap:String,metalness:Number,roughnessMap:String,roughness:Number,normalMap:String,normalScale:[Object,Number],normalMapType:String},l7={color:"#ffffff",wireframe:!1,envMap:void 0,aoMap:void 0,aoMapIntensity:1,bumpMap:void 0,bumpScale:1,displacementMap:void 0,displacementScale:1,displacementBias:0,emissive:!1,emissiveColor:"#000000",emissiveMap:void 0,emissiveIntensity:1,lightMap:void 0,lightMapIntensity:1,metalnessMap:void 0,metalness:0,roughnessMap:void 0,roughness:1,normalMap:void 0,normalScale:{x:1,y:1},normalMapType:void 0},$Fe={...Ple,...JD,...a7},e6e={...Tle,...QD,...l7},pJ=[0],fJ=new Map,t6e=new Set,Rle=n=>e=>{fJ.set(n,e.loaded),pJ[0]=[...fJ.values()].reduce((t,r)=>t+r,0),t6e.forEach(t=>{try{t(pJ[0])}finally{}})};class n6e extends mFe{constructor(e){super(e),this.type=Ip}parse(e){const a=function(A,P){switch(A){case 1:console.error("THREE.RGBELoader Read Error: "+(P||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(P||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(P||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(P||""))}return-1},p=`
`,f=function(A,P,D){P=P||1024;let j=A.pos,T=-1,k=0,U="",ee=String.fromCharCode.apply(null,new Uint16Array(A.subarray(j,j+128)));for(;0>(T=ee.indexOf(p))&&k<P&&j<A.byteLength;)U+=ee,k+=ee.length,j+=128,ee+=String.fromCharCode.apply(null,new Uint16Array(A.subarray(j,j+128)));return-1<T?(D!==!1&&(A.pos+=k+T+1),U+ee.slice(0,T)):!1},v=function(A){const P=/^#\?(\S+)/,D=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,N=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*FORMAT=(\S+)\s*$/,T=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,k={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let U,ee;if(A.pos>=A.byteLength||!(U=f(A)))return a(1,"no header found");if(!(ee=U.match(P)))return a(3,"bad initial token");for(k.valid|=1,k.programtype=ee[1],k.string+=U+`
`;U=f(A),U!==!1;){if(k.string+=U+`
`,U.charAt(0)==="#"){k.comments+=U+`
`;continue}if((ee=U.match(D))&&(k.gamma=parseFloat(ee[1])),(ee=U.match(N))&&(k.exposure=parseFloat(ee[1])),(ee=U.match(j))&&(k.valid|=2,k.format=ee[1]),(ee=U.match(T))&&(k.valid|=4,k.height=parseInt(ee[1],10),k.width=parseInt(ee[2],10)),k.valid&2&&k.valid&4)break}return k.valid&2?k.valid&4?k:a(3,"missing image size specifier"):a(3,"missing format specifier")},x=function(A,P,D){const N=P;if(N<8||N>32767||A[0]!==2||A[1]!==2||A[2]&128)return new Uint8Array(A);if(N!==(A[2]<<8|A[3]))return a(3,"wrong scanline width");const j=new Uint8Array(4*P*D);if(!j.length)return a(4,"unable to allocate buffer space");let T=0,k=0;const U=4*N,ee=new Uint8Array(4),xe=new Uint8Array(U);let ce=D;for(;ce>0&&k<A.byteLength;){if(k+4>A.byteLength)return a(1);if(ee[0]=A[k++],ee[1]=A[k++],ee[2]=A[k++],ee[3]=A[k++],ee[0]!=2||ee[1]!=2||(ee[2]<<8|ee[3])!=N)return a(3,"bad rgbe scanline format");let te=0,fe;for(;te<U&&k<A.byteLength;){fe=A[k++];const Se=fe>128;if(Se&&(fe-=128),fe===0||te+fe>U)return a(3,"bad scanline data");if(Se){const pe=A[k++];for(let se=0;se<fe;se++)xe[te++]=pe}else xe.set(A.subarray(k,k+fe),te),te+=fe,k+=fe}const ge=N;for(let Se=0;Se<ge;Se++){let pe=0;j[T]=xe[Se+pe],pe+=N,j[T+1]=xe[Se+pe],pe+=N,j[T+2]=xe[Se+pe],pe+=N,j[T+3]=xe[Se+pe],T+=4}ce--}return j},y=function(A,P,D,N){const j=A[P+3],T=Math.pow(2,j-128)/255;D[N+0]=A[P+0]*T,D[N+1]=A[P+1]*T,D[N+2]=A[P+2]*T,D[N+3]=1},_=function(A,P,D,N){const j=A[P+3],T=Math.pow(2,j-128)/255;D[N+0]=CT.toHalfFloat(Math.min(A[P+0]*T,65504)),D[N+1]=CT.toHalfFloat(Math.min(A[P+1]*T,65504)),D[N+2]=CT.toHalfFloat(Math.min(A[P+2]*T,65504)),D[N+3]=CT.toHalfFloat(1)},S=new Uint8Array(e);S.pos=0;const C=v(S);if(C!==-1){const A=C.width,P=C.height,D=x(S.subarray(S.pos),A,P);if(D!==-1){let N,j,T;switch(this.type){case jh:T=D.length/4;const k=new Float32Array(T*4);for(let ee=0;ee<T;ee++)y(D,ee*4,k,ee*4);N=k,j=jh;break;case Ip:T=D.length/4;const U=new Uint16Array(T*4);for(let ee=0;ee<T;ee++)_(D,ee*4,U,ee*4);N=U,j=Ip;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:A,height:P,data:N,header:C.string,gamma:C.gamma,exposure:C.exposure,type:j}}}return null}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case jh:case Ip:o.encoding=Nm,o.minFilter=Us,o.magFilter=Us,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const r6e=new Map,i6e=new vFe,s6e=new n6e,mF=new Tae,ol=(n,e)=>(e&&mF.once(n,()=>queueMicrotask(e)),ev(r6e,n,()=>(n.toLowerCase().endsWith(".hdr")?s6e:i6e).load(n,i=>{i.wrapS=i.wrapT=Tx,mF.setState(n)},Rle(n),()=>mF.setState(n)))),o6e=()=>{const n=new Map,e=tv(()=>{for(const t of n.values())t();n.clear()},0,"trailing");return(t,r)=>{n.set(t,r),e()}},ry=["map","alphaMap"],a6e=o6e();class dE{constructor(){We(this,"materialCloned");We(this,"_opacity");We(this,"videoTextureState");We(this,"textureState");We(this,"_alphaMap");We(this,"_textureRepeat");We(this,"_textureFlipY");We(this,"_textureRotation")}tryCloneMaterial(){this.materialCloned||(this.materialCloned=!0,this.material=this.nativeObject3d.material=this.material.clone(),this.then(()=>this.material.dispose()))}get color(){return"#"+this.material.color.getHexString()}set color(e){this.tryCloneMaterial(),this.material.color=new en(e)}get fog(){return this.material.fog}set fog(e){this.tryCloneMaterial(),this.material.fog=e}get opacity(){var e;return(e=this._opacity)!=null?e:this._opacity=1}set opacity(e){this.tryCloneMaterial(),this._opacity=e,this.material.opacity=e,this.material.transparent=e<=1,this.nativeObject3d.visible=!!e}applyTexture(e){const t=this._textureRepeat,r=this._textureFlipY,i=this._textureRotation;a6e(this,()=>{this.tryCloneMaterial();for(const s of e){const o=this.material[s];if(!o)return;t!==void 0&&(o.repeat=t),r!==void 0&&(o.flipY=r),i!==void 0&&(o.rotation=i*Co),o.needsUpdate=!0}})}initTexture(){if(this.textureState)return;this.tryCloneMaterial();const e=this.videoTextureState=new tu(void 0),t=this.textureState=new tu(void 0);this.createEffect(()=>{const r=t.get(),i=e.get();if(i){let a;typeof i=="string"?(a=document.createElement("video"),a.crossOrigin="anonymous",a.src=i,a.loop=!0,a.autoplay=!0,a.muted=!0,a.playsInline=!0,a.play()):a=i;const c=new MVe(a,void 0,Tx,Tx),{material:u}=this,{map:d}=u;return u.map=c,u.needsUpdate=!0,this.applyTexture(ry),()=>{a.pause(),c.dispose(),u.map=d,u.needsUpdate=!0}}if(!r)return;const{material:s}=this,{map:o}=s;return s.map=ol(r),this.applyTexture(ry),()=>{s.map=o,this.material.needsUpdate=!0}},[e.get,t.get])}get videoTexture(){var e;return(e=this.videoTextureState)==null?void 0:e.get()}set videoTexture(e){this.initTexture(),this.videoTextureState.set(e)}get texture(){var e;return(e=this.textureState)==null?void 0:e.get()}set texture(e){this.initTexture(),this.textureState.set(e)}get alphaMap(){return this._alphaMap}set alphaMap(e){this.tryCloneMaterial(),this._alphaMap=e,this.material.alphaMap=e?ol(e):null,this.applyTexture(ry)}get textureRepeat(){return this._textureRepeat}set textureRepeat(e){typeof e=="number"&&(e=new ut(e,e)),this._textureRepeat=e,this.applyTexture(ry)}get textureFlipY(){return this._textureFlipY}set textureFlipY(e){this._textureFlipY=e,this.applyTexture(ry)}get textureRotation(){return this._textureRotation}set textureRotation(e){this._textureRotation=e,this.applyTexture(ry)}}const yp=["map","alphaMap","envMap","aoMap","bumpMap","displacementMap","emissiveMap","lightMap","metalnessMap","roughnessMap","normalMap"];class c7 extends dE{constructor(){super(...arguments);We(this,"_envMap");We(this,"_aoMap");We(this,"_bumpMap");We(this,"_displacementMap");We(this,"_emissiveMap");We(this,"_emissive");We(this,"_lightMap");We(this,"_metalnessMap");We(this,"_roughnessMap");We(this,"_normalMap");We(this,"_normalMapType")}get wireframe(){return this.material.wireframe}set wireframe(t){this.tryCloneMaterial(),this.material.wireframe=t}get envMap(){return this._envMap}set envMap(t){this.tryCloneMaterial(),this._envMap=t,this.material.envMap=t?ol(t):null,this.applyTexture(yp)}get aoMap(){return this._aoMap}set aoMap(t){this.tryCloneMaterial(),this._aoMap=t,this.material.aoMap=t?ol(t):null,this.applyTexture(yp)}get aoMapIntensity(){return this.material.aoMapIntensity}set aoMapIntensity(t){this.tryCloneMaterial(),this.material.aoMapIntensity=t}get bumpMap(){return this._bumpMap}set bumpMap(t){this.tryCloneMaterial(),this._bumpMap=t,this.material.bumpMap=t?ol(t):null,this.applyTexture(yp)}get bumpScale(){return this.material.bumpScale}set bumpScale(t){this.tryCloneMaterial(),this.material.bumpScale=t}get displacementMap(){return this._displacementMap}set displacementMap(t){this.tryCloneMaterial(),this._displacementMap=t,this.material.displacementMap=t?ol(t):null,this.applyTexture(yp)}get displacementScale(){return this.material.displacementScale}set displacementScale(t){this.tryCloneMaterial(),this.material.displacementScale=t}get displacementBias(){return this.material.displacementBias}set displacementBias(t){this.tryCloneMaterial(),this.material.displacementBias=t}get emissiveColor(){return"#"+this.material.emissive.getHexString()}set emissiveColor(t){this.tryCloneMaterial(),this.material.emissive=new en(t)}get emissiveMap(){return this._emissiveMap}set emissiveMap(t){this.tryCloneMaterial(),this._emissiveMap=t,this.material.emissiveMap=t?ol(t):null,this.applyTexture(yp)}get emissiveIntensity(){return this.material.emissiveIntensity}set emissiveIntensity(t){this.tryCloneMaterial(),this.material.emissiveIntensity=t}get emissive(){return!!this._emissive}set emissive(t){this._emissive=t,t&&(this.tryCloneMaterial(),this.material.emissiveMap=this.material.map,this.material.emissive=this.material.color)}get lightMap(){return this._lightMap}set lightMap(t){this.tryCloneMaterial(),this._lightMap=t,this.material.lightMap=t?ol(t):null,this.applyTexture(yp)}get lightMapIntensity(){return this.material.lightMapIntensity}set lightMapIntensity(t){this.tryCloneMaterial(),this.material.lightMapIntensity=t}get metalnessMap(){return this._metalnessMap}set metalnessMap(t){this.tryCloneMaterial(),this._metalnessMap=t,this.material.metalnessMap=t?ol(t):null,this.applyTexture(yp)}get metalness(){return this.material.metalness}set metalness(t){this.tryCloneMaterial(),this.material.metalness=t}get roughnessMap(){return this._roughnessMap}set roughnessMap(t){this.tryCloneMaterial(),this._roughnessMap=t,this.material.roughnessMap=t?ol(t):null,this.applyTexture(yp)}get roughness(){return this.material.roughness}set roughness(t){this.tryCloneMaterial(),this.material.roughness=t}get normalMap(){return this._normalMap}set normalMap(t){this.tryCloneMaterial(),this._normalMap=t,this.material.normalMap=t?ol(t):null,this.applyTexture(yp)}get normalScale(){return this.material.normalScale}set normalScale(t){this.tryCloneMaterial(),typeof t=="number"?this.material.normalScale=new ut(t,t):this.material.normalScale=t}get normalMapType(){return this._normalMapType}set normalMapType(t){this.tryCloneMaterial(),this._normalMapType=t,this.material.normalMapType=t==="objectSpace"?jae:nE}}const[l6e,pE]=fa(),vF=tv(l6e,0,"trailing"),dl=new Set;class Ole extends Aae{constructor(t=new Qi){super();We(this,"outerObject3d");We(this,"nativeObject3d");We(this,"parent");We(this,"children");this.outerObject3d=t,t.userData.manager=this,this.nativeObject3d=t,dl.add(this),vF()}get uuid(){return this.outerObject3d.uuid}_append(t){var r,i,s;dl.delete(t),vF(),(i=(r=t.parent)==null?void 0:r.children)==null||i.delete(t),t.parent=this,((s=this.children)!=null?s:this.children=new Set).add(t)}traverse(t){var r;for(const i of(r=this.children)!=null?r:[])t(i),i.traverse(t)}traverseSome(t){var r;for(const i of(r=this.children)!=null?r:[]){if(t(i))return!0;i.traverseSome(t)}return!1}append(t){this._append(t),this.outerObject3d.add(t.outerObject3d)}attach(t){this._append(t),this.outerObject3d.attach(t.outerObject3d)}dispose(){var t,r,i;if(this.done)return this;if(super.dispose(),dl.delete(this),vF(),(r=(t=this.parent)==null?void 0:t.children)==null||r.delete(this),this.parent=void 0,(i=this.outerObject3d.parent)==null||i.remove(this.outerObject3d),this.children)for(const s of this.children)s.dispose();return this}}const oa=new Te,o$e=new Te,a$e=new Te,c6e=new Mc,u6e=new Mc,h6e=new Te(0,0,0);Object.freeze(h6e);const v8=new Te(Ec,Ec,Ec);Object.freeze(v8);const Lle=new Te(Fp,Fp,Fp);Object.freeze(Lle);const Gy=new nv,Dle=new rE,wh=new Eb(0,0,0,"YXZ"),l$e=new NFe,Ile=new HD,d6e=new Vr,ET=Math.PI*.5,Nle=new iE({wireframe:!0}),AO=new rFe,Up=n=>new h0(n.x*js,n.y*js,n.z*js),kle=n=>new Te(n.x*Qr,n.y*Qr,n.z*Qr),[gF,Ob]=fa(),AT=new WeakMap,ia=n=>{if(n.parent===Sn)return n.position.clone();if(AT.has(n))return AT.get(n).clone();const e=n.getWorldPosition(new Te);return AT.set(n,e.clone()),Ob(()=>AT.delete(n),!0),e},PT=new WeakMap,fE=n=>{if(PT.has(n))return PT.get(n).clone();let e;return n instanceof bVe?e=ia(n):(n.updateWorldMatrix(!0,!1),Gy.setFromObject(n),Gy.isEmpty()?e=ia(n):e=Gy.getCenter(new Te)),PT.set(n,e.clone()),Ob(()=>PT.delete(n),!0),e},p6e=!!window.chrome,f6e=(()=>{const n=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(n)?!0:!!/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(n)})(),[m6e,yC]=Pt("#000000"),[v6e,g8]=Pt(!1),[g6e,zi]=Pt(void 0);yn(()=>{const n=new nle({powerPreference:"high-performance",alpha:yC()==="transparent",logarithmicDepthBuffer:p6e&&!f6e?g8():!1,antialias:!0});return n.shadowMap.enabled=!0,n.shadowMap.type=Iae,g6e(n),()=>{n.dispose()}},[yC,g8]);const[_6e,_8]=Pt(60),[zle,u7]=Pt(0),y6e=()=>zle(u7()+1),mJ=()=>setTimeout(()=>zle(u7()-1)),[x6e,PO]=Pt(!1),b6e=u7(tv(n=>{n||(b6e.cancel(),x6e(!0))},100,"trailing")),[w6e,y8]=Pt(!1),[S6e,Ble]=fa(),[M6e,C6e]=fa(),E6e=(n,e,t)=>{let r=0;const i=setInterval(()=>{document.hidden||(t(),e!==-1&&++r>=e&&clearInterval(i))},n);return new di(()=>clearInterval(i))},x8=new Set,A6e=new xle;let NS=0;const Ah=[1],h7=[0];let vJ=0,gJ=0;yn(()=>{const n=zi();if(!n||y8()&&!PO())return;const e=1/_8()*.9,t=1/60;n.setAnimationLoop(()=>{if(NS+=A6e.getDelta(),!(NS<e)){Ah[0]=NS/t,h7[0]=NS,NS=0;for(const r of x8)r();++vJ===2&&(vJ=0,S6e()),++gJ===10&&(gJ=0,M6e())}})},[_8,zi,PO,y8]);const rR=n=>(x8.add(n),new di(()=>x8.delete(n)));class Lb extends Ole{constructor(){super(...arguments);We(this,"_proxy");We(this,"handles");We(this,"_onLoop")}get proxy(){return this._proxy}set proxy(t){this._proxy&&(this._proxy.__target=void 0),this._proxy=t,t&&(t.__target=this)}timer(t,r,i){return this.watch(E6e(t,r,i))}beforeRender(t){return this.watch(ha(t))}queueMicrotask(t){queueMicrotask(()=>!this.done&&t())}cancellable(t){return this.watch(new di(t))}createEffect(t,r){return this.watch(yn(t,r))}cancelHandle(t,r){var o,a;const i=(o=this.handles)!=null?o:this.handles=new Map;if((a=i.get(t))==null||a.cancel(),!r)return;const s=r();return i.set(t,s),s}dispose(){if(this.done)return this;if(super.dispose(),this.handles)for(const t of this.handles.values())t.cancel();return this}get onLoop(){return this._onLoop}set onLoop(t){this._onLoop=t,this.cancelHandle("onLoop",t&&(()=>ha(t)))}}class Vle extends Lb{get x(){return this.outerObject3d.position.x*js}set x(e){this.outerObject3d.position.x=e*Qr}get y(){return this.outerObject3d.position.y*js}set y(e){this.outerObject3d.position.y=e*Qr}get z(){return this.outerObject3d.position.z*js}set z(e){this.outerObject3d.position.z=e*Qr}getWorldPosition(){return Up(ia(this.nativeObject3d))}}const TO=n=>n instanceof Lb&&"x"in n,dr={c:null,u:[new Te,new Te,new Te],e:[]},Rr={c:null,u:[new Te,new Te,new Te],e:[]},Wi=[[],[],[]],Tn=[[],[],[]],Ci=[],Rg=new Te,Og=new Te,Lg=new Te,no=new Te,_J=new Te,yJ=new Te,Gu=new ua,xJ=new nv,TT=new Vr,bJ=new Vr,wJ=new rE;class d7{constructor(e=new Te,t=new Te,r=new ua){this.center=e,this.halfSize=t,this.rotation=r}set(e,t,r){return this.center=e,this.halfSize=t,this.rotation=r,this}copy(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this}clone(){return new this.constructor().copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}clampPoint(e,t){const r=this.halfSize;no.subVectors(e,this.center),this.rotation.extractBasis(Rg,Og,Lg),t.copy(this.center);const i=NV.clamp(no.dot(Rg),-r.x,r.x);t.add(Rg.multiplyScalar(i));const s=NV.clamp(no.dot(Og),-r.y,r.y);t.add(Og.multiplyScalar(s));const o=NV.clamp(no.dot(Lg),-r.z,r.z);return t.add(Lg.multiplyScalar(o)),t}containsPoint(e){return no.subVectors(e,this.center),this.rotation.extractBasis(Rg,Og,Lg),Math.abs(no.dot(Rg))<=this.halfSize.x&&Math.abs(no.dot(Og))<=this.halfSize.y&&Math.abs(no.dot(Lg))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(P6e.fromBox3(e))}intersectsSphere(e){return this.clampPoint(e.center,yJ),yJ.distanceToSquared(e.center)<=e.radius*e.radius}intersectsOBB(e,t=Number.EPSILON){dr.c=this.center,dr.e[0]=this.halfSize.x,dr.e[1]=this.halfSize.y,dr.e[2]=this.halfSize.z,this.rotation.extractBasis(dr.u[0],dr.u[1],dr.u[2]),Rr.c=e.center,Rr.e[0]=e.halfSize.x,Rr.e[1]=e.halfSize.y,Rr.e[2]=e.halfSize.z,e.rotation.extractBasis(Rr.u[0],Rr.u[1],Rr.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)Wi[s][o]=dr.u[s].dot(Rr.u[o]);no.subVectors(Rr.c,dr.c),Ci[0]=no.dot(dr.u[0]),Ci[1]=no.dot(dr.u[1]),Ci[2]=no.dot(dr.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)Tn[s][o]=Math.abs(Wi[s][o])+t;let r,i;for(let s=0;s<3;s++)if(r=dr.e[s],i=Rr.e[0]*Tn[s][0]+Rr.e[1]*Tn[s][1]+Rr.e[2]*Tn[s][2],Math.abs(Ci[s])>r+i)return!1;for(let s=0;s<3;s++)if(r=dr.e[0]*Tn[0][s]+dr.e[1]*Tn[1][s]+dr.e[2]*Tn[2][s],i=Rr.e[s],Math.abs(Ci[0]*Wi[0][s]+Ci[1]*Wi[1][s]+Ci[2]*Wi[2][s])>r+i)return!1;return r=dr.e[1]*Tn[2][0]+dr.e[2]*Tn[1][0],i=Rr.e[1]*Tn[0][2]+Rr.e[2]*Tn[0][1],!(Math.abs(Ci[2]*Wi[1][0]-Ci[1]*Wi[2][0])>r+i||(r=dr.e[1]*Tn[2][1]+dr.e[2]*Tn[1][1],i=Rr.e[0]*Tn[0][2]+Rr.e[2]*Tn[0][0],Math.abs(Ci[2]*Wi[1][1]-Ci[1]*Wi[2][1])>r+i)||(r=dr.e[1]*Tn[2][2]+dr.e[2]*Tn[1][2],i=Rr.e[0]*Tn[0][1]+Rr.e[1]*Tn[0][0],Math.abs(Ci[2]*Wi[1][2]-Ci[1]*Wi[2][2])>r+i)||(r=dr.e[0]*Tn[2][0]+dr.e[2]*Tn[0][0],i=Rr.e[1]*Tn[1][2]+Rr.e[2]*Tn[1][1],Math.abs(Ci[0]*Wi[2][0]-Ci[2]*Wi[0][0])>r+i)||(r=dr.e[0]*Tn[2][1]+dr.e[2]*Tn[0][1],i=Rr.e[0]*Tn[1][2]+Rr.e[2]*Tn[1][0],Math.abs(Ci[0]*Wi[2][1]-Ci[2]*Wi[0][1])>r+i)||(r=dr.e[0]*Tn[2][2]+dr.e[2]*Tn[0][2],i=Rr.e[0]*Tn[1][1]+Rr.e[1]*Tn[1][0],Math.abs(Ci[0]*Wi[2][2]-Ci[2]*Wi[0][2])>r+i)||(r=dr.e[0]*Tn[1][0]+dr.e[1]*Tn[0][0],i=Rr.e[1]*Tn[2][2]+Rr.e[2]*Tn[2][1],Math.abs(Ci[1]*Wi[0][0]-Ci[0]*Wi[1][0])>r+i)||(r=dr.e[0]*Tn[1][1]+dr.e[1]*Tn[0][1],i=Rr.e[0]*Tn[2][2]+Rr.e[2]*Tn[2][0],Math.abs(Ci[1]*Wi[0][1]-Ci[0]*Wi[1][1])>r+i)||(r=dr.e[0]*Tn[1][2]+dr.e[1]*Tn[0][2],i=Rr.e[0]*Tn[2][1]+Rr.e[1]*Tn[2][0],Math.abs(Ci[1]*Wi[0][2]-Ci[0]*Wi[1][2])>r+i))}intersectsPlane(e){this.rotation.extractBasis(Rg,Og,Lg);const t=this.halfSize.x*Math.abs(e.normal.dot(Rg))+this.halfSize.y*Math.abs(e.normal.dot(Og))+this.halfSize.z*Math.abs(e.normal.dot(Lg)),r=e.normal.dot(this.center)-e.constant;return Math.abs(r)<=t}intersectRay(e,t){return this.getSize(_J),xJ.setFromCenterAndSize(no.set(0,0,0),_J),TT.setFromMatrix3(this.rotation),TT.setPosition(this.center),bJ.copy(TT).invert(),wJ.copy(e).applyMatrix4(bJ),wJ.intersectBox(xJ,t)?t.applyMatrix4(TT):null}intersectsRay(e){return this.intersectRay(e,no)!==null}fromBox3(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const t=e.elements;let r=no.set(t[0],t[1],t[2]).length();const i=no.set(t[4],t[5],t[6]).length(),s=no.set(t[8],t[9],t[10]).length();e.determinant()<0&&(r=-r),Gu.setFromMatrix4(e);const a=1/r,c=1/i,u=1/s;return Gu.elements[0]*=a,Gu.elements[1]*=a,Gu.elements[2]*=a,Gu.elements[3]*=c,Gu.elements[4]*=c,Gu.elements[5]*=c,Gu.elements[6]*=u,Gu.elements[7]*=u,Gu.elements[8]*=u,this.rotation.multiply(Gu),this.halfSize.x*=r,this.halfSize.y*=i,this.halfSize.z*=s,no.setFromMatrixPosition(e),this.center.add(no),this}}const P6e=new d7,_c={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class pd{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const T6e=new oE(-1,1,1,-1,0,1),p7=new As;p7.setAttribute("position",new sr([-1,3,0,-1,-1,0,3,-1,0],3));p7.setAttribute("uv",new sr([0,2,0,0,2,0],2));class U0{constructor(e){this._mesh=new ul(p7,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,T6e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Lx extends pd{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof kr?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Ra.clone(e.uniforms),this.material=new kr({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new U0(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class SJ extends pd{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class R6e extends pd{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class b8{constructor(e,t){if(this.renderer=e,t===void 0){const r=e.getSize(new ut);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,t=new Ai(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],_c===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),Lx===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Lx(_c),this.clock=new xle}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,s=this.passes.length;i<s;i++){const o=this.passes[i];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}SJ!==void 0&&(o instanceof SJ?r=!0:o instanceof R6e&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new ut);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new oE(-1,1,1,-1,0,1);const Fle=new As;Fle.setAttribute("position",new sr([-1,3,0,-1,-1,0,3,-1,0],3));Fle.setAttribute("uv",new sr([0,2,0,0,2,0],2));const[O6e,S0]=Pt(1),f7=375,m7=667,Ule=-5e-4,L6e=3e3,jle=5,Hle=175,RT=5.7,Db=.1,Wh=1e4,D6e="https://unpkg.com/lingo3d-textures@1.0.3/assets/",I6e="1.34.4",[N6e,kl]=Pt([f7,m7]),k6e=([n,e])=>N6e([Math.max(n,1),Math.max(e,1)]),[z6e,Dx]=Pt(void 0);yn(()=>{const n=zi();if(!n)return;const e=new b8(n);e.renderToScreen=!1,z6e(e)},[zi]);yn(()=>{const n=Dx();if(!n)return;const[e,t]=kl();n.setSize(e,t),n.setPixelRatio(Math.min(S0(),1))},[Dx,kl,S0]);const Wle=[!1],Gle=n=>{n.userData.bloom=!0,Wle[0]=!0},Xle=n=>{n.userData.bloom=!1};let w8;const B6e=new iE({color:0});let S8=[];const qle=n=>{for(const e of n)e.userData.bloom||!e.visible||(qle(e.children),e.material&&(S8.push([e.material,e]),e.material=B6e))},V6e=()=>{qle(Sn.children),Sn.background&&(w8=Sn.background,Sn.background=null)},F6e=()=>{for(const[n,e]of S8)e.material=n;S8=[],w8&&(Sn.background=w8)},U6e=()=>{var n;V6e(),(n=Dx())==null||n.render(),F6e()},[j6e,M8]=Pt(1),[c$e,Ix]=Pt(!1),[H6e,C8]=Pt(!1),[u$e,E8]=Pt(void 0),RO={createButton(n,e){e&&console.error('THREE.VRButton: The "options" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.');const t=document.createElement("button");function r(){let c=null;async function u(p){p.addEventListener("end",d),await n.xr.setSession(p),t.textContent="EXIT VR",c=p}function d(){c.removeEventListener("end",d),t.textContent="ENTER VR",c=null}t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",t.textContent="ENTER VR",t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){if(c===null){const p={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",p).then(u)}else c.end()}}function i(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",t.onmouseenter=null,t.onmouseleave=null,t.onclick=null}function s(){i(),t.textContent="VR NOT SUPPORTED"}function o(c){i(),console.warn("Exception when trying to call xr.isSessionSupported",c),t.textContent="VR NOT ALLOWED"}function a(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}if("xr"in navigator)return t.id="VRButton",t.style.display="none",a(t),navigator.xr.isSessionSupported("immersive-vr").then(function(c){c?r():s(),c&&RO.xrSessionIsGranted&&t.click()}).catch(o),t;{const c=document.createElement("a");return window.isSecureContext===!1?(c.href=document.location.href.replace(/^http:/,"https:"),c.innerHTML="WEBXR NEEDS HTTPS"):(c.href="https://immersiveweb.dev/",c.innerHTML="WEBXR NOT AVAILABLE"),c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",a(c),c}},xrSessionIsGranted:!1,registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{RO.xrSessionIsGranted=!0})}}};RO.registerSessionGrantedListener();const[W6e,A8]=Pt(!1),[h$e,qp]=Pt(0),Lh=document.createElement("div");Object.assign(Lh.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"});const Ms=document.createElement("div");Object.assign(Ms.style,{position:"absolute",left:"0px",top:"0px",width:"100%"});Lh.appendChild(Ms);E8(n=>Ms.style.height=n?"50%":"100%");const Yle=[Ms.getBoundingClientRect()],_F=n=>{hC(()=>{const e=()=>{Yle[0]=Ms.getBoundingClientRect(),k6e(n===document.body?[window.innerWidth,window.innerHeight]:[n.clientWidth,n.clientHeight])};e();const t=tv(e,100,"both");window.addEventListener("resize",t);const r=qp(t);return()=>{window.removeEventListener("resize",e),r.cancel()}},[n])};yn(()=>{const n=A8();if(!!n){if(typeof n=="string"){const e=document.querySelector(n);return e?(e.prepend(Lh),_F(e),()=>{e.removeChild(Lh)}):void 0}return n===!0?(document.body.prepend(Lh),_F(document.body),()=>{document.body.removeChild(Lh)}):(n.prepend(Lh),_F(n),()=>{n.removeChild(Lh)})}},[A8]);yn(()=>{const n=zi();if(!n)return;const e=n.domElement;return Lh.prepend(e),Object.assign(e.style,{position:"absolute",left:"0px",top:"0px"}),()=>{Lh.removeChild(e)}},[zi]);yn(()=>{const n=zi();if(!n)return;const[e,t]=kl();n.setSize(e,t),n.setPixelRatio(Math.min(S0(),devicePixelRatio))},[zi,kl,S0]);yn(()=>{const n=zi();!n||(n.physicallyCorrectLights=C8())},[zi,C8]);yn(()=>{const n=zi();if(!n)return;const e=M8();n.toneMapping=e!==1?Fae:Jh,n.toneMappingExposure=e},[M8,zi]);yn(()=>{if(!Ix())return;const n=zi();if(!n)return;n.xr.enabled=!0;const e=RO.createButton(n);return Ms.appendChild(e),e.ontouchstart=()=>{var t;return(t=e.onclick)==null?void 0:t.call(e,new MouseEvent("click"))},()=>{n.xr.enabled=!1,Ms.removeChild(e)}},[Ix,zi]);const Xu=new al(75,1,Db,Wh),uo=new al(75,1,Db,Wh),[Zle,xC]=Pt([uo]),G6e=Mb(Zle,xC),MJ=Cb(Zle,xC),OT=new WeakMap,OO=n=>{if(n.parent===Sn)return n.quaternion.clone();if(OT.has(n))return OT.get(n).clone();const e=n.getWorldQuaternion(new Mc);return OT.set(n,e.clone()),Ob(()=>OT.delete(n),!0),e},v7=n=>Math.min(n*Ah[0],1),[yF,mn]=Pt(uo),P8=n=>{const[e,t]=kl(),r=e/t;return n instanceof al&&!Ix()?(n.aspect=r,n.updateProjectionMatrix()):n instanceof oE&&([n.left,n.right,n.top,n.bottom]=[r*RT*-.5,r*RT*.5,RT*.5,RT*-.5],n.updateProjectionMatrix()),[e,t,r]},CJ=(n,e,t)=>n+(e-n)*t;let EJ;yn(()=>{const n=mn()===Xu?Xu:EJ,e=EJ=$2(xC()),t=e.userData.transition;if(!n||!t||n===e||n===uo||e===uo){yF(e);return}yF(Xu);const r=ia(n),i=OO(n);Xu.zoom=n.zoom,Xu.fov=n.fov,P8(Xu);let s=0;const o=typeof t=="number"?t:1/0,a=ha(()=>{const c=ia(e),u=OO(e);Xu.position.lerpVectors(r,c,s),Xu.quaternion.slerpQuaternions(i,u,s),Xu.zoom=CJ(n.zoom,e.zoom,s),Xu.fov=CJ(n.fov,e.fov,s),Xu.updateProjectionMatrix(),s=Math.min((1-s)*v7(.1),o)+s,!(s<.9999)&&(yF(e),P8(e),a.cancel())});return()=>{a.cancel()}},[xC]);const LT=new WeakMap,AJ=n=>{if(LT.has(n))return LT.get(n);const e=fE(n),t=mn();e.project(t);const r=(e.x*.5+.5)*Ms.clientWidth,i=(e.y*-.5+.5)*Ms.clientHeight,s={x:r,y:i};return LT.set(n,s),Ob(()=>LT.delete(n),!0),s};class fm extends pd{constructor(e,t,r,i){super(),this.renderScene=t,this.renderCamera=r,this.selectedObjects=i!==void 0?i:[],this.visibleEdgeColor=new en(1,1,1),this.hiddenEdgeColor=new en(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=e!==void 0?new ut(e.x,e.y):new ut(256,256);const s=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Ai(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new GD,this.depthMaterial.side=Uh,this.depthMaterial.depthPacking=UD,this.depthMaterial.blending=zs,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=Uh,this.prepareMaskMaterial.fragmentShader=d(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Ai(this.resolution.x,this.resolution.y),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Ai(s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Ai(s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Ai(Math.round(s/2),Math.round(o/2)),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Ai(s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Ai(Math.round(s/2),Math.round(o/2)),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;const a=4,c=4;this.separableBlurMaterial1=this.getSeperableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(s,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(c),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(s/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=c,this.overlayMaterial=this.getOverlayMaterial(),_c===void 0&&console.error("THREE.OutlinePass relies on CopyShader");const u=_c;this.copyUniforms=Ra.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new kr({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:zs,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new en,this.oldClearAlpha=1,this.fsQuad=new U0(null),this.tempPulseColor1=new en,this.tempPulseColor2=new en,this.textureMatrix=new Vr;function d(p,f){const v=f.isPerspectiveCamera?"perspective":"orthographic";return p.replace(/DEPTH_TO_VIEW_Z/g,v+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let r=Math.round(e/this.downSampleRatio),i=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,i),this.renderTargetBlurBuffer1.setSize(r,i),this.renderTargetEdgeBuffer1.setSize(r,i),this.separableBlurMaterial1.uniforms.texSize.value.set(r,i),r=Math.round(r/2),i=Math.round(i/2),this.renderTargetBlurBuffer2.setSize(r,i),this.renderTargetEdgeBuffer2.setSize(r,i),this.separableBlurMaterial2.uniforms.texSize.value.set(r,i)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function r(i){i.isMesh&&(e===!0?i.visible=t.get(i):(t.set(i,i.visible),i.visible=e))}for(let i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(r)}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,r=[];function i(o){o.isMesh&&r.push(o)}for(let o=0;o<this.selectedObjects.length;o++)this.selectedObjects[o].traverse(i);function s(o){if(o.isMesh||o.isSprite){let a=!1;for(let c=0;c<r.length;c++)if(r[c].id===o.id){a=!0;break}if(a===!1){const c=o.visible;(e===!1||t.get(o)===!0)&&(o.visible=e),t.set(o,c)}}else(o.isPoints||o.isLine)&&(e===!0?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e))}this.renderScene.traverse(s)}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,r,i,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const c=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(c),this.tempPulseColor2.multiplyScalar(c)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=fm.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=fm.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=fm.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=fm.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new kr({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new ut(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>
					#include <worldpos_vertex>

					vPosition = mvPosition;
					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new kr({uniforms:{maskTexture:{value:null},texSize:{value:new ut(.5,.5)},visibleEdgeColor:{value:new Te(1,1,1)},hiddenEdgeColor:{value:new Te(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeperableBlurMaterial(e){return new kr({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new ut(.5,.5)},direction:{value:new ut(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new kr({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:gO,depthTest:!1,depthWrite:!1,transparent:!0})}}fm.BlurDirectionX=new ut(1,0);fm.BlurDirectionY=new ut(0,1);const[X6e,T8]=Pt("#ffffff"),[q6e,R8]=Pt(void 0),[Y6e,O8]=Pt(void 0),[Z6e,Kle]=Pt(0),[K6e,Jle]=Pt(3),[J6e,Qle]=Pt(1),$le=[!1],g7=[],ece=n=>{n.userData.outline||(n.userData.outline=!0,g7.push(n),$le[0]=!0)},tce=n=>{!n.userData.outline||(n.userData.outline=!1,NH(g7,n))},Qh=new fm(new ut,Sn,mn(),g7);mn(n=>Qh.renderCamera=n);Kle(n=>Qh.pulsePeriod=n*.001);Jle(n=>Qh.edgeStrength=n);Qle(n=>Qh.edgeThickness=n);yn(()=>{var t;const n=T8(),e=(t=R8())!=null?t:n;Qh.visibleEdgeColor=new en(n),Qh.hiddenEdgeColor=new en(e)},[T8,R8]);yn(()=>{const n=O8();if(!!n)return Qh.patternTexture=ol(n),Qh.usePatternTexture=!0,()=>{Qh.usePatternTexture=!1}},[O8]);const Q6e=["name","blending","side","vertexColors","opacity","transparent","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","alphaToCoverage","premultipliedAlpha","visible","toneMapped"],$6e=(n,e)=>{for(const i of Q6e){const s=n[i];s!=null&&(e[i]=s)}const t=n.clippingPlanes;let r=null;if(t){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}e.clippingPlanes=r},eUe=["map","gradientMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveMap","emissiveIntensity","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","fog"],tUe=(n,e)=>{$6e(n,e);for(const t of eUe){const r=n[t];r!=null&&(e[t]=r)}n.color&&e.color.copy(n.color),n.emissive&&e.emissive.copy(n.emissive),n.normalScale&&e.normalScale.copy(n.normalScale)},nUe=(n,e)=>n.clone().multiply(e.clone().invert()),DT=new WeakMap,nce=n=>{if(DT.has(n))return DT.get(n).clone();const e=n.getWorldDirection(new Te);return DT.set(n,e.clone()),Ob(()=>DT.delete(n),!0),e},rce=new Set,ice=new Set,sce=new Set,oce=new Set,ace=new Set,lce=new Set;class L8{constructor(e,t,r,i,s,o,a){We(this,"clientX");We(this,"clientY");We(this,"xNorm");We(this,"yNorm");We(this,"point");We(this,"distance");We(this,"target");this.clientX=e,this.clientY=t,this.xNorm=r,this.yNorm=i,this.point=s,this.distance=o,this.target=a}}const rUe={...uE,onClick:Function,onRightClick:Function,onMouseMove:Function,onMouseDown:Function,onMouseUp:Function,onMousePress:Function},iUe={...hE,onClick:void 0,onRightClick:void 0,onMouseMove:void 0,onMouseDown:void 0,onMouseUp:void 0,onMousePress:void 0},[d$e,sUe]=Pt(void 0),oUe=(n,e)=>{const t=Yle[0];return n-=t.x,e-=t.y,[n/t.width*2-1,-(e/t.height)*2+1,n,e]},aUe=n=>{const[t,r,i,s]=oUe(n.clientX,n.clientY);if(sUe())return new L8(i,s,0,0,new h0(0,0,0),500,void 0);const o=mn();oa.set(t,r,.5),oa.unproject(o);const a=ia(o);oa.sub(a).normalize();const c=a.add(oa.multiplyScalar(500*Qr));return new L8(i,s,t,r,Up(c),500,void 0)},[lUe,ou]=Pt("play");yn(()=>{lUe(mn()===uo&&qp()?"translate":"play")},[mn,qp]);const[cUe,gl]=Pt(!1);ou(n=>cUe(n!=="play"));const Oo=new Tae;let D8=0,I8=0,N8=0,k8=!1;Ms.addEventListener("contextmenu",n=>{n.preventDefault(),k8=!0});Ms.addEventListener("touchstart",n=>{n.preventDefault()});Oo.on("down",n=>{D8=Date.now(),I8=n.clientX,N8=n.clientY});Oo.on("up",n=>{const e=Date.now(),t=e-D8,r=Math.abs(n.clientX-I8),i=Math.abs(n.clientY-N8);D8=e,I8=n.clientX,N8=n.clientY,t<300&&r<5&&i<5&&Oo.emit(k8?"rightClick":"click",n),k8=!1});const _7=Sae(aUe,0,"leading");Ms.addEventListener("pointermove",n=>{Oo.emit("move",_7(n))});let z8=!1;Ms.addEventListener("pointerdown",n=>{z8=!0;const e=_7(n);Oo.emit("down",e),Oo.emit("move",e)});const y7=n=>{z8&&Oo.emit("up",_7(n)),z8=!1};Ms.addEventListener("pointerup",y7);Ms.addEventListener("pointercancel",y7);Ms.addEventListener("pointerleave",y7);class iR extends Lb{constructor(){super();We(this,"onClick");We(this,"onRightClick");We(this,"onMouseMove");We(this,"onMouseDown");We(this,"onMouseUp");We(this,"onMousePress");let t={clientX:0,clientY:0};const[r,i]=Pt(!1);this.createEffect(()=>{const s=this.onMousePress;if(!i()||!s)return;const o=ha(()=>s(t));return()=>{o.cancel()}},[i]),this.createEffect(()=>{if(gl()||qp()&&mn()===uo)return;const s=Oo.on("move",d=>{var p;(p=this.onMouseMove)==null||p.call(this,d),t=d}),o=Oo.on("click",d=>{var p;(p=this.onClick)==null||p.call(this,d),t=d}),a=Oo.on("rightClick",d=>{var p;(p=this.onRightClick)==null||p.call(this,d),t=d}),c=Oo.on("down",d=>{var p;(p=this.onMouseDown)==null||p.call(this,d),t=d,r(!0)}),u=Oo.on("up",d=>{var p;(p=this.onMouseUp)==null||p.call(this,d),t=d,r(!1)});return()=>{s.cancel(),o.cancel(),a.cancel(),c.cancel(),u.cancel()}},[gl,qp,mn])}}We(iR,"componentName","mouse"),We(iR,"defaults",iUe),We(iR,"schema",rUe);const uUe=new iR;dl.delete(uUe);const B8=new IFe;B8.firstHitOnly=!0;const hUe=(n,e,t)=>(B8.setFromCamera({x:n,y:e},mn()),B8.intersectObjects([...t])[0]),am=(n,e,t)=>Oo.on(n,r=>{if(!e.size)return;const i=hUe(r.xNorm,r.yNorm,e);if(!i)return;const s=Up(i.point),o=i.distance*js;t(i.object.userData.manager,new L8(r.clientX,r.clientY,r.xNorm,r.yNorm,s,o,i.object.userData.manager))}),dUe=()=>{hC(()=>{if(gl())return;o7(),_C(void 0);const n=am("click",rce,(u,d)=>{var p;return(p=u.onClick)==null?void 0:p.call(u,d)}),e=am("down",ice,(u,d)=>{var p;return(p=u.onMouseDown)==null?void 0:p.call(u,d)}),t=am("up",sce,(u,d)=>{var p;return(p=u.onMouseUp)==null?void 0:p.call(u,d)});let r=new Set,i=new Set;const s=am("move",oce,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),o=am("move",ace,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),a=am("move",lce,(u,d)=>{r.add(u),u.outerObject3d.userData.eMove=d}),c=Oo.on("move",()=>{var u,d,p;for(const f of r)i.has(f)||(u=f.onMouseOver)==null||u.call(f,f.outerObject3d.userData.eMove),(d=f.onMouseMove)==null||d.call(f,f.outerObject3d.userData.eMove);for(const f of i)r.has(f)||(p=f.onMouseOut)==null||p.call(f,f.outerObject3d.userData.eMove);i=r,r=new Set});return()=>{n.cancel(),e.cancel(),t.cancel(),s.cancel(),o.cancel(),a.cancel(),c.cancel()}},[gl])},[p$e,cce]=fa(),[pUe,$D]=fa(),yc=tv((n,e)=>!Sle()&&pUe({target:n,rightClick:e}),0,"trailing");yn(()=>{const n=Oc();if(!n)return;const e=pE(()=>{!n.outerObject3d.parent&&yc()});return()=>{e.cancel()}},[Oc]);const[fUe,Yp]=Pt(!1),[f$e,mUe]=Pt([new Set]),e4=new Set,vUe=new WeakSet,uce=(n,e)=>{for(const t of n)e.has(t)||("addToRaycastSet"in t&&!vUe.has(t)&&t.addToRaycastSet(e4),t.children&&uce(t.children,e))},Xy=tv((n=dl)=>{const[e]=mUe();e4.clear(),uce(n,e)},0,"trailing");let iy=[];const gUe=()=>{hC(()=>{if(!gl()||Yp()||ou()!=="path")return;Xy(iy);const n=pE(()=>Xy(iy)),e=cce(()=>{Xy(iy),yc()}),t=new di;Promise.all([rr(()=>Promise.resolve().then(()=>K8e),void 0),rr(()=>import("./Curve.b163fd00.js"),[])]).then(([{default:o},{default:a}])=>{if(t.done)return;const c=new a;t.then(()=>c.dispose()),t.watch(Oo.on("click",u=>{setTimeout(()=>{if(t.done||Oc())return;const d=new o;d.scale=.1,d.placeAt(u.point),d.name="point"+iy.length,iy.push(d),yc(d),c.addPoint(Up(d.outerObject3d.position))})}))});const r=Oo.on("click",()=>yc()),i=am("click",e4,o=>yc(o)),s=$D(({target:o})=>{o7(),_C(o)});return()=>{t.cancel(),n.cancel(),e.cancel(),t.cancel(),r.cancel(),i.cancel(),s.cancel(),ou()!=="path"&&(iy=[])}},[gl,Yp,ou])},[m$e,hce]=Pt(!1),_Ue=()=>{const n=hce(),e=$U(!0);hC(()=>{!n&&(e.current=!0)},[n]),hC(()=>{const t=ou();if(!gl()||Yp()||t!=="rotate"&&t!=="scale"&&t!=="select"&&t!=="translate")return;Xy();const r=pE(()=>Xy()),i=cce(()=>{Xy(),yc()}),s=Oo.on("click",()=>yc());let o=!1;const a=Oo.on("rightClick",()=>{o=!0,queueMicrotask(()=>{!o||(o=!1,yc(void 0,!0))})}),c=am(["click","rightClick"],e4,d=>{yc(d,o),o=!1}),u=$D(({target:d,rightClick:p})=>{if(n){if(!TO(d)||p)return;if(e.current){const f=Oc();TO(f)&&dJ(f)}e.current=!1,zm().includes(d)?jFe(d):dJ(d);return}o7(),_C(p?d:d===Oc()?void 0:d)});return()=>{r.cancel(),i.cancel(),s.cancel(),a.cancel(),c.cancel(),u.cancel()}},[gl,Yp,ou,n])};yn(()=>{dUe(),gUe(),_Ue()},[gl,ou,Yp,hce]);const xF=new d7,kS=new d7,yUe=Sae(()=>{const n=mn();Ile.setFromProjectionMatrix(d6e.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse))},200,"leading"),IT=(n,e,t)=>{var i,s;const r=(s=(i=n.userData)[e])!=null?s:i[e]=n[e];n[e]=t===void 0?r:Math.max(r||0,.25)*t},bF=(n,e,t)=>{var i,s;const r=(s=(i=n.userData)[e])!=null?s:i[e]=n[e];n[e]=t===void 0?r:t},p0=new Map,xUe=()=>new Set;class dce extends Lb{constructor(){super(...arguments);We(this,"_id");We(this,"_onClick");We(this,"_onMouseDown");We(this,"_onMouseUp");We(this,"_onMouseOver");We(this,"_onMouseOut");We(this,"_onMouseMove");We(this,"_visible");We(this,"_castShadow");We(this,"_receiveShadow");We(this,"_metalnessFactor");We(this,"_roughnessFactor");We(this,"_opacityFactor");We(this,"_envFactor");We(this,"_adjustColor");We(this,"_reflection");We(this,"_illumination");We(this,"_toon");We(this,"onLookToEnd")}dispose(){return this.done?this:(super.dispose(),this._id!==void 0&&p0.get(this._id).delete(this),this)}get id(){return this._id}set id(t){this._id!==void 0&&p0.get(this._id).delete(this),this._id=t,t!==void 0&&ev(p0,t,xUe).add(this)}addToRaycastSet(t){return t.add(this.nativeObject3d),new di(()=>t.delete(this.nativeObject3d))}get onClick(){return this._onClick}set onClick(t){this._onClick=t,this.cancelHandle("onClick",t&&(()=>this.addToRaycastSet(rce)))}get onMouseDown(){return this._onMouseDown}set onMouseDown(t){this._onMouseDown=t,this.cancelHandle("onMouseDown",t&&(()=>this.addToRaycastSet(ice)))}get onMouseUp(){return this._onMouseUp}set onMouseUp(t){this._onMouseUp=t,this.cancelHandle("onMouseUp",t&&(()=>this.addToRaycastSet(sce)))}get onMouseOver(){return this._onMouseOver}set onMouseOver(t){this._onMouseOver=t,this.cancelHandle("onMouseOver",t&&(()=>this.addToRaycastSet(oce)))}get onMouseOut(){return this._onMouseOut}set onMouseOut(t){this._onMouseOut=t,this.cancelHandle("onMouseOut",t&&(()=>this.addToRaycastSet(ace)))}get onMouseMove(){return this._onMouseMove}set onMouseMove(t){this._onMouseMove=t,this.cancelHandle("onMouseMove",t&&(()=>this.addToRaycastSet(lce)))}get name(){return this.outerObject3d.name}set name(t){this.outerObject3d.name=Dr.sanitizeNodeName(t)}getRay(){return Dle.set(ia(this.nativeObject3d),nce(this.nativeObject3d))}pointAt(t){return Up(this.getRay().at(t*Qr,oa))}rayIntersectsAt(t,r){if(this.done||t.done||this===t)return;kS.set(ia(t.nativeObject3d),Lle,new ua().setFromMatrix4(t.nativeObject3d.matrixWorld));const i=kS.intersectRay(this.getRay(),oa);if(!!i){if(r){const{x:s,y:o,z:a}=ia(this.nativeObject3d);if(Cle(i.x,i.y,i.z,s,o,a)*js>r)return}return Up(i)}}rayIntersects(t){return!!this.rayIntersectsAt(t)}intersects(t){return this.done||t.done||this===t?!1:(xF.set(ia(this.nativeObject3d),v8.clone(),new ua),xF.applyMatrix4(this.nativeObject3d.matrixWorld),kS.set(ia(t.nativeObject3d),v8.clone(),new ua),kS.applyMatrix4(t.nativeObject3d.matrixWorld),xF.intersectsOBB(kS,0))}get clientX(){return AJ(this.nativeObject3d).x}get clientY(){return AJ(this.nativeObject3d).y}get bloom(){return!!this.outerObject3d.userData.bloom}set bloom(t){t&&Gle(this.outerObject3d),this.cancelHandle("bloom",t&&(()=>new di(()=>Xle(this.outerObject3d))))}get outline(){return!!this.nativeObject3d.userData.outline}set outline(t){t&&ece(this.nativeObject3d),this.cancelHandle("outline",t&&(()=>new di(()=>tce(this.nativeObject3d))))}get visible(){return this._visible!==!1}set visible(t){this._visible=t,this.outerObject3d.visible=t}get frustumCulled(){return this.outerObject3d.frustumCulled}set frustumCulled(t){this.outerObject3d.frustumCulled=t,this.outerObject3d.traverse(r=>r.frustumCulled=t)}get castShadow(){var t;return(t=this._castShadow)!=null?t:!0}set castShadow(t){this._castShadow=t,this.outerObject3d.traverse(r=>r.castShadow=t)}get receiveShadow(){var t;return(t=this._receiveShadow)!=null?t:!0}set receiveShadow(t){this._receiveShadow=t,this.outerObject3d.traverse(r=>r.receiveShadow=t)}refreshFactors(){this.cancelHandle("refreshFactors",()=>{const t=new di;return"tryCloneMaterial"in this&&this.tryCloneMaterial(),queueMicrotask(()=>{if(t.done)return;const{_toon:r,_metalnessFactor:i,_roughnessFactor:s,_opacityFactor:o,_envFactor:a,_adjustColor:c,_reflection:u,_illumination:d}=this;let p;if(!r&&(u||d)){const f=new XH(u?256:16);p=f.texture,t.then(()=>{f.dispose(),p=void 0});const v=new WH(Db,u?Wh:5,f);t.watch(yn(()=>{const x=zi();if(!x)return;const _=(u?Ble:C6e)(()=>{v.position.copy(ia(this.outerObject3d)),this.outerObject3d.visible=!1,v.update(x,Sn),this.outerObject3d.visible=!0});return()=>{_.cancel()}},[zi]))}this.outerObject3d.traverse(f=>{let v=f.material;if(!!v){if(Array.isArray(v)&&(v=v[0]),r){f.material=new iFe,tUe(v,f.material),t.then(()=>{f.material.dispose(),f.material=v});return}i!==void 0&&IT(v,"metalness",i!==0?i:void 0),s!==void 0&&IT(v,"roughness",s!==1?s:void 0),o!==void 0&&(IT(v,"opacity",o),bF(v,"transparent",o<=1?!0:void 0)),a!==void 0&&IT(v,"envMapIntensity",a!==1?a:void 0),c!==void 0&&bF(v,"color",c!=="#ffffff"?new en(c):void 0),(u!==void 0||d!==void 0)&&bF(v,"envMap",p)}})}),t})}get metalnessFactor(){return this._metalnessFactor}set metalnessFactor(t){this._metalnessFactor=t,this.refreshFactors()}get roughnessFactor(){return this._roughnessFactor}set roughnessFactor(t){this._roughnessFactor=t,this.refreshFactors()}get opacityFactor(){return this._opacityFactor}set opacityFactor(t){this._opacityFactor=t,this.refreshFactors()}get envFactor(){return this._envFactor}set envFactor(t){this._envFactor=t,this.refreshFactors()}get adjustColor(){return this._adjustColor}set adjustColor(t){this._adjustColor=t,this.refreshFactors()}get reflection(){var t;return(t=this._reflection)!=null?t:!1}set reflection(t){this._reflection=t,this.refreshFactors()}get illumination(){var t;return(t=this._illumination)!=null?t:!1}set illumination(t){this._illumination=t,this.refreshFactors()}get toon(){var t;return(t=this._toon)!=null?t:!1}set toon(t){this._toon=t,this.refreshFactors()}get frustumVisible(){return yUe(),Ile.containsPoint(fE(this.nativeObject3d))}lookAt(t,r,i){if(typeof t=="number"){this.lookAt(new h0(t,r===void 0?this.outerObject3d.position.y*js:r,i));return}"outerObject3d"in t?this.outerObject3d.lookAt(ia(t.nativeObject3d)):this.outerObject3d.lookAt(kle(t))}lookTo(t,r,i,s){if(typeof t=="number"){this.lookTo(new h0(t,r===void 0?this.outerObject3d.position.y*js:r,i),s);return}const{quaternion:o}=this.outerObject3d,a=o.clone();this.lookAt(t);const c=o.clone();o.copy(a),this.cancelHandle("lookTo",()=>ha(()=>{var f;o.slerp(c,v7(r));const{x:u,y:d,z:p}=nUe(o,c);Math.abs(u)+Math.abs(d)+Math.abs(p)<.001&&(this.cancelHandle("lookTo",void 0),(f=this.onLookToEnd)==null||f.call(this),o.copy(c))}))}getWorldPosition(){return Up(ia(this.nativeObject3d))}}const[bUe,bC]=Pt(!1),wUe=new WeakMap,PJ=new WeakMap,wF=new WeakMap;class x7 extends Aae{constructor(t,r){super();We(this,"clip");We(this,"name");We(this,"mixer");We(this,"action");this.mixer=ev(wUe,r,()=>new DFe(r)),typeof t=="string"?this.name=t:(this.name=t.name,this.loadClip(t))}retarget(t){const r=this.clip.clone(),i=t.name+".";return r.tracks=r.tracks.filter(s=>s.name.startsWith(i)),new x7(r,t)}dispose(){return this.done?this:(super.dispose(),this.stop(),this)}get duration(){var t,r;return(r=(t=this.clip)==null?void 0:t.duration)!=null?r:0}loadClip(t){this.clip=t,this.action=this.mixer.clipAction(t)}setTracks(t){const r=Object.entries(t).map(([i,s])=>new gC("."+i,Object.keys(s).map(o=>Number(o)),Object.values(s)));this.clip&&this.mixer.uncacheClip(this.clip),this.loadClip(new f8(this.name,-1,r))}play({crossFade:t=.25,repeat:r=!0,onFinish:i}={}){var d,p;const[s,o]=(d=PJ.get(this.mixer))!=null?d:[];if((s==null?void 0:s.isRunning())&&this.action===s){r!==o&&s.setLoop(r?o8:s8,1/0);return}(p=wF.get(this.mixer))==null||p.cancel();const a=this.watch(ha(()=>this.mixer.update(h7[0])));wF.set(this.mixer,a);const{action:c}=this;if(!c)return;s&&t?(c.time=0,c.enabled=!0,c.crossFadeFrom(s,t,!0)):this.mixer.stopAllAction(),PJ.set(this.mixer,[c,r]),c.setLoop(r?o8:s8,1/0),c.clampWhenFinished=!0;const u=()=>i==null?void 0:i();this.mixer.addEventListener("finished",u),a.then(()=>this.mixer.removeEventListener("finished",u)),c.paused&&c.stop(),c.play()}stop(){var t;this.action&&(this.action.paused=!0),(t=wF.get(this.mixer))==null||t.cancel()}getPaused(){var t;return(t=this.action)==null?void 0:t.paused}setPaused(t){this.action&&(this.action.paused=t)}update(t){this.mixer.time=0,this.action&&(this.action.time=0),this.mixer.update(t)}}const SUe=tv(n=>{const e=Object.entries(n);let t=0;for(const[,{length:o}]of e)o>t&&(t=o);const i=1e3*.001/t,s={};for(const[o,a]of e)s[o]=Object.fromEntries(a.map((c,u)=>[(u*i).toFixed(2),c]));return s},0,"trailingPromise");class MUe extends dce{constructor(){super(...arguments);We(this,"animationManagers");We(this,"animationManager");We(this,"_animationPaused");We(this,"animationRepeat");We(this,"onAnimationFinish");We(this,"serializeAnimation");We(this,"_animation")}get animations(){var t;return(t=this.animationManagers)!=null?t:this.animationManagers={}}set animations(t){this.animationManagers=t}createAnimation(t){if(t in this.animations){const i=this.animations[t];if(typeof i!="string")return i}const r=this.watch(new x7(t,this));return this.animations[t]=r,r}buildAnimation(t){SUe(t).then(r=>{const i="lingo3d-animation";this.createAnimation(i).setTracks(r),this.playAnimation(i)})}makeAnimationProxy(t){return new Proxy(t,{get:(r,i)=>r[i],set:(r,i,s)=>(r[i]=s,this.buildAnimation(r),!0)})}get animationPaused(){return this._animationPaused}set animationPaused(t){var r;this._animationPaused=t,(r=this.animationManager)==null||r.setPaused(!!t)}playAnimation(t,r){const i=this.animationManager=typeof t=="string"?this.animations[t]:Object.values(this.animations)[t!=null?t:0];!i||(i.play(r),this._animationPaused&&i.setPaused(!0))}stopAnimation(){var t;(t=this.animationManager)==null||t.stop()}setAnimation(t,r){if(this._animation=t,typeof t=="string"||typeof t=="number"){this.serializeAnimation=t,this.playAnimation(t,r);return}if(typeof t=="boolean"){t?this.playAnimation(void 0,r):this.stopAnimation();return}if(!t){this.stopAnimation();return}this._animation=this.makeAnimationProxy(t),this.buildAnimation(t)}get animation(){return this._animation}set animation(t){if(Array.isArray(t)){let r=0;const i={onFinish:()=>{var s;if(++r>=t.length){if(this.animationRepeat===!1){(s=this.onAnimationFinish)==null||s.call(this);return}r=0}this.setAnimation(t[r],i)},repeat:!1};this.setAnimation(t[0],i);return}this.queueMicrotask(()=>this.setAnimation(t,{repeat:this.animationRepeat,onFinish:this.onAnimationFinish}))}}const NT=new WeakMap,mE=n=>{if(NT.has(n))return NT.get(n).clone();const e=n.nativeObject3d.scale.clone().multiply(n.outerObject3d.scale);return NT.set(n,e.clone()),Ob(()=>NT.delete(n),!0),e},TJ=new WeakMap,RJ=(n,e)=>{const t=TJ.get(n);if(t)return t;const r=Cle(n.x,n.y,n.z,e.x*js,e.y*js,e.z*js);return TJ.set(n,r),r};class vE extends MUe{constructor(){super(...arguments);We(this,"onIntersectState");We(this,"onIntersectOutState");We(this,"intersectIdsState");We(this,"onMoveToEnd")}getRayIntersectionsAt(t,r){var o;const i=[];for(const a of(o=p0.get(t))!=null?o:[]){if(a===this)continue;const c=this.rayIntersectsAt(a,r);c&&i.push([a,c])}const s=ia(this.nativeObject3d);return i.sort((a,c)=>RJ(a[1],s)-RJ(c[1],s))}getRayIntersections(t,r){return this.getRayIntersectionsAt(t,r).map(i=>i[0])}listenToRayIntersection(t,r,i){return this.beforeRender(()=>{for(const[s,o]of this.getRayIntersectionsAt(t,i))r(s,o)})}getIntersections(t){var i;const r=[];for(const s of(i=p0.get(t))!=null?i:[])s!==this&&this.intersects(s)&&r.push(s);return r}listenToIntersection(t,r,i){let s=[];return this.beforeRender(()=>{const o=this.getIntersections(t);if(r)for(const a of o)s.includes(a)||r(a);if(i)for(const a of s)o.includes(a)||i(a);s=o})}initIntersect(){this.onIntersectState||(this.onIntersectState=new tu(void 0),this.onIntersectOutState=new tu(void 0),this.intersectIdsState=new tu(void 0),this.createEffect(()=>{const{onIntersect:t,onIntersectOut:r,intersectIds:i}=this;if(!i||!t&&!r)return;const s=[];for(const o of i)s.push(this.listenToIntersection(o,t,r));return()=>{for(const o of s)o.cancel()}},[this.onIntersectState.get,this.onIntersectOutState.get,this.intersectIdsState.get]))}get onIntersect(){var t;return(t=this.onIntersectState)==null?void 0:t.get()}set onIntersect(t){var r;this.initIntersect(),(r=this.onIntersectState)==null||r.set(t)}get onIntersectOut(){var t;return(t=this.onIntersectOutState)==null?void 0:t.get()}set onIntersectOut(t){var r;this.initIntersect(),(r=this.onIntersectOutState)==null||r.set(t)}get intersectIds(){var t;return(t=this.intersectIdsState)==null?void 0:t.get()}set intersectIds(t){var r;this.initIntersect(),(r=this.intersectIdsState)==null||r.set(t)}get scaleX(){return this.outerObject3d.scale.x}set scaleX(t){this.outerObject3d.scale.x=t}get scaleY(){return this.outerObject3d.scale.y}set scaleY(t){this.outerObject3d.scale.y=t}get scaleZ(){return this.outerObject3d.scale.z}set scaleZ(t){this.outerObject3d.scale.z=t}get scale(){return this.scaleX}set scale(t){this.scaleX=t,this.scaleY=t,this.scaleZ=t}get rotationX(){return this.outerObject3d.rotation.x*d0}set rotationX(t){this.outerObject3d.rotation.x=t*Co}get rotationY(){return this.outerObject3d.rotation.y*d0}set rotationY(t){this.outerObject3d.rotation.y=t*Co}get rotationZ(){return this.outerObject3d.rotation.z*d0}set rotationZ(t){this.outerObject3d.rotation.z=t*Co}get rotation(){return this.rotationZ}set rotation(t){this.rotationZ=t}translateX(t){this.outerObject3d.translateX(t*Qr*Ah[0])}translateY(t){this.outerObject3d.translateY(t*Qr*Ah[0])}translateZ(t){this.outerObject3d.translateZ(t*Qr*Ah[0])}placeAt(t){var r;if(typeof t=="string"){const[i]=(r=p0.get(t))!=null?r:[void 0];if(!i)return;t=i}if("outerObject3d"in t){"isSpawnPoint"in t&&(t.object3d.position.y=mE(this).y*.5),this.outerObject3d.position.copy(fE(t.nativeObject3d)),this.outerObject3d.quaternion.copy(OO(t.outerObject3d));return}this.outerObject3d.position.copy(kle(t))}moveForward(t){bC()?this.translateZ(-t):(oa.setFromMatrixColumn(this.outerObject3d.matrix,0),oa.crossVectors(this.outerObject3d.up,oa),this.outerObject3d.position.addScaledVector(oa,t*Qr*Ah[0]))}moveRight(t){bC()?this.translateX(t):(oa.setFromMatrixColumn(this.outerObject3d.matrix,0),this.outerObject3d.position.addScaledVector(oa,t*Qr*Ah[0]))}lerpTo(t,r,i,s,o){const a=new Te(this.x,this.y,this.z),c=new Te(t,r,i);this.cancelHandle("lerpTo",()=>ha(()=>{var f;const{x:u,y:d,z:p}=a.lerp(c,v7(s));Math.abs(this.x-u)<.1&&Math.abs(this.y-d)<.1&&Math.abs(this.z-p)<.1&&(this.cancelHandle("lerpTo",void 0),(f=this.onMoveToEnd)==null||f.call(this)),this.x=u,this.y=d,this.z=p,o==null||o()}))}moveTo(t,r,i,s,o){t===this.x&&(t+=.01),i===this.z&&(i+=.01);const{x:a,y:c,z:u}=new Te(t-this.x,r===void 0?0:r-this.y,i-this.z).normalize(),d=s*a,p=s*c,f=s*u,v=qFe(t,i,this.x,this.z);this.cancelHandle("lerpTo",()=>ha(()=>{var _;this.x+=d*Ah[0],r!==void 0&&(this.y+=p*Ah[0]),this.z+=f*Ah[0];const x=GFe(new fy(this.x,this.z),new fy(t,i),new fy(this.x,i)),y=XFe(new fy(t,i),new fy(this.x,this.z),v===1||v===4?x:-x);i>y.y&&(this.cancelHandle("lerpTo",void 0),(_=this.onMoveToEnd)==null||_.call(this)),o==null||o(r)}))}}eE(vE,[Vle]);class Rp extends vE{constructor(t){var r;super(t);We(this,"material");We(this,"model");We(this,"managerSet");this.material=(r=t.material)!=null?r:t.material=AO,dl.delete(this)}retargetAnimations(){var t;if(!!((t=this.model)!=null&&t.animationManagers)){for(const r of Object.values(this.model.animationManagers))this.animations[r.name]=this.watch(r.retarget(this.nativeObject3d));this.model=void 0}}get animation(){return super.animation}set animation(t){this.retargetAnimations(),super.animation=t}addToRaycastSet(t){return this.managerSet||(this.managerSet=!0,this.nativeObject3d.traverse(r=>r.userData.manager=this)),super.addToRaycastSet(t)}}We(Rp,"componentName","find"),We(Rp,"defaults",e6e),We(Rp,"schema",$Fe);eE(Rp,[dE,c7]);const[CUe,pce]=Pt(20),[EUe,OJ]=Pt(void 0),b7=VD(async()=>{const{World:n,GSSolver:e,SplitSolver:t,NaiveBroadphase:r,Material:i,ContactMaterial:s,Body:o,Vec3:a,Box:c,Sphere:u,Cylinder:d}=await rr(()=>import("./cannon-es.28bd3118.js"),[]),p=new n;pce(y=>p.gravity.set(0,-y,0)),p.quatNormalizeSkip=0,p.quatNormalizeFast=!1;const f=new e;p.defaultContactMaterial.contactEquationStiffness=1e9,p.defaultContactMaterial.contactEquationRelaxation=4,f.iterations=7,f.tolerance=.1,p.solver=new t(f),p.broadphase=new r;const[v]=p.defaultContactMaterial.materials,x=new i("slipperyMaterial");return p.addContactMaterial(new s(x,x,{friction:0,restitution:0})),p.addContactMaterial(new s(x,v,{friction:.001,restitution:0})),EUe(p),{world:p,defaultMaterial:v,slipperyMaterial:x,Body:o,Vec3:a,Box:c,Sphere:u,Cylinder:d}});async function fce(){const{Box:n}=await b7();this.cannonBody.addShape(new n(mE(this).multiplyScalar(.5)))}const LJ=new Map,AUe=new Set,LO=new Map,DJ=new WeakSet,PUe=()=>new WeakSet;yn(function(){if(gl()||!PO())return;const n=OJ();if(!n)return;const e=ha(()=>{for(const t of AUe){const r=t.cannonBody;if("_mAV"in t){const{x:o,y:a,z:c}=t._mAV,{angularVelocity:u}=r;u.x>o?u.x=o:u.x<-o&&(u.x=-o),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>c?u.z=c:u.z<-c&&(u.z=-c)}if("_mV"in t){const{x:o,y:a,z:c}=t._mV,{velocity:u}=r;u.x>o?u.x=o:u.x<-o&&(u.x=-o),u.y>a?u.y=a:u.y<-a&&(u.y=-a),u.z>c?u.z=c:u.z<-c&&(u.z=-c)}const i=t.positionUpdate;i.x&&(r.position.x=t.outerObject3d.position.x,r.velocity.x=0,r.force.x=0),i.y&&(r.position.y=t.outerObject3d.position.y,r.velocity.y=0,r.force.y=0),i.z&&(r.position.z=t.outerObject3d.position.z,r.velocity.z=0,r.force.z=0),i.reset(),t.outerObject3d.position.copy(r.position);const s=t.rotationUpdate;s?(s.x&&(r.angularVelocity.x=0,r.torque.x=0),s.y&&(r.angularVelocity.y=0,r.torque.y=0),s.z&&(r.angularVelocity.z=0,r.torque.z=0),r.quaternion.copy(t.outerObject3d.quaternion)):t.outerObject3d.quaternion.copy(r.quaternion),s.reset}n.step(h7[0]),LO.clear();for(const t of n.contacts)ev(LO,t.bi,PUe).add(t.bj)});return()=>{e.cancel()}},[OJ,gl,PO]);const TUe=new WeakSet;class w7 extends vE{constructor(){super(...arguments);We(this,"_mAV");We(this,"_mV");We(this,"cannonBody");We(this,"positionUpdate");We(this,"rotationUpdate");We(this,"_noTumble");We(this,"_slippery");We(this,"_mass");We(this,"_physicsGroup");We(this,"_ignorePhysicsGroups");We(this,"_physicsShape");We(this,"bvhVelocity");We(this,"bvhOnGround");We(this,"bvhRadius");We(this,"bvhHalfHeight");We(this,"bvhMap");We(this,"bvhCharacter");We(this,"_physics");We(this,"_gravity")}getMAV(){var t;return(t=this._mAV)!=null?t:this._mAV=new h0(1/0,1/0,1/0)}get maxAngularVelocityX(){var t,r;return(r=(t=this._mAV)==null?void 0:t.x)!=null?r:1/0}set maxAngularVelocityX(t){this.getMAV().x=t}get maxAngularVelocityY(){var t,r;return(r=(t=this._mAV)==null?void 0:t.y)!=null?r:1/0}set maxAngularVelocityY(t){this.getMAV().y=t}get maxAngularVelocityZ(){var t,r;return(r=(t=this._mAV)==null?void 0:t.z)!=null?r:1/0}set maxAngularVelocityZ(t){this.getMAV().z=t}getMV(){var t;return(t=this._mV)!=null?t:this._mV=new h0(1/0,1/0,1/0)}get maxVelocityX(){var t,r;return(r=(t=this._mV)==null?void 0:t.x)!=null?r:1/0}set maxVelocityX(t){this.getMV().x=t}get maxVelocityY(){var t,r;return(r=(t=this._mV)==null?void 0:t.y)!=null?r:1/0}set maxVelocityY(t){this.getMV().y=t}get maxVelocityZ(){var t,r;return(r=(t=this._mV)==null?void 0:t.z)!=null?r:1/0}set maxVelocityZ(t){this.getMV().z=t}applyForce(t,r,i){setTimeout(()=>{var s;return(s=this.cannonBody)==null?void 0:s.applyForce({x:t,y:r,z:i})})}applyImpulse(t,r,i){setTimeout(()=>{var s;return(s=this.cannonBody)==null?void 0:s.applyImpulse({x:t,y:r,z:i})})}applyLocalForce(t,r,i){setTimeout(()=>{var s;return(s=this.cannonBody)==null?void 0:s.applyLocalForce({x:t,y:r,z:i})})}applyLocalImpulse(t,r,i){setTimeout(()=>{var s;return(s=this.cannonBody)==null?void 0:s.applyLocalImpulse({x:t,y:r,z:i})})}applyTorque(t,r,i){setTimeout(()=>{var s;return(s=this.cannonBody)==null?void 0:s.applyTorque({x:t,y:r,z:i})})}get velocity(){return this.bvhVelocity?this.bvhVelocity:this.cannonBody?this.cannonBody.velocity:new h0(0,0,0)}set velocity(t){this.bvhVelocity?Object.assign(this.bvhVelocity,t):this.cannonBody&&Object.assign(this.cannonBody.velocity,t)}refreshCannon(){var t;this.positionUpdate&&(this.physics=(t=this._physics)!=null?t:!1)}get noTumble(){return this._noTumble}set noTumble(t){this._noTumble=t,this.refreshCannon()}get slippery(){return this._slippery}set slippery(t){this._slippery=t,this.refreshCannon()}get mass(){return this._mass}set mass(t){this._mass=t,this.refreshCannon()}get physicsGroup(){return this._physicsGroup}set physicsGroup(t){this._physicsGroup=t,this.refreshCannon()}get ignorePhysicsGroups(){return this._ignorePhysicsGroups}set ignorePhysicsGroups(t){this._ignorePhysicsGroups=t,this.refreshCannon()}get physicsShape(){var t;return(t=this._physicsShape)!=null?t:this._physicsShape=fce}set physicsShape(t){this._physicsShape=t,this.refreshCannon()}initPhysics(t,r){if(!(!t||r.done))switch(t){case!0:case"2d":rr(()=>import("./enableCannon.1f29f9a4.js"),["assets/enableCannon.1f29f9a4.js","assets/PhysicsUpdate.424dc14a.js"]).then(i=>i.default.call(this,r));break;case"map":this.bvhMap=!0,rr(()=>import("./enableBVHMap.5fba9d77.js"),["assets/enableBVHMap.5fba9d77.js","assets/bvhManagerMap.cd08c8fd.js"]).then(i=>i.default.call(this,r,!1));break;case"map-debug":this.bvhMap=!0,rr(()=>import("./enableBVHMap.5fba9d77.js"),["assets/enableBVHMap.5fba9d77.js","assets/bvhManagerMap.cd08c8fd.js"]).then(i=>i.default.call(this,r,!0));break;case"character":this.bvhCharacter=!0,rr(()=>import("./enableBVHCharacter.1f3efa43.js"),["assets/enableBVHCharacter.1f3efa43.js","assets/bvhManagerMap.cd08c8fd.js","assets/PhysicsUpdate.424dc14a.js"]).then(i=>i.default.call(this,r));break;default:mIe(t)}}get physics(){var t;return(t=this._physics)!=null?t:!1}set physics(t){this._physics=t,this.initPhysics(t,this.cancelHandle("physics",()=>new di))}get gravity(){var t;return(t=this._gravity)!=null?t:!0}set gravity(t){this._gravity=t}intersects(t){var r,i,s,o;if(this.done||t.done||this===t)return!1;if(t instanceof w7){if(this.bvhMap&&t.bvhCharacter||this.bvhCharacter&&t.bvhMap)return((r=LJ.get(this))==null?void 0:r.has(t))||((i=LJ.get(t))==null?void 0:i.has(this))||!1;if(this.cannonBody&&t.cannonBody)return DJ.add(this.cannonBody),DJ.add(t.cannonBody),((s=LO.get(this.cannonBody))==null?void 0:s.has(t.cannonBody))||((o=LO.get(t.cannonBody))==null?void 0:o.has(this.cannonBody))||!1}return super.intersects(t)}get x(){return super.x}set x(t){var r;super.x=t,(r=this.positionUpdate)==null||r.updateX()}get y(){return super.y}set y(t){var r;super.y=t,(r=this.positionUpdate)==null||r.updateY()}get z(){return super.z}set z(t){var r;super.z=t,(r=this.positionUpdate)==null||r.updateZ()}get rotationX(){return super.rotationX}set rotationX(t){var r;super.rotationX=t,(r=this.rotationUpdate)==null||r.updateX()}get rotationY(){return super.rotationY}set rotationY(t){var r;super.rotationY=t,(r=this.rotationUpdate)==null||r.updateY()}get rotationZ(){return super.rotationZ}set rotationZ(t){var r;super.rotationZ=t,(r=this.rotationUpdate)==null||r.updateZ()}lookAt(t,r,i){var s;super.lookAt(t,r,i),(s=this.rotationUpdate)==null||s.updateXYZ()}placeAt(t){var r,i;super.placeAt(t),(r=this.positionUpdate)==null||r.updateXYZ(),(i=this.rotationUpdate)==null||i.updateXYZ(),TUe.add(this)}lerpTo(t,r,i,s){super.lerpTo(t,r,i,s,()=>{var o;return(o=this.positionUpdate)==null?void 0:o.updateXYZ()})}moveTo(t,r,i,s){super.moveTo(t,r,i,s,o=>{var a,c;return o===void 0?(a=this.positionUpdate)==null?void 0:a.updateXZ():(c=this.positionUpdate)==null?void 0:c.updateXYZ()})}}class gE extends w7{constructor(t=new Qi,r){super(t);We(this,"object3d");this.object3d=t,this.nativeObject3d=t;const i=this.outerObject3d=new Qi;i.userData.manager=this,!r&&Sn.add(i),i.add(t)}get innerRotationX(){return this.object3d.rotation.x*d0}set innerRotationX(t){this.object3d.rotation.x=t*Co}get innerRotationY(){return this.object3d.rotation.y*d0}set innerRotationY(t){this.object3d.rotation.y=t*Co}get innerRotationZ(){return this.object3d.rotation.z*d0}set innerRotationZ(t){this.object3d.rotation.z=t*Co}get innerRotation(){return this.innerRotationZ}set innerRotation(t){this.innerRotationZ=t}get innerX(){return this.object3d.position.x*js}set innerX(t){this.object3d.position.x=t*Qr}get innerY(){return this.object3d.position.y*js}set innerY(t){this.object3d.position.y=t*Qr}get innerZ(){return this.object3d.position.z*js}set innerZ(t){this.object3d.position.z=t*Qr}get width(){return this.object3d.scale.x*js}set width(t){this.object3d.scale.x=t*Qr}get height(){return this.object3d.scale.y*js}set height(t){this.object3d.scale.y=t*Qr}get depth(){return this.object3d.scale.z*js}set depth(t){this.object3d.scale.z=t*Qr}get innerVisible(){return this.object3d.visible}set innerVisible(t){this.object3d.visible=t}find(t,r){var o,a;const i=this.outerObject3d.getObjectByName(Dr.sanitizeNodeName(t));if(!i)return;const s=(a=(o=i.userData).manager)!=null?a:o.manager=new Rp(i);return!r&&this._append(s),s}findAll(t){const r=[];return t===void 0?this.outerObject3d.traverse(i=>{var s,o;r.push((o=(s=i.userData).manager)!=null?o:s.manager=new Rp(i))}):typeof t=="string"?this.outerObject3d.traverse(i=>{var s,o;i.name===t&&r.push((o=(s=i.userData).manager)!=null?o:s.manager=new Rp(i))}):typeof t=="function"?this.outerObject3d.traverse(i=>{var s,o;t(i.name)&&r.push((o=(s=i.userData).manager)!=null?o:s.manager=new Rp(i))}):this.outerObject3d.traverse(i=>{var s,o;t.test(i.name)&&r.push((o=(s=i.userData).manager)!=null?o:s.manager=new Rp(i))}),r}}const RUe={...Ple,maxAngularVelocityX:Number,maxAngularVelocityY:Number,maxAngularVelocityZ:Number,maxVelocityX:Number,maxVelocityY:Number,maxVelocityZ:Number,velocity:Object,gravity:Boolean,noTumble:Boolean,slippery:Boolean,mass:Number,physicsGroup:Number,ignorePhysicsGroups:Array,physics:[String,Boolean],physicsShape:Function};cE(["maxAngularVelocityX","maxAngularVelocityY","maxAngularVelocityZ","maxVelocityX","maxVelocityY","maxVelocityZ","velocity","noTumble","slippery","mass","physicsGroup","ignorePhysicsGroups","physicsShape"]);const OUe={...Tle,maxAngularVelocityX:1/0,maxAngularVelocityY:1/0,maxAngularVelocityZ:1/0,maxVelocityX:1/0,maxVelocityY:1/0,maxVelocityZ:1/0,velocity:{x:0,y:0,z:0},gravity:!0,noTumble:new ki(!1),slippery:new ki(!1),mass:new ki(1),physicsGroup:void 0,ignorePhysicsGroups:void 0,physics:!1,physicsShape:fce},Ib={...RUe,innerRotationX:Number,innerRotationY:Number,innerRotationZ:Number,innerRotation:Number,innerX:Number,innerY:Number,innerZ:Number,width:Number,height:Number,depth:Number,innerVisible:Boolean},Nb={...OUe,innerRotationX:0,innerRotationY:0,innerRotationZ:0,innerRotation:0,innerX:0,innerY:0,innerZ:0,width:100,height:100,depth:100,innerVisible:!0},S7={...Ib,...JD,...a7},M7={...Nb,...QD,...l7};class DO extends gE{constructor(t){const r=new ul(t,AO);r.castShadow=!0,r.receiveShadow=!0;super(r);We(this,"material",AO)}}We(DO,"defaults",M7),We(DO,"schema",S7);eE(DO,[dE,c7]);const LUe=new F0(Ec,Ec,Ec,1,1,1),sR=new WeakMap,mce=n=>{sR.has(n)&&(sR.get(n)(),sR.delete(n))},IJ=(n,e)=>{mce(n);const t=n(e);t&&sR.set(n,t)};class DUe{constructor(){We(this,"done");We(this,"value");We(this,"callbacks",[])}then(e){return this.callbacks.push(e),this.done&&IJ(e,this.value),new di(()=>{NH(this.callbacks,e),mce(e)})}resolve(e){for(const t of this.callbacks)IJ(t,e);this.done=!0,this.value=e}}const IUe=n=>{const e=new _Ie;return n.then(t=>{e.resolve(t)}),e};class vce extends gE{constructor(t){super(new ul(LUe,Nle),t);We(this,"loadedGroup",new kp);We(this,"loaded",new DUe);We(this,"_src");We(this,"_onLoad");We(this,"widthSet");We(this,"heightSet");We(this,"depthSet");We(this,"_boxVisible");We(this,"_outline");We(this,"_bloom");We(this,"managerSet");We(this,"materialCloned");this.outerObject3d.add(this.loadedGroup)}get src(){return this._src}set src(t){this._src=t,this.loaded.done&&this.loadedGroup.clear(),this.cancelHandle("src",t&&(()=>IUe(this.load(t)).then(r=>{const i=this.resolveLoaded(r,t);this.loadedGroup.add(i),this.loaded.resolve(i),this.object3d.visible=!!this._boxVisible})))}get onLoad(){return this._onLoad}set onLoad(t){this._onLoad=t,this.cancelHandle("onLoad",t&&(()=>this.loaded.then(()=>void t())))}get width(){return super.width}set width(t){super.width=t,this.widthSet=!0}get height(){return super.height}set height(t){super.height=t,this.heightSet=!0}get depth(){return super.depth}set depth(t){super.depth=t,this.depthSet=!0}get innerRotationX(){return super.innerRotationX}set innerRotationX(t){super.innerRotationX=t,this.loadedGroup.rotation.x=this.object3d.rotation.x}get innerRotationY(){return super.innerRotationY}set innerRotationY(t){super.innerRotationY=t,this.loadedGroup.rotation.y=this.object3d.rotation.y}get innerRotationZ(){return super.innerRotationZ}set innerRotationZ(t){super.innerRotationZ=t,this.loadedGroup.rotation.z=this.object3d.rotation.z}get innerX(){return super.innerX}set innerX(t){super.innerX=t,this.loadedGroup.position.x=this.object3d.position.x}get innerY(){return super.innerY}set innerY(t){super.innerY=t,this.loadedGroup.position.y=this.object3d.position.y}get innerZ(){return super.innerZ}set innerZ(t){super.innerZ=t,this.loadedGroup.position.z=this.object3d.position.z}get innerVisible(){return this.loadedGroup.visible}set innerVisible(t){this.loadedGroup.visible=t}get frustumCulled(){return super.frustumCulled}set frustumCulled(t){this.outerObject3d.frustumCulled=t,this.cancelHandle("frustumCulled",()=>this.loaded.then(()=>{super.frustumCulled=t}))}get castShadow(){return super.castShadow}set castShadow(t){this._castShadow=t,this.cancelHandle("castShadow",()=>this.loaded.then(()=>{super.castShadow=t}))}get receiveShadow(){return super.receiveShadow}set receiveShadow(t){this._receiveShadow=t,this.cancelHandle("receiveShadow",()=>this.loaded.then(()=>{super.receiveShadow=t}))}get physics(){return super.physics}set physics(t){this._physics=t;const r=this.cancelHandle("physics",()=>this.loaded.then(()=>{this.initPhysics(t,r)}))}get boxVisible(){var t;return(t=this._boxVisible)!=null?t:this.object3d.visible}set boxVisible(t){this._boxVisible=t,this.object3d.visible=t}get outline(){return!!this._outline}set outline(t){this._outline=t,this.cancelHandle("outline",()=>this.loaded.then(r=>{if(!!t)return ece(r),()=>{tce(r)}}))}get bloom(){return!!this._bloom}set bloom(t){this._bloom=t,this.cancelHandle("bloom",()=>this.loaded.then(r=>{if(!!t)return Gle(r),()=>{Xle(r)}}))}addToRaycastSet(t){const r=new di;return queueMicrotask(()=>{r.done||(this._physics==="map"||this._physics==="map-debug"?r.watch(this.loaded.then(i=>(this.managerSet||(this.managerSet=!0,i.traverse(s=>{var o,a;return(a=(o=s.userData).manager)!=null?a:o.manager=this})),t.add(i),()=>{t.delete(i)}))):r.watch(super.addToRaycastSet(t)))}),r}refreshFactors(){this.cancelHandle("refreshFactorsLoaded",()=>this.loaded.then(()=>void super.refreshFactors()))}tryCloneMaterial(){this.materialCloned||(this.materialCloned=!0,this.watch(this.loaded.then(t=>{const r=[];return t.traverse(i=>{!i.material||r.push(i.material=i.material.clone())}),()=>{for(const i of r)i.dispose()}})))}placeAt(t){this.cancelHandle("placeAt",()=>this.loaded.then(()=>void super.placeAt(t)))}}const NUe=new WeakSet;yn(()=>{const n=Oc();if(!(n instanceof vce)||mn()!==uo)return;const e=n.loadedGroup.children[0];if(!NUe.has(e))return;const t=new kFe(e);return Sn.add(t),()=>{Sn.remove(t)}},[Oc,mn]);const[v$e,wC]=Pt(!1),[kT,t4]=Pt({}),n4=!1,[gce,V8]=Pt(n4);yn(()=>{var n;gce((n=mn().userData.bokeh)!=null?n:n4)},[mn,t4]);const r4=.03,[_ce,yce]=Pt(r4);yn(()=>{var n;_ce((n=mn().userData.bokehAperture)!=null?n:r4)},[mn,t4]);const i4=1,[xce,bce]=Pt(i4);yn(()=>{var n;xce((n=mn().userData.bokehFocus)!=null?n:i4)},[mn,t4]);const s4=.01,[wce,Sce]=Pt(s4);yn(()=>{var n;wce((n=mn().userData.bokehMaxBlur)!=null?n:s4)},[mn,t4]);const kUe={...Ib,mouseControl:[Boolean,String],fov:Number,zoom:Number,near:Number,far:Number,active:Boolean,transition:[Boolean,Number],bokeh:Boolean,bokehFocus:Number,bokehMaxBlur:Number,bokehAperture:Number,minPolarAngle:Number,maxPolarAngle:Number,minAzimuthAngle:Number,maxAzimuthAngle:Number,polarAngle:Number,azimuthAngle:Number,enableDamping:Boolean},zUe={...Nb,mouseControl:!1,fov:75,zoom:1,near:Db,far:Wh,active:!1,transition:new ki(!1),bokeh:n4,bokehFocus:i4,bokehMaxBlur:s4,bokehAperture:r4,minPolarAngle:jle,maxPolarAngle:Hle,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,polarAngle:new ki(0),azimuthAngle:new ki(0),enableDamping:!1},BUe={...kUe,targetId:String,enableZoom:Boolean,enableFly:Boolean,autoRotate:[Boolean,Number]},VUe={...zUe,innerZ:500,mouseControl:"drag",targetId:void 0,enableZoom:!1,enableFly:!1,autoRotate:!1},[kb,C7]=fa();window.addEventListener("blur",()=>kb());window.addEventListener("focus",()=>kb());document.addEventListener("visibilitychange",()=>kb());const oR=new Set;C7(()=>oR.clear());let F8=!1;const Mce=()=>{!F8||(F8=!1,kb())};document.addEventListener("keydown",n=>{Mce(),(n.key==="Shift"||n.key==="Meta")&&oR.add(n.key),oR.has("Meta")&&oR.has("Shift")&&(kb(),F8=!0)});document.addEventListener("keyup",n=>{(n.key==="Shift"||n.key==="Meta")&&kb()});document.addEventListener("mousedown",Mce);async function FUe(){const{Sphere:n,Cylinder:e,Vec3:t}=await b7(),{x:r,y:i}=mE(this),s=r*.5,o=i*.5,a=new n(s),c=new n(s),u=new e(s,s,Math.abs(i-r));this.cannonBody.addShape(a,new t(0,-o+s,0)),this.cannonBody.addShape(c,new t(0,o-s,0)),this.cannonBody.addShape(u)}const[Cce,Ece]=Pt([]),UUe=Mb(Cce,Ece),jUe=Cb(Cce,Ece),HUe={...Ib,...JD},WUe={...Nb,...QD,scaleZ:0,depth:0},NJ=new rle({transparent:!0});class qy extends gE{constructor(){super(new xVe(NJ));We(this,"material",NJ)}get depth(){return 0}set depth(t){}get scaleZ(){return 0}set scaleZ(t){}}We(qy,"componentName","sprite"),We(qy,"defaults",WUe),We(qy,"schema",HUe);eE(qy,[dE]);const GUe=()=>{const n=new qy;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABnNJREFUaEPtWVmoVlUU/r5zNItModEGQinLMkqbyDLqoR6K0gZMEsxIkh6iEYSEZiR9iDTyoZEkqeylsoFeKmkwKOhGRaE5VIo0kVOIej37i3XY62f7e+//n//e44DcA//DvXuftde3hm+tvQ5xiDzcVzgk5QBMvno4w/8fSPa03rFatQORZDJJMlTRRlJWdW8rebUCSZWSdHUI4SoAx0XPmB5mfTtzW5ZlKwAsNY+Y90gWVYD3tqc2IOYJV0rSGwCmVFCsi+Qkkhv665k6gZQhEkJ4G8ANALoBDG4BZieAIQB+JjmO5C43RgUD7LWlFiAeGpKuk/QegF0ADgNglv4IwKB4sp23yxQHcBGAHQAOJ3kfyYWSBpHcfSCBDCbZHUJ4B8BkV1DSk3meP9KsmKTxkr4FYHlh7Laa5BkxNMsQ7RTMXh6xWAVgPxfWTqglareksZJ+iMlchhXJOSSfkmTesf9Z+BWSxkj6Ke41D5gnHiI5L9K2E0MznpIRTbdmctgDSF/ZQ9JwSR8AuCxa2RTIJb2eZdl0AEdEwxiQ/yTdImkpAKNoV844expJI4q2T6R5e6c0dAOIs4akU41xQgjnkTzWYjihzd4OOBfAMVEx82b6/BVDLfXyCTGHfJ/Tsv1tIbcpRkXz+k5JG7Mse5+kkQqcIEogSbLeFKnTQqHTx6zbDCJVsJ08D+FKBCRpSZ7n0xtAEv4/WtKvAI6KrGNKVRIaAaR7DZT9nK2aQfi6tzHpuq21yktbs5/l4N0kF5Vs55QnaaqkNyvwfzvLlsmbbFoHYCOALQCOB3AKgBHJujNXO7npur/TlWXZ+aUzJJXUKelhSU8AaFak6gFp4q4j+SyAjwGstGLXCHZpGIBxIYSpJO+K3uz0TA/ZP0iONgJpeKQoimesMPURSCM/JM3PsuxRkla5y2SMHrJQtW7XaLh8JI2W9AKAKzs814FsJjmK5OYUyAKS93YosNQn4fYbSb4blTS26+6pGbRwNnp2sEVRvEzyjqRAtouCfQKk9AbJ6SSXxOJnBau0vKRLAFwAYDiAfwF8TdIo1taGOJikR6sSZg5kC8mRdXikPFTSK3mez7R8i1V3d2xDFgGY0IN5l1t+kFzpYCQNlbQagNWYnqg8FVMrEBe2neRZJH83b8Qu1ptHO9yp1hXxFmgnyQkkuyRZ47hD0ixJz1cIsVqBuDcW53l+ewJilKSVsYXvrZX37ng9ybEkt3leRa+c3MYrtQIpuZzkZJLLPESKoniV5IwK9agE4x2ye6UoipdIzmxDOrUBcUE7Yvu9Plp0mKRfYuFr1554HqwhOcY7Wkl3RkpulfS1AXElNpA8k+T2COQcSd8n05NWLY4rY7kyhqS1R8ZkkyQZhbeq+LUDsQpuie7Fb5ykrnZFwOthBGw3xrNJrolArpH04f4C0piGxBbhz6jECEmrYuPZLrR8/W+Sp5PcGmXcJmnx/gLSqOgkLyX5lfdsIYRPK7YcJaPZtSHP82kJWcy1m+X+SnYD4vT7eJ7njyW1wGuIrXvNaI62RsEjOZ7kd96FhxCs6o/fn/Trylh3a7XA7uLloK0oiqdJPhC1L+/qCQHYe+WYiOT9JBck1X2ipM8r3EhrS3a3sA8O/ILT6J0kzZY0r5fLmSX4gySfi8MOm5wUIYTPAFze38relzY+bVMsRFaZdePsykaho0MIs0hOBHAkgK2SlmdZ9iLJ3+LExLxowzkDPr8CiLTjrrWNT2dTF5PcFJtHs3J6odpjXmU5BcBqiAGeIumtJlpuxeItQ2s+ydl9uI80Et8miyRvJflFpFLLDRtkGFjLjfKO7nUn7pkjaW4HIFKP/EPyNKPu9M5+j6SFfQRiwhuV2CYcWZZZqJb3juZHkoXZtZKMZm18mipXpZ460ayNXUG3ASmZRtKFkr6JQHqablQ9oDFwA/CjpBVZltkAYlMI4SQANhq9AsCJUaAZoJOJjb1WDsAlvZbnuRXQQT7XKuM3hLAMwPWR/tqNZVoBc+XaTePt/OZZWBWD2VXZ8stam7XlcDHGqX/bGBpCsPvzzTGeqwg9EHusY55B8kuPqL1GphHYSAA2BjX3G7tUHdTta1D2GWItgE/s80M6q24eYnf0/W9fa92Sf5s+1/Voaa+2B5EnUkxWQ/b6GnywhEy/nTsApN8mrFnAgEdqNmi/xQ14pN8mrFnAgEdqNmi/xR0yHvkfVPFBbg9BWmoAAAAASUVORK5CYII=",dl.delete(n),n.scale=.5,n},Z7=class extends gE{constructor(t){super();We(this,"camera");We(this,"_physicsShape",FUe);We(this,"midObject3d",this.outerObject3d);We(this,"orbitMode");We(this,"gyrateHandle");We(this,"_minPolarAngle",jle);We(this,"_maxPolarAngle",Hle);We(this,"_minAzimuthAngle",-1/0);We(this,"_maxAzimuthAngle",1/0);We(this,"_polarAngle");We(this,"_azimuthAngle");We(this,"enableDamping",!1);We(this,"mouseControlState",new tu(!1));We(this,"mouseControlInit");We(this,"_gyroControl");this.camera=t,this.object3d.add(t),t.userData.manager=this,UUe(t),this.then(()=>{MJ(t),jUe(t)}),this.createEffect(()=>{if(mn()!==uo||mn()===t)return;const r=new BFe(t);Sn.add(r);const i=GUe();r.add(i.outerObject3d);const s=$D(({target:o})=>{o===i&&yc(this)});return()=>{r.dispose(),Sn.remove(r),i.dispose(),s.cancel()}},[mn])}lookAt(t,r,i){super.lookAt(t,r,i);const s=wh.setFromQuaternion(this.outerObject3d.quaternion);s.x+=Math.PI,s.z+=Math.PI,this.outerObject3d.setRotationFromEuler(s)}get fov(){return this.camera.fov}set fov(t){var r,i;this.camera.fov=t,(i=(r=this.camera).updateProjectionMatrix)==null||i.call(r)}get zoom(){return this.camera.zoom}set zoom(t){var r,i;this.camera.zoom=t,(i=(r=this.camera).updateProjectionMatrix)==null||i.call(r)}get near(){return this.camera.near}set near(t){var r,i;this.camera.near=t,(i=(r=this.camera).updateProjectionMatrix)==null||i.call(r)}get far(){return this.camera.far}set far(t){var r,i;this.camera.far=t,(i=(r=this.camera).updateProjectionMatrix)==null||i.call(r)}get active(){return $2(xC())===this.camera}set active(t){MJ(this.camera),t&&G6e(this.camera)}get transition(){return this.camera.userData.transition}set transition(t){this.camera.userData.transition=t}get bokeh(){var t;return(t=this.camera.userData.bokeh)!=null?t:n4}set bokeh(t){this.camera.userData.bokeh=t,kT({})}get bokehFocus(){var t;return(t=this.camera.userData.bokehFocus)!=null?t:i4}set bokehFocus(t){this.camera.userData.bokehFocus=t,kT({})}get bokehMaxBlur(){var t;return(t=this.camera.userData.bokehMaxBlur)!=null?t:s4}set bokehMaxBlur(t){this.camera.userData.bokehMaxBlur=t,kT({})}get bokehAperture(){var t;return(t=this.camera.userData.bokehAperture)!=null?t:r4}set bokehAperture(t){this.camera.userData.bokehAperture=t,kT({})}getRay(){return Dle.set(ia(this.camera),nce(this.camera))}append(t){this._append(t),this.camera.add(t.outerObject3d)}attach(t){this._append(t),this.camera.attach(t.outerObject3d)}get width(){return super.width}set width(t){const r=t*Qr;this.object3d.scale.x=r,this.camera.scale.x=1/r}get height(){return super.height}set height(t){const r=t*Qr;this.object3d.scale.y=r,this.camera.scale.y=1/r}get depth(){return super.depth}set depth(t){const r=t*Qr;this.object3d.scale.z=r,this.camera.scale.z=1/r}_gyrate(t,r,i){var o;const s=i?this.object3d:this.midObject3d;wh.setFromQuaternion(s.quaternion),wh.y-=t*.002,wh.y=Math.max(ET-this._maxAzimuthAngle*Co,Math.min(ET-this._minAzimuthAngle*Co,wh.y)),wh.x-=r*.002,wh.x=Math.max(ET-this._maxPolarAngle*Co,Math.min(ET-this._minPolarAngle*Co,wh.x)),s.setRotationFromEuler(wh),!i&&((o=this.rotationUpdate)==null||o.updateXYZ())}gyrate(t,r,i){var a;if(this.enableDamping&&(t*=.5,r*=.5),this.orbitMode?this._gyrate(t,r):(this._gyrate(t,0),this._gyrate(0,r,!0)),!this.enableDamping||i||!(t||r))return;(a=this.gyrateHandle)==null||a.cancel();let s=1;const o=this.gyrateHandle=this.beforeRender(()=>{s*=.95,this._gyrate(t*s,r*s),s<=.001&&o.cancel()})}updateAngle(){Z7.updateAngle(this,this)}get minPolarAngle(){return this._minPolarAngle}set minPolarAngle(t){this._minPolarAngle=t,this.updateAngle()}get maxPolarAngle(){return this._maxPolarAngle}set maxPolarAngle(t){this._maxPolarAngle=t,this.updateAngle()}get minAzimuthAngle(){return this._minAzimuthAngle}set minAzimuthAngle(t){this._minAzimuthAngle=t,this.updateAngle()}get maxAzimuthAngle(){return this._maxAzimuthAngle}set maxAzimuthAngle(t){this._maxAzimuthAngle=t,this.updateAngle()}setPolarAngle(t){const{_minPolarAngle:r,_maxPolarAngle:i}=this;this.minPolarAngle=this.maxPolarAngle=t,this.queueMicrotask(()=>{this.minPolarAngle=r,this.maxPolarAngle=i})}setAzimuthAngle(t){const{_minAzimuthAngle:r,_maxAzimuthAngle:i}=this;this.minAzimuthAngle=this.maxAzimuthAngle=t,this.queueMicrotask(()=>{this.minAzimuthAngle=r,this.maxAzimuthAngle=i})}get polarAngle(){return this._polarAngle}set polarAngle(t){this._polarAngle=t,t&&this.setPolarAngle(t)}get azimuthAngle(){return this._azimuthAngle}set azimuthAngle(t){this._azimuthAngle=t,t&&this.setAzimuthAngle(t)}get mouseControl(){return this.mouseControlState.get()}set mouseControl(t){this.mouseControlState.set(t),!(!t||this.mouseControlInit)&&(this.mouseControlInit=!0,rr(()=>import("./enableMouseControl.a4fbd32b.js"),[]).then(r=>r.default.call(this)))}get gyroControl(){return!!this._gyroControl}set gyroControl(t){this._gyroControl=t;const r=wh,i=c6e,s=u6e,o=new Mc(-Math.sqrt(.5),0,0,Math.sqrt(.5)),a=OO(this.object3d),c=0,u=d=>{var f,v,x;this.object3d.quaternion.copy(a),r.set(((f=d.beta)!=null?f:0)*Co,((v=d.alpha)!=null?v:0)*Co,-((x=d.gamma)!=null?x:0)*Co,"YXZ"),this.object3d.quaternion.multiply(i.setFromEuler(r));const p=-c*.5;s.set(0,Math.sin(p),0,Math.cos(p)),this.object3d.quaternion.multiply(s),this.object3d.quaternion.multiply(o)};t&&window.addEventListener("deviceorientation",u),this.cancelHandle("gyroControl",t&&(()=>new di(()=>window.removeEventListener("deviceorientation",u))))}};let aR=Z7;We(aR,"updateAngle",Eae(t=>t.gyrate(0,0)));const XUe=n=>!!n&&(TO(n)||n instanceof dce),zT=new WeakSet,K7=class extends aR{constructor(t){super(t);We(this,"manualTarget");We(this,"targetState",new tu(void 0));this.createEffect(()=>{const r=this.targetState.get();if(!r)return;const i=pE(()=>r.parent!==this&&this.retarget());return()=>{i.cancel()}},[this.targetState.get])}retarget(){K7.retaget(this,this)}append(t){this._append(t),zT.delete(t),this.retarget()}attach(t){this._append(t),zT.add(t),this.retarget()}};let lR=K7;We(lR,"retaget",Eae(t=>{var i;let r=t.manualTarget;for(const s of(i=t.children)!=null?i:[])if(r)s.outerObject3d.parent!==t.camera&&t.camera[zT.has(s)?"attach":"add"](s.outerObject3d);else if(XUe(s)){r=s;const{parent:o}=t.outerObject3d;o&&s.outerObject3d.parent!==o&&o[zT.has(r)?"attach":"add"](r.outerObject3d)}t.targetState.set(r)}));class cR extends lR{constructor(t=new al(75,1,Db,Wh)){super(t);We(this,"targetIdState",new tu(void 0));We(this,"enableZoomState",new tu(!1));We(this,"enableFlyState",new tu(!1));We(this,"autoRotateState",new tu(!1));this.innerZ=500,this.orbitMode=!0,this.mouseControl="drag",this.camera.rotation.y=0,this.createEffect(()=>{const r=this.targetIdState.get();if(!r)return;const i=new di,s=setTimeout(()=>{const o=()=>{var c;const[a]=(c=p0.get(r))!=null?c:[void 0];return a&&(this.manualTarget=a,this.targetState.set(a)),a};o()||i.watch(pE(()=>setTimeout(()=>o()&&i.cancel())))});return()=>{clearTimeout(s),i.cancel()}},[this.targetIdState.get]),this.createEffect(()=>{const r=this.targetState.get();if(!r)return;const i=ha(()=>{this.placeAt(Up(fE(r.nativeObject3d)))});return()=>{i.cancel()}},[this.targetState.get]),this.createEffect(()=>{const r=this.autoRotateState.get();if(mn()!==t||!r)return;const i=typeof r=="number"?r:2,s=ha(()=>{this.gyrate(i,0,!0)});return()=>{s.cancel()}},[mn,this.autoRotateState.get]),this.createEffect(()=>{if(Yp()||mn()!==t||!this.mouseControlState.get())return;const r=new di;if(this.enableZoomState.get()){const i=s=>{s.preventDefault(),this.innerZ+=s.deltaY,this.innerZ<0&&(this.innerZ=0)};Ms.addEventListener("wheel",i),r.then(()=>Ms.removeEventListener("wheel",i))}if(this.enableFlyState.get()){const i=new Set;r.watch(ha(()=>{if(i.has("Meta")||i.has("Control"))return;const a=i.has("Shift")?50:10;if(i.has("w")?this.translateZ(-a):i.has("s")&&this.translateZ(a),i.has("a")||i.has("ArrowLeft")?this.moveRight(-a):(i.has("d")||i.has("ArrowRight"))&&this.moveRight(a),i.has("w")||i.has("s")||i.has("a")||i.has("d")){const c=Up(ia(this.object3d));this.innerZ=0,this.placeAt(c)}i.has("Meta")||i.has("Control")||(i.has("ArrowDown")?this.y-=a:i.has("ArrowUp")&&(this.y+=a))}));const s=a=>{i.add(a.key.length===1?a.key.toLocaleLowerCase():a.key)},o=a=>{i.delete(a.key.length===1?a.key.toLocaleLowerCase():a.key)};document.addEventListener("keydown",s),document.addEventListener("keyup",o),r.watch(C7(()=>i.clear())),r.then(()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",o)})}return()=>{r.cancel()}},[mn,Yp,this.enableZoomState.get,this.enableFlyState.get,this.mouseControlState.get])}get targetId(){return this.targetIdState.get()}set targetId(t){this.targetIdState.set(t)}get enableZoom(){return this.enableZoomState.get()}set enableZoom(t){this.enableZoomState.set(t)}get enableFly(){return this.enableFlyState.get()}set enableFly(t){this.enableFlyState.set(t)}get autoRotate(){return this.autoRotateState.get()}set autoRotate(t){this.autoRotateState.set(t)}}We(cR,"componentName","orbitCamera"),We(cR,"defaults",VUe),We(cR,"schema",BUe);const[g$e,qUe]=fa(),[kJ,YUe]=Pt(0),xc=new cR(uo);xc.enableZoom=!0;xc.enableFly=!0;xc.mouseControl=!1;dl.delete(xc);qUe(n=>{const e=n.getWorldPosition();xc.x=e.x,xc.y=e.y,xc.z=e.z;const t=mE(n);xc.innerZ=Math.max(t.x,t.y,t.z,1)*js+50});wC(n=>{n||(xc.setPolarAngle(90),xc.setAzimuthAngle(90))});yn(()=>{if(!(!wC()||mn()!==uo||Yp()))return xc.mouseControl="drag",Ms.style.cursor="grab",()=>{xc.mouseControl=!1,Ms.style.cursor="auto"}},[wC,Yp,mn]);yn(()=>{if(mn()!==uo||wC())return;const n=YUe(e=>xc.innerZ=e);return()=>{n.cancel()}},[mn,wC]);const[zJ,_$e]=fa(),[y$e,BJ]=Pt(null),[BT,VJ]=Pt(ou());yn(()=>{const n=Oc(),e=ou();if(!n||e==="select"){BT(e);return}if(!TO(n)){BT("select");return}if(!(n instanceof vE)){BT("translate");return}BT(e)},[ou,Oc]);const[x$e,U8]=Pt("world"),[FJ,UJ]=Pt(U8());yn(()=>{ou()==="scale"?FJ("local"):FJ(U8())},[U8,ou]);const ZUe=VD(async()=>{const{TransformControls:n}=await rr(()=>import("./TransformControls.967d7bd3.js"),[]),e=new n(mn(),Ms);mn(r=>e.camera=r),e.enabled=!1;let t=!1;return e.addEventListener("dragging-changed",({value:r})=>{t=r,fUe(t),zJ(t?"start":"stop")}),e.addEventListener("change",()=>t&&zJ("move")),e});yn(()=>{const n=Oc();if(!n)return;let e=VJ();e==="path"&&(e="translate");const t=UJ(),r=BJ(),i=new di;return ZUe().then(s=>{i.done||!n.outerObject3d.parent||e!=="translate"&&e!=="rotate"&&e!=="scale"||(s.setMode(e),s.setSpace(t),s.setScaleSnap(r),s.setRotationSnap(r),s.setTranslationSnap(r),Sn.add(s),s.attach(n.outerObject3d),s.enabled=!0,i.then(()=>{Sn.remove(s),s.detach(),s.enabled=!1}))}),()=>{i.cancel()}},[Oc,VJ,UJ,BJ]);const[KUe,j8]=Pt(!1),[JUe,H8]=Pt(10);yn(()=>{if(!j8())return;const n=H8(),e=new zFe(n,n);return Sn.add(e),()=>{Sn.remove(e)}},[j8,H8]);const[b$e,IO]=Pt(void 0),[w$e,jJ]=Pt(!1),Dg=new ul(new sE(Ec,Ec,4,4),Nle);yn(()=>{var r;if(!jJ()||mn()!==uo)return;Sn.add(Dg);const[n,e]=(r=IO())!=null?r:kl();Dg.scale.x=n*Qr,Dg.scale.y=e*Qr;const t=ha(()=>{Dg.quaternion.copy(uo.quaternion),Dg.position.copy(uo.position),Dg.translateZ(-4.9)});return()=>{t.cancel(),Sn.remove(Dg)}},[jJ,IO,kl,mn]);const[S$e,QUe]=Pt({turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.5,inclination:.49,azimuth:.25});class o4 extends ul{constructor(){const e=o4.SkyShader,t=new kr({name:"SkyShader",fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:Ra.clone(e.uniforms),side:Sc,depthWrite:!1});super(new F0(1,1,1),t),this.isSky=!0}}o4.SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Te},up:{value:new Te(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPos );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <encodings_fragment>

		}`};const[M$e,$Ue]=Pt(!1),HJ=VD(()=>{const n=new o4;return n.scale.setScalar(45e4),QUe(e=>{const{uniforms:t}=n.material;t.turbidity.value=e.turbidity,t.rayleigh.value=e.rayleigh,t.mieCoefficient.value=e.mieCoefficient,t.mieDirectionalG.value=e.mieDirectionalG;const r=Math.PI*(e.inclination-.5),i=2*Math.PI*(e.azimuth-.5);oa.x=Math.cos(i),oa.y=Math.sin(i)*Math.sin(r),oa.z=Math.sin(i)*Math.cos(r),t.sunPosition.value.copy(oa)}),n});let WJ=!1;$Ue(n=>{WJ!==n&&(WJ=n,n?Sn.add(HJ()):Sn.remove(HJ()))});const[e8e,GJ]=Pt(!1),[t8e,XJ]=Pt(!1),qJ=(n,e)=>Math.abs(n*.5/Math.cos(e.fov*.6*Co));yn(()=>{var u;const[n,e]=(u=IO())!=null?u:kl(),[t,r,i]=P8(mn()),s={width:t,height:e-(n-t)*e/n},o={width:n-(e-r)*n/e,height:r},a=Math.min(t-s.width,r-s.height),c=Math.min(t-o.width,r-o.height);a>c?kJ(qJ(n/i,uo)):kJ(qJ(e,uo))},[kl,IO,mn,Ix]);const[n8e,W8]=Pt(!1),YJ={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new en(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Nx extends pd{constructor(e,t,r,i){super(),this.strength=t!==void 0?t:1,this.radius=r,this.threshold=i,this.resolution=e!==void 0?new ut(e.x,e.y):new ut(256,256),this.clearColor=new en(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Ai(s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let p=0;p<this.nMips;p++){const f=new Ai(s,o);f.texture.name="UnrealBloomPass.h"+p,f.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(f);const v=new Ai(s,o);v.texture.name="UnrealBloomPass.v"+p,v.texture.generateMipmaps=!1,this.renderTargetsVertical.push(v),s=Math.round(s/2),o=Math.round(o/2)}YJ===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const a=YJ;this.highPassUniforms=Ra.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new kr({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let p=0;p<this.nMips;p++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[p])),this.separableBlurMaterials[p].uniforms.texSize.value=new ut(s,o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const u=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=u,this.bloomTintColors=[new Te(1,1,1),new Te(1,1,1),new Te(1,1,1),new Te(1,1,1),new Te(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,_c===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const d=_c;this.copyUniforms=Ra.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new kr({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:gO,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new en,this.oldClearAlpha=1,this.basic=new iE,this.fsQuad=new U0(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(r,i);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(r,i),this.renderTargetsVertical[s].setSize(r,i),this.separableBlurMaterials[s].uniforms.texSize.value=new ut(r,i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=Nx.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[c]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=Nx.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[c]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new kr({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new ut(.5,.5)},direction:{value:new ut(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new kr({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Nx.BlurDirectionX=new ut(1,0);Nx.BlurDirectionY=new ut(0,1);const[r8e,E7]=Pt(0),[i8e,A7]=Pt(.5),[s8e,P7]=Pt(0),kx=new Nx(new ut,A7(),E7(),P7());E7(n=>kx.radius=n);A7(n=>kx.strength=n);P7(n=>kx.threshold=n);class o8e extends pd{constructor(e,t,r,i,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s!==void 0?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new en}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=i}}const NO=new o8e(Sn,mn());mn(n=>NO.camera=n);yn(()=>{const n=Dx();if(!!n)return n.addPass(NO),n.addPass(kx),()=>{n.removePass(NO),n.removePass(kx)}},[Dx]);const Ace=new Lx(new kr({uniforms:{baseTexture:{value:null},bloomTexture:{value:null}},vertexShader:`
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,fragmentShader:`
            uniform sampler2D baseTexture;
            uniform sampler2D bloomTexture;
            varying vec2 vUv;
            void main() {
                gl_FragColor = texture2D(baseTexture, vUv) + texture2D(bloomTexture, vUv);
            }
        `,defines:{}}),"baseTexture"),{uniforms:a8e}=Ace;Dx(n=>n&&(a8e.bloomTexture.value=n.renderTarget2.texture));const[l8e,Pce]=Pt(.8),[c8e,Tce]=Pt(.01),Rce=new Lx(new kr({defines:{BAND_MODE:2,CHROMA_SAMPLES:1},uniforms:{tDiffuse:{value:null},baseIor:{value:.8},bandOffset:{value:.01},jitterIntensity:{value:1},jitterOffset:{value:0}},vertexShader:`

		varying vec2 vUv;
		varying vec3 viewDir;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			viewDir = normalize( ( modelViewMatrix * vec4( position, 1.0 ) ).xyz );

		}

	`,fragmentShader:`

		varying vec2 vUv;
		varying vec3 viewDir;
		uniform float baseIor;
		uniform float bandOffset;
		uniform float jitterIntensity;
		uniform float jitterOffset;
		uniform sampler2D tDiffuse;

		#include <common>
		void main() {

			vec3 normal = vec3( ( 2.0 * vUv - vec2( 1.0 ) ), 1.0 );
			normal.z = 1.0;
			normal = normalize( normal );

			vec3 color;

			// if NO BANDS
			#if BAND_MODE == 0

			vec3 refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor );
			color = texture2D( tDiffuse, vUv + refracted.xy ).rgb;

			// if RGB or RYGCBV BANDS
			#else

			float index, randValue, offsetValue;
			float r, g, b, r_ior, g_ior, b_ior;
			vec3 r_refracted, g_refracted, b_refracted;
			vec4 r_sample, g_sample, b_sample;

			#if BAND_MODE == 2
			float y, c, v, y_ior, c_ior, v_ior;
			vec3 y_refracted, c_refracted, v_refracted;
			vec4 y_sample, c_sample, v_sample;
			#endif

			for ( int i = 0; i < CHROMA_SAMPLES; i ++ ) {

				index = float( i );
				randValue = rand( sin( index + 1. ) * gl_FragCoord.xy + vec2( jitterOffset, - jitterOffset ) ) - 0.5;
				offsetValue = index / float( CHROMA_SAMPLES ) + randValue * jitterIntensity;
				#if BAND_MODE == 1
				randValue *= 2.0;
				#endif

				// Paper describing functions for creating yellow, cyan, and violet bands and reforming
				// them into RGB:
				// https://web.archive.org/web/20061108181225/http://home.iitk.ac.in/~shankars/reports/dispersionraytrace.pdf
				r_ior = 1.0 + bandOffset * ( 0.0 + offsetValue );
				g_ior = 1.0 + bandOffset * ( 2.0 + offsetValue );
				b_ior = 1.0 + bandOffset * ( 4.0 + offsetValue );

				r_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / r_ior );
				g_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / g_ior );
				b_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / b_ior );

				r_sample = texture2D( tDiffuse, vUv + r_refracted.xy );
				g_sample = texture2D( tDiffuse, vUv + g_refracted.xy );
				b_sample = texture2D( tDiffuse, vUv + b_refracted.xy );

				#if BAND_MODE == 2
				y_ior = 1.0 + bandOffset * ( 1.0 + offsetValue );
				c_ior = 1.0 + bandOffset * ( 3.0 + offsetValue );
				v_ior = 1.0 + bandOffset * ( 5.0 + offsetValue );

				y_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / y_ior );
				c_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / c_ior );
				v_refracted = refract( vec3( 0.0, 0.0, - 1.0 ), normal, baseIor / v_ior );

				y_sample = texture2D( tDiffuse, vUv + y_refracted.xy );
				c_sample = texture2D( tDiffuse, vUv + c_refracted.xy );
				v_sample = texture2D( tDiffuse, vUv + v_refracted.xy );

				r = r_sample.r / 2.0;
				y = ( 2.0 * y_sample.r + 2.0 * y_sample.g - y_sample.b ) / 6.0;
				g = g_sample.g / 2.0;
				c = ( 2.0 * c_sample.g + 2.0 * c_sample.b - c_sample.r ) / 6.0;
				b = b_sample.b / 2.0;
				v = ( 2.0 * v_sample.b + 2.0 * v_sample.r - v_sample.g ) / 6.0;

				color.r += r + ( 2.0 * v + 2.0 * y - c ) / 3.0;
				color.g += g + ( 2.0 * y + 2.0 * c - v ) / 3.0;
				color.b += b + ( 2.0 * c + 2.0 * v - y ) / 3.0;
				#else
				color.r += r_sample.r;
				color.g += g_sample.g;
				color.b += b_sample.b;
				#endif

			}

			color /= float( CHROMA_SAMPLES );

			#endif

			gl_FragColor = vec4( color, 1.0 );

		}

	`})),{uniforms:Oce}=Rce;Pce(n=>Oce.baseIor.value=n);Tce(n=>Oce.bandOffset.value=n);const[u8e,G8]=Pt(!1),[h8e,SC]=Pt("MSAA"),[ZJ,zx]=Pt(void 0);yn(()=>{const n=zi();if(!n)return;if(SC()!=="MSAA"||!n.capabilities.isWebGL2){ZJ(new b8(n));return}const e=new Ai(f7,m7,{samples:4}),t=kl(([r,i])=>e.setSize(r,i));return ZJ(new b8(n,e)),()=>{e.dispose(),t.cancel()}},[zi,SC]);yn(()=>{const n=zx();if(!n)return;const[e,t]=kl();n.setSize(e,t),n.setPixelRatio(Math.min(S0(),devicePixelRatio))},[zx,kl,S0]);class d8e extends pd{constructor(e){super(),_c===void 0&&console.error("THREE.SavePass relies on CopyShader");const t=_c;this.textureID="tDiffuse",this.uniforms=Ra.clone(t.uniforms),this.material=new kr({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new Ai(window.innerWidth,window.innerHeight),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new U0(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}}const p8e={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;
		uniform float mixRatio;

		uniform sampler2D tDiffuse1;
		uniform sampler2D tDiffuse2;

		varying vec2 vUv;

		void main() {

			vec4 texel1 = texture2D( tDiffuse1, vUv );
			vec4 texel2 = texture2D( tDiffuse2, vUv );
			gl_FragColor = mix( texel1, texel2, mixRatio );
			gl_FragColor.a *= opacity;

		}`},[f8e,Lce]=Pt(.5),Dce=new d8e,T7=new Lx(p8e,"tDiffuse1");T7.uniforms.tDiffuse2.value=Dce.renderTarget.texture;Lce(n=>T7.uniforms.mixRatio.value=n);const Ice=new Lx(_c);Ice.renderToScreen=!0;const m8e=[T7,Dce,Ice],[v8e,X8]=Pt(!1),[g8e,kO]=Pt(!1),zS={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new ut(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Vr},cameraInverseProjectionMatrix:{value:new Vr},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		#if DIFFUSE_TEXTURE == 1
		uniform sampler2D tDiffuse;
		#endif

		uniform sampler2D tDepth;

		#if NORMAL_TEXTURE == 1
		uniform sampler2D tNormal;
		#endif

		uniform float cameraNear;
		uniform float cameraFar;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;

		uniform float scale;
		uniform float intensity;
		uniform float bias;
		uniform float kernelRadius;
		uniform float minResolution;
		uniform vec2 size;
		uniform float randomSeed;

		// RGBA depth

		#include <packing>

		vec4 getDefaultColor( const in vec2 screenPosition ) {
			#if DIFFUSE_TEXTURE == 1
			return texture2D( tDiffuse, vUv );
			#else
			return vec4( 1.0 );
			#endif
		}

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {
			float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];
			vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );
			clipPosition *= clipW; // unprojection.

			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;
		}

		vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {
			#if NORMAL_TEXTURE == 1
			return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );
			#else
			return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );
			#endif
		}

		float scaleDividedByCameraFar;
		float minResolutionMultipliedByCameraFar;

		float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {
			vec3 viewDelta = sampleViewPosition - centerViewPosition;
			float viewDistance = length( viewDelta );
			float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;

			return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );
		}

		// moving costly divides into consts
		const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
		const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

		float getAmbientOcclusion( const in vec3 centerViewPosition ) {
			// precompute some variables require in getOcclusion.
			scaleDividedByCameraFar = scale / cameraFar;
			minResolutionMultipliedByCameraFar = minResolution * cameraFar;
			vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );

			// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
			float angle = rand( vUv + randomSeed ) * PI2;
			vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;
			vec2 radiusStep = radius;

			float occlusionSum = 0.0;
			float weightSum = 0.0;

			for( int i = 0; i < NUM_SAMPLES; i ++ ) {
				vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;
				radius += radiusStep;
				angle += ANGLE_STEP;

				float sampleDepth = getDepth( sampleUv );
				if( sampleDepth >= ( 1.0 - EPSILON ) ) {
					continue;
				}

				float sampleViewZ = getViewZ( sampleDepth );
				vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );
				occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );
				weightSum += 1.0;
			}

			if( weightSum == 0.0 ) discard;

			return occlusionSum * ( intensity / weightSum );
		}

		void main() {
			float centerDepth = getDepth( vUv );
			if( centerDepth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = getViewZ( centerDepth );
			vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );

			float ambientOcclusion = getAmbientOcclusion( viewPosition );

			gl_FragColor = getDefaultColor( vUv );
			gl_FragColor.xyz *=  1.0 - ambientOcclusion;
		}`},xp={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new ut(512,512)},sampleUvOffsets:{value:[new ut(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:`

		#include <common>

		uniform vec2 size;

		varying vec2 vUv;
		varying vec2 vInvSize;

		void main() {
			vUv = uv;
			vInvSize = 1.0 / size;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>
		#include <packing>

		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform float depthCutoff;

		uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];
		uniform float sampleWeights[ KERNEL_RADIUS + 1 ];

		varying vec2 vUv;
		varying vec2 vInvSize;

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		void main() {
			float depth = getDepth( vUv );
			if( depth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = -getViewZ( depth );
			bool rBreak = false, lBreak = false;

			float weightSum = sampleWeights[0];
			vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;

			for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {

				float sampleWeight = sampleWeights[i];
				vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;

				vec2 sampleUv = vUv + sampleUvOffset;
				float viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;

				if( ! rBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

				sampleUv = vUv - sampleUvOffset;
				viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;

				if( ! lBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

			}

			gl_FragColor = diffuseSum / weightSum;
		}`},zO={createSampleWeights:function(n,e){const t=[];for(let r=0;r<=n;r++)t.push(_8e(r,e));return t},createSampleOffsets:function(n,e){const t=[];for(let r=0;r<=n;r++)t.push(e.clone().multiplyScalar(r));return t},configure:function(n,e,t,r){n.defines.KERNEL_RADIUS=e,n.uniforms.sampleUvOffsets.value=zO.createSampleOffsets(e,r),n.uniforms.sampleWeights.value=zO.createSampleWeights(e,t),n.needsUpdate=!0}};function _8e(n,e){return Math.exp(-(n*n)/(2*(e*e)))/(Math.sqrt(2*Math.PI)*e)}const VT={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		#include <packing>

		void main() {

			float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );
			gl_FragColor = vec4( vec3( depth ), opacity );

		}`};class Nce extends pd{constructor(e,t,r=!1,i=!1,s=new ut(256,256)){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=r,this.supportsNormalTexture=i,this.originalClearColor=new en,this._oldClearColor=new en,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new ut(s.x,s.y),this.saoRenderTarget=new Ai(this.resolution.x,this.resolution.y),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new Ai(this.resolution.x,this.resolution.y,{minFilter:ds,magFilter:ds}),this.depthRenderTarget=this.normalRenderTarget.clone();let o;this.supportsDepthTextureExtension&&(o=new tle,o.type=VH,this.beautyRenderTarget.depthTexture=o,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new GD,this.depthMaterial.depthPacking=UD,this.depthMaterial.blending=zs,this.normalMaterial=new sFe,this.normalMaterial.blending=zs,zS===void 0&&console.error("THREE.SAOPass relies on SAOShader"),this.saoMaterial=new kr({defines:Object.assign({},zS.defines),fragmentShader:zS.fragmentShader,vertexShader:zS.vertexShader,uniforms:Ra.clone(zS.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=zs,xp===void 0&&console.error("THREE.SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new kr({uniforms:Ra.clone(xp.uniforms),defines:Object.assign({},xp.defines),vertexShader:xp.vertexShader,fragmentShader:xp.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=zs,this.hBlurMaterial=new kr({uniforms:Ra.clone(xp.uniforms),defines:Object.assign({},xp.defines),vertexShader:xp.vertexShader,fragmentShader:xp.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?o:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=zs,_c===void 0&&console.error("THREE.SAOPass relies on CopyShader"),this.materialCopy=new kr({uniforms:Ra.clone(_c.uniforms),vertexShader:_c.vertexShader,fragmentShader:_c.fragmentShader,blending:zs}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=e8,this.materialCopy.blendSrc=Bae,this.materialCopy.blendDst=t8,this.materialCopy.blendEquation=dm,this.materialCopy.blendSrcAlpha=zae,this.materialCopy.blendDstAlpha=t8,this.materialCopy.blendEquationAlpha=dm,VT===void 0&&console.error("THREE.SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new kr({uniforms:Ra.clone(VT.uniforms),vertexShader:VT.vertexShader,fragmentShader:VT.fragmentShader,blending:zs}),this.fsQuad=new U0(null)}render(e,t,r){if(this.renderToScreen&&(this.materialCopy.blending=zs,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),this.params.output===1)return;e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const i=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const s=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=s,this.hBlurMaterial.uniforms.depthCutoff.value=s,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(zO.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ut(0,1)),zO.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new ut(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let o=this.materialCopy;this.params.output===3?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,o=this.depthCopy):this.params.output===4?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===0?o.blending=e8:o.blending=zs,this.renderPass(e,o,this.renderToScreen?null:r),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=i}renderPass(e,t,r,i,s){e.getClearColor(this.originalClearColor);const o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,i!=null&&(e.setClearColor(i),e.setClearAlpha(s||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)}renderOverride(e,t,r,i,s){e.getClearColor(this.originalClearColor);const o=e.getClearAlpha(),a=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,i=t.clearColor||i,s=t.clearAlpha||s,i!=null&&(e.setClearColor(i),e.setClearAlpha(s||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=a,e.setClearColor(this.originalClearColor),e.setClearAlpha(o)}setSize(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}Nce.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4};const Dh=new Nce(Sn,mn(),!1,!0);Dh.params.saoKernelRadius=80;Dh.params.saoBlurStdDev=5;kO(n=>Dh.params.saoScale=n==="light"?3e3:2e3);mn(n=>{Dh.camera=n,Dh.saoMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,Dh.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(n.projectionMatrixInverse),Dh.saoMaterial.uniforms.cameraProjectionMatrix.value=n.projectionMatrix,Dh.vBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0,Dh.hBlurMaterial.defines.PERSPECTIVE_CAMERA=n.isPerspectiveCamera?1:0});const KJ={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		varying vec2 vUv;

		uniform sampler2D tColor;
		uniform sampler2D tDepth;

		uniform float maxblur; // max blur amount
		uniform float aperture; // aperture - bigger values for shallower depth of field

		uniform float nearClip;
		uniform float farClip;

		uniform float focus;
		uniform float aspect;

		#include <packing>

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, nearClip, farClip );
			#else
			return orthographicDepthToViewZ( depth, nearClip, farClip );
			#endif
		}


		void main() {

			vec2 aspectcorrect = vec2( 1.0, aspect );

			float viewZ = getViewZ( getDepth( vUv ) );

			float factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation

			vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );

			vec2 dofblur9 = dofblur * 0.9;
			vec2 dofblur7 = dofblur * 0.7;
			vec2 dofblur4 = dofblur * 0.4;

			vec4 col = vec4( 0.0 );

			col += texture2D( tColor, vUv.xy );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );

			col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );
			col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );

			gl_FragColor = col / 41.0;
			gl_FragColor.a = 1.0;

		}`};class y8e extends pd{constructor(e,t,r){super(),this.scene=e,this.camera=t;const i=r.focus!==void 0?r.focus:1,s=r.aspect!==void 0?r.aspect:t.aspect,o=r.aperture!==void 0?r.aperture:.025,a=r.maxblur!==void 0?r.maxblur:1,c=r.width||window.innerWidth||1,u=r.height||window.innerHeight||1;this.renderTargetDepth=new Ai(c,u,{minFilter:ds,magFilter:ds}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new GD,this.materialDepth.depthPacking=UD,this.materialDepth.blending=zs,KJ===void 0&&console.error("THREE.BokehPass relies on BokehShader");const d=KJ,p=Ra.clone(d.uniforms);p.tDepth.value=this.renderTargetDepth.texture,p.focus.value=i,p.aspect.value=s,p.aperture.value=o,p.maxblur.value=a,p.nearClip.value=t.near,p.farClip.value=t.far,this.materialBokeh=new kr({defines:Object.assign({},d.defines),uniforms:p,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}),this.uniforms=p,this.needsSwap=!1,this.fsQuad=new U0(this.materialBokeh),this._oldClearColor=new en}render(e,t,r){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const i=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(i),e.autoClear=s}}const R7=new y8e(Sn,mn(),{}),Yy=R7.uniforms;mn(n=>{R7.camera=n,Yy.aspect.value=n.aspect,Yy.nearClip.value=n.near,Yy.farClip.value=n.far});bce(n=>Yy.focus.value=n);yce(n=>Yy.aperture.value=n);Sce(n=>Yy.maxblur.value=n);const BS={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new ut(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		void SMAAEdgeDetectionVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAAEdgeDetectionVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
			vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );

			// Calculate color deltas:
			vec4 delta;
			vec3 C = texture2D( colorTex, texcoord ).rgb;

			vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
			vec3 t = abs( C - Cleft );
			delta.x = max( max( t.r, t.g ), t.b );

			vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
			t = abs( C - Ctop );
			delta.y = max( max( t.r, t.g ), t.b );

			// We do the usual threshold:
			vec2 edges = step( threshold, delta.xy );

			// Then discard if there is no edge:
			if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
				discard;

			// Calculate right and bottom deltas:
			vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
			t = abs( C - Cright );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
			t = abs( C - Cbottom );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the maximum delta in the direct neighborhood:
			float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

			// Calculate left-left and top-top deltas:
			vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
			t = abs( C - Cleftleft );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
			t = abs( C - Ctoptop );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the final maximum delta:
			maxDelta = max( max( maxDelta, delta.z ), delta.w );

			// Local contrast adaptation in action:
			edges.xy *= step( 0.5 * maxDelta, delta.xy );

			return vec4( edges, 0.0, 0.0 );
		}

		void main() {

			gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );

		}`},FT={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new ut(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];
		varying vec2 vPixcoord;

		void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
			vPixcoord = texcoord / resolution;

			// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components

			// And these for the searches, they indicate the ends of the loops:
			vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );

		}

		void main() {

			vUv = uv;

			SMAABlendingWeightCalculationVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )

		uniform sampler2D tDiffuse;
		uniform sampler2D tArea;
		uniform sampler2D tSearch;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[3];
		varying vec2 vPixcoord;

		#if __VERSION__ == 100
		vec2 round( vec2 x ) {
			return sign( x ) * floor( abs( x ) + 0.5 );
		}
		#endif

		float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
			// Not required if searchTex accesses are set to point:
			// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);
			// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +
			//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;
			e.r = bias + e.r * scale;
			return 255.0 * texture2D( searchTex, e, 0.0 ).r;
		}

		float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			/**
				* @PSEUDO_GATHER4
				* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to
				* sample between edge, thus fetching four edges in a row.
				* Sampling with different offsets in each direction allows to disambiguate
				* which edges are active from the four fetched ones.
				*/
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			// We correct the previous (-0.25, -0.125) offset we applied:
			texcoord.x += 0.25 * resolution.x;

			// The searches are bias by 1, so adjust the coords accordingly:
			texcoord.x += resolution.x;

			// Disambiguate the length added by the last step:
			texcoord.x += 2.0 * resolution.x; // Undo last step
			texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);

			return texcoord.x;
		}

		float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			texcoord.x -= 0.25 * resolution.x;
			texcoord.x -= resolution.x;
			texcoord.x -= 2.0 * resolution.x;
			texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );

			return texcoord.x;
		}

		float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y; // WebGL port note: Changed sign
			texcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y; // WebGL port note: Changed sign
			texcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
			// Rounding prevents precision errors of bilinear filtering:
			vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;

			// We do a scale and bias for mapping to texel space:
			texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );

			// Move to proper place, according to the subpixel offset:
			texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;

			return texture2D( areaTex, texcoord, 0.0 ).rg;
		}

		vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
			vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );

			vec2 e = texture2D( edgesTex, texcoord ).rg;

			if ( e.g > 0.0 ) { // Edge at north
				vec2 d;

				// Find the distance to the left:
				vec2 coords;
				coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
				coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)
				d.x = coords.x;

				// Now fetch the left crossing edges, two at a time using bilinear
				// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to
				// discern what value each edge has:
				float e1 = texture2D( edgesTex, coords, 0.0 ).r;

				// Find the distance to the right:
				coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
				d.y = coords.x;

				// We want the distances to be in pixel units (doing this here allow to
				// better interleave arithmetic and memory accesses):
				d = d / resolution.x - pixcoord.x;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the right crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;

				// Ok, we know how this pattern looks like, now it is time for getting
				// the actual area:
				weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
			}

			if ( e.r > 0.0 ) { // Edge at west
				vec2 d;

				// Find the distance to the top:
				vec2 coords;

				coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
				coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;
				d.x = coords.y;

				// Fetch the top crossing edges:
				float e1 = texture2D( edgesTex, coords, 0.0 ).g;

				// Find the distance to the bottom:
				coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
				d.y = coords.y;

				// We want the distances to be in pixel units:
				d = d / resolution.y - pixcoord.y;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the bottom crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;

				// Get the area for this direction:
				weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
			}

			return weights;
		}

		void main() {

			gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );

		}`},SF={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new ut(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAANeighborhoodBlendingVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform sampler2D tColor;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
			// Fetch the blending weights for current pixel:
			vec4 a;
			a.xz = texture2D( blendTex, texcoord ).xz;
			a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
			a.w = texture2D( blendTex, offset[ 1 ].xy ).a;

			// Is there any blending weight with a value greater than 0.0?
			if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
				return texture2D( colorTex, texcoord, 0.0 );
			} else {
				// Up to 4 lines can be crossing a pixel (one through each edge). We
				// favor blending by choosing the line with the maximum weight for each
				// direction:
				vec2 offset;
				offset.x = a.a > a.b ? a.a : -a.b; // left vs. right
				offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs

				// Then we go in the direction that has the maximum weight:
				if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical
					offset.y = 0.0;
				} else {
					offset.x = 0.0;
				}

				// Fetch the opposite color and lerp by hand:
				vec4 C = texture2D( colorTex, texcoord, 0.0 );
				texcoord += sign( offset ) * resolution;
				vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
				float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );

				// WebGL port note: Added gamma correction
				C.xyz = pow(C.xyz, vec3(2.2));
				Cop.xyz = pow(Cop.xyz, vec3(2.2));
				vec4 mixed = mix(C, Cop, s);
				mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));

				return mixed;
			}
		}

		void main() {

			gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );

		}`};class x8e extends pd{constructor(e,t){super(),this.edgesRT=new Ai(e,t,{depthBuffer:!1}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Ai(e,t,{depthBuffer:!1}),this.weightsRT.texture.name="SMAAPass.weights";const r=this,i=new Image;i.src=this.getAreaTexture(),i.onload=function(){r.areaTexture.needsUpdate=!0},this.areaTexture=new ka,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=i,this.areaTexture.minFilter=Us,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){r.searchTexture.needsUpdate=!0},this.searchTexture=new ka,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=ds,this.searchTexture.minFilter=ds,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,BS===void 0&&console.error("THREE.SMAAPass relies on SMAAShader"),this.uniformsEdges=Ra.clone(BS.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new kr({defines:Object.assign({},BS.defines),uniforms:this.uniformsEdges,vertexShader:BS.vertexShader,fragmentShader:BS.fragmentShader}),this.uniformsWeights=Ra.clone(FT.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new kr({defines:Object.assign({},FT.defines),uniforms:this.uniformsWeights,vertexShader:FT.vertexShader,fragmentShader:FT.fragmentShader}),this.uniformsBlend=Ra.clone(SF.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new kr({uniforms:this.uniformsBlend,vertexShader:SF.vertexShader,fragmentShader:SF.fragmentShader}),this.needsSwap=!1,this.fsQuad=new U0(null)}render(e,t,r){this.uniformsEdges.tDiffuse.value=r.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=r.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}}const b8e=new x8e(f7,m7);yn(()=>{var r;const n=zx();if(!n)return;const e=[NO];if(kO()&&e.push(Dh),W8()&&e.push(kx),XJ()&&e.push(Ace),V8()&&e.push(R7),GJ()&&e.push(Qh),G8()&&e.push(Rce),X8())for(const i of m8e)e.push(i);const t=SC();(t==="SMAA"||t==="MSAA"&&!((r=zi())!=null&&r.capabilities.isWebGL2))&&e.push(b8e);for(const i of e)n.addPass(i);return()=>{for(const i of e)n.removePass(i)}},[zx,kO,W8,XJ,V8,GJ,G8,X8,SC,zi]);const[MF,C$e]=fa();yn(()=>{const n=zi();if(!n)return;const e=mn(),t=E8();if(t){const[a,c]=kl(),u=a*1,d=c*.5;t.aspect=e.aspect=u/d,e.updateProjectionMatrix(),t.updateProjectionMatrix();const p=rR(()=>{pF(),MF(),n.setViewport(0,0,u,d),n.setScissor(0,0,u,d),n.setScissorTest(!0),n.render(Sn,t),n.setViewport(0,d,u,d),n.setScissor(0,d,u,d),n.render(Sn,e),gF()});return()=>{p.cancel(),n.setViewport(0,0,a,c),n.setScissor(0,0,a,c),n.setScissorTest(!1),e.aspect=a/c,e.updateProjectionMatrix()}}if(Ix()){const a=rR(()=>{pF(),MF(),n.render(Sn,e),gF()});return()=>{a.cancel()}}const r=zx();if(!r)return;let i=!1,s=!1;const o=rR(()=>{pF(),MF(),Wle[0]&&(i||(t8e(!0),i=!0),U6e()),$le[0]&&!s&&(e8e(!0),s=!0),r.render(),gF()});return()=>{o.cancel()}},[Ix,mn,E8,kl,zi,zx]);const w8e=new Map,S8e=new fFe,M8e=n=>ev(w8e,n.join(","),()=>S8e.load(n,void 0,Rle(n.join(",")))),[C8e,q8]=Pt(void 0),[O7,MC]=Pt([]),E8e=Mb(O7,MC),A8e=Cb(O7,MC);yn(()=>{var r;const n=q8(),e=yC(),t=(r=$2(MC()))==null?void 0:r.texture;if(t)if(Array.isArray(t))Sn.background=M8e(t);else{let i=!0;const s=ol(t,()=>i&&(Sn.background=s));return s.mapping=dC,()=>{i=!1}}else n?Sn.background=ol(n):e?e==="transparent"?Sn.background=null:Sn.background=new en(e):Sn.background=new en("black")},[yC,q8,MC]);const[L7,CC]=Pt([]),P8e=Mb(L7,CC),T8e=Cb(L7,CC),R8e=Rae(L7,CC),O8e={...Ele,texture:String,helper:Boolean},L8e={...Ale,texture:"studio",helper:!0},D8e=()=>{const n=new qy;return n.texture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABjVJREFUaEPtWmvLVUUYXWu2VlaGUGGgZUWl3cvILhqlplYWkWVlfsofkHQhyEjRSCK64Q+wT2kkWpGWl7QIpRvZzUKxgi6SRUEX0yz3XvFsZl7G43vOmTnnmEEdEF/Onj3zrFnPZc0zh+jhRxJzpiOpnPGtxmYt3GoiSQXJMsewTt5pNn9PgBgTYXclDQBQAWg2t7HgSO4zo+J3czahcWzXQCSZUZWkWZLuB2CstJvXwBiDj5FcHOY4ZEDCbkoaImkHgCMzjdlNchjJn7tlpt3OtbQrYmOEpM88kGRGABiQs0h+1S0rvQIyXNI2D8Tcpt28YYwBGUny238LkBM9kEEWvxlA9ngg3/wPxDt/OxdoFyN12pVkjGzt0LXOJPn1oWakLoIeyBcABma61l6Sp5D87pAB8XLEakhZluUCkg/5GlIkpmDLbrYRD5B81Kq8FdJOZUtHrhXn/AhEov19w/qSgqQFRVHM66bSdwqkruZlWT5J8u5IkuTOZ2BqySLpqaIo7unUxXIXNm00wHSSpHslPQ7gLwCmr7Ln8twYENNdA0neR/KJsEYOxVmLB7UqabSk9yNDsubpx8A+NyN5EcnNuco4y4AQG1VVbQQw1u+ksdGLj7Fic21yzo3L1V7JQCI2Jklam5mhUoGGTDaZ5LocVrKBlGW5lOTtPWYjAK1ZkfRcURQzeg4kkuuDJW0HMDSx8KUyEcaFWPme5Okkf0t1sSRGIrl+vqQPc63rZDzJC0h+lJqOU4EEKXKNpFcPUnwEvCFOriW5OtW9UoGE2nGHpGf/ISAzSS5JrSn/OSDBtSZIWu8lievE9xPesQ6MSaCJJDf02rVCp2SYPwkedZCz1u/+5Lijp8Eeq9Kqqt4FcPFBipM60AG855wbk5p6zb6kGPFAQsDPlTTfi0U7SPXyYwLUxOM8kgtSAz0XSHCvk/yxNrXRkAo0FENrSIzKPf4mMxKzUpblIyTn9JiVmg1JC4uieDCHjSxG4jiRdJikjwGM7BGYGgSAbSTPI/lnTnx0AsRSrnWsrXNyoSQLfJPewZBUN4rHhXf3kRxD8gPfD7AOjaXipE+ya0V6y2LjWN8dHCtpHQD7Lvek2HcyBGBxMYnkJknDAfxEck9q6k1mJJ6wqqqVAM4hOYHkl5JGSVpm3/mtMyluGxT+xTsazuj2fziQbSE5neRWSadK2gBgi3Pueu/OdZJpR0tbRhpArABwk1/gmaIoZvm/LffPkXQXgOPaLeqf/0hyEYCF4YKoLMvFJO/0z19wzk1LBdMSSDMQANaTnEpyryTL++ZW1pg4BsB0SVMBnAvgBABHeMP+ALATwCckVwFYRvJX/149h6TDJdmziblgmgJpAeIN71YW8EGDjQAwjqQp4/pjAC2WABztv9rlfb8G7cfMBLDRXyuEuSyTmHtdlQOmXyBx6quqajmAmmIA+4GwOLDWUFmW80nOBbCZpJ0jfmjlXpKGSnoFgHVj6uacv7KzjGgt2EYwK5xzN3vwfdd88RoHAGkA8TKAOugaQQS/9jXlUwCn2e46566ImLrUzt/2sp3zSb4dnlVVtQnA5QA+J3m21Q5vaDNmVjrnbmgGpiUjkoKu2uCcq/02MjJoL4uJ572xt5Bcbr7u4+dqn54NiKXX16Jnt0UgbyW5LGr+9d0QV1VlxwbLkEF/pTHSiFiS+fEqf8/Xt0CIoaqq1gCYDGA7SUvLVpUDyPHe3w2IGfN69GyQv647GcBa59yUOC6jDRsCwBJLHX/NKn5y1mpYJAhIa0Zs9gehuSQfbvD1/oBYqg6xFTSbdeFHNzYb+luzWeyl1JED2v1hV8uyfJrkbAC7vJ/XFzbeUAvaZkAsqO1K+wyv2SztLiqKYnajWIyvL1olkLZAGl+OpIqdFrcAsKvpJUVRzIzcIQRsv0B8ZqrHVFX1IoAbAfziNyP5VNgya7VC3RDsl0l6CcDxJK8k+WYnQCRd54vgTpLTSL6Vo7GCvdmMxAEnaTCA8QBWh/TZALa/rLXfb1Yk2Y8MpgBYQ3J3rnzvCkir7NEA5BJJS31qnkHynVZdkU5B1PO3c6U2Fdrer+8R+xsXAtU/a3o/2O39YddAutmEXr/bFSMpxoQfo3V6W5uyho35G4LD428xBkRwAAAAAElFTkSuQmCC",dl.delete(n),n.scale=.5,n};class uR extends Vle{constructor(){super();We(this,"_texture","studio");We(this,"helperState",new tu(!0));Sn.add(this.outerObject3d),P8e(this),this.createEffect(()=>{if(mn()!==uo||!this.helperState.get())return;const t=D8e(),r=$D(({target:i})=>{i===t&&yc(this)});return this.outerObject3d.add(t.outerObject3d),()=>{r.cancel(),t.dispose()}},[mn,this.helperState.get])}dispose(){return this.done?this:(super.dispose(),T8e(this),this)}get texture(){return this._texture}set texture(t){this._texture=t,R8e()}get helper(){return this.helperState.get()}set helper(t){this.helperState.set(t)}}We(uR,"componentName","environment"),We(uR,"defaults",L8e),We(uR,"schema",O8e);const[I8e,Y8]=Pt("default"),Zy=new uR;Zy.texture=void 0;dl.delete(Zy);Zy.helper=!1;const kce=new XH(256),CF=new WH(Db,Wh,kce);yn(()=>{const n=$2(CC()),e=zi();if(!(n!=null&&n.texture)||!e)return;if(n.texture==="dynamic"){const i=Ble(()=>{CF.position.copy(n.outerObject3d.position),CF.matrixWorld.copy(n.outerObject3d.matrixWorld),CF.update(e,Sn)});return Sn.environment=kce.texture,()=>{i.cancel(),Sn.environment=null}}let t=!0;const r=ol(n.texture==="studio"?D6e+"studio.jpg":n.texture,()=>t&&(Sn.environment=r));return r.mapping=dC,()=>{t=!1,Sn.environment=null}},[CC,zi]);yn(()=>{const n=Y8();if(!n)return;if(typeof n=="string"&&n!=="default")return n==="dynamic"?Zy.texture="dynamic":Zy.texture=n,()=>{Zy.texture=void 0};const e=new di;return rr(()=>import("./SkyLight.8fddaffa.js"),["assets/SkyLight.8fddaffa.js","assets/LightBase.dae87e70.js"]).then(t=>{const r=t.default,i=new r;dl.delete(i),i.helper=!1,i.groundColor="#666666",e.then(()=>i.dispose())}),rr(()=>import("./DirectionalLight.8c202928.js"),["assets/DirectionalLight.8c202928.js","assets/LightBase.dae87e70.js"]).then(t=>{const r=t.default,i=new r;if(dl.delete(i),i.helper=!1,i.y=Wh,i.z=Wh,i.intensity=.5,e.then(()=>i.dispose()),!bC())return;const s=new r;dl.delete(s),s.helper=!1,s.y=-Wh,s.z=-Wh,s.intensity=.5,e.then(()=>s.dispose())}),()=>{e.cancel()}},[Y8,bC]);const N8e={...uE,texture:[String,Array]},k8e={...hE,texture:void 0};class hR extends Lb{constructor(){super();We(this,"_texture");E8e(this)}dispose(){return this.done?this:(super.dispose(),A8e(this),this)}get texture(){return this._texture}set texture(t){this._texture=t,O7([...MC()])}}We(hR,"componentName","skybox"),We(hR,"defaults",k8e),We(hR,"schema",N8e);const[z8e,B8e]=Pt(0),[V8e,F8e]=Pt(void 0),[U8e,j8e]=Pt(void 0),[H8e,W8e]=Pt(void 0),Z8=new hR;dl.delete(Z8);const D7={get defaultLight(){return Y8()},set defaultLight(n){I8e(n)},get shadowResolution(){return W8e()},set shadowResolution(n){H8e(n)},get shadowBias(){return F8e()},set shadowBias(n){V8e(n)},get shadowDistance(){return j8e()},set shadowDistance(n){U8e(n)},get skybox(){return Z8.texture},set skybox(n){Z8.texture=n},get gridHelper(){return j8()},set gridHelper(n){KUe(n)},get gridHelperSize(){return H8()},set gridHelperSize(n){JUe(n)},get gravity(){return pce()},set gravity(n){CUe(n)},get repulsion(){return B8e()},set repulsion(n){z8e(n)},get centripetal(){return bC()},set centripetal(n){bUe(n)},get antiAlias(){return SC()},set antiAlias(n){h8e(n)},get pixelRatio(){return S0()},set pixelRatio(n){O6e(n)},get fps(){return _8()},set fps(n){_6e(n)},get logarithmicDepth(){return g8()},set logarithmicDepth(n){v6e(n)},get exposure(){return M8()},set exposure(n){j6e(n)},get pbr(){return C8()},set pbr(n){H6e(n)},get bloom(){return W8()},set bloom(n){n8e(n)},get bloomStrength(){return A7()},set bloomStrength(n){i8e(n)},get bloomRadius(){return E7()},set bloomRadius(n){r8e(n)},get bloomThreshold(){return P7()},set bloomThreshold(n){s8e(n)},get ambientOcclusion(){return kO()},set ambientOcclusion(n){g8e(n)},get outlineColor(){return T8()},set outlineColor(n){X6e(n)},get outlineHiddenColor(){return R8()},set outlineHiddenColor(n){q6e(n)},get outlinePattern(){return O8()},set outlinePattern(n){Y6e(n)},get outlinePulse(){return Kle()},set outlinePulse(n){Z6e(n)},get outlineStrength(){return Jle()},set outlineStrength(n){K6e(n)},get outlineThickness(){return Qle()},set outlineThickness(n){J6e(n)},get bokeh(){return V8()},set bokeh(n){gce(n)},get bokehAperture(){return yce()},set bokehAperture(n){_ce(n)},get bokehFocus(){return bce()},set bokehFocus(n){xce(n)},get bokehMaxBlur(){return Sce()},set bokehMaxBlur(n){wce(n)},get lensDistortion(){return G8()},set lensDistortion(n){u8e(n)},get lensIor(){return Pce()},set lensIor(n){l8e(n)},get lensBand(){return Tce()},set lensBand(n){c8e(n)},get motionBlur(){return X8()},set motionBlur(n){v8e(n)},get motionBlurStrength(){return Lce()},set motionBlurStrength(n){f8e(n)},get texture(){return q8()},set texture(n){C8e(n)},get color(){return yC()},set color(n){m6e(n)}},I7={skybox:[String,Array],defaultLight:[String,Boolean],shadowDistance:Number,shadowResolution:Number,shadowBias:Number,gridHelper:Boolean,gridHelperSize:Number,gravity:Number,repulsion:Number,centripetal:Boolean,antiAlias:[Boolean,String],logarithmicDepth:Boolean,pixelRatio:Number,fps:Number,exposure:Number,pbr:Boolean,bloom:Boolean,bloomStrength:Number,bloomRadius:Number,bloomThreshold:Number,ambientOcclusion:[Boolean,String],outlineColor:String,outlineHiddenColor:String,outlinePattern:String,outlinePulse:Number,outlineStrength:Number,outlineThickness:Number,bokeh:Boolean,bokehAperture:Number,bokehFocus:Number,bokehMaxBlur:Number,lensDistortion:Boolean,lensIor:Number,lensBand:Number,motionBlur:Boolean,motionBlurStrength:Number,texture:String,color:String},zce={...D7,shadowDistance:new ki(L6e),shadowResolution:new ki(1024),shadowBias:new ki(Ule)},[N7,EC]=Pt([]),G8e=Mb(N7,EC),X8e=Cb(N7,EC),Bce=tv(Rae(N7,EC),0,"trailing"),q8e={get autoMount(){return A8()},set autoMount(n){W6e(n)},get firstLoadBeforeRender(){return y8()},set firstLoadBeforeRender(n){w6e(n)}},Vce={};for(const n of Object.keys(I7))Object.defineProperty(q8e,n,{get(){return D7[n]},set(e){Vce[n]=e,Bce()},enumerable:!0});const Y8e=Object.fromEntries(Object.entries(zce).map(([n,e])=>[n,e instanceof ki?void 0:e]));yn(function(){const n={};for(const e of[Y8e,...EC(),Vce])for(const[t,r]of Object.entries(e))r!==void 0&&(n[t]=r);Object.assign(D7,n)},[EC]);const BO=window;"__THREE__"in BO&&(BO.__THREE__+=" - Lingo3D Beta "+I6e);"__LINGO3D__"in BO&&console.warn("multiple versions of Lingo3D detected");BO.__LINGO3D__=!0;async function Z8e(){const{Sphere:n}=await b7(),e=new n(mE(this).x*.5);this.cannonBody.addShape(e)}const Fce=new e7(Fp,32,32);class Uce extends DO{constructor(){super(Fce);We(this,"_physicsShape",Z8e)}}We(Uce,"componentName","sphere");const K8e=Object.freeze(Object.defineProperty({__proto__:null,sphereGeometry:Fce,default:Uce},Symbol.toStringTag,{value:"Module"}));new QH(Fp,Ec,16);new qD(Fp,Fp,Ec,16);new $H(Fp);const k7=new t7(61*Qr);k7.rotateY(45*Co);k7.rotateX(125*Co);k7.translate(0,-.2,.2);new n7(40*Qr,1*Qr,8,32);({...S7});({...M7});new sE(Ec,Ec,1,1);({...S7});({...M7});new JH(Fp,32);const EF=new Map,jce=(n,e)=>{if(EF.has(e))return EF.get(e);const t=new Te;return Gy.setFromObject(n).getSize(t),Object.freeze(t),EF.set(e,t),t},AF=new Map,J8e=(n,e)=>{if(AF.has(e)){const[s,o,a]=AF.get(e);return n.scale.multiplyScalar(s),n.position.copy(o).multiplyScalar(-1),a}const t=jce(n,e).clone(),r=1/t.y;n.scale.multiplyScalar(r);const i=fE(n);return n.position.copy(i).multiplyScalar(-1),t.multiplyScalar(r),Object.freeze(t),AF.set(e,[r,i,t]),t},Q8e={...Ib,src:String,onLoad:Function,boxVisible:Boolean},$8e={...Nb,src:void 0,onLoad:void 0,boxVisible:!1},eje=n=>{var t;const e=n.split("/");return(t=$2(e))!=null&&t.includes(".")?(e.pop(),e.join("/")):n},tje=n=>n.startsWith("./")||n.startsWith("../"),nje=(n,e)=>{for(var t="",r=0,i=-1,s=0,o,a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var c=t.lastIndexOf("/");if(c!==t.length-1){c===-1?(t="",r=0):(t=t.slice(0,c),r=t.length-1-t.lastIndexOf("/")),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,i=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return t},rje=n=>{if(n.length===0)return".";var e=n.charCodeAt(0)===47,t=n.charCodeAt(n.length-1)===47;return n=nje(n,!e),n.length===0&&!e&&(n="."),n.length>0&&t&&(n+="/"),e?"/"+n:n},ije=(...n)=>{if(n.length===0)return".";for(var e,t=0;t<n.length;++t){var r=n[t];r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":rje(e)},[E$e,JJ]=Pt(void 0),[A$e,QJ]=Pt(void 0),$J=n=>{vle.setURLModifier(n)},Hce=new Map,K8=new Map,Wce=new Map,sje=(n,e=(t=>(t=vIe(n.webkitRelativePath)[1])==null?void 0:t.toLowerCase())())=>ev(K8,n,()=>{const r=URL.createObjectURL(n);return e&&Hce.set(r,e),Wce.set(r,n),r}),J8=new Map;yn(()=>{const n=QJ();if(!!n){for(const e of n)J8.set(e.webkitRelativePath,e);return()=>{for(const e of K8.values())URL.revokeObjectURL(e);J8.clear(),Hce.clear(),K8.clear(),Wce.clear()}}},[QJ]);yn(()=>{var e;const n=(e=JJ())==null?void 0:e.webkitRelativePath;if(!!n)return $J(t=>{if(tje(t)){const r=J8.get(ije(eje(n),t));if(r)return sje(r)}return t}),()=>{$J(void 0)}},[JJ]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var rn=function(){return rn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},rn.apply(this,arguments)};function z7(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function qi(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Or(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function Ii(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var pi;(function(n){n.Start="xstate.start",n.Stop="xstate.stop",n.Raise="xstate.raise",n.Send="xstate.send",n.Cancel="xstate.cancel",n.NullEvent="",n.Assign="xstate.assign",n.After="xstate.after",n.DoneState="done.state",n.DoneInvoke="done.invoke",n.Log="xstate.log",n.Init="xstate.init",n.Invoke="xstate.invoke",n.ErrorExecution="error.execution",n.ErrorCommunication="error.communication",n.ErrorPlatform="error.platform",n.ErrorCustom="xstate.error",n.Update="xstate.update",n.Pure="xstate.pure",n.Choose="xstate.choose"})(pi||(pi={}));var Bx;(function(n){n.Parent="#_parent",n.Internal="#_internal"})(Bx||(Bx={}));var eQ=pi.Start,Gce=pi.Stop,AC=pi.Raise,VO=pi.Send,oje=pi.Cancel,aje=pi.NullEvent,Xce=pi.Assign;pi.After;pi.DoneState;var lje=pi.Log,cje=pi.Init,Q8=pi.Invoke;pi.ErrorExecution;pi.ErrorPlatform;pi.ErrorCustom;var uje=pi.Update,hje=pi.Choose,dje=pi.Pure,qce=".",tQ={},$8="xstate.guard",pje="",fje=!0,UT;function B7(n,e,t){t===void 0&&(t=qce);var r=BM(n,t),i=BM(e,t);return Gr(i)?Gr(r)?i===r:!1:Gr(r)?r in i:Object.keys(r).every(function(s){return s in i?B7(r[s],i[s]):!1})}function Yce(n){try{return Gr(n)||typeof n=="number"?"".concat(n):n.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function ej(n,e){try{return _E(n)?n:n.toString().split(e)}catch{throw new Error("'".concat(n,"' is not a valid state path."))}}function mje(n){return typeof n=="object"&&"value"in n&&"context"in n&&"event"in n&&"_event"in n}function BM(n,e){if(mje(n))return n.value;if(_E(n))return FO(n);if(typeof n!="string")return n;var t=ej(n,e);return FO(t)}function FO(n){if(n.length===1)return n[0];for(var e={},t=e,r=0;r<n.length-1;r++)r===n.length-2?t[n[r]]=n[r+1]:(t[n[r]]={},t=t[n[r]]);return e}function lM(n,e){for(var t={},r=Object.keys(n),i=0;i<r.length;i++){var s=r[i];t[s]=e(n[s],s,n,i)}return t}function nQ(n,e,t){var r,i,s={};try{for(var o=qi(Object.keys(n)),a=o.next();!a.done;a=o.next()){var c=a.value,u=n[c];!t(u)||(s[c]=e(u,c,n))}}catch(d){r={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}var vje=function(n){return function(e){var t,r,i=e;try{for(var s=qi(n),o=s.next();!o.done;o=s.next()){var a=o.value;i=i[a]}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i}};function gje(n,e){return function(t){var r,i,s=t;try{for(var o=qi(n),a=o.next();!a.done;a=o.next()){var c=a.value;s=s[e][c]}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}}function dR(n){if(!n)return[[]];if(Gr(n))return[[n]];var e=as(Object.keys(n).map(function(t){var r=n[t];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[t]]:dR(n[t]).map(function(i){return[t].concat(i)})}));return e}function as(n){var e;return(e=[]).concat.apply(e,Ii([],Or(n),!1))}function Zce(n){return _E(n)?n:[n]}function Ku(n){return n===void 0?[]:Zce(n)}function Kce(n,e,t){var r,i;if(lo(n))return n(e,t.data);var s={};try{for(var o=qi(Object.keys(n)),a=o.next();!a.done;a=o.next()){var c=a.value,u=n[c];lo(u)?s[c]=u(e,t.data):s[c]=u}}catch(d){r={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function _je(n){return/^(done|error)\./.test(n)}function yje(n,e){var t,r,i=Or([[],[]],2),s=i[0],o=i[1];try{for(var a=qi(n),c=a.next();!c.done;c=a.next()){var u=c.value;e(u)?s.push(u):o.push(u)}}catch(d){t={error:d}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return[s,o]}function Jce(n,e){return lM(n.states,function(t,r){if(!!t){var i=(Gr(e)?void 0:e[r])||(t?t.current:void 0);if(!!i)return{current:i,states:Jce(t,i)}}})}function xje(n,e){return{current:e,states:Jce(n,e)}}function rQ(n,e,t,r){var i=n&&t.reduce(function(s,o){var a,c,u=o.assignment,d={state:r,action:o,_event:e},p={};if(lo(u))p=u(s,e.data,d);else try{for(var f=qi(Object.keys(u)),v=f.next();!v.done;v=f.next()){var x=v.value,y=u[x];p[x]=lo(y)?y(s,e.data,d):y}}catch(_){a={error:_}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}return Object.assign({},s,p)},n);return i}var bje=function(){};function _E(n){return Array.isArray(n)}function lo(n){return typeof n=="function"}function Gr(n){return typeof n=="string"}function Qce(n,e){if(!!n)return Gr(n)?{type:$8,name:n,predicate:e?e[n]:void 0}:lo(n)?{type:$8,name:n.name,predicate:n}:n}var $ce=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();UT={},UT[$ce]=function(){return this},UT[Symbol.observable]=function(){return this};function UO(n){return!!n&&"__xstatenode"in n}function eue(n,e){return Gr(n)||typeof n=="number"?rn({type:n},e):n}function PC(n,e){if(!Gr(n)&&"$$type"in n&&n.$$type==="scxml")return n;var t=eue(n);return rn({name:t.type,data:t,$$type:"scxml",type:"external"},e)}function sy(n,e){var t=Zce(e).map(function(r){return typeof r>"u"||typeof r=="string"||UO(r)?{target:r,event:n}:rn(rn({},r),{event:n})});return t}function wje(n){if(!(n===void 0||n===pje))return Ku(n)}function tue(n,e,t,r,i){var s=n.options.guards,o={state:i,cond:e,_event:r};if(e.type===$8)return((s==null?void 0:s[e.name])||e.predicate)(t,r.data,o);var a=s==null?void 0:s[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(n.id,"'."));return a(t,r.data,o)}function Sje(n){return typeof n=="string"?{type:n}:n}function jT(n,e){return"".concat(n,":invocation[").concat(e,"]")}var tj=PC({type:cje});function iQ(n,e){return e&&e[n]||void 0}function TC(n,e){var t;if(Gr(n)||typeof n=="number"){var r=iQ(n,e);lo(r)?t={type:n,exec:r}:r?t=r:t={type:n,exec:void 0}}else if(lo(n))t={type:n.name||n.toString(),exec:n};else{var r=iQ(n.type,e);if(lo(r))t=rn(rn({},n),{exec:r});else if(r){var i=r.type||n.type;t=rn(rn(rn({},r),n),{type:i})}else t=n}return t}var Zg=function(n,e){if(!n)return[];var t=_E(n)?n:[n];return t.map(function(r){return TC(r,e)})};function V7(n){var e=TC(n);return rn(rn({id:Gr(n)?n:e.id},e),{type:e.type})}function Mje(n){return Gr(n)?{type:AC,event:n}:nue(n,{to:Bx.Internal})}function Cje(n){return{type:AC,_event:PC(n.event)}}function nue(n,e){return{to:e?e.to:void 0,type:VO,event:lo(n)?n:eue(n),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:lo(n)?n.name:Yce(n)}}function Eje(n,e,t,r){var i={_event:t},s=PC(lo(n.event)?n.event(e,t.data,i):n.event),o;if(Gr(n.delay)){var a=r&&r[n.delay];o=lo(a)?a(e,t.data,i):a}else o=lo(n.delay)?n.delay(e,t.data,i):n.delay;var c=lo(n.to)?n.to(e,t.data,i):n.to;return rn(rn({},n),{to:c,_event:s,event:s.data,delay:o})}var Aje=function(n,e,t){return rn(rn({},n),{value:Gr(n.expr)?n.expr:n.expr(e,t.data,{_event:t})})},Pje=function(n){return{type:oje,sendId:n}};function Tje(n){var e=V7(n);return{type:pi.Start,activity:e,exec:void 0}}function Rje(n){var e=lo(n)?n:V7(n);return{type:pi.Stop,activity:e,exec:void 0}}function Oje(n,e,t){var r=lo(n.activity)?n.activity(e,t.data):n.activity,i=typeof r=="string"?{id:r}:r,s={type:pi.Stop,activity:i};return s}function Lje(n,e){var t=e?"#".concat(e):"";return"".concat(pi.After,"(").concat(n,")").concat(t)}function HT(n,e){var t="".concat(pi.DoneState,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}function Dje(n,e){var t="".concat(pi.DoneInvoke,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}function Ije(n,e){var t="".concat(pi.ErrorPlatform,".").concat(n),r={type:t,data:e};return r.toString=function(){return t},r}var Nje=function(n){var e,t,r=[];try{for(var i=qi(n),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.length;){if(o[a].type===Xce){r.push(o[a]),o.splice(a,1);continue}a++}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r};function nj(n,e,t,r,i,s,o){o===void 0&&(o=!1);var a=o?[]:Nje(i),c=a.length?rQ(t,r,a,e):t,u=o?[t]:void 0,d=[];function p(x){var y;switch(x.type){case AC:return Cje(x);case VO:var _=Eje(x,c,r,n.options.delays);return s&&_.to!==Bx.Internal&&d.push(_),_;case lje:{var S=Aje(x,c,r);return s==null||s(S,c,r),S}case hje:{var C=x,A=(y=C.conds.find(function(ce){var te=Qce(ce.cond,n.options.guards);return!te||tue(n,te,c,r,s?void 0:e)}))===null||y===void 0?void 0:y.actions;if(!A)return[];var P=Or(nj(n,e,c,r,[Zg(Ku(A),n.options.actions)],s,o),2),D=P[0],N=P[1];return c=N,u==null||u.push(c),D}case dje:{var A=x.get(c,r.data);if(!A)return[];var j=Or(nj(n,e,c,r,[Zg(Ku(A),n.options.actions)],s,o),2),T=j[0],k=j[1];return c=k,u==null||u.push(c),T}case Gce:{var S=Oje(x,c,r);return s==null||s(S,t,r),S}case Xce:{c=rQ(c,r,[x],s?void 0:e),u==null||u.push(c);break}default:var U=TC(x,n.options.actions),ee=U.exec;if(s)s(U,c,r);else if(ee&&u){var xe=u.length-1;U=rn(rn({},U),{exec:function(ce){for(var te=[],fe=1;fe<arguments.length;fe++)te[fe-1]=arguments[fe];ee.apply(void 0,Ii([u[xe]],Or(te),!1))}})}return U}}function f(x){var y,_,S=[];try{for(var C=qi(x),A=C.next();!A.done;A=C.next()){var P=A.value,D=p(P);D&&(S=S.concat(D))}}catch(N){y={error:N}}finally{try{A&&!A.done&&(_=C.return)&&_.call(C)}finally{if(y)throw y.error}}return d.forEach(function(N){s(N,c,r)}),d.length=0,S}var v=as(i.map(f));return[v,c]}var kje=function(n,e){var t=e(n);return t};function rue(n){var e;return e={id:n,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:n}}},e[$ce]=function(){return this},e}function zje(n,e,t,r){var i,s=Sje(n.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],a=n.data?Kce(n.data,t,r):void 0,c=o?Bje(o,n.id,a):rue(n.id);return c.meta=n,c}function Bje(n,e,t){var r=rue(e);if(r.deferred=!0,UO(n)){var i=r.state=kje(void 0,function(){return(t?n.withContext(t):n).initialState});r.getSnapshot=function(){return i}}return r}var jO=function(n){return n.type==="atomic"||n.type==="final"};function iue(n){return Object.keys(n.states).map(function(e){return n.states[e]})}function RC(n){return iue(n).filter(function(e){return e.type!=="history"})}function sue(n){var e=[n];return jO(n)?e:e.concat(as(RC(n).map(sue)))}function cM(n,e){var t,r,i,s,o,a,c,u,d=new Set(n),p=rj(d),f=new Set(e);try{for(var v=qi(f),x=v.next();!x.done;x=v.next())for(var y=x.value,_=y.parent;_&&!f.has(_);)f.add(_),_=_.parent}catch(k){t={error:k}}finally{try{x&&!x.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}var S=rj(f);try{for(var C=qi(f),A=C.next();!A.done;A=C.next()){var y=A.value;if(y.type==="compound"&&(!S.get(y)||!S.get(y).length))p.get(y)?p.get(y).forEach(function(U){return f.add(U)}):y.initialStateNodes.forEach(function(U){return f.add(U)});else if(y.type==="parallel")try{for(var P=(o=void 0,qi(RC(y))),D=P.next();!D.done;D=P.next()){var N=D.value;f.has(N)||(f.add(N),p.get(N)?p.get(N).forEach(function(U){return f.add(U)}):N.initialStateNodes.forEach(function(U){return f.add(U)}))}}catch(U){o={error:U}}finally{try{D&&!D.done&&(a=P.return)&&a.call(P)}finally{if(o)throw o.error}}}}catch(k){i={error:k}}finally{try{A&&!A.done&&(s=C.return)&&s.call(C)}finally{if(i)throw i.error}}try{for(var j=qi(f),T=j.next();!T.done;T=j.next())for(var y=T.value,_=y.parent;_&&!f.has(_);)f.add(_),_=_.parent}catch(k){c={error:k}}finally{try{T&&!T.done&&(u=j.return)&&u.call(j)}finally{if(c)throw c.error}}return f}function oue(n,e){var t=e.get(n);if(!t)return{};if(n.type==="compound"){var r=t[0];if(r){if(jO(r))return r.key}else return{}}var i={};return t.forEach(function(s){i[s.key]=oue(s,e)}),i}function rj(n){var e,t,r=new Map;try{for(var i=qi(n),s=i.next();!s.done;s=i.next()){var o=s.value;r.has(o)||r.set(o,[]),o.parent&&(r.has(o.parent)||r.set(o.parent,[]),r.get(o.parent).push(o))}}catch(a){e={error:a}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}function Vje(n,e){var t=cM([n],e);return oue(n,rj(t))}function my(n,e){return Array.isArray(n)?n.some(function(t){return t===e}):n instanceof Set?n.has(e):!1}function Fje(n){return Ii([],Or(new Set(as(Ii([],Or(n.map(function(e){return e.ownEvents})),!1)))),!1)}function pR(n,e){return e.type==="compound"?RC(e).some(function(t){return t.type==="final"&&my(n,t)}):e.type==="parallel"?RC(e).every(function(t){return pR(n,t)}):!1}function Uje(n){return n===void 0&&(n=[]),n.reduce(function(e,t){return t.meta!==void 0&&(e[t.id]=t.meta),e},{})}function sQ(n){return new Set(as(n.map(function(e){return e.tags})))}function aue(n,e){if(n===e)return!0;if(n===void 0||e===void 0)return!1;if(Gr(n)||Gr(e))return n===e;var t=Object.keys(n),r=Object.keys(e);return t.length===r.length&&t.every(function(i){return aue(n[i],e[i])})}var Kf=function(){function n(e){var t=this,r;this.actions=[],this.activities=tQ,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||tQ,this.meta=Uje(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Fje(t.configuration)}})}return n.from=function(e,t){if(e instanceof n)return e.context!==t?new n({value:e.value,context:t,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=tj;return new n({value:e,context:t,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},n.create=function(e){return new n(e)},n.inert=function(e,t){if(e instanceof n){if(!e.actions.length)return e;var r=tj;return new n({value:e.value,context:t,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return n.from(e,t)},n.prototype.toStrings=function(e,t){var r=this;if(e===void 0&&(e=this.value),t===void 0&&(t="."),Gr(e))return[e];var i=Object.keys(e);return i.concat.apply(i,Ii([],Or(i.map(function(s){return r.toStrings(e[s],t).map(function(o){return s+t+o})})),!1))},n.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var r=z7(e,["configuration","transitions","tags","machine"]);return rn(rn({},r),{tags:Array.from(t)})},n.prototype.matches=function(e){return B7(e,this.value)},n.prototype.hasTag=function(e){return this.tags.has(e)},n.prototype.can=function(e){var t;bje(!!this.machine);var r=(t=this.machine)===null||t===void 0?void 0:t.getTransitionData(this,e);return!!(r!=null&&r.transitions.length)&&r.transitions.some(function(i){return i.target!==void 0||i.actions.length})},n}();function jje(n){if(typeof n=="string"){var e={type:n};return e.toString=function(){return n},e}return n}function WT(n){return rn(rn({type:Q8},n),{toJSON:function(){n.onDone,n.onError;var e=z7(n,["onDone","onError"]);return rn(rn({},e),{type:Q8,src:jje(n.src)})}})}var GT="",ij="#",PF="*",oy={},ay=function(n){return n[0]===ij},Hje=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Wje=function(){function n(e,t,r,i){r===void 0&&(r="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Hje(),t),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:qce),this.id=this.config.id||Ii([this.machine.key],Or(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?lM(this.config.states,function(u,d){var p,f=new n(u,{},void 0,{parent:s,key:d});return Object.assign(s.idMap,rn((p={},p[f.id]=f,p),f.idMap)),f}):oy;var a=0;function c(u){var d,p;u.order=a++;try{for(var f=qi(iue(u)),v=f.next();!v.done;v=f.next()){var x=v.value;c(x)}}catch(y){d={error:y}}finally{try{v&&!v.done&&(p=f.return)&&p.call(f)}finally{if(d)throw d.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var d=u.event;return d===GT}):GT in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=Ku(this.config.entry||this.config.onEntry).map(function(u){return TC(u)}),this.onExit=Ku(this.config.exit||this.config.onExit).map(function(u){return TC(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=Ku(this.config.invoke).map(function(u,d){var p,f;if(UO(u)){var v=jT(s.id,d);return s.machine.options.services=rn((p={},p[v]=u,p),s.machine.options.services),WT({src:v,id:v})}else if(Gr(u.src)){var v=u.id||jT(s.id,d);return WT(rn(rn({},u),{id:v,src:u.src}))}else if(UO(u.src)||lo(u.src)){var v=u.id||jT(s.id,d);return s.machine.options.services=rn((f={},f[v]=u.src,f),s.machine.options.services),WT(rn(rn({id:v},u),{src:v}))}else{var x=u.src;return WT(rn(rn({id:jT(s.id,d)},u),{src:x}))}}),this.activities=Ku(this.config.activities).concat(this.invoke).map(function(u){return V7(u)}),this.transition=this.transition.bind(this),this.tags=Ku(this.config.tags)}return n.prototype._init=function(){this.__cache.transitions||sue(this).forEach(function(e){return e.on})},n.prototype.withConfig=function(e,t){var r=this.options,i=r.actions,s=r.activities,o=r.guards,a=r.services,c=r.delays;return new n(this.config,{actions:rn(rn({},i),e.actions),activities:rn(rn({},s),e.activities),guards:rn(rn({},o),e.guards),services:rn(rn({},a),e.services),delays:rn(rn({},c),e.delays)},t!=null?t:this.context)},n.prototype.withContext=function(e){return new n(this.config,this.options,e)},Object.defineProperty(n.prototype,"context",{get:function(){return lo(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:lM(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return this.definition},Object.defineProperty(n.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(t,r){return t[r.eventType]=t[r.eventType]||[],t[r.eventType].push(r),t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),n.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===GT,r=this.transitions.filter(function(i){var s=i.eventType===e;return t?s:s||i.eventType===PF});return this.__cache.candidates[e]=r,r},n.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var r=function(s,o){var a=lo(s)?"".concat(e.id,":delay[").concat(o,"]"):s,c=Lje(a,e.id);return e.onEntry.push(nue(c,{delay:s})),e.onExit.push(Pje(c)),c},i=_E(t)?t.map(function(s,o){var a=r(s.delay,o);return rn(rn({},s),{event:a})}):as(Object.keys(t).map(function(s,o){var a=t[s],c=Gr(a)?{target:a}:a,u=isNaN(+s)?s:+s,d=r(u,o);return Ku(c).map(function(p){return rn(rn({},p),{event:d,delay:u})})}));return i.map(function(s){var o=s.delay;return rn(rn({},e.formatTransition(s)),{delay:o})})},n.prototype.getStateNodes=function(e){var t,r=this;if(!e)return[];var i=e instanceof Kf?e.value:BM(e,this.delimiter);if(Gr(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((t={},t[i]=s,t)):[this,this.states[i]]}var o=Object.keys(i),a=[this];return a.push.apply(a,Ii([],Or(as(o.map(function(c){return r.getStateNode(c).getStateNodes(i[c])}))),!1)),a},n.prototype.handles=function(e){var t=Yce(e);return this.events.includes(t)},n.prototype.resolveState=function(e){var t=e instanceof Kf?e:Kf.create(e),r=Array.from(cM([],this.getStateNodes(t.value)));return new Kf(rn(rn({},t),{value:this.resolve(t.value),configuration:r,done:pR(r,this),tags:sQ(r),machine:this.machine}))},n.prototype.transitionLeafNode=function(e,t,r){var i=this.getStateNode(e),s=i.next(t,r);return!s||!s.transitions.length?this.next(t,r):s},n.prototype.transitionCompoundNode=function(e,t,r){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],t,r);return!o||!o.transitions.length?this.next(t,r):o},n.prototype.transitionParallelNode=function(e,t,r){var i,s,o={};try{for(var a=qi(Object.keys(e)),c=a.next();!c.done;c=a.next()){var u=c.value,d=e[u];if(!!d){var p=this.getStateNode(u),f=p._transition(d,t,r);f&&(o[u]=f)}}}catch(C){i={error:C}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}var v=Object.keys(o).map(function(C){return o[C]}),x=as(v.map(function(C){return C.transitions})),y=v.some(function(C){return C.transitions.length>0});if(!y)return this.next(t,r);var _=as(v.map(function(C){return C.entrySet})),S=as(Object.keys(o).map(function(C){return o[C].configuration}));return{transitions:x,entrySet:_,exitSet:as(v.map(function(C){return C.exitSet})),configuration:S,source:t,actions:as(Object.keys(o).map(function(C){return o[C].actions}))}},n.prototype._transition=function(e,t,r){return Gr(e)?this.transitionLeafNode(e,t,r):Object.keys(e).length===1?this.transitionCompoundNode(e,t,r):this.transitionParallelNode(e,t,r)},n.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,PC(t))},n.prototype.next=function(e,t){var r,i,s=this,o=t.name,a=[],c=[],u;try{for(var d=qi(this.getCandidates(o)),p=d.next();!p.done;p=d.next()){var f=p.value,v=f.cond,x=f.in,y=e.context,_=x?Gr(x)&&ay(x)?e.matches(BM(this.getStateNodeById(x).path,this.delimiter)):B7(BM(x,this.delimiter),vje(this.path.slice(0,-2))(e.value)):!0,S=!1;try{S=!v||tue(this.machine,v,y,t,e)}catch(D){throw new Error("Unable to evaluate guard '".concat(v.name||v.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(D.message))}if(S&&_){f.target!==void 0&&(c=f.target),a.push.apply(a,Ii([],Or(f.actions),!1)),u=f;break}}}catch(D){r={error:D}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(!!u){if(!c.length)return{transitions:[u],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var C=as(c.map(function(D){return s.getRelativeStateNodes(D,e.historyValue)})),A=!!u.internal,P=[];return A||c.forEach(function(D){P.push.apply(P,Ii([],Or(s.getExternalReentryNodes(D)),!1))}),{transitions:[u],entrySet:P,exitSet:A?[]:[this],configuration:C,source:e,actions:a}}},n.prototype.getExternalReentryNodes=function(e){for(var t=[],r=Or(e.order>this.order?[e,this]:[this,e],2),i=r[0],s=r[1];i&&i!==s;)t.push(i),i=i.parent;return i!==s?[]:(t.push(s),t)},n.prototype.getActions=function(e,t,r,i,s,o,a){var c,u,d,p,f=this,v=cM([],o?this.getStateNodes(o.value):[this]);try{for(var x=qi(e),y=x.next();!y.done;y=x.next()){var _=y.value;(!my(v,_)||my(r.entrySet,_.parent)&&!my(r.entrySet,_))&&r.entrySet.push(_)}}catch(U){c={error:U}}finally{try{y&&!y.done&&(u=x.return)&&u.call(x)}finally{if(c)throw c.error}}try{for(var S=qi(v),C=S.next();!C.done;C=S.next()){var _=C.value;(!my(e,_)||my(r.exitSet,_.parent))&&r.exitSet.push(_)}}catch(U){d={error:U}}finally{try{C&&!C.done&&(p=S.return)&&p.call(S)}finally{if(d)throw d.error}}var A=as(r.entrySet.map(function(U){var ee=[];if(U.type!=="final")return ee;var xe=U.parent;if(!xe.parent)return ee;ee.push(HT(U.id,U.doneData),HT(xe.id,U.doneData?Kce(U.doneData,i,s):void 0));var ce=xe.parent;return ce.type==="parallel"&&RC(ce).every(function(te){return pR(r.configuration,te)})&&ee.push(HT(ce.id)),ee}));r.exitSet.sort(function(U,ee){return ee.order-U.order}),r.entrySet.sort(function(U,ee){return U.order-ee.order});var P=new Set(r.entrySet),D=new Set(r.exitSet),N=Array.from(P).map(function(U){var ee=U.onEntry,xe=U.activities.map(function(ce){return Tje(ce)});return Zg(a?Ii(Ii([],Or(ee),!1),Or(xe),!1):Ii(Ii([],Or(xe),!1),Or(ee),!1),f.machine.options.actions)}).concat([A.map(Mje)]),j=Array.from(D).map(function(U){return Zg(Ii(Ii([],Or(U.onExit),!1),Or(U.activities.map(function(ee){return Rje(ee)})),!1),f.machine.options.actions)}),T=j.concat([Zg(r.actions,this.machine.options.actions)]).concat(N);if(t){var k=Zg(as(Ii([],Or(e),!1).sort(function(U,ee){return ee.order-U.order}).map(function(U){return U.onExit})),this.machine.options.actions).filter(function(U){return U.type!==AC&&(U.type!==VO||!!U.to&&U.to!==Bx.Internal)});return T.concat([k])}return T},n.prototype.transition=function(e,t,r,i){e===void 0&&(e=this.initialState);var s=PC(t),o;if(e instanceof Kf)o=r===void 0?e:this.resolveState(Kf.from(e,r));else{var a=Gr(e)?this.resolve(FO(this.getResolvedPath(e))):this.resolve(e),c=r!=null?r:this.machine.context;o=this.resolveState(Kf.from(a,c))}if(this.strict&&!this.events.includes(s.name)&&!_je(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(o.value,o,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},d=cM([],this.getStateNodes(o.value)),p=u.configuration.length?cM(d,u.configuration):d;return u.configuration=Ii([],Or(p),!1),this.resolveTransition(u,o,o.context,i,s)},n.prototype.resolveRaisedTransition=function(e,t,r,i){var s,o=e.actions;return e=this.transition(e,t,void 0,i),e._event=r,e.event=r.data,(s=e.actions).unshift.apply(s,Ii([],Or(o),!1)),e},n.prototype.resolveTransition=function(e,t,r,i,s){var o,a,c,u,d=this;s===void 0&&(s=tj);var p=e.configuration,f=!t||e.transitions.length>0,v=f?e.configuration:t?t.configuration:[],x=pR(v,this),y=f?Vje(this.machine,p):void 0,_=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,S=this.getActions(new Set(v),x,e,r,s,t,i),C=t?rn({},t.activities):{};try{for(var A=qi(S),P=A.next();!P.done;P=A.next()){var D=P.value;try{for(var N=(c=void 0,qi(D)),j=N.next();!j.done;j=N.next()){var T=j.value;T.type===eQ?C[T.activity.id||T.activity.type]=T:T.type===Gce&&(C[T.activity.id||T.activity.type]=!1)}}catch(Ze){c={error:Ze}}finally{try{j&&!j.done&&(u=N.return)&&u.call(N)}finally{if(c)throw c.error}}}}catch(Ze){o={error:Ze}}finally{try{P&&!P.done&&(a=A.return)&&a.call(A)}finally{if(o)throw o.error}}var k=Or(nj(this,t,r,s,S,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),U=k[0],ee=k[1],xe=Or(yje(U,function(Ze){return Ze.type===AC||Ze.type===VO&&Ze.to===Bx.Internal}),2),ce=xe[0],te=xe[1],fe=U.filter(function(Ze){var st;return Ze.type===eQ&&((st=Ze.activity)===null||st===void 0?void 0:st.type)===Q8}),ge=fe.reduce(function(Ze,st){return Ze[st.activity.id]=zje(st.activity,d.machine,ee,s),Ze},t?rn({},t.children):{}),Se=new Kf({value:y||t.value,context:ee,_event:s,_sessionid:t?t._sessionid:null,historyValue:y?_?xje(_,y):void 0:t?t.historyValue:void 0,history:!y||e.source?t:void 0,actions:y?te:[],activities:y?C:t?t.activities:{},events:[],configuration:v,transitions:e.transitions,children:ge,done:x,tags:sQ(v),machine:this}),pe=r!==ee;Se.changed=s.name===uje||pe;var se=Se.history;se&&delete se.history;var ae=!x&&(this._transient||p.some(function(Ze){return Ze._transient}));if(!f&&(!ae||s.name===GT))return Se;var Le=Se;if(!x)for(ae&&(Le=this.resolveRaisedTransition(Le,{type:aje},s,i));ce.length;){var Re=ce.shift();Le=this.resolveRaisedTransition(Le,Re._event,s,i)}var Ue=Le.changed||(se?!!Le.actions.length||pe||typeof se.value!=typeof Le.value||!aue(Le.value,se.value):void 0);return Le.changed=Ue,Le.history=se,Le},n.prototype.getStateNode=function(e){if(ay(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},n.prototype.getStateNodeById=function(e){var t=ay(e)?e.slice(ij.length):e;if(t===this.id)return this;var r=this.machine.idMap[t];if(!r)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return r},n.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&ay(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var t=ej(e,this.delimiter).slice(),r=this;t.length;){var i=t.shift();if(!i.length)break;r=r.getStateNode(i)}return r},n.prototype.resolve=function(e){var t,r=this;if(!e)return this.initialStateValue||oy;switch(this.type){case"parallel":return lM(this.initialStateValue,function(s,o){return s?r.getStateNode(o).resolve(e[o]||s):oy});case"compound":if(Gr(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(t={},t[e]=i.initialStateValue,t):e}return Object.keys(e).length?lM(e,function(s,o){return s?r.getStateNode(o).resolve(s):oy}):this.initialStateValue||{};default:return e||oy}},n.prototype.getResolvedPath=function(e){if(ay(e)){var t=this.machine.idMap[e.slice(ij.length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return ej(e,this.delimiter)},Object.defineProperty(n.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var t;if(this.type==="parallel")t=nQ(this.states,function(r){return r.initialStateValue||oy},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=jO(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),n.prototype.getInitialState=function(e,t){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,entrySet:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,t!=null?t:this.machine.context,void 0)},Object.defineProperty(n.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){var e;if(this.type==="history"){var t=this.config;Gr(t.target)?e=ay(t.target)?FO(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target:e=t.target}return e},enumerable:!1,configurable:!0}),n.prototype.getRelativeStateNodes=function(e,t,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(n.prototype,"initialStateNodes",{get:function(){var e=this;if(jO(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var t=dR(this.initialStateValue);return as(t.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),n.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=Or(e),r=t[0],i=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var s=this.getStateNode(r);if(s.type==="history")return s.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(i)},n.prototype.historyValue=function(e){if(!!Object.keys(this.states).length)return{current:e||this.initialStateValue,states:nQ(this.states,function(t,r){if(!e)return t.historyValue();var i=Gr(e)?void 0:e[r];return t.historyValue(i||t.initialStateValue)},function(t){return!t.history})}},n.prototype.resolveHistory=function(e){var t=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var i=this.target;return i?as(dR(i).map(function(o){return r.getFromRelativePath(o)})):r.initialStateNodes}var s=gje(r.path,"states")(e).current;return Gr(s)?[r.getStateNode(s)]:as(dR(s).map(function(o){return t.history==="deep"?r.getFromRelativePath(o):[r.states[o[0]]]}))},Object.defineProperty(n.prototype,"stateIds",{get:function(){var e=this,t=as(Object.keys(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"events",{get:function(){var e,t,r,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var a=qi(Object.keys(s)),c=a.next();!c.done;c=a.next()){var u=c.value,d=s[u];if(d.states)try{for(var p=(r=void 0,qi(d.events)),f=p.next();!f.done;f=p.next()){var v=f.value;o.add("".concat(v))}}catch(x){r={error:x}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}}}catch(x){e={error:x}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(t){return!(!t.target&&!t.actions.length&&t.internal)}).map(function(t){return t.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),n.prototype.resolveTarget=function(e){var t=this;if(e!==void 0)return e.map(function(r){if(!Gr(r))return r;var i=r[0]===t.delimiter;if(i&&!t.parent)return t.getStateNodeByPath(r.slice(1));var s=i?t.key+r:r;if(t.parent)try{var o=t.parent.getStateNodeByPath(s);return o}catch(a){throw new Error("Invalid transition definition for state node '".concat(t.id,`':
`).concat(a.message))}else return t.getStateNodeByPath(s)})},n.prototype.formatTransition=function(e){var t=this,r=wje(e.target),i="internal"in e?e.internal:r?r.some(function(c){return Gr(c)&&c[0]===t.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(r),a=rn(rn({},e),{actions:Zg(Ku(e.actions)),cond:Qce(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return rn(rn({},a),{target:a.target?a.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(t.id)})}});return a},n.prototype.formatTransitions=function(){var e,t,r=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=PF,a=s[o],c=a===void 0?[]:a,u=z7(s,[typeof o=="symbol"?o:o+""]);i=as(Object.keys(u).map(function(C){var A=sy(C,u[C]);return A}).concat(sy(PF,c)))}var d=this.config.always?sy("",this.config.always):[],p=this.config.onDone?sy(String(HT(this.id)),this.config.onDone):[],f=as(this.invoke.map(function(C){var A=[];return C.onDone&&A.push.apply(A,Ii([],Or(sy(String(Dje(C.id)),C.onDone)),!1)),C.onError&&A.push.apply(A,Ii([],Or(sy(String(Ije(C.id)),C.onError)),!1)),A})),v=this.after,x=as(Ii(Ii(Ii(Ii([],Or(p),!1),Or(f),!1),Or(i),!1),Or(d),!1).map(function(C){return Ku(C).map(function(A){return r.formatTransition(A)})}));try{for(var y=qi(v),_=y.next();!_.done;_=y.next()){var S=_.value;x.push(S)}}catch(C){e={error:C}}finally{try{_&&!_.done&&(t=y.return)&&t.call(y)}finally{if(e)throw e.error}}return x},n}(),oQ=!1;function Gje(n,e){return!fje&&!n.predictableActionArguments&&!oQ&&(oQ=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Wje(n,e)}Gje({predictableActionArguments:!0,states:{idle:{on:{RUN_START:"running",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},running:{on:{RUN_STOP:"idle",RUN_BACKWARDS_START:"runningBackwards",JUMP_START:"jumping"}},runningBackwards:{on:{RUN_STOP:"idle",RUN_START:"running",JUMP_START:"jumping"}},jumping:{on:{JUMP_STOP:"idle"}}},initial:"idle"});const Xje={...Q8e,...JD,...a7},qje={...$8e,...QD,...l7},Yje=new WeakMap;class fR extends vce{constructor(){super(...arguments);We(this,"material",AO)}async load(t){y6e();const r=await rr(()=>import("./loadSVG.7c3d6543.js"),[]);let i;try{i=await r.default(t)}catch{throw mJ(),new Error("Failed to load svg, check if src is correct")}return mJ(),i}resolveLoaded(t,r){const i=new kp;i.scale.y*=-1;const s=ev(Yje,t,()=>{const a=[];for(const p of t.paths)for(const f of p.toShapes(!0))a.push(f);if(!a.length)return[];const c=new kp;for(const p of a){const f=new MO(p,{depth:0,bevelEnabled:!1});f.dispose(),c.add(new ul(f))}const u=jce(c,r),d=[];for(const p of a)d.push(new MO(p,{depth:u.y,bevelEnabled:!1}));return d});for(const a of s){const c=new ul(a,this.material);c.castShadow=!0,c.receiveShadow=!0,i.add(c)}const o=J8e(i,r);return!this.widthSet&&(this.object3d.scale.x=o.x),!this.heightSet&&(this.object3d.scale.y=o.y),!this.depthSet&&(this.object3d.scale.z=o.z),i}}We(fR,"componentName","svgMesh"),We(fR,"defaults",qje),We(fR,"schema",Xje);eE(fR,[dE,c7]);cE(["element"]);const Zje=n=>{const e=document.createElement("div");return e.innerHTML=n,e.children[0]};Zje(`
    <div style="position: absolute; visibility: hidden; pointer-events: none;"></div>
`);new xFe;const[P$e,aQ]=Pt(void 0);yn(()=>{const n=aQ();if(!n)return;const e=mn();return e.add(n),()=>{e.remove(n)}},[mn,aQ]);const[T$e,Kje]=fa(),Jje={...Ib},Qje={...Nb};class mR extends gE{constructor(){super(new kp)}}We(mR,"componentName","group"),We(mR,"defaults",Qje),We(mR,"schema",Jje);yn(()=>{const n=zm();if(!n.length)return;const e=new kp;Sn.add(e);const t=new vE(e);HFe.add(t),_C(t);const r=[];for(const{outerObject3d:o}of n)!o.parent||(r.push([o,o.parent]),e.attach(o));Gy.setFromObject(e);for(const[o,a]of r)a.attach(o);e.position.copy(Gy.getCenter(oa));for(const[o]of r)e.attach(o);let i=!1;const s=Kje(()=>{if(!n.length||i)return;i=!0;const o=new mR;o.outerObject3d.position.copy(e.position);for(const a of n)o.attach(a);yc(o)});return()=>{if(yc(),!t.done&&!i)for(const[o,a]of r)a.attach(o);_C(void 0),t.dispose(),Sn.remove(e),s.cancel()}},[zm]);class vR extends Ole{constructor(t){super();We(this,"noEffect");We(this,"data",{});this.noEffect=t,!t&&(G8e(this.data),this.then(()=>X8e(this.data)))}}We(vR,"componentName","setup"),We(vR,"defaults",zce),We(vR,"schema",I7);for(const n of Object.keys(I7))Object.defineProperty(vR.prototype,n,{get(){return this.data[n]},set(e){this.data[n]=e,!this.noEffect&&Bce()}});fa();class $je{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const Ma=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function e9e(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ma[n&255]+Ma[n>>8&255]+Ma[n>>16&255]+Ma[n>>24&255]+"-"+Ma[e&255]+Ma[e>>8&255]+"-"+Ma[e>>16&15|64]+Ma[e>>24&255]+"-"+Ma[t&63|128]+Ma[t>>8&255]+"-"+Ma[t>>16&255]+Ma[t>>24&255]+Ma[r&255]+Ma[r>>8&255]+Ma[r>>16&255]+Ma[r>>24&255]).toLowerCase()}function lm(n,e,t){return Math.max(e,Math.min(t,n))}class F7{constructor(){F7.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,s,o,a,c,u){const d=this.elements;return d[0]=e,d[1]=i,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=r,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],c=r[6],u=r[1],d=r[4],p=r[7],f=r[2],v=r[5],x=r[8],y=i[0],_=i[3],S=i[6],C=i[1],A=i[4],P=i[7],D=i[2],N=i[5],j=i[8];return s[0]=o*y+a*C+c*D,s[3]=o*_+a*A+c*N,s[6]=o*S+a*P+c*j,s[1]=u*y+d*C+p*D,s[4]=u*_+d*A+p*N,s[7]=u*S+d*P+p*j,s[2]=f*y+v*C+x*D,s[5]=f*_+v*A+x*N,s[8]=f*S+v*P+x*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-r*s*d+r*a*c+i*s*u-i*o*c}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=d*o-a*u,f=a*c-d*s,v=u*s-o*c,x=t*p+r*f+i*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return e[0]=p*y,e[1]=(i*u-d*r)*y,e[2]=(a*r-i*o)*y,e[3]=f*y,e[4]=(d*t-i*c)*y,e[5]=(i*s-a*t)*y,e[6]=v*y,e[7]=(r*c-u*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const c=Math.cos(s),u=Math.sin(s);return this.set(r*c,r*u,-r*(c*o+u*a)+o+e,-i*u,i*c,-i*(-u*o+c*a)+a+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],u=i[4],d=i[7];return i[0]=t*s+r*c,i[3]=t*o+r*u,i[6]=t*a+r*d,i[1]=-r*s+t*c,i[4]=-r*o+t*u,i[7]=-r*a+t*d,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}class yE{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let c=r[i+0],u=r[i+1],d=r[i+2],p=r[i+3];const f=s[o+0],v=s[o+1],x=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p;return}if(a===1){e[t+0]=f,e[t+1]=v,e[t+2]=x,e[t+3]=y;return}if(p!==y||c!==f||u!==v||d!==x){let _=1-a;const S=c*f+u*v+d*x+p*y,C=S>=0?1:-1,A=1-S*S;if(A>Number.EPSILON){const D=Math.sqrt(A),N=Math.atan2(D,S*C);_=Math.sin(_*N)/D,a=Math.sin(a*N)/D}const P=a*C;if(c=c*_+f*P,u=u*_+v*P,d=d*_+x*P,p=p*_+y*P,_===1-a){const D=1/Math.sqrt(c*c+u*u+d*d+p*p);c*=D,u*=D,d*=D,p*=D}}e[t]=c,e[t+1]=u,e[t+2]=d,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],c=r[i+1],u=r[i+2],d=r[i+3],p=s[o],f=s[o+1],v=s[o+2],x=s[o+3];return e[t]=a*x+d*p+c*v-u*f,e[t+1]=c*x+d*f+u*p-a*v,e[t+2]=u*x+d*v+a*f-c*p,e[t+3]=d*x-a*p-c*f-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,u=a(r/2),d=a(i/2),p=a(s/2),f=c(r/2),v=c(i/2),x=c(s/2);switch(o){case"XYZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"YXZ":this._x=f*d*p+u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"ZXY":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p-f*v*x;break;case"ZYX":this._x=f*d*p-u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p+f*v*x;break;case"YZX":this._x=f*d*p+u*v*x,this._y=u*v*p+f*d*x,this._z=u*d*x-f*v*p,this._w=u*d*p-f*v*x;break;case"XZY":this._x=f*d*p-u*v*x,this._y=u*v*p-f*d*x,this._z=u*d*x+f*v*p,this._w=u*d*p+f*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],c=t[9],u=t[2],d=t[6],p=t[10],f=r+a+p;if(f>0){const v=.5/Math.sqrt(f+1);this._w=.25/v,this._x=(d-c)*v,this._y=(s-u)*v,this._z=(o-i)*v}else if(r>a&&r>p){const v=2*Math.sqrt(1+r-a-p);this._w=(d-c)/v,this._x=.25*v,this._y=(i+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-r-p);this._w=(s-u)/v,this._x=(i+o)/v,this._y=.25*v,this._z=(c+d)/v}else{const v=2*Math.sqrt(1+p-r-a);this._w=(o-i)/v,this._x=(s+u)/v,this._y=(c+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(lm(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,c=t._y,u=t._z,d=t._w;return this._x=r*d+o*a+i*u-s*c,this._y=i*d+o*c+s*a-r*u,this._z=s*d+o*u+r*c-i*a,this._w=o*d-r*a-i*c-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*r+t*this._x,this._y=v*i+t*this._y,this._z=v*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(c),d=Math.atan2(u,a),p=Math.sin((1-t)*d)/u,f=Math.sin(t*d)/u;return this._w=o*p+this._w*f,this._x=r*p+this._x*f,this._y=i*p+this._y*f,this._z=s*p+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class vo{constructor(e=0,t=0,r=0){vo.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(lQ.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(lQ.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,c=e.w,u=c*t+o*i-a*r,d=c*r+a*t-s*i,p=c*i+s*r-o*t,f=-s*t-o*r-a*i;return this.x=u*c+f*-s+d*-a-p*-o,this.y=d*c+f*-o+p*-s-u*-a,this.z=p*c+f*-a+u*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=i*c-s*a,this.y=s*o-r*c,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return TF.copy(this).projectOnVector(e),this.sub(TF)}reflect(e){return this.sub(TF.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(lm(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const TF=new vo,lQ=new yE;class jp{constructor(){jp.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,s,o,a,c,u,d,p,f,v,x,y,_){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=i,S[1]=s,S[5]=o,S[9]=a,S[13]=c,S[2]=u,S[6]=d,S[10]=p,S[14]=f,S[3]=v,S[7]=x,S[11]=y,S[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jp().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/ly.setFromMatrixColumn(e,0).length(),s=1/ly.setFromMatrixColumn(e,1).length(),o=1/ly.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),c=Math.cos(i),u=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=-c*p,t[8]=u,t[1]=v+x*u,t[5]=f-y*u,t[9]=-a*c,t[2]=y-f*u,t[6]=x+v*u,t[10]=o*c}else if(e.order==="YXZ"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f+y*a,t[4]=x*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*d,t[9]=-a,t[2]=v*a-x,t[6]=y+f*a,t[10]=o*c}else if(e.order==="ZXY"){const f=c*d,v=c*p,x=u*d,y=u*p;t[0]=f-y*a,t[4]=-o*p,t[8]=x+v*a,t[1]=v+x*a,t[5]=o*d,t[9]=y-f*a,t[2]=-o*u,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const f=o*d,v=o*p,x=a*d,y=a*p;t[0]=c*d,t[4]=x*u-v,t[8]=f*u+y,t[1]=c*p,t[5]=y*u+f,t[9]=v*u-x,t[2]=-u,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=y-f*p,t[8]=x*p+v,t[1]=p,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=v*p+x,t[10]=f-y*p}else if(e.order==="XZY"){const f=o*c,v=o*u,x=a*c,y=a*u;t[0]=c*d,t[4]=-p,t[8]=u*d,t[1]=f*p+y,t[5]=o*d,t[9]=v*p-x,t[2]=x*p-v,t[6]=a*d,t[10]=y*p+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(t9e,e,n9e)}lookAt(e,t,r){const i=this.elements;return dc.subVectors(e,t),dc.lengthSq()===0&&(dc.z=1),dc.normalize(),Jf.crossVectors(r,dc),Jf.lengthSq()===0&&(Math.abs(r.z)===1?dc.x+=1e-4:dc.z+=1e-4,dc.normalize(),Jf.crossVectors(r,dc)),Jf.normalize(),XT.crossVectors(dc,Jf),i[0]=Jf.x,i[4]=XT.x,i[8]=dc.x,i[1]=Jf.y,i[5]=XT.y,i[9]=dc.y,i[2]=Jf.z,i[6]=XT.z,i[10]=dc.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],c=r[8],u=r[12],d=r[1],p=r[5],f=r[9],v=r[13],x=r[2],y=r[6],_=r[10],S=r[14],C=r[3],A=r[7],P=r[11],D=r[15],N=i[0],j=i[4],T=i[8],k=i[12],U=i[1],ee=i[5],xe=i[9],ce=i[13],te=i[2],fe=i[6],ge=i[10],Se=i[14],pe=i[3],se=i[7],ae=i[11],Le=i[15];return s[0]=o*N+a*U+c*te+u*pe,s[4]=o*j+a*ee+c*fe+u*se,s[8]=o*T+a*xe+c*ge+u*ae,s[12]=o*k+a*ce+c*Se+u*Le,s[1]=d*N+p*U+f*te+v*pe,s[5]=d*j+p*ee+f*fe+v*se,s[9]=d*T+p*xe+f*ge+v*ae,s[13]=d*k+p*ce+f*Se+v*Le,s[2]=x*N+y*U+_*te+S*pe,s[6]=x*j+y*ee+_*fe+S*se,s[10]=x*T+y*xe+_*ge+S*ae,s[14]=x*k+y*ce+_*Se+S*Le,s[3]=C*N+A*U+P*te+D*pe,s[7]=C*j+A*ee+P*fe+D*se,s[11]=C*T+A*xe+P*ge+D*ae,s[15]=C*k+A*ce+P*Se+D*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],c=e[9],u=e[13],d=e[2],p=e[6],f=e[10],v=e[14],x=e[3],y=e[7],_=e[11],S=e[15];return x*(+s*c*p-i*u*p-s*a*f+r*u*f+i*a*v-r*c*v)+y*(+t*c*v-t*u*f+s*o*f-i*o*v+i*u*d-s*c*d)+_*(+t*u*p-t*a*v-s*o*p+r*o*v+s*a*d-r*u*d)+S*(-i*a*d-t*c*p+t*a*f+i*o*p-r*o*f+r*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],d=e[8],p=e[9],f=e[10],v=e[11],x=e[12],y=e[13],_=e[14],S=e[15],C=p*_*u-y*f*u+y*c*v-a*_*v-p*c*S+a*f*S,A=x*f*u-d*_*u-x*c*v+o*_*v+d*c*S-o*f*S,P=d*y*u-x*p*u+x*a*v-o*y*v-d*a*S+o*p*S,D=x*p*c-d*y*c-x*a*f+o*y*f+d*a*_-o*p*_,N=t*C+r*A+i*P+s*D;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const j=1/N;return e[0]=C*j,e[1]=(y*f*s-p*_*s-y*i*v+r*_*v+p*i*S-r*f*S)*j,e[2]=(a*_*s-y*c*s+y*i*u-r*_*u-a*i*S+r*c*S)*j,e[3]=(p*c*s-a*f*s-p*i*u+r*f*u+a*i*v-r*c*v)*j,e[4]=A*j,e[5]=(d*_*s-x*f*s+x*i*v-t*_*v-d*i*S+t*f*S)*j,e[6]=(x*c*s-o*_*s-x*i*u+t*_*u+o*i*S-t*c*S)*j,e[7]=(o*f*s-d*c*s+d*i*u-t*f*u-o*i*v+t*c*v)*j,e[8]=P*j,e[9]=(x*p*s-d*y*s-x*r*v+t*y*v+d*r*S-t*p*S)*j,e[10]=(o*y*s-x*a*s+x*r*u-t*y*u-o*r*S+t*a*S)*j,e[11]=(d*a*s-o*p*s-d*r*u+t*p*u+o*r*v-t*a*v)*j,e[12]=D*j,e[13]=(d*y*i-x*p*i+x*r*f-t*y*f-d*r*_+t*p*_)*j,e[14]=(x*a*i-o*y*i-x*r*c+t*y*c+o*r*_-t*a*_)*j,e[15]=(o*p*i-d*a*i+d*r*c-t*p*c-o*r*f+t*a*f)*j,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,c=e.z,u=s*o,d=s*a;return this.set(u*o+r,u*a-i*c,u*c+i*a,0,u*a+i*c,d*a+r,d*c-i*o,0,u*c-i*a,d*c+i*o,s*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,u=s+s,d=o+o,p=a+a,f=s*u,v=s*d,x=s*p,y=o*d,_=o*p,S=a*p,C=c*u,A=c*d,P=c*p,D=r.x,N=r.y,j=r.z;return i[0]=(1-(y+S))*D,i[1]=(v+P)*D,i[2]=(x-A)*D,i[3]=0,i[4]=(v-P)*N,i[5]=(1-(f+S))*N,i[6]=(_+C)*N,i[7]=0,i[8]=(x+A)*j,i[9]=(_-C)*j,i[10]=(1-(f+y))*j,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=ly.set(i[0],i[1],i[2]).length();const o=ly.set(i[4],i[5],i[6]).length(),a=ly.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],qu.copy(this);const u=1/s,d=1/o,p=1/a;return qu.elements[0]*=u,qu.elements[1]*=u,qu.elements[2]*=u,qu.elements[4]*=d,qu.elements[5]*=d,qu.elements[6]*=d,qu.elements[8]*=p,qu.elements[9]*=p,qu.elements[10]*=p,t.setFromRotationMatrix(qu),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o){const a=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),p=(r+i)/(r-i),f=-(o+s)/(o-s),v=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=u,a[9]=p,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=v,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,s,o){const a=this.elements,c=1/(t-e),u=1/(r-i),d=1/(o-s),p=(t+e)*c,f=(r+i)*u,v=(o+s)*d;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-p,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-v,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const ly=new vo,qu=new jp,t9e=new vo(0,0,0),n9e=new vo(1,1,1),Jf=new vo,XT=new vo,dc=new vo,cQ=new jp,uQ=new yE;class xE{constructor(e=0,t=0,r=0,i=xE.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],c=i[1],u=i[5],d=i[9],p=i[2],f=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(lm(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-lm(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(lm(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-lm(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(f,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(lm(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-lm(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return cQ.makeRotationFromQuaternion(e),this.setFromRotationMatrix(cQ,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return uQ.setFromEuler(this),this.setFromQuaternion(uQ,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}xE.DefaultOrder="XYZ";xE.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class r9e{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let i9e=0;const hQ=new vo,cy=new yE,bp=new jp,qT=new vo,VS=new vo,s9e=new vo,o9e=new yE,dQ=new vo(1,0,0),pQ=new vo(0,1,0),fQ=new vo(0,0,1),a9e={type:"added"},mQ={type:"removed"};class Sm extends $je{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:i9e++}),this.uuid=e9e(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Sm.DefaultUp.clone();const e=new vo,t=new xE,r=new yE,i=new vo(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new jp},normalMatrix:{value:new F7}}),this.matrix=new jp,this.matrixWorld=new jp,this.matrixAutoUpdate=Sm.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Sm.DefaultMatrixWorldAutoUpdate,this.layers=new r9e,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return cy.setFromAxisAngle(e,t),this.quaternion.multiply(cy),this}rotateOnWorldAxis(e,t){return cy.setFromAxisAngle(e,t),this.quaternion.premultiply(cy),this}rotateX(e){return this.rotateOnAxis(dQ,e)}rotateY(e){return this.rotateOnAxis(pQ,e)}rotateZ(e){return this.rotateOnAxis(fQ,e)}translateOnAxis(e,t){return hQ.copy(e).applyQuaternion(this.quaternion),this.position.add(hQ.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(dQ,e)}translateY(e){return this.translateOnAxis(pQ,e)}translateZ(e){return this.translateOnAxis(fQ,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(bp.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?qT.copy(e):qT.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),VS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bp.lookAt(VS,qT,this.up):bp.lookAt(qT,VS,this.up),this.quaternion.setFromRotationMatrix(bp),i&&(bp.extractRotation(i.matrixWorld),cy.setFromRotationMatrix(bp),this.quaternion.premultiply(cy.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(a9e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(mQ)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(mQ)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),bp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),bp.multiply(e.parent.matrixWorld)),e.applyMatrix4(bp),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(VS,e,s9e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(VS,o9e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++){const p=c[u];s(e.shapes,p)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,u=this.material.length;c<u;c++)a.push(s(e.materials,this.material[c]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];i.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),u=o(e.textures),d=o(e.images),p=o(e.shapes),f=o(e.skeletons),v=o(e.animations),x=o(e.nodes);a.length>0&&(r.geometries=a),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),f.length>0&&(r.skeletons=f),v.length>0&&(r.animations=v),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(a){const c=[];for(const u in a){const d=a[u];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Sm.DefaultUp=new vo(0,1,0);Sm.DefaultMatrixAutoUpdate=!0;Sm.DefaultMatrixWorldAutoUpdate=!0;new Sm;yn(()=>{gl()||qp()&&mn()},[gl,qp,mn]);const l9e={...Ib,color:String,intensity:Number,shadowResolution:Number,shadowBias:Number,helper:Boolean},c9e={...Nb,color:"#ffffff",intensity:1,shadowResolution:new ki(256),shadowBias:new ki(Ule),helper:!0},u9e={...l9e},h9e={...c9e};VD(async()=>{const{RectAreaLightUniformsLib:n}=await rr(()=>import("./RectAreaLightUniformsLib.9a4068c8.js"),[]);n.init()});var d9e={},fd={};Object.defineProperty(fd,"__esModule",{value:!0});fd.BladeApi=void 0;var p9e=function(){function n(e){this.controller_=e}return Object.defineProperty(n.prototype,"element",{get:function(){return this.controller_.view.element},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this.controller_.viewProps.get("disabled")},set:function(e){this.controller_.viewProps.set("disabled",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this.controller_.viewProps.get("hidden")},set:function(e){this.controller_.viewProps.set("hidden",e)},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.controller_.viewProps.set("disposed",!0)},n}();fd.BladeApi=p9e;var lue={};Object.defineProperty(lue,"__esModule",{value:!0});var cue={};Object.defineProperty(cue,"__esModule",{value:!0});var Lo={},a4=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Lo,"__esModule",{value:!0});Lo.TpTabSelectEvent=Lo.TpFoldEvent=Lo.TpUpdateEvent=Lo.TpChangeEvent=Lo.TpEvent=void 0;var bE=function(){function n(e){this.target=e}return n}();Lo.TpEvent=bE;var f9e=function(n){a4(e,n);function e(t,r,i,s){var o=n.call(this,t)||this;return o.value=r,o.presetKey=i,o.last=s!=null?s:!0,o}return e}(bE);Lo.TpChangeEvent=f9e;var m9e=function(n){a4(e,n);function e(t,r,i){var s=n.call(this,t)||this;return s.value=r,s.presetKey=i,s}return e}(bE);Lo.TpUpdateEvent=m9e;var v9e=function(n){a4(e,n);function e(t,r){var i=n.call(this,t)||this;return i.expanded=r,i}return e}(bE);Lo.TpFoldEvent=v9e;var g9e=function(n){a4(e,n);function e(t,r){var i=n.call(this,t)||this;return i.index=r,i}return e}(bE);Lo.TpTabSelectEvent=g9e;var wE={},Fl={},Gn={};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.deepEqualsArray=Gn.isEmpty=Gn.forceCast=void 0;function _9e(n){return n}Gn.forceCast=_9e;function y9e(n){return n==null}Gn.isEmpty=y9e;function x9e(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}Gn.deepEqualsArray=x9e;Object.defineProperty(Fl,"__esModule",{value:!0});Fl.TpError=void 0;var b9e=Gn,w9e={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(n){return"Invalid parameters for '"+n.name+"'"},nomatchingcontroller:function(n){return"No matching controller for '"+n.key+"'"},nomatchingview:function(n){return"No matching view for '"+JSON.stringify(n.params)+"'"},notbindable:function(){return"Value is not bindable"},propertynotfound:function(n){return"Property '"+n.name+"' not found"},shouldneverhappen:function(){return"This error should never happen"}},S9e=function(){function n(e){var t;this.message=(t=w9e[e.type]((0,b9e.forceCast)(e.context)))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return n.alreadyDisposed=function(){return new n({type:"alreadydisposed"})},n.notBindable=function(){return new n({type:"notbindable"})},n.propertyNotFound=function(e){return new n({type:"propertynotfound",context:{name:e}})},n.shouldNeverHappen=function(){return new n({type:"shouldneverhappen"})},n}();Fl.TpError=S9e;Object.defineProperty(wE,"__esModule",{value:!0});wE.BindingTarget=void 0;var vQ=Fl,M9e=function(){function n(e,t,r){this.obj_=e,this.key_=t,this.presetKey_=r!=null?r:t}return n.isBindable=function(e){return!(e===null||typeof e!="object")},Object.defineProperty(n.prototype,"key",{get:function(){return this.key_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"presetKey",{get:function(){return this.presetKey_},enumerable:!1,configurable:!0}),n.prototype.read=function(){return this.obj_[this.key_]},n.prototype.write=function(e){this.obj_[this.key_]=e},n.prototype.writeProperty=function(e,t){var r=this.read();if(!n.isBindable(r))throw vQ.TpError.notBindable();if(!(e in r))throw vQ.TpError.propertyNotFound(e);r[e]=t},n}();wE.BindingTarget=M9e;var SE={},C9e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(SE,"__esModule",{value:!0});SE.ButtonApi=void 0;var E9e=fd,A9e=Lo,P9e=function(n){C9e(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var t;return(t=this.controller_.valueController.props.get("title"))!==null&&t!==void 0?t:""},set:function(t){this.controller_.valueController.props.set("title",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=this,s=r.bind(this),o=this.controller_.valueController.emitter;return o.on(t,function(){s(new A9e.TpEvent(i))}),this},e}(E9e.BladeApi);SE.ButtonApi=P9e;var ME={},Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.Emitter=void 0;var T9e=function(){function n(){this.observers_={}}return n.prototype.on=function(e,t){var r=this.observers_[e];return r||(r=this.observers_[e]=[]),r.push({handler:t}),this},n.prototype.off=function(e,t){var r=this.observers_[e];return r&&(this.observers_[e]=r.filter(function(i){return i.handler!==t})),this},n.prototype.emit=function(e,t){var r=this.observers_[e];!r||r.forEach(function(i){i.handler(t)})},n}();Ps.Emitter=T9e;var CE={},fr={};Object.defineProperty(fr,"__esModule",{value:!0});fr.ClassName=void 0;var R9e="tp";function O9e(n){var e=function(t,r){return[R9e,"-",n,"v",t?"_"+t:"",r?"-"+r:""].join("")};return e}fr.ClassName=O9e;var zl={},go={};Object.defineProperty(go,"__esModule",{value:!0});go.bindValueMap=go.bindValue=void 0;function L9e(n,e){return function(t){return e(n(t))}}function D9e(n){return n.rawValue}function uue(n,e){n.emitter.on("change",L9e(D9e,e)),e(n.rawValue)}go.bindValue=uue;function I9e(n,e,t){uue(n.value(e),t)}go.bindValueMap=I9e;Object.defineProperty(zl,"__esModule",{value:!0});zl.bindValueToTextContent=zl.valueToClassName=void 0;var N9e=go;function k9e(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function z9e(n,e){return function(t){k9e(n,e,t)}}zl.valueToClassName=z9e;function B9e(n,e){(0,N9e.bindValue)(n,function(t){e.textContent=t!=null?t:""})}zl.bindValueToTextContent=B9e;Object.defineProperty(CE,"__esModule",{value:!0});CE.ButtonView=void 0;var V9e=fr,F9e=zl,RF=(0,V9e.ClassName)("btn"),U9e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(RF()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("button");r.classList.add(RF("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var i=e.createElement("div");i.classList.add(RF("t")),(0,F9e.bindValueToTextContent)(t.props.value("title"),i),this.buttonElement.appendChild(i)}return n}();CE.ButtonView=U9e;Object.defineProperty(ME,"__esModule",{value:!0});ME.ButtonController=void 0;var j9e=Ps,H9e=CE,W9e=function(){function n(e,t){this.emitter=new j9e.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new H9e.ButtonView(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();ME.ButtonController=W9e;var EE={},es={},yl={},l4={};Object.defineProperty(l4,"__esModule",{value:!0});l4.BoundValue=void 0;var G9e=Ps,X9e=function(){function n(e,t){var r;this.constraint_=t==null?void 0:t.constraint,this.equals_=(r=t==null?void 0:t.equals)!==null&&r!==void 0?r:function(i,s){return i===s},this.emitter=new G9e.Emitter,this.rawValue_=e}return Object.defineProperty(n.prototype,"constraint",{get:function(){return this.constraint_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.rawValue_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var r=t!=null?t:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=!this.equals_(this.rawValue_,i);!s&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:r,rawValue:i,sender:this}))},n}();l4.BoundValue=X9e;var c4={};Object.defineProperty(c4,"__esModule",{value:!0});c4.PrimitiveValue=void 0;var q9e=Ps,Y9e=function(){function n(e){this.emitter=new q9e.Emitter,this.value_=e}return Object.defineProperty(n.prototype,"rawValue",{get:function(){return this.value_},set:function(e){this.setRawValue(e,{forceEmit:!1,last:!0})},enumerable:!1,configurable:!0}),n.prototype.setRawValue=function(e,t){var r=t!=null?t:{forceEmit:!1,last:!0};this.value_===e&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:r,rawValue:this.value_,sender:this}))},n}();c4.PrimitiveValue=Y9e;Object.defineProperty(yl,"__esModule",{value:!0});yl.createValue=void 0;var Z9e=l4,K9e=c4;function J9e(n,e){var t=e==null?void 0:e.constraint,r=e==null?void 0:e.equals;return!t&&!r?new K9e.PrimitiveValue(n):new Z9e.BoundValue(n,e)}yl.createValue=J9e;Object.defineProperty(es,"__esModule",{value:!0});es.ValueMap=void 0;var Q9e=Ps,$9e=yl,eHe=function(){function n(e){var t=this;this.emitter=new Q9e.Emitter,this.valMap_=e;var r=function(o){var a=i.valMap_[o];a.emitter.on("change",function(){t.emitter.emit("change",{key:o,sender:t})})},i=this;for(var s in this.valMap_)r(s)}return n.createCore=function(e){var t=Object.keys(e);return t.reduce(function(r,i){var s;return Object.assign(r,(s={},s[i]=(0,$9e.createValue)(e[i]),s))},{})},n.fromObject=function(e){var t=this.createCore(e);return new n(t)},n.prototype.get=function(e){return this.valMap_[e].rawValue},n.prototype.set=function(e,t){this.valMap_[e].rawValue=t},n.prototype.value=function(e){return this.valMap_[e]},n}();es.ValueMap=eHe;var Ws={};(function(n){var e=Ct&&Ct.__assign||function(){return e=Object.assign||function(d){for(var p,f=1,v=arguments.length;f<v;f++){p=arguments[f];for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(d[x]=p[x])}return d},e.apply(this,arguments)},t=Ct&&Ct.__spreadArray||function(d,p,f){if(f||arguments.length===2)for(var v=0,x=p.length,y;v<x;v++)(y||!(v in p))&&(y||(y=Array.prototype.slice.call(p,0,v)),y[v]=p[v]);return d.concat(y||Array.prototype.slice.call(p))};Object.defineProperty(n,"__esModule",{value:!0}),n.parseParams=n.ParamsParsers=void 0;var r=Gn;function i(d,p){var f=Object.keys(p),v=f.reduce(function(x,y){var _;if(x!==void 0){var S=p[y],C=S(d[y]);return C.succeeded?e(e({},x),(_={},_[y]=C.value,_)):void 0}},{});return(0,r.forceCast)(v)}function s(d,p){return d.reduce(function(f,v){if(f!==void 0){var x=p(v);if(!(!x.succeeded||x.value===void 0))return t(t([],f,!0),[x.value],!1)}},[])}function o(d){return d===null?!1:typeof d=="object"}function a(d){return function(p){return function(f){if(!p&&f===void 0)return{succeeded:!1,value:void 0};if(p&&f===void 0)return{succeeded:!0,value:void 0};var v=d(f);return v!==void 0?{succeeded:!0,value:v}:{succeeded:!1,value:void 0}}}}function c(d){return{custom:function(p){return a(p)(d)},boolean:a(function(p){return typeof p=="boolean"?p:void 0})(d),number:a(function(p){return typeof p=="number"?p:void 0})(d),string:a(function(p){return typeof p=="string"?p:void 0})(d),function:a(function(p){return typeof p=="function"?p:void 0})(d),constant:function(p){return a(function(f){return f===p?p:void 0})(d)},raw:a(function(p){return p})(d),object:function(p){return a(function(f){if(!!o(f))return i(f,p)})(d)},array:function(p){return a(function(f){if(!!Array.isArray(f))return s(f,p)})(d)}}}n.ParamsParsers={optional:c(!0),required:c(!1)};function u(d,p){var f=n.ParamsParsers.required.object(p)(d);return f.succeeded?f.value:void 0}n.parseParams=u})(Ws);var j0={},af={},u4={};Object.defineProperty(u4,"__esModule",{value:!0});u4.disposeElement=void 0;function tHe(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}u4.disposeElement=tHe;var AE={};Object.defineProperty(AE,"__esModule",{value:!0});AE.getAllBladePositions=void 0;function nHe(){return["veryfirst","first","last","verylast"]}AE.getAllBladePositions=nHe;Object.defineProperty(af,"__esModule",{value:!0});af.BladeController=void 0;var rHe=u4,iHe=fr,sHe=AE,gQ=(0,iHe.ClassName)(""),_Q={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},oHe=function(){function n(e){var t=this;this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var r=this.view.element;this.blade.value("positions").emitter.on("change",function(){(0,sHe.getAllBladePositions)().forEach(function(i){r.classList.remove(gQ(void 0,_Q[i]))}),t.blade.get("positions").forEach(function(i){r.classList.add(gQ(void 0,_Q[i]))})}),this.viewProps.handleDispose(function(){(0,rHe.disposeElement)(r)})}return Object.defineProperty(n.prototype,"parent",{get:function(){return this.parent_},enumerable:!1,configurable:!0}),n}();af.BladeController=oHe;var zb={},ma={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.findNextTarget=n.indexOfChildElement=n.removeChildNodes=n.removeChildElements=n.removeElement=n.insertElementAt=n.createSvgIconElement=n.getCanvasContext=n.getWindowDocument=n.supportsTouch=n.disableTransitionTemporarily=n.forceReflow=n.SVG_NS=void 0;var e=Gn;n.SVG_NS="http://www.w3.org/2000/svg";function t(_){_.offsetHeight}n.forceReflow=t;function r(_,S){var C=_.style.transition;_.style.transition="none",S(),_.style.transition=C}n.disableTransitionTemporarily=r;function i(_){return _.ontouchstart!==void 0}n.supportsTouch=i;function s(){return new Function("return this")()}function o(){var _=(0,e.forceCast)(s());return _.document}n.getWindowDocument=o;function a(_){var S=_.ownerDocument.defaultView;if(!S)return null;var C="document"in S;return C?_.getContext("2d"):null}n.getCanvasContext=a;var c={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function u(_,S){var C=_.createElementNS(n.SVG_NS,"svg");return C.innerHTML=c[S],C}n.createSvgIconElement=u;function d(_,S,C){_.insertBefore(S,_.children[C])}n.insertElementAt=d;function p(_){_.parentElement&&_.parentElement.removeChild(_)}n.removeElement=p;function f(_){for(;_.children.length>0;)_.removeChild(_.children[0])}n.removeChildElements=f;function v(_){for(;_.childNodes.length>0;)_.removeChild(_.childNodes[0])}n.removeChildNodes=v;function x(_){var S=_.parentElement;if(!S)return-1;var C=Array.prototype.slice.call(S.children);return C.indexOf(_)}n.indexOfChildElement=x;function y(_){return _.relatedTarget?(0,e.forceCast)(_.relatedTarget):"explicitOriginalTarget"in _?_.explicitOriginalTarget:null}n.findNextTarget=y})(ma);Object.defineProperty(zb,"__esModule",{value:!0});zb.LabelView=void 0;var aHe=ma,lHe=go,cHe=fr,uHe=Gn,FS=(0,cHe.ClassName)("lbl");function hHe(n,e){var t=n.createDocumentFragment(),r=e.split(`
`).map(function(i){return n.createTextNode(i)});return r.forEach(function(i,s){s>0&&t.appendChild(n.createElement("br")),t.appendChild(i)}),t}var dHe=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(FS()),t.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(FS("l")),(0,lHe.bindValueMap)(t.props,"label",function(o){(0,uHe.isEmpty)(o)?r.element.classList.add(FS(void 0,"nol")):(r.element.classList.remove(FS(void 0,"nol")),(0,aHe.removeChildNodes)(i),i.appendChild(hHe(e,o)))}),this.element.appendChild(i),this.labelElement=i;var s=e.createElement("div");s.classList.add(FS("v")),this.element.appendChild(s),this.valueElement=s}return n}();zb.LabelView=dHe;var pHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),HO=Ct&&Ct.__assign||function(){return HO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},HO.apply(this,arguments)};Object.defineProperty(j0,"__esModule",{value:!0});j0.LabelController=void 0;var fHe=af,mHe=zb,vHe=function(n){pHe(e,n);function e(t,r){var i=this,s=r.valueController.viewProps;return i=n.call(this,HO(HO({},r),{view:new mHe.LabelView(t,{props:r.props,viewProps:s}),viewProps:s}))||this,i.props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return e}(fHe.BladeController);j0.LabelController=vHe;Object.defineProperty(EE,"__esModule",{value:!0});EE.ButtonBladePlugin=void 0;var yQ=es,xQ=Ws,bQ=j0,gHe=SE,wQ=ME;EE.ButtonBladePlugin={id:"button",type:"blade",accept:function(n){var e=xQ.ParamsParsers,t=(0,xQ.parseParams)(n,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return t?{params:t}:null},controller:function(n){return new bQ.LabelController(n.document,{blade:n.blade,props:yQ.ValueMap.fromObject({label:n.params.label}),valueController:new wQ.ButtonController(n.document,{props:yQ.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api:function(n){return!(n.controller instanceof bQ.LabelController)||!(n.controller.valueController instanceof wQ.ButtonController)?null:new gHe.ButtonApi(n.controller)}};var H0={},_He=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(H0,"__esModule",{value:!0});H0.ValueBladeController=void 0;var yHe=af,xHe=function(n){_He(e,n);function e(t){var r=n.call(this,t)||this;return r.value=t.value,r}return e}(yHe.BladeController);H0.ValueBladeController=xHe;var rv={};Object.defineProperty(rv,"__esModule",{value:!0});rv.createBlade=void 0;var bHe=es,wHe=yl,SHe=Gn;function MHe(){return new bHe.ValueMap({positions:(0,wHe.createValue)([],{equals:SHe.deepEqualsArray})})}rv.createBlade=MHe;var cl={},CHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(cl,"__esModule",{value:!0});cl.bindFoldable=cl.getFoldableStyleHeight=cl.getFoldableStyleExpanded=cl.createFoldable=cl.Foldable=void 0;var gR=ma,SQ=go,MQ=es,hue=Gn,due=function(n){CHe(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var r={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=MQ.ValueMap.createCore(r);return new e(i)},Object.defineProperty(e.prototype,"styleExpanded",{get:function(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"styleHeight",{get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!(0,hue.isEmpty)(t)?t+"px":"auto"},enumerable:!1,configurable:!0}),e.prototype.bindExpandedClass=function(t,r){var i=this,s=function(){var o=i.styleExpanded;o?t.classList.add(r):t.classList.remove(r)};(0,SQ.bindValueMap)(this,"expanded",s),(0,SQ.bindValueMap)(this,"temporaryExpanded",s)},e.prototype.cleanUpTransition=function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)},e}(MQ.ValueMap);cl.Foldable=due;function EHe(n){return due.create(n)}cl.createFoldable=EHe;function AHe(n,e){var t=0;return(0,gR.disableTransitionTemporarily)(e,function(){n.set("expandedHeight",null),n.set("temporaryExpanded",!0),(0,gR.forceReflow)(e),t=e.clientHeight,n.set("temporaryExpanded",null),(0,gR.forceReflow)(e)}),t}function PHe(n){return n.styleExpanded}cl.getFoldableStyleExpanded=PHe;function THe(n){return n.styleHeight}cl.getFoldableStyleHeight=THe;function CQ(n,e){e.style.height=n.styleHeight}function RHe(n,e){n.value("expanded").emitter.on("beforechange",function(){n.set("completed",!1),(0,hue.isEmpty)(n.get("expandedHeight"))&&n.set("expandedHeight",AHe(n,e)),n.set("shouldFixHeight",!0),(0,gR.forceReflow)(e)}),n.emitter.on("change",function(){CQ(n,e)}),CQ(n,e),e.addEventListener("transitionend",function(t){t.propertyName==="height"&&n.cleanUpTransition()})}cl.bindFoldable=RHe;var PE={},Bb={},OHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Bb,"__esModule",{value:!0});Bb.RackLikeApi=void 0;var LHe=fd,DHe=function(n){OHe(e,n);function e(t,r){var i=n.call(this,t)||this;return i.rackApi_=r,i}return e}(LHe.BladeApi);Bb.RackLikeApi=DHe;var Bm={},Gh={},id=Ct&&Ct.__assign||function(){return id=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},id.apply(this,arguments)};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.addTabAsBlade=Gh.addSeparatorAsBlade=Gh.addFolderAsBlade=Gh.addButtonAsBlade=void 0;function IHe(n,e){return n.addBlade(id(id({},e),{view:"button"}))}Gh.addButtonAsBlade=IHe;function NHe(n,e){return n.addBlade(id(id({},e),{view:"folder"}))}Gh.addFolderAsBlade=NHe;function kHe(n,e){var t=e!=null?e:{};return n.addBlade(id(id({},t),{view:"separator"}))}Gh.addSeparatorAsBlade=kHe;function zHe(n,e){return n.addBlade(id(id({},e),{view:"tab"}))}Gh.addTabAsBlade=zHe;var Vb={};Object.defineProperty(Vb,"__esModule",{value:!0});Vb.NestedOrderedSet=void 0;var BHe=Ps,VHe=Fl,FHe=function(){function n(e){this.emitter=new BHe.Emitter,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return Object.defineProperty(n.prototype,"items",{get:function(){return this.items_},enumerable:!1,configurable:!0}),n.prototype.allItems=function(){return Array.from(this.cache_)},n.prototype.find=function(e){for(var t=0,r=this.allItems();t<r.length;t++){var i=r[t];if(e(i))return i}return null},n.prototype.includes=function(e){return this.cache_.has(e)},n.prototype.add=function(e,t){var r=this;if(this.includes(e))throw VHe.TpError.shouldNeverHappen();var i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);var s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(function(o){r.cache_.add(o)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})},n.prototype.remove=function(e){var t=this.items_.indexOf(e);if(!(t<0)){this.items_.splice(t,1),this.cache_.delete(e);var r=this.extract_(e);r&&(r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}},n.prototype.onSubListAdd_=function(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})},n.prototype.onSubListRemove_=function(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})},n}();Vb.NestedOrderedSet=FHe;var Fb={},UHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Fb,"__esModule",{value:!0});Fb.InputBindingApi=void 0;var jHe=Ps,HHe=Gn,WHe=fd,GHe=Lo,XHe=function(n){UHe(e,n);function e(t){var r=n.call(this,t)||this;return r.onBindingChange_=r.onBindingChange_.bind(r),r.emitter_=new jHe.Emitter,r.controller_.binding.emitter.on("change",r.onBindingChange_),r}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingChange_=function(t){var r=t.sender.target.read();this.emitter_.emit("change",{event:new GHe.TpChangeEvent(this,(0,HHe.forceCast)(r),this.controller_.binding.target.presetKey,t.options.last)})},e}(WHe.BladeApi);Fb.InputBindingApi=XHe;var iv={},qHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(iv,"__esModule",{value:!0});iv.InputBindingController=void 0;var YHe=j0,ZHe=function(n){qHe(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.binding=r.binding,i}return e}(YHe.LabelController);iv.InputBindingController=ZHe;var Ub={},KHe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Ub,"__esModule",{value:!0});Ub.MonitorBindingApi=void 0;var JHe=Ps,QHe=Gn,$He=fd,e7e=Lo,t7e=function(n){KHe(e,n);function e(t){var r=n.call(this,t)||this;return r.onBindingUpdate_=r.onBindingUpdate_.bind(r),r.emitter_=new JHe.Emitter,r.controller_.binding.emitter.on("update",r.onBindingUpdate_),r}return Object.defineProperty(e.prototype,"label",{get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.refresh=function(){this.controller_.binding.read()},e.prototype.onBindingUpdate_=function(t){var r=t.sender.target.read();this.emitter_.emit("update",{event:new e7e.TpUpdateEvent(this,(0,QHe.forceCast)(r),this.controller_.binding.target.presetKey)})},e}($He.BladeApi);Ub.MonitorBindingApi=t7e;var sv={},n7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(sv,"__esModule",{value:!0});sv.MonitorBindingController=void 0;var r7e=j0,i7e=function(n){n7e(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.binding=r.binding,i.viewProps.bindDisabled(i.binding.ticker),i.viewProps.handleDispose(function(){i.binding.dispose()}),i}return e}(r7e.LabelController);sv.MonitorBindingController=i7e;var s7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Bm,"__esModule",{value:!0});Bm.RackApi=Bm.findSubBladeApiSet=void 0;var EQ=wE,o7e=Ps,U7=Fl,OF=Gn,a7e=fd,YT=Gh,l7e=Bb,LF=Lo,c7e=H0,u7e=Vb,h7e=Fb,d7e=iv,p7e=Ub,f7e=sv;function pue(n){return n instanceof fue?n.apiSet_:n instanceof l7e.RackLikeApi?n.rackApi_.apiSet_:null}Bm.findSubBladeApiSet=pue;function US(n,e){var t=n.find(function(r){return r.controller_===e});if(!t)throw U7.TpError.shouldNeverHappen();return t}function AQ(n,e,t){if(!EQ.BindingTarget.isBindable(n))throw U7.TpError.notBindable();return new EQ.BindingTarget(n,e,t)}var fue=function(n){s7e(e,n);function e(t,r){var i=n.call(this,t)||this;i.onRackAdd_=i.onRackAdd_.bind(i),i.onRackRemove_=i.onRackRemove_.bind(i),i.onRackInputChange_=i.onRackInputChange_.bind(i),i.onRackMonitorUpdate_=i.onRackMonitorUpdate_.bind(i),i.emitter_=new o7e.Emitter,i.apiSet_=new u7e.NestedOrderedSet(pue),i.pool_=r;var s=i.controller_.rack;return s.emitter.on("add",i.onRackAdd_),s.emitter.on("remove",i.onRackRemove_),s.emitter.on("inputchange",i.onRackInputChange_),s.emitter.on("monitorupdate",i.onRackMonitorUpdate_),s.children.forEach(function(o){i.setUpApi_(o)}),i}return Object.defineProperty(e.prototype,"children",{get:function(){var t=this;return this.controller_.rack.children.map(function(r){return US(t.apiSet_,r)})},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,r,i){var s=i!=null?i:{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createInput(o,AQ(t,r,s.presetKey),s),c=new h7e.InputBindingApi(a);return this.add(c,s.index)},e.prototype.addMonitor=function(t,r,i){var s=i!=null?i:{},o=this.controller_.view.element.ownerDocument,a=this.pool_.createMonitor(o,AQ(t,r),s),c=new p7e.MonitorBindingApi(a);return(0,OF.forceCast)(this.add(c,s.index))},e.prototype.addFolder=function(t){return(0,YT.addFolderAsBlade)(this,t)},e.prototype.addButton=function(t){return(0,YT.addButtonAsBlade)(this,t)},e.prototype.addSeparator=function(t){return(0,YT.addSeparatorAsBlade)(this,t)},e.prototype.addTab=function(t){return(0,YT.addTabAsBlade)(this,t)},e.prototype.add=function(t,r){this.controller_.rack.add(t.controller_,r);var i=this.apiSet_.find(function(s){return s.controller_===t.controller_});return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t},e.prototype.remove=function(t){this.controller_.rack.remove(t.controller_)},e.prototype.addBlade=function(t){var r=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(r,t),s=this.pool_.createBladeApi(i);return this.add(s,t.index)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.setUpApi_=function(t){var r=this.apiSet_.find(function(i){return i.controller_===t});r||this.apiSet_.add(this.pool_.createBladeApi(t))},e.prototype.onRackAdd_=function(t){this.setUpApi_(t.bladeController)},e.prototype.onRackRemove_=function(t){if(t.isRoot){var r=US(this.apiSet_,t.bladeController);this.apiSet_.remove(r)}},e.prototype.onRackInputChange_=function(t){var r=t.bladeController;if(r instanceof d7e.InputBindingController){var i=US(this.apiSet_,r),s=r.binding;this.emitter_.emit("change",{event:new LF.TpChangeEvent(i,(0,OF.forceCast)(s.target.read()),s.target.presetKey,t.options.last)})}else if(r instanceof c7e.ValueBladeController){var i=US(this.apiSet_,r);this.emitter_.emit("change",{event:new LF.TpChangeEvent(i,r.value.rawValue,void 0,t.options.last)})}},e.prototype.onRackMonitorUpdate_=function(t){if(!(t.bladeController instanceof f7e.MonitorBindingController))throw U7.TpError.shouldNeverHappen();var r=US(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new LF.TpUpdateEvent(r,(0,OF.forceCast)(i.target.read()),i.target.presetKey)})},e}(a7e.BladeApi);Bm.RackApi=fue;var m7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(PE,"__esModule",{value:!0});PE.FolderApi=void 0;var v7e=Ps,g7e=Bb,_7e=Lo,y7e=Bm,x7e=function(n){m7e(e,n);function e(t,r){var i=n.call(this,t,new y7e.RackApi(t.rackController,r))||this;return i.emitter_=new v7e.Emitter,i.controller_.foldable.value("expanded").emitter.on("change",function(s){i.emitter_.emit("fold",{event:new _7e.TpFoldEvent(i,s.sender.rawValue)})}),i.rackApi_.on("change",function(s){i.emitter_.emit("change",{event:s})}),i.rackApi_.on("update",function(s){i.emitter_.emit("update",{event:s})}),i}return Object.defineProperty(e.prototype,"expanded",{get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),e.prototype.addInput=function(t,r,i){return this.rackApi_.addInput(t,r,i)},e.prototype.addMonitor=function(t,r,i){return this.rackApi_.addMonitor(t,r,i)},e.prototype.addFolder=function(t){return this.rackApi_.addFolder(t)},e.prototype.addButton=function(t){return this.rackApi_.addButton(t)},e.prototype.addSeparator=function(t){return this.rackApi_.addSeparator(t)},e.prototype.addTab=function(t){return this.rackApi_.addTab(t)},e.prototype.add=function(t,r){return this.rackApi_.add(t,r)},e.prototype.remove=function(t){this.rackApi_.remove(t)},e.prototype.addBlade=function(t){return this.rackApi_.addBlade(t)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e}(g7e.RackLikeApi);PE.FolderApi=x7e;var TE={},jb={},b7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(jb,"__esModule",{value:!0});jb.RackLikeController=void 0;var w7e=af,S7e=function(n){b7e(e,n);function e(t){var r=n.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})||this;return r.rackController=t.rackController,r}return e}(w7e.BladeController);jb.RackLikeController=S7e;var jS={},RE={};Object.defineProperty(RE,"__esModule",{value:!0});RE.PlainView=void 0;var M7e=fr,C7e=function(){function n(e,t){var r=(0,M7e.ClassName)(t.viewName);this.element=e.createElement("div"),this.element.classList.add(r()),t.viewProps.bindClassModifiers(this.element)}return n}();RE.PlainView=C7e;var HS={},PQ;function E7e(){if(PQ)return HS;PQ=1,Object.defineProperty(HS,"__esModule",{value:!0}),HS.BladeRack=void 0;var n=Ps,e=Fl,t=Gn,r=iv,i=sv,s=OE(),o=jb,a=H0,c=Vb;function u(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof r.InputBindingController&&C.binding===_)return C}return null}function d(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof i.MonitorBindingController&&C.binding===_)return C}return null}function p(y,_){for(var S=0;S<y.length;S++){var C=y[S];if(C instanceof a.ValueBladeController&&C.value===_)return C}return null}function f(y){return y instanceof s.RackController?y.rack:y instanceof o.RackLikeController?y.rackController.rack:null}function v(y){var _=f(y);return _?_.bcSet_:null}var x=function(){function y(_){var S;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new n.Emitter,this.blade_=_!=null?_:null,(S=this.blade_)===null||S===void 0||S.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new c.NestedOrderedSet(v),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return Object.defineProperty(y.prototype,"children",{get:function(){return this.bcSet_.items},enumerable:!1,configurable:!0}),y.prototype.add=function(_,S){_.parent&&_.parent.remove(_),_.parent_=this,this.bcSet_.add(_,S)},y.prototype.remove=function(_){_.parent_=null,this.bcSet_.remove(_)},y.prototype.find=function(_){return(0,t.forceCast)(this.bcSet_.allItems().filter(function(S){return S instanceof _}))},y.prototype.onSetAdd_=function(_){this.updatePositions_();var S=_.target===_.root;if(this.emitter.emit("add",{bladeController:_.item,index:_.index,isRoot:S,sender:this}),!!S){var C=_.item;if(C.viewProps.emitter.on("change",this.onChildViewPropsChange_),C.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),C.viewProps.handleDispose(this.onChildDispose_),C instanceof r.InputBindingController)C.binding.emitter.on("change",this.onChildInputChange_);else if(C instanceof i.MonitorBindingController)C.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(C instanceof a.ValueBladeController)C.value.emitter.on("change",this.onChildValueChange_);else{var A=f(C);if(A){var P=A.emitter;P.on("layout",this.onDescendantLayout_),P.on("inputchange",this.onDescendantInputChange_),P.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}},y.prototype.onSetRemove_=function(_){this.updatePositions_();var S=_.target===_.root;if(this.emitter.emit("remove",{bladeController:_.item,isRoot:S,sender:this}),!!S){var C=_.item;if(C instanceof r.InputBindingController)C.binding.emitter.off("change",this.onChildInputChange_);else if(C instanceof i.MonitorBindingController)C.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(C instanceof a.ValueBladeController)C.value.emitter.off("change",this.onChildValueChange_);else{var A=f(C);if(A){var P=A.emitter;P.off("layout",this.onDescendantLayout_),P.off("inputchange",this.onDescendantInputChange_),P.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}},y.prototype.updatePositions_=function(){var _=this,S=this.bcSet_.items.filter(function(P){return!P.viewProps.get("hidden")}),C=S[0],A=S[S.length-1];this.bcSet_.items.forEach(function(P){var D=[];P===C&&(D.push("first"),(!_.blade_||_.blade_.get("positions").includes("veryfirst"))&&D.push("veryfirst")),P===A&&(D.push("last"),(!_.blade_||_.blade_.get("positions").includes("verylast"))&&D.push("verylast")),P.blade.set("positions",D)})},y.prototype.onChildPositionsChange_=function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onChildViewPropsChange_=function(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onChildDispose_=function(){var _=this,S=this.bcSet_.items.filter(function(C){return C.viewProps.get("disposed")});S.forEach(function(C){_.bcSet_.remove(C)})},y.prototype.onChildInputChange_=function(_){var S=u(this.find(r.InputBindingController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:S,options:_.options,sender:this})},y.prototype.onChildMonitorUpdate_=function(_){var S=d(this.find(i.MonitorBindingController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:S,sender:this})},y.prototype.onChildValueChange_=function(_){var S=p(this.find(a.ValueBladeController),_.sender);if(!S)throw e.TpError.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:S,options:_.options,sender:this})},y.prototype.onDescendantLayout_=function(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})},y.prototype.onDescendantInputChange_=function(_){this.emitter.emit("inputchange",{bladeController:_.bladeController,options:_.options,sender:this})},y.prototype.onDescendantMonitorUpdate_=function(_){this.emitter.emit("monitorupdate",{bladeController:_.bladeController,sender:this})},y.prototype.onBladePositionsChange_=function(){this.updatePositions_()},y}();return HS.BladeRack=x,HS}var TQ;function OE(){if(TQ)return jS;TQ=1;var n=Ct&&Ct.__extends||function(){var a=function(c,u){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,p){d.__proto__=p}||function(d,p){for(var f in p)Object.prototype.hasOwnProperty.call(p,f)&&(d[f]=p[f])},a(c,u)};return function(c,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");a(c,u);function d(){this.constructor=c}c.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)}}(),e=Ct&&Ct.__assign||function(){return e=Object.assign||function(a){for(var c,u=1,d=arguments.length;u<d;u++){c=arguments[u];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(a[p]=c[p])}return a},e.apply(this,arguments)};Object.defineProperty(jS,"__esModule",{value:!0}),jS.RackController=void 0;var t=ma,r=RE,i=af,s=E7e(),o=function(a){n(c,a);function c(u,d){var p=a.call(this,e(e({},d),{view:new r.PlainView(u,{viewName:"brk",viewProps:d.viewProps})}))||this;p.onRackAdd_=p.onRackAdd_.bind(p),p.onRackRemove_=p.onRackRemove_.bind(p);var f=new s.BladeRack(d.root?void 0:d.blade);return f.emitter.on("add",p.onRackAdd_),f.emitter.on("remove",p.onRackRemove_),p.rack=f,p.viewProps.handleDispose(function(){for(var v=p.rack.children.length-1;v>=0;v--){var x=p.rack.children[v];x.viewProps.set("disposed",!0)}}),p}return c.prototype.onRackAdd_=function(u){!u.isRoot||(0,t.insertElementAt)(this.view.element,u.bladeController.view.element,u.index)},c.prototype.onRackRemove_=function(u){!u.isRoot||(0,t.removeElement)(u.bladeController.view.element)},c}(i.BladeController);return jS.RackController=o,jS}var LE={},DE={};Object.defineProperty(DE,"__esModule",{value:!0});DE.bladeContainerClassName=void 0;var A7e=fr;DE.bladeContainerClassName=(0,A7e.ClassName)("cnt");Object.defineProperty(LE,"__esModule",{value:!0});LE.FolderView=void 0;var RQ=go,P7e=fr,OQ=zl,T7e=Gn,R7e=DE,O7e=function(){function n(e,t){var r=this,i;this.className_=(0,P7e.ClassName)((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),(0,R7e.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),(0,RQ.bindValueMap)(this.foldable_,"completed",(0,OQ.valueToClassName)(this.element,this.className_(void 0,"cpl")));var s=e.createElement("button");s.classList.add(this.className_("b")),(0,RQ.bindValueMap)(t.props,"title",function(u){(0,T7e.isEmpty)(u)?r.element.classList.add(r.className_(void 0,"not")):r.element.classList.remove(r.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;var o=e.createElement("div");o.classList.add(this.className_("t")),(0,OQ.bindValueToTextContent)(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;var a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);var c=t.containerElement;c.classList.add(this.className_("c")),this.element.appendChild(c),this.containerElement=c}return n}();LE.FolderView=O7e;var L7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),WO=Ct&&Ct.__assign||function(){return WO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},WO.apply(this,arguments)};Object.defineProperty(TE,"__esModule",{value:!0});TE.FolderController=void 0;var D7e=jb,LQ=cl,I7e=OE(),N7e=LE,k7e=function(n){L7e(e,n);function e(t,r){var i,s=this,o=LQ.Foldable.create((i=r.expanded)!==null&&i!==void 0?i:!0),a=new I7e.RackController(t,{blade:r.blade,root:r.root,viewProps:r.viewProps});return s=n.call(this,WO(WO({},r),{rackController:a,view:new N7e.FolderView(t,{containerElement:a.view.element,foldable:o,props:r.props,viewName:r.root?"rot":void 0,viewProps:r.viewProps})}))||this,s.onTitleClick_=s.onTitleClick_.bind(s),s.props=r.props,s.foldable=o,(0,LQ.bindFoldable)(s.foldable,s.view.containerElement),s.rackController.rack.emitter.on("add",function(){s.foldable.cleanUpTransition()}),s.rackController.rack.emitter.on("remove",function(){s.foldable.cleanUpTransition()}),s.view.buttonElement.addEventListener("click",s.onTitleClick_),s}return Object.defineProperty(e.prototype,"document",{get:function(){return this.view.element.ownerDocument},enumerable:!1,configurable:!0}),e.prototype.onTitleClick_=function(){this.foldable.set("expanded",!this.foldable.get("expanded"))},e}(D7e.RackLikeController);TE.FolderController=k7e;var IE={};Object.defineProperty(IE,"__esModule",{value:!0});IE.FolderBladePlugin=void 0;var z7e=es,DQ=Ws,B7e=PE,IQ=TE;IE.FolderBladePlugin={id:"folder",type:"blade",accept:function(n){var e=DQ.ParamsParsers,t=(0,DQ.parseParams)(n,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return t?{params:t}:null},controller:function(n){return new IQ.FolderController(n.document,{blade:n.blade,expanded:n.params.expanded,props:z7e.ValueMap.fromObject({title:n.params.title}),viewProps:n.viewProps})},api:function(n){return n.controller instanceof IQ.FolderController?new B7e.FolderApi(n.controller,n.pool):null}};var h4={},V7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),GO=Ct&&Ct.__assign||function(){return GO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},GO.apply(this,arguments)};Object.defineProperty(h4,"__esModule",{value:!0});h4.LabeledValueController=void 0;var F7e=H0,U7e=zb,j7e=function(n){V7e(e,n);function e(t,r){var i=this,s=r.valueController.viewProps;return i=n.call(this,GO(GO({},r),{value:r.valueController.value,view:new U7e.LabelView(t,{props:r.props,viewProps:s}),viewProps:s}))||this,i.props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return e}(F7e.ValueBladeController);h4.LabeledValueController=j7e;var NE={},H7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(NE,"__esModule",{value:!0});NE.SeparatorApi=void 0;var W7e=fd,G7e=function(n){H7e(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(W7e.BladeApi);NE.SeparatorApi=G7e;var kE={},d4={};Object.defineProperty(d4,"__esModule",{value:!0});d4.SeparatorView=void 0;var X7e=fr,NQ=(0,X7e.ClassName)("spr"),q7e=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(NQ()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("hr");r.classList.add(NQ("r")),this.element.appendChild(r)}return n}();d4.SeparatorView=q7e;var Y7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),XO=Ct&&Ct.__assign||function(){return XO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},XO.apply(this,arguments)};Object.defineProperty(kE,"__esModule",{value:!0});kE.SeparatorController=void 0;var Z7e=af,K7e=d4,J7e=function(n){Y7e(e,n);function e(t,r){return n.call(this,XO(XO({},r),{view:new K7e.SeparatorView(t,{viewProps:r.viewProps})}))||this}return e}(Z7e.BladeController);kE.SeparatorController=J7e;var zE={};Object.defineProperty(zE,"__esModule",{value:!0});zE.SeparatorBladePlugin=void 0;var kQ=Ws,Q7e=NE,zQ=kE;zE.SeparatorBladePlugin={id:"separator",type:"blade",accept:function(n){var e=kQ.ParamsParsers,t=(0,kQ.parseParams)(n,{view:e.required.constant("separator")});return t?{params:t}:null},controller:function(n){return new zQ.SeparatorController(n.document,{blade:n.blade,viewProps:n.viewProps})},api:function(n){return n.controller instanceof zQ.SeparatorController?new Q7e.SeparatorApi(n.controller):null}};var BE={},Hb={},ov={},$7e=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(ov,"__esModule",{value:!0});ov.ViewProps=void 0;var eWe=fr,tWe=zl,ZT=go,BQ=es,nWe=(0,eWe.ClassName)("");function VQ(n,e){return(0,tWe.valueToClassName)(n,nWe(void 0,e))}var rWe=function(n){$7e(e,n);function e(t){return n.call(this,t)||this}return e.create=function(t){var r,i,s=t!=null?t:{},o={disabled:(r=s.disabled)!==null&&r!==void 0?r:!1,disposed:!1,hidden:(i=s.hidden)!==null&&i!==void 0?i:!1},a=BQ.ValueMap.createCore(o);return new e(a)},e.prototype.bindClassModifiers=function(t){(0,ZT.bindValueMap)(this,"disabled",VQ(t,"disabled")),(0,ZT.bindValueMap)(this,"hidden",VQ(t,"hidden"))},e.prototype.bindDisabled=function(t){(0,ZT.bindValueMap)(this,"disabled",function(r){t.disabled=r})},e.prototype.bindTabIndex=function(t){(0,ZT.bindValueMap)(this,"disabled",function(r){t.tabIndex=r?-1:0})},e.prototype.handleDispose=function(t){this.value("disposed").emitter.on("change",function(r){r&&t()})},e}(BQ.ValueMap);ov.ViewProps=rWe;var p4={},f4={};Object.defineProperty(f4,"__esModule",{value:!0});f4.TabItemView=void 0;var iWe=go,sWe=fr,oWe=zl,WS=(0,sWe.ClassName)("tbi"),aWe=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(WS()),t.viewProps.bindClassModifiers(this.element),(0,iWe.bindValueMap)(t.props,"selected",function(o){o?r.element.classList.add(WS(void 0,"sel")):r.element.classList.remove(WS(void 0,"sel"))});var i=e.createElement("button");i.classList.add(WS("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var s=e.createElement("div");s.classList.add(WS("t")),(0,oWe.bindValueToTextContent)(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}return n}();f4.TabItemView=aWe;Object.defineProperty(p4,"__esModule",{value:!0});p4.TabItemController=void 0;var lWe=Ps,cWe=f4,uWe=function(){function n(e,t){this.emitter=new lWe.Emitter,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new cWe.TabItemView(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return n.prototype.onClick_=function(){this.emitter.emit("click",{sender:this})},n}();p4.TabItemController=uWe;Object.defineProperty(Hb,"__esModule",{value:!0});Hb.TabPageController=void 0;var hWe=go,FQ=ov,dWe=rv,pWe=OE(),fWe=p4,mWe=function(){function n(e,t){var r=this;this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new fWe.TabItemController(e,{props:t.itemProps,viewProps:FQ.ViewProps.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new pWe.RackController(e,{blade:(0,dWe.createBlade)(),viewProps:FQ.ViewProps.create()}),this.props=t.props,(0,hWe.bindValueMap)(this.props,"selected",function(i){r.itemController.props.set("selected",i),r.contentController.viewProps.set("hidden",!i)})}return Object.defineProperty(n.prototype,"itemController",{get:function(){return this.ic_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentController",{get:function(){return this.cc_},enumerable:!1,configurable:!0}),n.prototype.onItemClick_=function(){this.props.set("selected",!0)},n}();Hb.TabPageController=mWe;var VE={};Object.defineProperty(VE,"__esModule",{value:!0});VE.TabPageApi=void 0;var vWe=function(){function n(e,t){this.controller_=e,this.rackApi_=t}return Object.defineProperty(n.prototype,"title",{get:function(){var e;return(e=this.controller_.itemController.props.get("title"))!==null&&e!==void 0?e:""},set:function(e){this.controller_.itemController.props.set("title",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.controller_.props.get("selected")},set:function(e){this.controller_.props.set("selected",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"children",{get:function(){return this.rackApi_.children},enumerable:!1,configurable:!0}),n.prototype.addButton=function(e){return this.rackApi_.addButton(e)},n.prototype.addFolder=function(e){return this.rackApi_.addFolder(e)},n.prototype.addSeparator=function(e){return this.rackApi_.addSeparator(e)},n.prototype.addTab=function(e){return this.rackApi_.addTab(e)},n.prototype.add=function(e,t){this.rackApi_.add(e,t)},n.prototype.remove=function(e){this.rackApi_.remove(e)},n.prototype.addInput=function(e,t,r){return this.rackApi_.addInput(e,t,r)},n.prototype.addMonitor=function(e,t,r){return this.rackApi_.addMonitor(e,t,r)},n.prototype.addBlade=function(e){return this.rackApi_.addBlade(e)},n}();VE.TabPageApi=vWe;var gWe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(BE,"__esModule",{value:!0});BE.TabApi=void 0;var _We=Ps,UQ=es,KT=Fl,yWe=Bb,xWe=Lo,bWe=Bm,wWe=Hb,SWe=VE,MWe=function(n){gWe(e,n);function e(t,r){var i=n.call(this,t,new bWe.RackApi(t.rackController,r))||this;return i.onPageAdd_=i.onPageAdd_.bind(i),i.onPageRemove_=i.onPageRemove_.bind(i),i.onSelect_=i.onSelect_.bind(i),i.emitter_=new _We.Emitter,i.pageApiMap_=new Map,i.rackApi_.on("change",function(s){i.emitter_.emit("change",{event:s})}),i.rackApi_.on("update",function(s){i.emitter_.emit("update",{event:s})}),i.controller_.tab.selectedIndex.emitter.on("change",i.onSelect_),i.controller_.pageSet.emitter.on("add",i.onPageAdd_),i.controller_.pageSet.emitter.on("remove",i.onPageRemove_),i.controller_.pageSet.items.forEach(function(s){i.setUpPageApi_(s)}),i}return Object.defineProperty(e.prototype,"pages",{get:function(){var t=this;return this.controller_.pageSet.items.map(function(r){var i=t.pageApiMap_.get(r);if(!i)throw KT.TpError.shouldNeverHappen();return i})},enumerable:!1,configurable:!0}),e.prototype.addPage=function(t){var r=this.controller_.view.element.ownerDocument,i=new wWe.TabPageController(r,{itemProps:UQ.ValueMap.fromObject({selected:!1,title:t.title}),props:UQ.ValueMap.fromObject({selected:!1})});this.controller_.add(i,t.index);var s=this.pageApiMap_.get(i);if(!s)throw KT.TpError.shouldNeverHappen();return s},e.prototype.removePage=function(t){this.controller_.remove(t)},e.prototype.on=function(t,r){var i=r.bind(this);return this.emitter_.on(t,function(s){i(s.event)}),this},e.prototype.setUpPageApi_=function(t){var r=this.rackApi_.apiSet_.find(function(s){return s.controller_===t.contentController});if(!r)throw KT.TpError.shouldNeverHappen();var i=new SWe.TabPageApi(t,r);this.pageApiMap_.set(t,i)},e.prototype.onPageAdd_=function(t){this.setUpPageApi_(t.item)},e.prototype.onPageRemove_=function(t){var r=this.pageApiMap_.get(t.item);if(!r)throw KT.TpError.shouldNeverHappen();this.pageApiMap_.delete(t.item)},e.prototype.onSelect_=function(t){this.emitter_.emit("select",{event:new xWe.TpTabSelectEvent(this,t.rawValue)})},e}(yWe.RackLikeApi);BE.TabApi=MWe;var FE={},m4={};Object.defineProperty(m4,"__esModule",{value:!0});m4.Tab=void 0;var jQ=yl,HQ=-1,CWe=function(){function n(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=(0,jQ.createValue)(!0),this.selectedIndex=(0,jQ.createValue)(HQ),this.items_=[]}return n.prototype.add=function(e,t){var r=t!=null?t:this.items_.length;this.items_.splice(r,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()},n.prototype.remove=function(e){var t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())},n.prototype.keepSelection_=function(){if(this.items_.length===0){this.selectedIndex.rawValue=HQ,this.empty.rawValue=!0;return}var e=this.items_.findIndex(function(t){return t.rawValue});e<0?(this.items_.forEach(function(t,r){t.rawValue=r===0}),this.selectedIndex.rawValue=0):(this.items_.forEach(function(t,r){t.rawValue=r===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1},n.prototype.onItemSelectedChange_=function(e){if(e.rawValue){var t=this.items_.findIndex(function(r){return r===e.sender});this.items_.forEach(function(r,i){r.rawValue=i===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()},n}();m4.Tab=CWe;var v4={};Object.defineProperty(v4,"__esModule",{value:!0});v4.TabView=void 0;var EWe=go,AWe=fr,PWe=zl,TWe=DE,JT=(0,AWe.ClassName)("tab"),RWe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(JT(),(0,TWe.bladeContainerClassName)()),t.viewProps.bindClassModifiers(this.element),(0,EWe.bindValue)(t.empty,(0,PWe.valueToClassName)(this.element,JT(void 0,"nop")));var r=e.createElement("div");r.classList.add(JT("i")),this.element.appendChild(r),this.itemsElement=r;var i=t.contentsElement;i.classList.add(JT("c")),this.element.appendChild(i),this.contentsElement=i}return n}();v4.TabView=RWe;var OWe=Ct&&Ct.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(FE,"__esModule",{value:!0});FE.TabController=void 0;var WQ=ma,LWe=jb,DWe=Vb,IWe=OE(),NWe=m4,kWe=v4,zWe=function(n){OWe(e,n);function e(t,r){var i=this,s=new IWe.RackController(t,{blade:r.blade,viewProps:r.viewProps}),o=new NWe.Tab;return i=n.call(this,{blade:r.blade,rackController:s,view:new kWe.TabView(t,{contentsElement:s.view.element,empty:o.empty,viewProps:r.viewProps})})||this,i.onPageAdd_=i.onPageAdd_.bind(i),i.onPageRemove_=i.onPageRemove_.bind(i),i.pageSet_=new DWe.NestedOrderedSet(function(){return null}),i.pageSet_.emitter.on("add",i.onPageAdd_),i.pageSet_.emitter.on("remove",i.onPageRemove_),i.tab=o,i}return Object.defineProperty(e.prototype,"pageSet",{get:function(){return this.pageSet_},enumerable:!1,configurable:!0}),e.prototype.add=function(t,r){this.pageSet_.add(t,r)},e.prototype.remove=function(t){this.pageSet_.remove(this.pageSet_.items[t])},e.prototype.onPageAdd_=function(t){var r=t.item;(0,WQ.insertElementAt)(this.view.itemsElement,r.itemController.view.element,t.index),this.rackController.rack.add(r.contentController,t.index),this.tab.add(r.props.value("selected"))},e.prototype.onPageRemove_=function(t){var r=t.item;(0,WQ.removeElement)(r.itemController.view.element),this.rackController.rack.remove(r.contentController),this.tab.remove(r.props.value("selected"))},e}(LWe.RackLikeController);FE.TabController=zWe;var UE={};Object.defineProperty(UE,"__esModule",{value:!0});UE.TabBladePlugin=void 0;var GQ=es,XQ=Ws,BWe=BE,qQ=FE,VWe=Hb;UE.TabBladePlugin={id:"tab",type:"blade",accept:function(n){var e=XQ.ParamsParsers,t=(0,XQ.parseParams)(n,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return!t||t.pages.length===0?null:{params:t}},controller:function(n){var e=new qQ.TabController(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(function(t){var r=new VWe.TabPageController(n.document,{itemProps:GQ.ValueMap.fromObject({selected:!1,title:t.title}),props:GQ.ValueMap.fromObject({selected:!1})});e.add(r)}),e},api:function(n){return n.controller instanceof qQ.TabController?new BWe.TabApi(n.controller,n.pool):null}};var jE={},qO=Ct&&Ct.__assign||function(){return qO=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},qO.apply(this,arguments)};Object.defineProperty(jE,"__esModule",{value:!0});jE.createBladeController=void 0;var FWe=ov,YQ=Ws,UWe=Gn,jWe=rv;function HWe(n,e){var t=n.accept(e.params);if(!t)return null;var r=YQ.ParamsParsers.optional.boolean(e.params.disabled).value,i=YQ.ParamsParsers.optional.boolean(e.params.hidden).value;return n.controller({blade:(0,jWe.createBlade)(),document:e.document,params:(0,UWe.forceCast)(qO(qO({},t.params),{disabled:r,hidden:i})),viewProps:FWe.ViewProps.create({disabled:r,hidden:i})})}jE.createBladeController=HWe;var HE={};Object.defineProperty(HE,"__esModule",{value:!0});HE.ManualTicker=void 0;var WWe=Ps,GWe=function(){function n(){this.disabled=!1,this.emitter=new WWe.Emitter}return n.prototype.dispose=function(){},n.prototype.tick=function(){this.disabled||this.emitter.emit("tick",{sender:this})},n}();HE.ManualTicker=GWe;var WE={};Object.defineProperty(WE,"__esModule",{value:!0});WE.IntervalTicker=void 0;var XWe=Ps,qWe=function(){function n(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new XWe.Emitter,this.interval_=t,this.setTimer_()}return Object.defineProperty(n.prototype,"disabled",{get:function(){return this.disabled_},set:function(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this.clearTimer_()},n.prototype.clearTimer_=function(){if(this.timerId_!==null){var e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}},n.prototype.setTimer_=function(){if(this.clearTimer_(),!(this.interval_<=0)){var e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}},n.prototype.onTick_=function(){this.disabled_||this.emitter.emit("tick",{sender:this})},n}();WE.IntervalTicker=qWe;var mue={};Object.defineProperty(mue,"__esModule",{value:!0});var uh={};Object.defineProperty(uh,"__esModule",{value:!0});uh.findConstraint=uh.CompositeConstraint=void 0;var vue=function(){function n(e){this.constraints=e}return n.prototype.constrain=function(e){return this.constraints.reduce(function(t,r){return r.constrain(t)},e)},n}();uh.CompositeConstraint=vue;function YWe(n,e){if(n instanceof e)return n;if(n instanceof vue){var t=n.constraints.reduce(function(r,i){return r||(i instanceof e?i:null)},null);if(t)return t}return null}uh.findConstraint=YWe;var gue={};Object.defineProperty(gue,"__esModule",{value:!0});var av={};Object.defineProperty(av,"__esModule",{value:!0});av.ListConstraint=void 0;var ZWe=function(){function n(e){this.options=e}return n.prototype.constrain=function(e){var t=this.options;if(t.length===0)return e;var r=t.filter(function(i){return i.value===e}).length>0;return r?e:t[0].value},n}();av.ListConstraint=ZWe;var lv={};Object.defineProperty(lv,"__esModule",{value:!0});lv.RangeConstraint=void 0;var ZQ=Gn,KWe=function(){function n(e){this.maxValue=e.max,this.minValue=e.min}return n.prototype.constrain=function(e){var t=e;return(0,ZQ.isEmpty)(this.minValue)||(t=Math.max(t,this.minValue)),(0,ZQ.isEmpty)(this.maxValue)||(t=Math.min(t,this.maxValue)),t},n}();lv.RangeConstraint=KWe;var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});Wb.StepConstraint=void 0;var JWe=function(){function n(e,t){t===void 0&&(t=0),this.step=e,this.origin=t}return n.prototype.constrain=function(e){var t=this.origin%this.step,r=Math.round((e-t)/this.step);return t+r*this.step},n}();Wb.StepConstraint=JWe;var _ue={};Object.defineProperty(_ue,"__esModule",{value:!0});var W0={},GE={};Object.defineProperty(GE,"__esModule",{value:!0});GE.ListView=void 0;var KQ=ma,QWe=go,$We=fr,DF=(0,$We.ClassName)("lst"),eGe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(DF()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("select");r.classList.add(DF("s")),(0,QWe.bindValueMap)(this.props_,"options",function(s){(0,KQ.removeChildElements)(r),s.forEach(function(o,a){var c=e.createElement("option");c.dataset.index=String(a),c.textContent=o.text,c.value=String(o.value),r.appendChild(c)})}),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;var i=e.createElement("div");i.classList.add(DF("m")),i.appendChild((0,KQ.createSvgIconElement)(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,this.update_()}return n.prototype.update_=function(){this.selectElement.value=String(this.value_.rawValue)},n.prototype.onValueChange_=function(){this.update_()},n}();GE.ListView=eGe;Object.defineProperty(W0,"__esModule",{value:!0});W0.ListController=void 0;var tGe=Gn,nGe=GE,rGe=function(){function n(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new nGe.ListView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return n.prototype.onSelectChange_=function(e){var t=(0,tGe.forceCast)(e.currentTarget),r=t.selectedOptions.item(0);if(!!r){var i=Number(r.dataset.index);this.value.rawValue=this.props.get("options")[i].value}},n}();W0.ListController=rGe;var Gb={},XE={};Object.defineProperty(XE,"__esModule",{value:!0});XE.PopupView=void 0;var iGe=go,sGe=fr,oGe=zl,JQ=(0,sGe.ClassName)("pop"),aGe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(JQ()),t.viewProps.bindClassModifiers(this.element),(0,iGe.bindValue)(t.shows,(0,oGe.valueToClassName)(this.element,JQ(void 0,"v")))}return n}();XE.PopupView=aGe;Object.defineProperty(Gb,"__esModule",{value:!0});Gb.PopupController=void 0;var lGe=yl,cGe=XE,uGe=function(){function n(e,t){this.shows=(0,lGe.createValue)(!1),this.viewProps=t.viewProps,this.view=new cGe.PopupView(e,{shows:this.shows,viewProps:this.viewProps})}return n}();Gb.PopupController=uGe;var Xb={},qE={};Object.defineProperty(qE,"__esModule",{value:!0});qE.TextView=void 0;var hGe=fr,QQ=(0,hGe.ClassName)("txt"),dGe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(QQ()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);var r=e.createElement("input");r.classList.add(QQ("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}return n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();qE.TextView=dGe;Object.defineProperty(Xb,"__esModule",{value:!0});Xb.TextController=void 0;var $Q=Gn,pGe=qE,fGe=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new pGe.TextView(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,$Q.forceCast)(e.currentTarget),r=t.value,i=this.parser_(r);(0,$Q.isEmpty)(i)||(this.value.rawValue=i),this.view.refresh()},n}();Xb.TextController=fGe;var yue={};Object.defineProperty(yue,"__esModule",{value:!0});var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.BooleanFormatter=$h.boolFromUnknown=$h.boolToString=void 0;function xue(n){return String(n)}$h.boolToString=xue;function mGe(n){return n==="false"?!1:!!n}$h.boolFromUnknown=mGe;function vGe(n){return xue(n)}$h.BooleanFormatter=vGe;var bue={};Object.defineProperty(bue,"__esModule",{value:!0});var co={},g4={},Mm={};Object.defineProperty(Mm,"__esModule",{value:!0});Mm.UnaryOperationNode=Mm.BinaryOperationNode=Mm.NumberLiteralNode=void 0;var gGe=function(){function n(e){this.text=e}return n.prototype.evaluate=function(){return Number(this.text)},n.prototype.toString=function(){return this.text},n}();Mm.NumberLiteralNode=gGe;var _Ge={"**":function(n,e){return Math.pow(n,e)},"*":function(n,e){return n*e},"/":function(n,e){return n/e},"%":function(n,e){return n%e},"+":function(n,e){return n+e},"-":function(n,e){return n-e},"<<":function(n,e){return n<<e},">>":function(n,e){return n>>e},">>>":function(n,e){return n>>>e},"&":function(n,e){return n&e},"^":function(n,e){return n^e},"|":function(n,e){return n|e}},yGe=function(){function n(e,t,r){this.left=t,this.operator=e,this.right=r}return n.prototype.evaluate=function(){var e=_Ge[this.operator];if(!e)throw new Error("unexpected binary operator: '"+this.operator);return e(this.left.evaluate(),this.right.evaluate())},n.prototype.toString=function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")},n}();Mm.BinaryOperationNode=yGe;var xGe={"+":function(n){return n},"-":function(n){return-n},"~":function(n){return~n}},bGe=function(){function n(e,t){this.operator=e,this.expression=t}return n.prototype.evaluate=function(){var e=xGe[this.operator];if(!e)throw new Error("unexpected unary operator: '"+this.operator);return e(this.expression.evaluate())},n.prototype.toString=function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")},n}();Mm.UnaryOperationNode=bGe;var Vx={};Object.defineProperty(Vx,"__esModule",{value:!0});Vx.readNumericLiteral=Vx.readWhitespace=void 0;function j7(n){return function(e,t){for(var r=0;r<n.length;r++){var i=n[r](e,t);if(i!=="")return i}return""}}function wGe(n,e){var t,r=n.substr(e).match(/^\s+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}Vx.readWhitespace=wGe;function SGe(n,e){var t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function OC(n,e){var t,r=n.substr(e).match(/^[0-9]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function MGe(n,e){var t=OC(n,e);if(t!=="")return t;var r=n.substr(e,1);if(e+=1,r!=="-"&&r!=="+")return"";var i=OC(n,e);return i===""?"":r+i}function H7(n,e){var t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";var r=MGe(n,e);return r===""?"":t+r}function wue(n,e){var t=n.substr(e,1);if(t==="0")return t;var r=SGe(n,e);return e+=r.length,r===""?"":r+OC(n,e)}function CGe(n,e){var t=wue(n,e);if(e+=t.length,t==="")return"";var r=n.substr(e,1);if(e+=r.length,r!==".")return"";var i=OC(n,e);return e+=i.length,t+r+i+H7(n,e)}function EGe(n,e){var t=n.substr(e,1);if(e+=t.length,t!==".")return"";var r=OC(n,e);return e+=r.length,r===""?"":t+r+H7(n,e)}function AGe(n,e){var t=wue(n,e);return e+=t.length,t===""?"":t+H7(n,e)}var PGe=j7([CGe,EGe,AGe]);function TGe(n,e){var t,r=n.substr(e).match(/^[01]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function RGe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";var r=TGe(n,e);return r===""?"":t+r}function OGe(n,e){var t,r=n.substr(e).match(/^[0-7]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function LGe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";var r=OGe(n,e);return r===""?"":t+r}function DGe(n,e){var t,r=n.substr(e).match(/^[0-9a-f]+/i);return(t=r&&r[0])!==null&&t!==void 0?t:""}function IGe(n,e){var t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";var r=DGe(n,e);return r===""?"":t+r}var NGe=j7([RGe,LGe,IGe]);Vx.readNumericLiteral=j7([NGe,PGe]);Object.defineProperty(g4,"__esModule",{value:!0});g4.parseEcmaNumberExpression=void 0;var W7=Mm,Fx=Vx;function kGe(n,e){var t=(0,Fx.readNumericLiteral)(n,e);return e+=t.length,t===""?null:{evaluable:new W7.NumberLiteralNode(t),cursor:e}}function zGe(n,e){var t=n.substr(e,1);if(e+=t.length,t!=="(")return null;var r=Mue(n,e);if(!r)return null;e=r.cursor,e+=(0,Fx.readWhitespace)(n,e).length;var i=n.substr(e,1);return e+=i.length,i!==")"?null:{evaluable:r.evaluable,cursor:e}}function BGe(n,e){var t;return(t=kGe(n,e))!==null&&t!==void 0?t:zGe(n,e)}function Sue(n,e){var t=BGe(n,e);if(t)return t;var r=n.substr(e,1);if(e+=r.length,r!=="+"&&r!=="-"&&r!=="~")return null;var i=Sue(n,e);return i?(e=i.cursor,{cursor:e,evaluable:new W7.UnaryOperationNode(r,i.evaluable)}):null}function VGe(n,e,t){t+=(0,Fx.readWhitespace)(e,t).length;var r=n.filter(function(i){return e.startsWith(i,t)})[0];return r?(t+=r.length,t+=(0,Fx.readWhitespace)(e,t).length,{cursor:t,operator:r}):null}function FGe(n,e){return function(t,r){var i=n(t,r);if(!i)return null;r=i.cursor;for(var s=i.evaluable;;){var o=VGe(e,t,r);if(!o)break;r=o.cursor;var a=n(t,r);if(!a)return null;r=a.cursor,s=new W7.BinaryOperationNode(o.operator,s,a.evaluable)}return s?{cursor:r,evaluable:s}:null}}var UGe=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(function(n,e){return FGe(n,e)},Sue);function Mue(n,e){return e+=(0,Fx.readWhitespace)(n,e).length,UGe(n,e)}function jGe(n){var e=Mue(n,0);if(!e)return null;var t=e.cursor+(0,Fx.readWhitespace)(n,e.cursor).length;return t!==n.length?null:e.evaluable}g4.parseEcmaNumberExpression=jGe;Object.defineProperty(co,"__esModule",{value:!0});co.createNumberFormatter=co.numberToString=co.numberFromUnknown=co.parseNumber=void 0;var HGe=Gn,WGe=g4;function Cue(n){var e,t=(0,WGe.parseEcmaNumberExpression)(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}co.parseNumber=Cue;function GGe(n){if(typeof n=="number")return n;if(typeof n=="string"){var e=Cue(n);if(!(0,HGe.isEmpty)(e))return e}return 0}co.numberFromUnknown=GGe;function XGe(n){return String(n)}co.numberToString=XGe;function qGe(n){return function(e){return e.toFixed(Math.max(Math.min(n,20),0))}}co.createNumberFormatter=qGe;var Eue={};Object.defineProperty(Eue,"__esModule",{value:!0});var YE={};Object.defineProperty(YE,"__esModule",{value:!0});YE.formatPercentage=void 0;var YGe=co,ZGe=(0,YGe.createNumberFormatter)(0);function KGe(n){return ZGe(n)+"%"}YE.formatPercentage=KGe;var Vm={};Object.defineProperty(Vm,"__esModule",{value:!0});Vm.formatString=Vm.stringFromUnknown=void 0;function JGe(n){return String(n)}Vm.stringFromUnknown=JGe;function QGe(n){return n}Vm.formatString=QGe;var Fm={},e$=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Fm,"__esModule",{value:!0});Fm.createPushedBuffer=Fm.initializeBuffer=void 0;var $Ge=Gn,eXe=yl;function Aue(n,e){for(;n.length<e;)n.push(void 0)}function tXe(n){var e=[];return Aue(e,n),(0,eXe.createValue)(e)}Fm.initializeBuffer=tXe;function nXe(n){var e=n.indexOf(void 0);return(0,$Ge.forceCast)(e<0?n:n.slice(0,e))}function rXe(n,e){var t=e$(e$([],nXe(n),!0),[e],!1);return t.length>n.length?t.splice(0,t.length-n.length):Aue(t,n.length),t}Fm.createPushedBuffer=rXe;var Pue={};Object.defineProperty(Pue,"__esModule",{value:!0});var lf={};Object.defineProperty(lf,"__esModule",{value:!0});lf.connectValues=void 0;function iXe(n){var e=n.primary,t=n.secondary,r=n.forward,i=n.backward,s=!1;function o(a){s||(s=!0,a(),s=!1)}e.emitter.on("change",function(a){o(function(){t.setRawValue(r(e,t),a.options)})}),t.emitter.on("change",function(a){o(function(){e.setRawValue(i(e,t),a.options)}),o(function(){t.setRawValue(r(e,t),a.options)})}),o(function(){t.setRawValue(r(e,t),{forceEmit:!1,last:!0})})}lf.connectValues=iXe;var cf={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.isArrowKey=Do.isVerticalArrowKey=Do.getHorizontalStepKeys=Do.getVerticalStepKeys=Do.getStepForKey=void 0;function sXe(n,e){var t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}Do.getStepForKey=sXe;function oXe(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}Do.getVerticalStepKeys=oXe;function aXe(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}Do.getHorizontalStepKeys=aXe;function Tue(n){return n==="ArrowUp"||n==="ArrowDown"}Do.isVerticalArrowKey=Tue;function lXe(n){return Tue(n)||n==="ArrowLeft"||n==="ArrowRight"}Do.isArrowKey=lXe;var ph={};Object.defineProperty(ph,"__esModule",{value:!0});ph.PointerHandler=void 0;var cXe=Ps;function IF(n,e){var t,r,i=e.ownerDocument.defaultView,s=e.getBoundingClientRect();return{x:n.pageX-(((t=i&&i.scrollX)!==null&&t!==void 0?t:0)+s.left),y:n.pageY-(((r=i&&i.scrollY)!==null&&r!==void 0?r:0)+s.top)}}var uXe=function(){function n(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new cXe.Emitter,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return n.prototype.computePosition_=function(e){var t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}},n.prototype.onMouseDown_=function(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();var r=this.elem_.ownerDocument;r.addEventListener("mousemove",this.onDocumentMouseMove_),r.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(IF(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseMove_=function(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(IF(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onDocumentMouseUp_=function(e){var t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(IF(e,this.elem_)),sender:this,shiftKey:e.shiftKey})},n.prototype.onTouchStart_=function(e){e.preventDefault();var t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchMove_=function(e){var t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t},n.prototype.onTouchEnd_=function(e){var t,r=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(r?{x:r.clientX-i.left,y:r.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})},n}();ph.PointerHandler=uXe;var ZE={},_i={};Object.defineProperty(_i,"__esModule",{value:!0});_i.loopRange=_i.constrainRange=_i.getDecimalDigits=_i.mapRange=void 0;function hXe(n,e,t,r,i){var s=(n-e)/(t-e);return r+s*(i-r)}_i.mapRange=hXe;function dXe(n){var e=String(n.toFixed(10)),t=e.split(".")[1];return t.replace(/0+$/,"").length}_i.getDecimalDigits=dXe;function pXe(n,e,t){return Math.min(Math.max(n,e),t)}_i.constrainRange=pXe;function fXe(n,e){return(n%e+e)%e}_i.loopRange=fXe;Object.defineProperty(ZE,"__esModule",{value:!0});ZE.NumberTextView=void 0;var NF=ma,mXe=_i,Rue=fr,$c=(0,Rue.ClassName)("txt"),vXe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add($c(),$c(void 0,"num")),t.arrayPosition&&this.element.classList.add($c(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add($c("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add($c()),this.inputElement.classList.add($c("i"));var i=e.createElement("div");i.classList.add($c("k")),this.element.appendChild(i),this.knobElement=i;var s=e.createElementNS(NF.SVG_NS,"svg");s.classList.add($c("g")),this.knobElement.appendChild(s);var o=e.createElementNS(NF.SVG_NS,"path");o.classList.add($c("gb")),s.appendChild(o),this.guideBodyElem_=o;var a=e.createElementNS(NF.SVG_NS,"path");a.classList.add($c("gh")),s.appendChild(a),this.guideHeadElem_=a;var c=e.createElement("div");c.classList.add((0,Rue.ClassName)("tt")()),this.knobElement.appendChild(c),this.tooltipElem_=c,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}return n.prototype.onDraggingChange_=function(e){if(e.rawValue===null){this.element.classList.remove($c(void 0,"drg"));return}this.element.classList.add($c(void 0,"drg"));var t=e.rawValue/this.props_.get("draggingScale"),r=t+(t>0?-1:t<0?1:0),i=(0,mXe.constrainRange)(-r,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M "+(r+i)+",0 L"+r+",4 L"+(r+i)+",8","M "+t+",-1 L"+t+",9"].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L"+t+",4");var s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=t+"px"},n.prototype.refresh=function(){var e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)},n.prototype.onChange_=function(){this.refresh()},n}();ZE.NumberTextView=vXe;Object.defineProperty(cf,"__esModule",{value:!0});cf.NumberTextController=void 0;var t$=Gn,gXe=yl,QT=Do,_Xe=ph,yXe=ZE,xXe=function(){function n(e,t){var r;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=(r=t.sliderProps)!==null&&r!==void 0?r:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=(0,gXe.createValue)(null),this.view=new yXe.NumberTextView(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new _Xe.PointerHandler(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return n.prototype.constrainValue_=function(e){var t,r,i=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("minValue"),s=(r=this.sliderProps_)===null||r===void 0?void 0:r.get("maxValue"),o=e;return i!==void 0&&(o=Math.max(o,i)),s!==void 0&&(o=Math.min(o,s)),o},n.prototype.onInputChange_=function(e){var t=(0,t$.forceCast)(e.currentTarget),r=t.value,i=this.parser_(r);(0,t$.isEmpty)(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()},n.prototype.onInputKeyDown_=function(e){var t=(0,QT.getStepForKey)(this.baseStep_,(0,QT.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})},n.prototype.onInputKeyUp_=function(e){var t=(0,QT.getStepForKey)(this.baseStep_,(0,QT.getVerticalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n.prototype.onPointerDown_=function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0},n.prototype.computeDraggingValue_=function(e){if(!e.point)return null;var t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))},n.prototype.onPointerMove_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)},n.prototype.onPointerUp_=function(e){var t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)},n}();cf.NumberTextController=xXe;var KE={},JE={};Object.defineProperty(JE,"__esModule",{value:!0});JE.SliderView=void 0;var n$=_i,bXe=fr,kF=(0,bXe.ClassName)("sld"),wXe=function(){function n(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(kF()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(kF("t")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;var i=e.createElement("div");i.classList.add(kF("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=(0,n$.constrainRange)((0,n$.mapRange)(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=e+"%"},n.prototype.onChange_=function(){this.update_()},n}();JE.SliderView=wXe;Object.defineProperty(KE,"__esModule",{value:!0});KE.SliderController=void 0;var r$=_i,$T=Do,SXe=ph,MXe=JE,CXe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new MXe.SliderView(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new SXe.PointerHandler(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){!e.point||this.value.setRawValue((0,r$.mapRange)((0,r$.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)},n.prototype.onPointerDownOrMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,$T.getStepForKey)(this.baseStep_,(0,$T.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,$T.getStepForKey)(this.baseStep_,(0,$T.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();KE.SliderController=CXe;var QE={},$E={};Object.defineProperty($E,"__esModule",{value:!0});$E.SliderTextView=void 0;var EXe=fr,zF=(0,EXe.ClassName)("sldtxt"),AXe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(zF());var r=e.createElement("div");r.classList.add(zF("s")),this.sliderView_=t.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(zF("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}return n}();$E.SliderTextView=AXe;Object.defineProperty(QE,"__esModule",{value:!0});QE.SliderTextController=void 0;var PXe=$E,TXe=cf,RXe=KE,OXe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new RXe.SliderController(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new TXe.NumberTextController(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new PXe.SliderTextView(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"sliderController",{get:function(){return this.sliderC_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();QE.SliderTextController=OXe;var Oue={};Object.defineProperty(Oue,"__esModule",{value:!0});var _4={};Object.defineProperty(_4,"__esModule",{value:!0});_4.warnDeprecation=void 0;function LXe(n){var e;console.warn([n.name+" is deprecated.",n.alternative?"use "+n.alternative+" instead.":"",(e=n.postscript)!==null&&e!==void 0?e:""].join(" "))}_4.warnDeprecation=LXe;var Lue={};Object.defineProperty(Lue,"__esModule",{value:!0});var cv={};Object.defineProperty(cv,"__esModule",{value:!0});cv.writePrimitive=void 0;function DXe(n,e){n.write(e)}cv.writePrimitive=DXe;var hi={};Object.defineProperty(hi,"__esModule",{value:!0});hi.getSuitableDraggingScale=hi.getBaseStep=hi.getSuitableDecimalDigits=hi.findListItems=hi.createListConstraint=hi.normalizeListOptions=hi.parsePointDimensionParams=hi.parsePickerLayout=hi.parseListOptions=void 0;var i$=Gn,y4=uh,Due=av,G7=Wb,s$=_i,Iue=Ws;function IXe(n){var e=Iue.ParamsParsers;if(Array.isArray(n))return e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(n).value;if(typeof n=="object")return e.required.raw(n).value}hi.parseListOptions=IXe;function NXe(n){if(n==="inline"||n==="popup")return n}hi.parsePickerLayout=NXe;function kXe(n){var e=Iue.ParamsParsers;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(n).value}hi.parsePointDimensionParams=kXe;function Nue(n){if(Array.isArray(n))return n;var e=[];return Object.keys(n).forEach(function(t){e.push({text:t,value:n[t]})}),e}hi.normalizeListOptions=Nue;function zXe(n){return(0,i$.isEmpty)(n)?null:new Due.ListConstraint(Nue((0,i$.forceCast)(n)))}hi.createListConstraint=zXe;function BXe(n){var e=n?(0,y4.findConstraint)(n,Due.ListConstraint):null;return e?e.options:null}hi.findListItems=BXe;function VXe(n){var e=n?(0,y4.findConstraint)(n,G7.StepConstraint):null;return e?e.step:null}function FXe(n,e){var t=n&&(0,y4.findConstraint)(n,G7.StepConstraint);return t?(0,s$.getDecimalDigits)(t.step):Math.max((0,s$.getDecimalDigits)(e),2)}hi.getSuitableDecimalDigits=FXe;function UXe(n){var e=VXe(n);return e!=null?e:1}hi.getBaseStep=UXe;function jXe(n,e){var t,r=n&&(0,y4.findConstraint)(n,G7.StepConstraint),i=Math.abs((t=r==null?void 0:r.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}hi.getSuitableDraggingScale=jXe;var eA={},x4={};Object.defineProperty(x4,"__esModule",{value:!0});x4.CheckboxView=void 0;var HXe=ma,WXe=fr,e3=(0,WXe.ClassName)("ckb"),GXe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(e3()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("label");r.classList.add(e3("l")),this.element.appendChild(r);var i=e.createElement("input");i.classList.add(e3("i")),i.type="checkbox",r.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);var s=e.createElement("div");s.classList.add(e3("w")),r.appendChild(s);var o=(0,HXe.createSvgIconElement)(e,"check");s.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return n.prototype.update_=function(){this.inputElement.checked=this.value.rawValue},n.prototype.onValueChange_=function(){this.update_()},n}();x4.CheckboxView=GXe;Object.defineProperty(eA,"__esModule",{value:!0});eA.CheckboxController=void 0;var XXe=Gn,qXe=x4,YXe=function(){function n(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new qXe.CheckboxView(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return n.prototype.onInputChange_=function(e){var t=(0,XXe.forceCast)(e.currentTarget);this.value.rawValue=t.checked},n}();eA.CheckboxController=YXe;var tA={};Object.defineProperty(tA,"__esModule",{value:!0});tA.BooleanInputPlugin=void 0;var kue=uh,ZXe=av,KXe=W0,JXe=$h,QXe=es,o$=Ws,$Xe=cv,sj=hi,eqe=eA;function tqe(n){var e=[],t=(0,sj.createListConstraint)(n.options);return t&&e.push(t),new kue.CompositeConstraint(e)}tA.BooleanInputPlugin={id:"input-bool",type:"input",accept:function(n,e){if(typeof n!="boolean")return null;var t=o$.ParamsParsers,r=(0,o$.parseParams)(e,{options:t.optional.custom(sj.parseListOptions)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return JXe.boolFromUnknown},constraint:function(n){return tqe(n.params)},writer:function(n){return $Xe.writePrimitive}},controller:function(n){var e,t=n.document,r=n.value,i=n.constraint;return i&&(0,kue.findConstraint)(i,ZXe.ListConstraint)?new KXe.ListController(t,{props:QXe.ValueMap.fromObject({options:(e=(0,sj.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps}):new eqe.CheckboxController(t,{value:r,viewProps:n.viewProps})}};var G0={},b4={};Object.defineProperty(b4,"__esModule",{value:!0});b4.ColorView=void 0;var nqe=go,rqe=fr,iqe=zl,Ig=(0,rqe.ClassName)("col"),sqe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(Ig()),t.foldable.bindExpandedClass(this.element,Ig(void 0,"expanded")),(0,nqe.bindValueMap)(t.foldable,"completed",(0,iqe.valueToClassName)(this.element,Ig(void 0,"cpl")));var r=e.createElement("div");r.classList.add(Ig("h")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(Ig("s")),r.appendChild(i),this.swatchElement=i;var s=e.createElement("div");if(s.classList.add(Ig("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){var o=e.createElement("div");o.classList.add(Ig("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return n}();b4.ColorView=sqe;var w4={},Va={},cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.convertColor=cs.constrainColorComponents=cs.getColorMaxComponents=cs.appendAlphaComponent=cs.removeAlphaComponent=cs.hsvToHslInt=cs.hslToHsvInt=cs.hsvToRgbInt=void 0;var Oa=_i;function oqe(n,e,t){var r=(0,Oa.constrainRange)(n/255,0,1),i=(0,Oa.constrainRange)(e/255,0,1),s=(0,Oa.constrainRange)(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),c=o-a,u=0,d=0,p=(a+o)/2;return c!==0&&(d=c/(1-Math.abs(o+a-1)),r===o?u=(i-s)/c:i===o?u=2+(s-r)/c:u=4+(r-i)/c,u=u/6+(u<0?1:0)),[u*360,d*100,p*100]}function aqe(n,e,t){var r,i,s,o,a,c,u=(n%360+360)%360,d=(0,Oa.constrainRange)(e/100,0,1),p=(0,Oa.constrainRange)(t/100,0,1),f=(1-Math.abs(2*p-1))*d,v=f*(1-Math.abs(u/60%2-1)),x=p-f/2,y,_,S;return u>=0&&u<60?(r=[f,v,0],y=r[0],_=r[1],S=r[2]):u>=60&&u<120?(i=[v,f,0],y=i[0],_=i[1],S=i[2]):u>=120&&u<180?(s=[0,f,v],y=s[0],_=s[1],S=s[2]):u>=180&&u<240?(o=[0,v,f],y=o[0],_=o[1],S=o[2]):u>=240&&u<300?(a=[v,0,f],y=a[0],_=a[1],S=a[2]):(c=[f,0,v],y=c[0],_=c[1],S=c[2]),[(y+x)*255,(_+x)*255,(S+x)*255]}function lqe(n,e,t){var r=(0,Oa.constrainRange)(n/255,0,1),i=(0,Oa.constrainRange)(e/255,0,1),s=(0,Oa.constrainRange)(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),c=o-a,u;c===0?u=0:o===r?u=60*(((i-s)/c%6+6)%6):o===i?u=60*((s-r)/c+2):u=60*((r-i)/c+4);var d=o===0?0:c/o,p=o;return[u,d*100,p*100]}function zue(n,e,t){var r,i,s,o,a,c,u=(0,Oa.loopRange)(n,360),d=(0,Oa.constrainRange)(e/100,0,1),p=(0,Oa.constrainRange)(t/100,0,1),f=p*d,v=f*(1-Math.abs(u/60%2-1)),x=p-f,y,_,S;return u>=0&&u<60?(r=[f,v,0],y=r[0],_=r[1],S=r[2]):u>=60&&u<120?(i=[v,f,0],y=i[0],_=i[1],S=i[2]):u>=120&&u<180?(s=[0,f,v],y=s[0],_=s[1],S=s[2]):u>=180&&u<240?(o=[0,v,f],y=o[0],_=o[1],S=o[2]):u>=240&&u<300?(a=[v,0,f],y=a[0],_=a[1],S=a[2]):(c=[f,0,v],y=c[0],_=c[1],S=c[2]),[(y+x)*255,(_+x)*255,(S+x)*255]}cs.hsvToRgbInt=zue;function Bue(n,e,t){var r=t+e*(100-Math.abs(2*t-100))/200;return[n,r!==0?e*(100-Math.abs(2*t-100))/r:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}cs.hslToHsvInt=Bue;function Vue(n,e,t){var r=100-Math.abs(t*(200-e)/100-100);return[n,r!==0?e*t/r:0,t*(200-e)/(2*100)]}cs.hsvToHslInt=Vue;function cqe(n){return[n[0],n[1],n[2]]}cs.removeAlphaComponent=cqe;function uqe(n,e){return[n[0],n[1],n[2],e]}cs.appendAlphaComponent=uqe;var hqe={hsl:{hsl:function(n,e,t){return[n,e,t]},hsv:Bue,rgb:aqe},hsv:{hsl:Vue,hsv:function(n,e,t){return[n,e,t]},rgb:zue},rgb:{hsl:oqe,hsv:lqe,rgb:function(n,e,t){return[n,e,t]}}};function YO(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}cs.getColorMaxComponents=YO;function dqe(n,e,t){var r,i=YO(e,t);return[e==="rgb"?(0,Oa.constrainRange)(n[0],0,i[0]):(0,Oa.loopRange)(n[0],i[0]),(0,Oa.constrainRange)(n[1],0,i[1]),(0,Oa.constrainRange)(n[2],0,i[2]),(0,Oa.constrainRange)((r=n[3])!==null&&r!==void 0?r:1,0,1)]}cs.constrainColorComponents=dqe;function a$(n,e,t,r){var i=YO(e,t),s=YO(e,r);return n.map(function(o,a){return o/i[a]*s[a]})}function pqe(n,e,t){var r,i=a$(n,e.mode,e.type,"int"),s=(r=hqe[e.mode])[t.mode].apply(r,i);return a$(s,t.mode,"int",t.type)}cs.convertColor=pqe;Object.defineProperty(Va,"__esModule",{value:!0});Va.Color=void 0;var fqe=Gn,t3=cs;function n3(n,e){return typeof n!="object"||(0,fqe.isEmpty)(n)?!1:e in n&&typeof n[e]=="number"}var mqe=function(){function n(e,t,r){r===void 0&&(r="int"),this.mode=t,this.type=r,this.comps_=(0,t3.constrainColorComponents)(e,t,r)}return n.black=function(e){return e===void 0&&(e="int"),new n([0,0,0],"rgb",e)},n.fromObject=function(e,t){t===void 0&&(t="int");var r="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new n(r,"rgb",t)},n.toRgbaObject=function(e,t){return t===void 0&&(t="int"),e.toRgbaObject(t)},n.isRgbColorObject=function(e){return n3(e,"r")&&n3(e,"g")&&n3(e,"b")},n.isRgbaColorObject=function(e){return this.isRgbColorObject(e)&&n3(e,"a")},n.isColorObject=function(e){return this.isRgbColorObject(e)},n.equals=function(e,t){if(e.mode!==t.mode)return!1;for(var r=e.comps_,i=t.comps_,s=0;s<r.length;s++)if(r[s]!==i[s])return!1;return!0},n.prototype.getComponents=function(e,t){return t===void 0&&(t="int"),(0,t3.appendAlphaComponent)((0,t3.convertColor)((0,t3.removeAlphaComponent)(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:t}),this.comps_[3])},n.prototype.toRgbaObject=function(e){e===void 0&&(e="int");var t=this.getComponents("rgb",e);return{r:t[0],g:t[1],b:t[2],a:t[3]}},n}();Va.Color=mqe;var S4={},vqe=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(S4,"__esModule",{value:!0});S4.ColorPickerView=void 0;var gqe=fr,Qf=(0,gqe.ClassName)("colp"),_qe=function(){function n(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Qf());var r=e.createElement("div");r.classList.add(Qf("hsv"));var i=e.createElement("div");i.classList.add(Qf("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),r.appendChild(i);var s=e.createElement("div");s.classList.add(Qf("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),r.appendChild(s),this.element.appendChild(r);var o=e.createElement("div");if(o.classList.add(Qf("rgb")),this.textView_=t.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};var a=e.createElement("div");a.classList.add(Qf("a"));var c=e.createElement("div");c.classList.add(Qf("ap")),c.appendChild(this.alphaViews_.palette.element),a.appendChild(c);var u=e.createElement("div");u.classList.add(Qf("at")),u.appendChild(this.alphaViews_.text.element),a.appendChild(u),this.element.appendChild(a)}}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){var e=vqe([this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement],this.textView_.textViews.map(function(t){return t.inputElement}),!0);return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e},enumerable:!1,configurable:!0}),n}();S4.ColorPickerView=_qe;var M4={},Dl={};Object.defineProperty(Dl,"__esModule",{value:!0});Dl.extractColorType=Dl.getBaseStepForColor=Dl.parseColorInputParams=void 0;var l$=Ws,yqe=hi;function xqe(n){return n==="int"?"int":n==="float"?"float":void 0}function bqe(n){var e=l$.ParamsParsers;return(0,l$.parseParams)(n,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(xqe)}),expanded:e.optional.boolean,picker:e.optional.custom(yqe.parsePickerLayout)})}Dl.parseColorInputParams=bqe;function wqe(n){return n?.1:1}Dl.getBaseStepForColor=wqe;function Sqe(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}Dl.extractColorType=Sqe;var C4={},uf={};(function(n){var e=Ct&&Ct.__assign||function(){return e=Object.assign||function(ne){for(var W,O=1,E=arguments.length;O<E;O++){W=arguments[O];for(var F in W)Object.prototype.hasOwnProperty.call(W,F)&&(ne[F]=W[F])}return ne},e.apply(this,arguments)},t=Ct&&Ct.__spreadArray||function(ne,W,O){if(O||arguments.length===2)for(var E=0,F=W.length,z;E<F;E++)(z||!(E in W))&&(z||(z=Array.prototype.slice.call(W,0,E)),z[E]=W[E]);return ne.concat(z||Array.prototype.slice.call(W))};Object.defineProperty(n,"__esModule",{value:!0}),n.findColorStringifier=n.getColorStringifier=n.colorToObjectRgbaString=n.colorToObjectRgbString=n.colorToFunctionalHslaString=n.colorToFunctionalHslString=n.colorToFunctionalRgbaString=n.colorToFunctionalRgbString=n.colorToHexRgbaString=n.colorToHexRgbString=n.colorFromString=n.hasAlphaComponent=n.createColorStringParser=n.createColorStringBindingReader=n.CompositeColorParser=n.detectStringColorFormat=n.getColorNotation=void 0;var r=co,i=YE,s=_i,o=Va,a=cs;function c(ne,W){return ne.alpha===W.alpha&&ne.mode===W.mode&&ne.notation===W.notation&&ne.type===W.type}function u(ne,W){var O=ne.match(/^(.+)%$/);return Math.min(O?parseFloat(O[1])*.01*W:parseFloat(ne),W)}var d={deg:function(ne){return ne},grad:function(ne){return ne*360/400},rad:function(ne){return ne*360/(2*Math.PI)},turn:function(ne){return ne*360}};function p(ne){var W=ne.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!W)return parseFloat(ne);var O=parseFloat(W[1]),E=W[2];return d[E](O)}function f(ne){var W=ne.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[u(W[1],255),u(W[2],255),u(W[3],255)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function v(ne){return function(W){var O=f(W);return O?new o.Color(O,"rgb",ne):null}}function x(ne){var W=ne.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[u(W[1],255),u(W[2],255),u(W[3],255),u(W[4],1)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function y(ne){return function(W){var O=x(W);return O?new o.Color(O,"rgb",ne):null}}function _(ne){var W=ne.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[p(W[1]),u(W[2],100),u(W[3],100)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function S(ne){return function(W){var O=_(W);return O?new o.Color(O,"hsl",ne):null}}function C(ne){var W=ne.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!W)return null;var O=[p(W[1]),u(W[2],100),u(W[3],100),u(W[4],1)];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function A(ne){return function(W){var O=C(W);return O?new o.Color(O,"hsl",ne):null}}function P(ne){var W=ne.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(W)return[parseInt(W[1]+W[1],16),parseInt(W[2]+W[2],16),parseInt(W[3]+W[3],16)];var O=ne.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return O?[parseInt(O[1],16),parseInt(O[2],16),parseInt(O[3],16)]:null}function D(ne){var W=P(ne);return W?new o.Color(W,"rgb","int"):null}function N(ne){var W=ne.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(W)return[parseInt(W[1]+W[1],16),parseInt(W[2]+W[2],16),parseInt(W[3]+W[3],16),(0,s.mapRange)(parseInt(W[4]+W[4],16),0,255,0,1)];var O=ne.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return O?[parseInt(O[1],16),parseInt(O[2],16),parseInt(O[3],16),(0,s.mapRange)(parseInt(O[4],16),0,255,0,1)]:null}function j(ne){var W=N(ne);return W?new o.Color(W,"rgb","int"):null}function T(ne){var W=ne.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!W)return null;var O=[parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3])];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])?null:O}function k(ne){return function(W){var O=T(W);return O?new o.Color(O,"rgb",ne):null}}function U(ne){var W=ne.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!W)return null;var O=[parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3]),parseFloat(W[4])];return isNaN(O[0])||isNaN(O[1])||isNaN(O[2])||isNaN(O[3])?null:O}function ee(ne){return function(W){var O=U(W);return O?new o.Color(O,"rgb",ne):null}}var xe={"func.rgb":v("int"),"func.rgba":y("int"),"func.hsl":S("int"),"func.hsla":A("int"),"hex.rgb":D,"hex.rgba":j};function ce(ne){var W=Object.keys(xe);return W.reduce(function(O,E){if(O)return O;var F=xe[E];return F(ne)?E:null},null)}n.getColorNotation=ce;var te=[{parser:P,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:N,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:f,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:x,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:_,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:C,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:T,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:U,result:{alpha:!0,mode:"rgb",notation:"object"}}];function fe(ne){return te.reduce(function(W,O){var E=O.parser,F=O.result;return W||(E(ne)?F:null)},null)}function ge(ne,W){W===void 0&&(W="int");var O=fe(ne);return O?O.notation==="hex"&&W!=="float"?e(e({},O),{type:"int"}):O.notation==="func"?e(e({},O),{type:W}):null:null}n.detectStringColorFormat=ge;var Se=function(ne){var W=ce(ne);return W?xe[W](ne):null};n.CompositeColorParser=Se;var pe={int:[D,j,v("int"),y("int"),S("int"),A("int"),k("int"),ee("int")],float:[v("float"),y("float"),S("float"),A("float"),k("float"),ee("float")]};function se(ne){var W=pe[ne];return function(O){if(typeof O!="string")return o.Color.black(ne);var E=W.reduce(function(F,z){return F||z(O)},null);return E!=null?E:o.Color.black(ne)}}n.createColorStringBindingReader=se;function ae(ne){var W=pe[ne];return function(O){return W.reduce(function(E,F){return E||F(O)},null)}}n.createColorStringParser=ae;function Le(ne){return ne==="func.hsla"||ne==="func.rgba"||ne==="hex.rgba"}n.hasAlphaComponent=Le;function Re(ne){if(typeof ne=="string"){var W=(0,n.CompositeColorParser)(ne);if(W)return W}return o.Color.black()}n.colorFromString=Re;function Ue(ne){var W=(0,s.constrainRange)(Math.floor(ne),0,255).toString(16);return W.length===1?"0"+W:W}function Ze(ne,W){W===void 0&&(W="#");var O=(0,a.removeAlphaComponent)(ne.getComponents("rgb")).map(Ue).join("");return""+W+O}n.colorToHexRgbString=Ze;function st(ne,W){W===void 0&&(W="#");var O=ne.getComponents("rgb"),E=[O[0],O[1],O[2],O[3]*255].map(Ue).join("");return""+W+E}n.colorToHexRgbaString=st;function we(ne,W){var O=(0,r.createNumberFormatter)(W==="float"?2:0),E=(0,a.removeAlphaComponent)(ne.getComponents("rgb",W)).map(function(F){return O(F)});return"rgb("+E.join(", ")+")"}n.colorToFunctionalRgbString=we;function Mt(ne){return function(W){return we(W,ne)}}function rt(ne,W){var O=(0,r.createNumberFormatter)(2),E=(0,r.createNumberFormatter)(W==="float"?2:0),F=ne.getComponents("rgb",W).map(function(z,Z){var de=Z===3?O:E;return de(z)});return"rgba("+F.join(", ")+")"}n.colorToFunctionalRgbaString=rt;function it(ne){return function(W){return rt(W,ne)}}function Ke(ne){var W=[(0,r.createNumberFormatter)(0),i.formatPercentage,i.formatPercentage],O=(0,a.removeAlphaComponent)(ne.getComponents("hsl")).map(function(E,F){return W[F](E)});return"hsl("+O.join(", ")+")"}n.colorToFunctionalHslString=Ke;function Qe(ne){var W=[(0,r.createNumberFormatter)(0),i.formatPercentage,i.formatPercentage,(0,r.createNumberFormatter)(2)],O=ne.getComponents("hsl").map(function(E,F){return W[F](E)});return"hsla("+O.join(", ")+")"}n.colorToFunctionalHslaString=Qe;function Y(ne,W){var O=(0,r.createNumberFormatter)(W==="float"?2:0),E=["r","g","b"],F=(0,a.removeAlphaComponent)(ne.getComponents("rgb",W)).map(function(z,Z){return E[Z]+": "+O(z)});return"{"+F.join(", ")+"}"}n.colorToObjectRgbString=Y;function K(ne){return function(W){return Y(W,ne)}}function ve(ne,W){var O=(0,r.createNumberFormatter)(2),E=(0,r.createNumberFormatter)(W==="float"?2:0),F=["r","g","b","a"],z=ne.getComponents("rgb",W).map(function(Z,de){var be=de===3?O:E;return F[de]+": "+be(Z)});return"{"+z.join(", ")+"}"}n.colorToObjectRgbaString=ve;function Ae(ne){return function(W){return ve(W,ne)}}var De={"func.hsl":Ke,"func.hsla":Qe,"func.rgb":we,"func.rgba":rt,"hex.rgb":Ze,"hex.rgba":st};function je(ne){return De[ne]}n.getColorStringifier=je;var Xe=t([{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Ze},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:st},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Ke},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Qe}],["int","float"].reduce(function(ne,W){return t(t([],ne,!0),[{format:{alpha:!1,mode:"rgb",notation:"func",type:W},stringifier:Mt(W)},{format:{alpha:!0,mode:"rgb",notation:"func",type:W},stringifier:it(W)},{format:{alpha:!1,mode:"rgb",notation:"object",type:W},stringifier:K(W)},{format:{alpha:!0,mode:"rgb",notation:"object",type:W},stringifier:Ae(W)}],!1)},[]),!0);function He(ne){return Xe.reduce(function(W,O){return W||(c(O.format,ne)?O.stringifier:null)},null)}n.findColorStringifier=He})(uf);Object.defineProperty(C4,"__esModule",{value:!0});C4.APaletteView=void 0;var Mqe=_i,Cqe=fr,BF=uf,c$=Va,GS=(0,Cqe.ClassName)("apl"),Eqe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(GS()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(GS("b")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(GS("c")),r.appendChild(i),this.colorElem_=i;var s=e.createElement("div");s.classList.add(GS("m")),this.element.appendChild(s),this.markerElem_=s;var o=e.createElement("div");o.classList.add(GS("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("rgb"),r=new c$.Color([t[0],t[1],t[2],0],"rgb"),i=new c$.Color([t[0],t[1],t[2],255],"rgb"),s=["to right",(0,BF.colorToFunctionalRgbaString)(r),(0,BF.colorToFunctionalRgbaString)(i)];this.colorElem_.style.background="linear-gradient("+s.join(",")+")",this.previewElem_.style.backgroundColor=(0,BF.colorToFunctionalRgbaString)(e);var o=(0,Mqe.mapRange)(t[3],0,1,0,100);this.markerElem_.style.left=o+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();C4.APaletteView=Eqe;Object.defineProperty(M4,"__esModule",{value:!0});M4.APaletteController=void 0;var r3=Do,Aqe=ph,u$=Va,h$=Dl,Pqe=C4,Tqe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Pqe.APaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Aqe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(!!e.point){var r=e.point.x/e.bounds.width,i=this.value.rawValue,s=i.getComponents("hsv"),o=s[0],a=s[1],c=s[2];this.value.setRawValue(new u$.Color([o,a,c,r],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,r3.getStepForKey)((0,h$.getBaseStepForColor)(!0),(0,r3.getHorizontalStepKeys)(e));if(t!==0){var r=this.value.rawValue,i=r.getComponents("hsv"),s=i[0],o=i[1],a=i[2],c=i[3];this.value.setRawValue(new u$.Color([s,o,a,c+t],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,r3.getStepForKey)((0,h$.getBaseStepForColor)(!0),(0,r3.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();M4.APaletteController=Tqe;var E4={},A4={};Object.defineProperty(A4,"__esModule",{value:!0});A4.ColorTextView=void 0;var d$=ma,Rqe=go,Oqe=fr,uy=(0,Oqe.ClassName)("coltxt");function Lqe(n){var e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(t.reduce(function(r,i){var s=n.createElement("option");return s.textContent=i.text,s.value=i.value,r.appendChild(s),r},n.createDocumentFragment())),e}var Dqe=function(){function n(e,t){var r=this;this.element=e.createElement("div"),this.element.classList.add(uy());var i=e.createElement("div");i.classList.add(uy("m")),this.modeElem_=Lqe(e),this.modeElem_.classList.add(uy("ms")),i.appendChild(this.modeSelectElement);var s=e.createElement("div");s.classList.add(uy("mm")),s.appendChild((0,d$.createSvgIconElement)(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);var o=e.createElement("div");o.classList.add(uy("w")),this.element.appendChild(o),this.textsElem_=o,this.textViews_=t.textViews,this.applyTextViews_(),(0,Rqe.bindValue)(t.colorMode,function(a){r.modeElem_.value=a})}return Object.defineProperty(n.prototype,"modeSelectElement",{get:function(){return this.modeElem_},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textViews",{get:function(){return this.textViews_},set:function(e){this.textViews_=e,this.applyTextViews_()},enumerable:!1,configurable:!0}),n.prototype.applyTextViews_=function(){var e=this;(0,d$.removeChildElements)(this.textsElem_);var t=this.element.ownerDocument;this.textViews_.forEach(function(r){var i=t.createElement("div");i.classList.add(uy("c")),i.appendChild(r.element),e.textsElem_.appendChild(i)})},n}();A4.ColorTextView=Dqe;Object.defineProperty(E4,"__esModule",{value:!0});E4.ColorTextController=void 0;var Iqe=lv,Nqe=co,kqe=es,zqe=lf,Fue=yl,Bqe=cf,Vqe=Va,oj=cs,Fqe=Dl,Uqe=A4;function jqe(n){return(0,Nqe.createNumberFormatter)(n==="float"?2:0)}function Hqe(n,e,t){var r=(0,oj.getColorMaxComponents)(n,e)[t];return new Iqe.RangeConstraint({min:0,max:r})}function VF(n,e,t){return new Bqe.NumberTextController(n,{arrayPosition:t===0?"fst":t===3-1?"lst":"mid",baseStep:(0,Fqe.getBaseStepForColor)(!1),parser:e.parser,props:kqe.ValueMap.fromObject({draggingScale:e.colorType==="float"?.01:1,formatter:jqe(e.colorType)}),value:(0,Fue.createValue)(0,{constraint:Hqe(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}var Wqe=function(){function n(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=(0,Fue.createValue)(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Uqe.ColorTextView(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return n.prototype.createComponentControllers_=function(e){var t=this,r={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[VF(e,r,0),VF(e,r,1),VF(e,r,2)];return i.forEach(function(s,o){(0,zqe.connectValues)({primary:t.value,secondary:s.value,forward:function(a){return a.rawValue.getComponents(t.colorMode.rawValue,t.colorType_)[o]},backward:function(a,c){var u=t.colorMode.rawValue,d=a.rawValue.getComponents(u,t.colorType_);return d[o]=c.rawValue,new Vqe.Color((0,oj.appendAlphaComponent)((0,oj.removeAlphaComponent)(d),d[3]),u,t.colorType_)}})}),i},n.prototype.onModeSelectChange_=function(e){var t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]},n}();E4.ColorTextController=Wqe;var P4={},T4={};Object.defineProperty(T4,"__esModule",{value:!0});T4.HPaletteView=void 0;var Gqe=_i,Xqe=fr,qqe=uf,Yqe=Va,FF=(0,Xqe.ClassName)("hpl"),Zqe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(FF()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(FF("c")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(FF("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e.getComponents("hsv")[0];this.markerElem_.style.backgroundColor=(0,qqe.colorToFunctionalRgbString)(new Yqe.Color([t,100,100],"hsv"));var r=(0,Gqe.mapRange)(t,0,360,0,100);this.markerElem_.style.left=r+"%"},n.prototype.onValueChange_=function(){this.update_()},n}();T4.HPaletteView=Zqe;Object.defineProperty(P4,"__esModule",{value:!0});P4.HPaletteController=void 0;var p$=_i,i3=Do,Kqe=ph,f$=Va,m$=Dl,Jqe=T4,Qqe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Jqe.HPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Kqe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(!!e.point){var r=(0,p$.mapRange)((0,p$.constrainRange)(e.point.x,0,e.bounds.width),0,e.bounds.width,0,359),i=this.value.rawValue,s=i.getComponents("hsv"),o=s[1],a=s[2],c=s[3];this.value.setRawValue(new f$.Color([r,o,a,c],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){var t=(0,i3.getStepForKey)((0,m$.getBaseStepForColor)(!1),(0,i3.getHorizontalStepKeys)(e));if(t!==0){var r=this.value.rawValue,i=r.getComponents("hsv"),s=i[0],o=i[1],a=i[2],c=i[3];this.value.setRawValue(new f$.Color([s+t,o,a,c],"hsv"),{forceEmit:!1,last:!1})}},n.prototype.onKeyUp_=function(e){var t=(0,i3.getStepForKey)((0,m$.getBaseStepForColor)(!1),(0,i3.getHorizontalStepKeys)(e));t!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();P4.HPaletteController=Qqe;var R4={},O4={};Object.defineProperty(O4,"__esModule",{value:!0});O4.SvPaletteView=void 0;var $qe=ma,s3=_i,eYe=fr,tYe=cs,UF=(0,eYe.ClassName)("svp"),v$=64,nYe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(UF()),t.viewProps.bindTabIndex(this.element);var r=e.createElement("canvas");r.height=v$,r.width=v$,r.classList.add(UF("c")),this.element.appendChild(r),this.canvasElement=r;var i=e.createElement("div");i.classList.add(UF("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return n.prototype.update_=function(){var e=(0,$qe.getCanvasContext)(this.canvasElement);if(!!e){for(var t=this.value.rawValue,r=t.getComponents("hsv"),i=this.canvasElement.width,s=this.canvasElement.height,o=e.getImageData(0,0,i,s),a=o.data,c=0;c<s;c++)for(var u=0;u<i;u++){var d=(0,s3.mapRange)(u,0,i,0,100),p=(0,s3.mapRange)(c,0,s,100,0),f=(0,tYe.hsvToRgbInt)(r[0],d,p),v=(c*i+u)*4;a[v]=f[0],a[v+1]=f[1],a[v+2]=f[2],a[v+3]=255}e.putImageData(o,0,0);var x=(0,s3.mapRange)(r[1],0,100,0,100);this.markerElem_.style.left=x+"%";var y=(0,s3.mapRange)(r[2],0,100,100,0);this.markerElem_.style.top=y+"%"}},n.prototype.onValueChange_=function(){this.update_()},n}();O4.SvPaletteView=nYe;Object.defineProperty(R4,"__esModule",{value:!0});R4.SvPaletteController=void 0;var g$=_i,wp=Do,rYe=ph,_$=Va,y$=Dl,iYe=O4,sYe=function(){function n(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new iYe.SvPaletteView(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new rYe.PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(!!e.point){var r=(0,g$.mapRange)(e.point.x,0,e.bounds.width,0,100),i=(0,g$.mapRange)(e.point.y,0,e.bounds.height,100,0),s=this.value.rawValue.getComponents("hsv"),o=s[0],a=s[3];this.value.setRawValue(new _$.Color([o,r,i,a],"hsv"),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onKeyDown_=function(e){(0,wp.isArrowKey)(e.key)&&e.preventDefault();var t=this.value.rawValue.getComponents("hsv"),r=t[0],i=t[1],s=t[2],o=t[3],a=(0,y$.getBaseStepForColor)(!1),c=(0,wp.getStepForKey)(a,(0,wp.getHorizontalStepKeys)(e)),u=(0,wp.getStepForKey)(a,(0,wp.getVerticalStepKeys)(e));c===0&&u===0||this.value.setRawValue(new _$.Color([r,i+c,s+u,o],"hsv"),{forceEmit:!1,last:!1})},n.prototype.onKeyUp_=function(e){var t=(0,y$.getBaseStepForColor)(!1),r=(0,wp.getStepForKey)(t,(0,wp.getHorizontalStepKeys)(e)),i=(0,wp.getStepForKey)(t,(0,wp.getVerticalStepKeys)(e));r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();R4.SvPaletteController=sYe;Object.defineProperty(w4,"__esModule",{value:!0});w4.ColorPickerController=void 0;var oYe=lv,jF=co,aYe=es,lYe=lf,cYe=yl,uYe=cf,hYe=Va,dYe=S4,pYe=M4,fYe=E4,mYe=P4,vYe=R4,gYe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new mYe.HPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new vYe.SvPaletteController(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new pYe.APaletteController(e,{value:this.value,viewProps:this.viewProps}),text:new uYe.NumberTextController(e,{parser:jF.parseNumber,baseStep:.1,props:aYe.ValueMap.fromObject({draggingScale:.01,formatter:(0,jF.createNumberFormatter)(2)}),value:(0,cYe.createValue)(0,{constraint:new oYe.RangeConstraint({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&(0,lYe.connectValues)({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(r){return r.rawValue.getComponents()[3]},backward:function(r,i){var s=r.rawValue.getComponents();return s[3]=i.rawValue,new hYe.Color(s,r.rawValue.mode)}}),this.textC_=new fYe.ColorTextController(e,{colorType:t.colorType,parser:jF.parseNumber,value:this.value,viewProps:this.viewProps}),this.view=new dYe.ColorPickerView(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n}();w4.ColorPickerController=gYe;var L4={},D4={};Object.defineProperty(D4,"__esModule",{value:!0});D4.ColorSwatchView=void 0;var _Ye=fr,yYe=uf,HF=(0,_Ye.ClassName)("colsw"),xYe=function(){function n(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(HF()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(HF("sw")),this.element.appendChild(r),this.swatchElem_=r;var i=e.createElement("button");i.classList.add(HF("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue;this.swatchElem_.style.backgroundColor=(0,yYe.colorToHexRgbaString)(e)},n.prototype.onValueChange_=function(){this.update_()},n}();D4.ColorSwatchView=xYe;Object.defineProperty(L4,"__esModule",{value:!0});L4.ColorSwatchController=void 0;var bYe=D4,wYe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new bYe.ColorSwatchView(e,{value:this.value,viewProps:this.viewProps})}return n}();L4.ColorSwatchController=wYe;Object.defineProperty(G0,"__esModule",{value:!0});G0.ColorController=void 0;var x$=cl,SYe=Gb,MYe=Xb,b$=ma,CYe=es,EYe=lf,AYe=Gn,PYe=b4,TYe=w4,RYe=L4,OYe=function(){function n(e,t){var r=this;this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=x$.Foldable.create(t.expanded),this.swatchC_=new RYe.ColorSwatchController(e,{value:this.value,viewProps:this.viewProps});var i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new MYe.TextController(e,{parser:t.parser,props:CYe.ValueMap.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new PYe.ColorView(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new SYe.PopupController(e,{viewProps:this.viewProps}):null;var s=new TYe.ColorPickerController(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(function(o){o.addEventListener("blur",r.onPopupChildBlur_),o.addEventListener("keydown",r.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),(0,EYe.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(o){return o.rawValue},backward:function(o,a){return a.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,x$.bindFoldable)(this.foldable_,this.view.pickerElement))}return Object.defineProperty(n.prototype,"textController",{get:function(){return this.textC_},enumerable:!1,configurable:!0}),n.prototype.onButtonBlur_=function(e){if(!!this.popC_){var t=this.view.element,r=(0,AYe.forceCast)(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(!!this.popC_){var t=this.popC_.view.element,r=(0,b$.findNextTarget)(e);r&&t.contains(r)||r&&r===this.swatchC_.view.buttonElement&&!(0,b$.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()},n}();G0.ColorController=OYe;var io={};Object.defineProperty(io,"__esModule",{value:!0});io.colorFromRgbaNumber=io.colorFromRgbNumber=io.numberToRgbaColor=io.numberToRgbColor=io.colorToRgbaNumber=io.colorToRgbNumber=io.colorFromObject=void 0;var LYe=_i,f0=Va,DYe=cs;function IYe(n,e){return f0.Color.isColorObject(n)?f0.Color.fromObject(n,e):f0.Color.black(e)}io.colorFromObject=IYe;function NYe(n){return(0,DYe.removeAlphaComponent)(n.getComponents("rgb")).reduce(function(e,t){return e<<8|Math.floor(t)&255},0)}io.colorToRgbNumber=NYe;function kYe(n){return n.getComponents("rgb").reduce(function(e,t,r){var i=Math.floor(r===3?t*255:t)&255;return e<<8|i},0)>>>0}io.colorToRgbaNumber=kYe;function Uue(n){return new f0.Color([n>>16&255,n>>8&255,n&255],"rgb")}io.numberToRgbColor=Uue;function jue(n){return new f0.Color([n>>24&255,n>>16&255,n>>8&255,(0,LYe.mapRange)(n&255,0,255,0,1)],"rgb")}io.numberToRgbaColor=jue;function zYe(n){return typeof n!="number"?f0.Color.black():Uue(n)}io.colorFromRgbNumber=zYe;function BYe(n){return typeof n!="number"?f0.Color.black():jue(n)}io.colorFromRgbaNumber=BYe;var nA={},Tl={};Object.defineProperty(Tl,"__esModule",{value:!0});Tl.createColorObjectWriter=Tl.writeRgbColorObject=Tl.writeRgbaColorObject=Tl.createColorNumberWriter=Tl.createColorStringWriter=void 0;var Hue=cv,w$=io,VYe=uf;function FYe(n){var e=(0,VYe.findColorStringifier)(n);return e?function(t,r){(0,Hue.writePrimitive)(t,e(r))}:null}Tl.createColorStringWriter=FYe;function UYe(n){var e=n?w$.colorToRgbaNumber:w$.colorToRgbNumber;return function(t,r){(0,Hue.writePrimitive)(t,e(r))}}Tl.createColorNumberWriter=UYe;function Wue(n,e,t){var r=e.toRgbaObject(t);n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b),n.writeProperty("a",r.a)}Tl.writeRgbaColorObject=Wue;function Gue(n,e,t){var r=e.toRgbaObject(t);n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b)}Tl.writeRgbColorObject=Gue;function jYe(n,e){return function(t,r){n?Wue(t,r,e):Gue(t,r,e)}}Tl.createColorObjectWriter=jYe;Object.defineProperty(nA,"__esModule",{value:!0});nA.NumberColorInputPlugin=void 0;var HYe=G0,S$=io,aj=uf,WYe=Tl,GYe=Va,XYe=Dl;function WF(n){var e;return!!((n==null?void 0:n.alpha)||((e=n==null?void 0:n.color)===null||e===void 0?void 0:e.alpha))}function qYe(n){return n?function(e){return(0,aj.colorToHexRgbaString)(e,"0x")}:function(e){return(0,aj.colorToHexRgbString)(e,"0x")}}function YYe(n){return"color"in n||"view"in n&&n.view==="color"}nA.NumberColorInputPlugin={id:"input-color-number",type:"input",accept:function(n,e){if(typeof n!="number"||!YYe(e))return null;var t=(0,XYe.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return WF(n.params)?S$.colorFromRgbaNumber:S$.colorFromRgbNumber},equals:GYe.Color.equals,writer:function(n){return(0,WYe.createColorNumberWriter)(WF(n.params))}},controller:function(n){var e=WF(n.params),t="expanded"in n.params?n.params.expanded:void 0,r="picker"in n.params?n.params.picker:void 0;return new HYe.ColorController(n.document,{colorType:"int",expanded:t!=null?t:!1,formatter:qYe(e),parser:(0,aj.createColorStringParser)("int"),pickerLayout:r!=null?r:"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}};var rA={};Object.defineProperty(rA,"__esModule",{value:!0});rA.ObjectColorInputPlugin=void 0;var ZYe=G0,KYe=io,lj=uf,JYe=Tl,_R=Va,o3=Dl;function QYe(n){return _R.Color.isRgbaColorObject(n)}function $Ye(n){return function(e){return(0,KYe.colorFromObject)(e,n)}}function eZe(n,e){return function(t){return n?(0,lj.colorToObjectRgbaString)(t,e):(0,lj.colorToObjectRgbString)(t,e)}}rA.ObjectColorInputPlugin={id:"input-color-object",type:"input",accept:function(n,e){if(!_R.Color.isColorObject(n))return null;var t=(0,o3.parseColorInputParams)(e);return t?{initialValue:n,params:t}:null},binding:{reader:function(n){return $Ye((0,o3.extractColorType)(n.params))},equals:_R.Color.equals,writer:function(n){return(0,JYe.createColorObjectWriter)(QYe(n.initialValue),(0,o3.extractColorType)(n.params))}},controller:function(n){var e,t=_R.Color.isRgbaColorObject(n.initialValue),r="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0,s=(e=(0,o3.extractColorType)(n.params))!==null&&e!==void 0?e:"int";return new ZYe.ColorController(n.document,{colorType:s,expanded:r!=null?r:!1,formatter:eZe(t,s),parser:(0,lj.createColorStringParser)(s),pickerLayout:i!=null?i:"popup",supportsAlpha:t,value:n.value,viewProps:n.viewProps})}};var iA={};Object.defineProperty(iA,"__esModule",{value:!0});iA.StringColorInputPlugin=void 0;var a3=Fl,tZe=G0,Ng=uf,nZe=Tl,rZe=Va,XS=Dl;iA.StringColorInputPlugin={id:"input-color-string",type:"input",accept:function(n,e){if(typeof n!="string"||"view"in e&&e.view==="text")return null;var t=(0,Ng.detectStringColorFormat)(n,(0,XS.extractColorType)(e));if(!t)return null;var r=(0,Ng.findColorStringifier)(t);if(!r)return null;var i=(0,XS.parseColorInputParams)(e);return i?{initialValue:n,params:i}:null},binding:{reader:function(n){var e;return(0,Ng.createColorStringBindingReader)((e=(0,XS.extractColorType)(n.params))!==null&&e!==void 0?e:"int")},equals:rZe.Color.equals,writer:function(n){var e=(0,Ng.detectStringColorFormat)(n.initialValue,(0,XS.extractColorType)(n.params));if(!e)throw a3.TpError.shouldNeverHappen();var t=(0,nZe.createColorStringWriter)(e);if(!t)throw a3.TpError.notBindable();return t}},controller:function(n){var e=(0,Ng.detectStringColorFormat)(n.initialValue,(0,XS.extractColorType)(n.params));if(!e)throw a3.TpError.shouldNeverHappen();var t=(0,Ng.findColorStringifier)(e);if(!t)throw a3.TpError.shouldNeverHappen();var r="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0;return new tZe.ColorController(n.document,{colorType:e.type,expanded:r!=null?r:!1,formatter:t,parser:(0,Ng.createColorStringParser)(e.type),pickerLayout:i!=null?i:"popup",supportsAlpha:e.alpha,value:n.value,viewProps:n.viewProps})}};var X0={};Object.defineProperty(X0,"__esModule",{value:!0});X0.PointNdConstraint=void 0;var iZe=function(){function n(e){this.components=e.components,this.asm_=e.assembly}return n.prototype.constrain=function(e){var t=this,r=this.asm_.toComponents(e).map(function(i,s){var o,a;return(a=(o=t.components[s])===null||o===void 0?void 0:o.constrain(i))!==null&&a!==void 0?a:i});return this.asm_.fromComponents(r)},n}();X0.PointNdConstraint=iZe;var q0={},I4={};Object.defineProperty(I4,"__esModule",{value:!0});I4.PointNdTextView=void 0;var sZe=fr,M$=(0,sZe.ClassName)("pndtxt"),oZe=function(){function n(e,t){var r=this;this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(M$()),this.textViews.forEach(function(i){var s=e.createElement("div");s.classList.add(M$("a")),s.appendChild(i.element),r.element.appendChild(s)})}return n}();I4.PointNdTextView=oZe;Object.defineProperty(q0,"__esModule",{value:!0});q0.PointNdTextController=void 0;var aZe=lf,lZe=yl,cZe=cf,uZe=I4;function hZe(n,e,t){return new cZe.NumberTextController(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",baseStep:e.axes[t].baseStep,parser:e.parser,props:e.axes[t].textProps,value:(0,lZe.createValue)(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}var dZe=function(){function n(e,t){var r=this;this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(function(i,s){return hZe(e,t,s)}),this.acs_.forEach(function(i,s){(0,aZe.connectValues)({primary:r.value,secondary:i.value,forward:function(o){return t.assembly.toComponents(o.rawValue)[s]},backward:function(o,a){var c=t.assembly.toComponents(o.rawValue);return c[s]=a.rawValue,t.assembly.fromComponents(c)}})}),this.view=new uZe.PointNdTextView(e,{textViews:this.acs_.map(function(i){return i.view})})}return n}();q0.PointNdTextController=dZe;var ed={};Object.defineProperty(ed,"__esModule",{value:!0});ed.NumberInputPlugin=ed.createRangeConstraint=ed.createStepConstraint=void 0;var ZO=uh,pZe=av,X7=lv,fZe=Wb,mZe=W0,l3=co,c3=es,vZe=cf,gZe=QE,C$=Ws,_Ze=cv,nm=hi,cj=Gn;function Xue(n,e){return"step"in n&&!(0,cj.isEmpty)(n.step)?new fZe.StepConstraint(n.step,e):null}ed.createStepConstraint=Xue;function que(n){return"max"in n&&!(0,cj.isEmpty)(n.max)||"min"in n&&!(0,cj.isEmpty)(n.min)?new X7.RangeConstraint({max:n.max,min:n.min}):null}ed.createRangeConstraint=que;function yZe(n,e){var t=[],r=Xue(n,e);r&&t.push(r);var i=que(n);i&&t.push(i);var s=(0,nm.createListConstraint)(n.options);return s&&t.push(s),new ZO.CompositeConstraint(t)}function xZe(n){var e=n?(0,ZO.findConstraint)(n,X7.RangeConstraint):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function bZe(n){var e=xZe(n),t=e[0],r=e[1];return[t!=null?t:0,r!=null?r:100]}ed.NumberInputPlugin={id:"input-number",type:"input",accept:function(n,e){if(typeof n!="number")return null;var t=C$.ParamsParsers,r=(0,C$.parseParams)(e,{format:t.optional.function,max:t.optional.number,min:t.optional.number,options:t.optional.custom(nm.parseListOptions),step:t.optional.number});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return l3.numberFromUnknown},constraint:function(n){return yZe(n.params,n.initialValue)},writer:function(n){return _Ze.writePrimitive}},controller:function(n){var e,t,r=n.value,i=n.constraint;if(i&&(0,ZO.findConstraint)(i,pZe.ListConstraint))return new mZe.ListController(n.document,{props:c3.ValueMap.fromObject({options:(e=(0,nm.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps});var s=(t="format"in n.params?n.params.format:void 0)!==null&&t!==void 0?t:(0,l3.createNumberFormatter)((0,nm.getSuitableDecimalDigits)(i,r.rawValue));if(i&&(0,ZO.findConstraint)(i,X7.RangeConstraint)){var o=bZe(i),a=o[0],c=o[1];return new gZe.SliderTextController(n.document,{baseStep:(0,nm.getBaseStep)(i),parser:l3.parseNumber,sliderProps:c3.ValueMap.fromObject({maxValue:c,minValue:a}),textProps:c3.ValueMap.fromObject({draggingScale:(0,nm.getSuitableDraggingScale)(i,r.rawValue),formatter:s}),value:r,viewProps:n.viewProps})}return new vZe.NumberTextController(n.document,{baseStep:(0,nm.getBaseStep)(i),parser:l3.parseNumber,props:c3.ValueMap.fromObject({draggingScale:(0,nm.getSuitableDraggingScale)(i,r.rawValue),formatter:s}),value:r,viewProps:n.viewProps})}};var sA={},Zp={},wZe=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(Zp,"__esModule",{value:!0});Zp.Point2dAssembly=Zp.Point2d=void 0;var SZe=Gn,uj=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=e,this.y=t}return n.prototype.getComponents=function(){return[this.x,this.y]},n.isObject=function(e){if((0,SZe.isEmpty)(e))return!1;var t=e.x,r=e.y;return!(typeof t!="number"||typeof r!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y},n.prototype.toObject=function(){return{x:this.x,y:this.y}},n}();Zp.Point2d=uj;Zp.Point2dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(uj.bind.apply(uj,wZe([void 0],n,!1)))}};var N4={};Object.defineProperty(N4,"__esModule",{value:!0});N4.Point2dView=void 0;var MZe=ma,CZe=go,EZe=fr,AZe=zl,hy=(0,EZe.ClassName)("p2d"),PZe=function(){function n(e,t){this.element=e.createElement("div"),this.element.classList.add(hy()),t.viewProps.bindClassModifiers(this.element),(0,CZe.bindValue)(t.expanded,(0,AZe.valueToClassName)(this.element,hy(void 0,"expanded")));var r=e.createElement("div");r.classList.add(hy("h")),this.element.appendChild(r);var i=e.createElement("button");i.classList.add(hy("b")),i.appendChild((0,MZe.createSvgIconElement)(e,"p2dpad")),t.viewProps.bindDisabled(i),r.appendChild(i),this.buttonElement=i;var s=e.createElement("div");if(s.classList.add(hy("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){var o=e.createElement("div");o.classList.add(hy("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}return n}();N4.Point2dView=PZe;var k4={},z4={};Object.defineProperty(z4,"__esModule",{value:!0});z4.Point2dPickerView=void 0;var u3=ma,E$=_i,TZe=fr,$f=(0,TZe.ClassName)("p2dp"),RZe=function(){function n(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add($f()),t.layout==="popup"&&this.element.classList.add($f(void 0,"p"));var r=e.createElement("div");r.classList.add($f("p")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;var i=e.createElementNS(u3.SVG_NS,"svg");i.classList.add($f("g")),this.padElement.appendChild(i),this.svgElem_=i;var s=e.createElementNS(u3.SVG_NS,"line");s.classList.add($f("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);var o=e.createElementNS(u3.SVG_NS,"line");o.classList.add($f("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);var a=e.createElementNS(u3.SVG_NS,"line");a.classList.add($f("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;var c=e.createElement("div");c.classList.add($f("m")),this.padElement.appendChild(c),this.markerElem_=c,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"allFocusableElements",{get:function(){return[this.padElement]},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.value.rawValue.getComponents(),t=e[0],r=e[1],i=this.maxValue_,s=(0,E$.mapRange)(t,-i,+i,0,100),o=(0,E$.mapRange)(r,-i,+i,0,100),a=this.invertsY_?100-o:o;this.lineElem_.setAttributeNS(null,"x2",s+"%"),this.lineElem_.setAttributeNS(null,"y2",a+"%"),this.markerElem_.style.left=s+"%",this.markerElem_.style.top=a+"%"},n.prototype.onValueChange_=function(){this.update_()},n.prototype.onFoldableChange_=function(){this.update_()},n}();z4.Point2dPickerView=RZe;Object.defineProperty(k4,"__esModule",{value:!0});k4.Point2dPickerController=void 0;var A$=_i,uM=Do,OZe=ph,P$=Zp,LZe=z4;function T$(n,e,t){return[(0,uM.getStepForKey)(e[0],(0,uM.getHorizontalStepKeys)(n)),(0,uM.getStepForKey)(e[1],(0,uM.getVerticalStepKeys)(n))*(t?1:-1)]}var DZe=function(){function n(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new LZe.Point2dPickerView(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new OZe.PointerHandler(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return n.prototype.handlePointerEvent_=function(e,t){if(!!e.point){var r=this.maxValue_,i=(0,A$.mapRange)(e.point.x,0,e.bounds.width,-r,+r),s=(0,A$.mapRange)(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-r,+r);this.value.setRawValue(new P$.Point2d(i,s),t)}},n.prototype.onPointerDown_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerMove_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})},n.prototype.onPointerUp_=function(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})},n.prototype.onPadKeyDown_=function(e){(0,uM.isArrowKey)(e.key)&&e.preventDefault();var t=T$(e,this.baseSteps_,this.invertsY_),r=t[0],i=t[1];r===0&&i===0||this.value.setRawValue(new P$.Point2d(this.value.rawValue.x+r,this.value.rawValue.y+i),{forceEmit:!1,last:!1})},n.prototype.onPadKeyUp_=function(e){var t=T$(e,this.baseSteps_,this.invertsY_),r=t[0],i=t[1];r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})},n}();k4.Point2dPickerController=DZe;Object.defineProperty(sA,"__esModule",{value:!0});sA.Point2dController=void 0;var R$=cl,IZe=Gb,O$=ma,NZe=lf,kZe=Gn,zZe=q0,BZe=Zp,VZe=N4,FZe=k4,UZe=function(){function n(e,t){var r=this,i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=R$.Foldable.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new IZe.PopupController(e,{viewProps:this.viewProps}):null;var o=new FZe.Point2dPickerController(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(function(a){a.addEventListener("blur",r.onPopupChildBlur_),a.addEventListener("keydown",r.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new zZe.PointNdTextController(e,{assembly:BZe.Point2dAssembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new VZe.Point2dView(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),(0,NZe.connectValues)({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(a){return a.rawValue},backward:function(a,c){return c.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),(0,R$.bindFoldable)(this.foldable_,this.view.pickerElement))}return n.prototype.onPadButtonBlur_=function(e){if(!!this.popC_){var t=this.view.element,r=(0,kZe.forceCast)(e.relatedTarget);(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}},n.prototype.onPadButtonClick_=function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()},n.prototype.onPopupChildBlur_=function(e){if(!!this.popC_){var t=this.popC_.view.element,r=(0,O$.findNextTarget)(e);r&&t.contains(r)||r&&r===this.view.buttonElement&&!(0,O$.supportsTouch)(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}},n.prototype.onPopupChildKeydown_=function(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()},n}();sA.Point2dController=UZe;var ah={},Ux={};Object.defineProperty(Ux,"__esModule",{value:!0});Ux.writePoint2d=Ux.point2dFromUnknown=void 0;var GF=Zp;function jZe(n){return GF.Point2d.isObject(n)?new GF.Point2d(n.x,n.y):new GF.Point2d}Ux.point2dFromUnknown=jZe;function HZe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}Ux.writePoint2d=HZe;Object.defineProperty(ah,"__esModule",{value:!0});ah.Point2dInputPlugin=ah.getSuitableMaxValue=ah.createDimensionConstraint=void 0;var Yue=uh,WZe=lv,Zue=co,GZe=es,L$=Ws,XZe=Fl,Ky=hi,KO=X0,D$=ed,qZe=sA,I$=Ux,hj=Zp;function dj(n,e){if(!!n){var t=[],r=(0,D$.createStepConstraint)(n,e);r&&t.push(r);var i=(0,D$.createRangeConstraint)(n);return i&&t.push(i),new Yue.CompositeConstraint(t)}}ah.createDimensionConstraint=dj;function YZe(n,e){return new KO.PointNdConstraint({assembly:hj.Point2dAssembly,components:[dj("x"in n?n.x:void 0,e.x),dj("y"in n?n.y:void 0,e.y)]})}function N$(n,e){var t,r,i=n&&(0,Yue.findConstraint)(n,WZe.RangeConstraint);if(i)return Math.max(Math.abs((t=i.minValue)!==null&&t!==void 0?t:0),Math.abs((r=i.maxValue)!==null&&r!==void 0?r:0));var s=(0,Ky.getBaseStep)(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Kue(n,e){var t=e instanceof KO.PointNdConstraint?e.components[0]:void 0,r=e instanceof KO.PointNdConstraint?e.components[1]:void 0,i=N$(t,n.x),s=N$(r,n.y);return Math.max(i,s)}ah.getSuitableMaxValue=Kue;function k$(n,e){return{baseStep:(0,Ky.getBaseStep)(e),constraint:e,textProps:GZe.ValueMap.fromObject({draggingScale:(0,Ky.getSuitableDraggingScale)(e,n),formatter:(0,Zue.createNumberFormatter)((0,Ky.getSuitableDecimalDigits)(e,n))})}}function ZZe(n){if(!("y"in n))return!1;var e=n.y;return e&&"inverted"in e?!!e.inverted:!1}ah.Point2dInputPlugin={id:"input-point2d",type:"input",accept:function(n,e){if(!hj.Point2d.isObject(n))return null;var t=L$.ParamsParsers,r=(0,L$.parseParams)(e,{expanded:t.optional.boolean,picker:t.optional.custom(Ky.parsePickerLayout),x:t.optional.custom(Ky.parsePointDimensionParams),y:t.optional.object({inverted:t.optional.boolean,max:t.optional.number,min:t.optional.number,step:t.optional.number})});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return I$.point2dFromUnknown},constraint:function(n){return YZe(n.params,n.initialValue)},equals:hj.Point2d.equals,writer:function(n){return I$.writePoint2d}},controller:function(n){var e=n.document,t=n.value,r=n.constraint;if(!(r instanceof KO.PointNdConstraint))throw XZe.TpError.shouldNeverHappen();var i="expanded"in n.params?n.params.expanded:void 0,s="picker"in n.params?n.params.picker:void 0;return new qZe.Point2dController(e,{axes:[k$(t.rawValue.x,r.components[0]),k$(t.rawValue.y,r.components[1])],expanded:i!=null?i:!1,invertsY:ZZe(n.params),maxValue:Kue(t.rawValue,r),parser:Zue.parseNumber,pickerLayout:s!=null?s:"popup",value:t,viewProps:n.viewProps})}};var oA={},jx={},M0={},KZe=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(M0,"__esModule",{value:!0});M0.Point3dAssembly=M0.Point3d=void 0;var JZe=Gn,pj=function(){function n(e,t,r){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),this.x=e,this.y=t,this.z=r}return n.prototype.getComponents=function(){return[this.x,this.y,this.z]},n.isObject=function(e){if((0,JZe.isEmpty)(e))return!1;var t=e.x,r=e.y,i=e.z;return!(typeof t!="number"||typeof r!="number"||typeof i!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z}},n}();M0.Point3d=pj;M0.Point3dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(pj.bind.apply(pj,KZe([void 0],n,!1)))}};Object.defineProperty(jx,"__esModule",{value:!0});jx.writePoint3d=jx.point3dFromUnknown=void 0;var XF=M0;function QZe(n){return XF.Point3d.isObject(n)?new XF.Point3d(n.x,n.y,n.z):new XF.Point3d}jx.point3dFromUnknown=QZe;function $Ze(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}jx.writePoint3d=$Ze;Object.defineProperty(oA,"__esModule",{value:!0});oA.Point3dInputPlugin=void 0;var Jue=co,eKe=es,z$=Ws,tKe=Fl,Jy=hi,Que=X0,nKe=q0,qF=ah,B$=jx,yR=M0;function rKe(n,e){return new Que.PointNdConstraint({assembly:yR.Point3dAssembly,components:[(0,qF.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,qF.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,qF.createDimensionConstraint)("z"in n?n.z:void 0,e.z)]})}function YF(n,e){return{baseStep:(0,Jy.getBaseStep)(e),constraint:e,textProps:eKe.ValueMap.fromObject({draggingScale:(0,Jy.getSuitableDraggingScale)(e,n),formatter:(0,Jue.createNumberFormatter)((0,Jy.getSuitableDecimalDigits)(e,n))})}}oA.Point3dInputPlugin={id:"input-point3d",type:"input",accept:function(n,e){if(!yR.Point3d.isObject(n))return null;var t=z$.ParamsParsers,r=(0,z$.parseParams)(e,{x:t.optional.custom(Jy.parsePointDimensionParams),y:t.optional.custom(Jy.parsePointDimensionParams),z:t.optional.custom(Jy.parsePointDimensionParams)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return B$.point3dFromUnknown},constraint:function(n){return rKe(n.params,n.initialValue)},equals:yR.Point3d.equals,writer:function(n){return B$.writePoint3d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof Que.PointNdConstraint))throw tKe.TpError.shouldNeverHappen();return new nKe.PointNdTextController(n.document,{assembly:yR.Point3dAssembly,axes:[YF(e.rawValue.x,t.components[0]),YF(e.rawValue.y,t.components[1]),YF(e.rawValue.z,t.components[2])],parser:Jue.parseNumber,value:e,viewProps:n.viewProps})}};var aA={},Hx={},C0={},iKe=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(C0,"__esModule",{value:!0});C0.Point4dAssembly=C0.Point4d=void 0;var sKe=Gn,fj=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=e,this.y=t,this.z=r,this.w=i}return n.prototype.getComponents=function(){return[this.x,this.y,this.z,this.w]},n.isObject=function(e){if((0,sKe.isEmpty)(e))return!1;var t=e.x,r=e.y,i=e.z,s=e.w;return!(typeof t!="number"||typeof r!="number"||typeof i!="number"||typeof s!="number")},n.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},n.prototype.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},n}();C0.Point4d=fj;C0.Point4dAssembly={toComponents:function(n){return n.getComponents()},fromComponents:function(n){return new(fj.bind.apply(fj,iKe([void 0],n,!1)))}};Object.defineProperty(Hx,"__esModule",{value:!0});Hx.writePoint4d=Hx.point4dFromUnknown=void 0;var ZF=C0;function oKe(n){return ZF.Point4d.isObject(n)?new ZF.Point4d(n.x,n.y,n.z,n.w):new ZF.Point4d}Hx.point4dFromUnknown=oKe;function aKe(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}Hx.writePoint4d=aKe;Object.defineProperty(aA,"__esModule",{value:!0});aA.Point4dInputPlugin=void 0;var $ue=co,lKe=es,V$=Ws,cKe=Fl,t0=hi,ehe=X0,uKe=q0,h3=ah,F$=Hx,xR=C0;function hKe(n,e){return new ehe.PointNdConstraint({assembly:xR.Point4dAssembly,components:[(0,h3.createDimensionConstraint)("x"in n?n.x:void 0,e.x),(0,h3.createDimensionConstraint)("y"in n?n.y:void 0,e.y),(0,h3.createDimensionConstraint)("z"in n?n.z:void 0,e.z),(0,h3.createDimensionConstraint)("w"in n?n.w:void 0,e.w)]})}function dKe(n,e){return{baseStep:(0,t0.getBaseStep)(e),constraint:e,textProps:lKe.ValueMap.fromObject({draggingScale:(0,t0.getSuitableDraggingScale)(e,n),formatter:(0,$ue.createNumberFormatter)((0,t0.getSuitableDecimalDigits)(e,n))})}}aA.Point4dInputPlugin={id:"input-point4d",type:"input",accept:function(n,e){if(!xR.Point4d.isObject(n))return null;var t=V$.ParamsParsers,r=(0,V$.parseParams)(e,{x:t.optional.custom(t0.parsePointDimensionParams),y:t.optional.custom(t0.parsePointDimensionParams),z:t.optional.custom(t0.parsePointDimensionParams),w:t.optional.custom(t0.parsePointDimensionParams)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return F$.point4dFromUnknown},constraint:function(n){return hKe(n.params,n.initialValue)},equals:xR.Point4d.equals,writer:function(n){return F$.writePoint4d}},controller:function(n){var e=n.value,t=n.constraint;if(!(t instanceof ehe.PointNdConstraint))throw cKe.TpError.shouldNeverHappen();return new uKe.PointNdTextController(n.document,{assembly:xR.Point4dAssembly,axes:e.rawValue.getComponents().map(function(r,i){return dKe(r,t.components[i])}),parser:$ue.parseNumber,value:e,viewProps:n.viewProps})}};var lA={};Object.defineProperty(lA,"__esModule",{value:!0});lA.StringInputPlugin=void 0;var the=uh,pKe=av,fKe=W0,mKe=Xb,U$=Vm,j$=es,H$=Ws,vKe=cv,mj=hi;function gKe(n){var e=[],t=(0,mj.createListConstraint)(n.options);return t&&e.push(t),new the.CompositeConstraint(e)}lA.StringInputPlugin={id:"input-string",type:"input",accept:function(n,e){if(typeof n!="string")return null;var t=H$.ParamsParsers,r=(0,H$.parseParams)(e,{options:t.optional.custom(mj.parseListOptions)});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return U$.stringFromUnknown},constraint:function(n){return gKe(n.params)},writer:function(n){return vKe.writePrimitive}},controller:function(n){var e,t=n.document,r=n.value,i=n.constraint;return i&&(0,the.findConstraint)(i,pKe.ListConstraint)?new fKe.ListController(t,{props:j$.ValueMap.fromObject({options:(e=(0,mj.findListItems)(i))!==null&&e!==void 0?e:[]}),value:r,viewProps:n.viewProps}):new mKe.TextController(t,{parser:function(s){return s},props:j$.ValueMap.fromObject({formatter:U$.formatString}),value:r,viewProps:n.viewProps})}};var uv={};Object.defineProperty(uv,"__esModule",{value:!0});uv.Constants=void 0;uv.Constants={monitor:{defaultInterval:200,defaultLineCount:3}};var cA={},Y0={},B4={};Object.defineProperty(B4,"__esModule",{value:!0});B4.MultiLogView=void 0;var _Ke=fr,W$=(0,_Ke.ClassName)("mll"),yKe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(W$()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("textarea");r.classList.add(W$("i")),r.style.height="calc(var(--bld-us) * "+t.lineCount+")",r.readOnly=!0,t.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this,t=this.textareaElem_,r=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach(function(s){s!==void 0&&i.push(e.formatter_(s))}),t.textContent=i.join(`
`),r&&(t.scrollTop=t.scrollHeight)},n.prototype.onValueUpdate_=function(){this.update_()},n}();B4.MultiLogView=yKe;Object.defineProperty(Y0,"__esModule",{value:!0});Y0.MultiLogController=void 0;var xKe=B4,bKe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new xKe.MultiLogView(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}return n}();Y0.MultiLogController=bKe;var Z0={},V4={};Object.defineProperty(V4,"__esModule",{value:!0});V4.SingleLogView=void 0;var wKe=fr,G$=(0,wKe.ClassName)("sgl"),SKe=function(){function n(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(G$()),t.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add(G$("i")),r.readOnly=!0,r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return n.prototype.update_=function(){var e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""},n.prototype.onValueUpdate_=function(){this.update_()},n}();V4.SingleLogView=SKe;Object.defineProperty(Z0,"__esModule",{value:!0});Z0.SingleLogController=void 0;var MKe=V4,CKe=function(){function n(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new MKe.SingleLogView(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}return n}();Z0.SingleLogController=CKe;Object.defineProperty(cA,"__esModule",{value:!0});cA.BooleanMonitorPlugin=void 0;var KF=$h,X$=Ws,EKe=uv,AKe=Y0,PKe=Z0;cA.BooleanMonitorPlugin={id:"monitor-bool",type:"monitor",accept:function(n,e){if(typeof n!="boolean")return null;var t=X$.ParamsParsers,r=(0,X$.parseParams)(e,{lineCount:t.optional.number});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return KF.boolFromUnknown}},controller:function(n){var e;return n.value.rawValue.length===1?new PKe.SingleLogController(n.document,{formatter:KF.BooleanFormatter,value:n.value,viewProps:n.viewProps}):new AKe.MultiLogController(n.document,{formatter:KF.BooleanFormatter,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:EKe.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}};var uA={},F4={};Object.defineProperty(F4,"__esModule",{value:!0});F4.GraphLogView=void 0;var JF=ma,d3=_i,nhe=fr,em=(0,nhe.ClassName)("grl"),TKe=function(){function n(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(em()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var r=e.createElementNS(JF.SVG_NS,"svg");r.classList.add(em("g")),r.style.height="calc(var(--bld-us) * "+t.lineCount+")",this.element.appendChild(r),this.svgElem_=r;var i=e.createElementNS(JF.SVG_NS,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;var s=e.createElement("div");s.classList.add(em("t"),(0,nhe.ClassName)("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}return Object.defineProperty(n.prototype,"graphElement",{get:function(){return this.svgElem_},enumerable:!1,configurable:!0}),n.prototype.update_=function(){var e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,r=this.props_.get("minValue"),i=this.props_.get("maxValue"),s=[];this.value.rawValue.forEach(function(d,p){if(d!==void 0){var f=(0,d3.mapRange)(p,0,t,0,e.width),v=(0,d3.mapRange)(d,r,i,e.height,0);s.push([f,v].join(","))}}),this.lineElem_.setAttributeNS(null,"points",s.join(" "));var o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove(em("t","a"));return}var c=(0,d3.mapRange)(this.cursor_.rawValue,0,t,0,e.width),u=(0,d3.mapRange)(a,r,i,e.height,0);o.style.left=c+"px",o.style.top=u+"px",o.textContent=""+this.formatter_(a),o.classList.contains(em("t","a"))||(o.classList.add(em("t","a"),em("t","in")),(0,JF.forceReflow)(o),o.classList.remove(em("t","in")))},n.prototype.onValueUpdate_=function(){this.update_()},n.prototype.onCursorChange_=function(){this.update_()},n}();F4.GraphLogView=TKe;Object.defineProperty(uA,"__esModule",{value:!0});uA.GraphLogController=void 0;var RKe=ma,OKe=yl,q$=_i,LKe=ph,DKe=F4,IKe=function(){function n(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=(0,OKe.createValue)(-1),this.view=new DKe.GraphLogView(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!(0,RKe.supportsTouch)(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{var r=new LKe.PointerHandler(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}}return n.prototype.onGraphMouseLeave_=function(){this.cursor_.rawValue=-1},n.prototype.onGraphMouseMove_=function(e){var t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor((0,q$.mapRange)(e.offsetX,0,t.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerDown_=function(e){this.onGraphPointerMove_(e)},n.prototype.onGraphPointerMove_=function(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor((0,q$.mapRange)(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))},n.prototype.onGraphPointerUp_=function(){this.cursor_.rawValue=-1},n}();uA.GraphLogController=IKe;var hA={};Object.defineProperty(hA,"__esModule",{value:!0});hA.NumberMonitorPlugin=void 0;var rhe=co,NKe=es,Y$=Ws,ihe=uv,kKe=Gn,zKe=Y0,BKe=Z0,VKe=uA;function vj(n){return"format"in n&&!(0,kKe.isEmpty)(n.format)?n.format:(0,rhe.createNumberFormatter)(2)}function FKe(n){var e;return n.value.rawValue.length===1?new BKe.SingleLogController(n.document,{formatter:vj(n.params),value:n.value,viewProps:n.viewProps}):new zKe.MultiLogController(n.document,{formatter:vj(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:ihe.Constants.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function UKe(n){var e,t,r;return new VKe.GraphLogController(n.document,{formatter:vj(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:ihe.Constants.monitor.defaultLineCount,props:NKe.ValueMap.fromObject({maxValue:(t="max"in n.params?n.params.max:null)!==null&&t!==void 0?t:100,minValue:(r="min"in n.params?n.params.min:null)!==null&&r!==void 0?r:0}),value:n.value,viewProps:n.viewProps})}function Z$(n){return"view"in n&&n.view==="graph"}hA.NumberMonitorPlugin={id:"monitor-number",type:"monitor",accept:function(n,e){if(typeof n!="number")return null;var t=Y$.ParamsParsers,r=(0,Y$.parseParams)(e,{format:t.optional.function,lineCount:t.optional.number,max:t.optional.number,min:t.optional.number,view:t.optional.string});return r?{initialValue:n,params:r}:null},binding:{defaultBufferSize:function(n){return Z$(n)?64:1},reader:function(n){return rhe.numberFromUnknown}},controller:function(n){return Z$(n.params)?UKe(n):FKe(n)}};var dA={};Object.defineProperty(dA,"__esModule",{value:!0});dA.StringMonitorPlugin=void 0;var QF=Vm,K$=Ws,jKe=uv,HKe=Y0,WKe=Z0;dA.StringMonitorPlugin={id:"monitor-string",type:"monitor",accept:function(n,e){if(typeof n!="string")return null;var t=K$.ParamsParsers,r=(0,K$.parseParams)(e,{lineCount:t.optional.number,multiline:t.optional.boolean});return r?{initialValue:n,params:r}:null},binding:{reader:function(n){return QF.stringFromUnknown}},controller:function(n){var e,t=n.value,r=t.rawValue.length>1||"multiline"in n.params&&n.params.multiline;return r?new HKe.MultiLogController(n.document,{formatter:QF.formatString,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:jKe.Constants.monitor.defaultLineCount,value:t,viewProps:n.viewProps}):new WKe.SingleLogController(n.document,{formatter:QF.formatString,value:t,viewProps:n.viewProps})}};var she={};Object.defineProperty(she,"__esModule",{value:!0});var U4={},pA={},j4={},H4={};Object.defineProperty(H4,"__esModule",{value:!0});H4.InputBinding=void 0;var GKe=Ps,XKe=function(){function n(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new GKe.Emitter,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return n.prototype.read=function(){var e=this.target.read();e!==void 0&&(this.value.rawValue=this.reader(e))},n.prototype.write_=function(e){this.writer(this.target,e)},n.prototype.onValueChange_=function(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})},n}();H4.InputBinding=XKe;Object.defineProperty(j4,"__esModule",{value:!0});j4.createInputBindingController=void 0;var qKe=rv,YKe=iv,ZKe=H4,KKe=es,JKe=yl,QKe=ov,$Ke=Ws,eJe=Gn;function tJe(n,e){var t=n.accept(e.target.read(),e.params);if((0,eJe.isEmpty)(t))return null;var r=$Ke.ParamsParsers,i={target:e.target,initialValue:t.initialValue,params:t.params},s=n.binding.reader(i),o=n.binding.constraint?n.binding.constraint(i):void 0,a=(0,JKe.createValue)(s(t.initialValue),{constraint:o,equals:n.binding.equals}),c=new ZKe.InputBinding({reader:s,target:e.target,value:a,writer:n.binding.writer(i)}),u=r.optional.boolean(e.params.disabled).value,d=r.optional.boolean(e.params.hidden).value,p=n.controller({constraint:o,document:e.document,initialValue:t.initialValue,params:t.params,value:c.value,viewProps:QKe.ViewProps.create({disabled:u,hidden:d})}),f=r.optional.string(e.params.label).value;return new YKe.InputBindingController(e.document,{binding:c,blade:(0,qKe.createBlade)(),props:KKe.ValueMap.fromObject({label:f!=null?f:e.target.key}),valueController:p})}j4.createInputBindingController=tJe;var W4={},G4={};Object.defineProperty(G4,"__esModule",{value:!0});G4.MonitorBinding=void 0;var nJe=Fm,rJe=Ps,iJe=function(){function n(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new rJe.Emitter,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return n.prototype.dispose=function(){this.ticker.dispose()},n.prototype.read=function(){var e=this.target.read();if(e!==void 0){var t=this.value.rawValue,r=this.reader_(e);this.value.rawValue=(0,nJe.createPushedBuffer)(t,r),this.emitter.emit("update",{rawValue:r,sender:this})}},n.prototype.onTick_=function(e){this.read()},n}();G4.MonitorBinding=iJe;Object.defineProperty(W4,"__esModule",{value:!0});W4.createMonitorBindingController=void 0;var sJe=rv,oJe=sv,aJe=G4,lJe=WE,cJe=HE,uJe=Fm,hJe=es,dJe=ov,pJe=Ws,fJe=uv,mJe=Gn;function vJe(n,e){return e===0?new cJe.ManualTicker:new lJe.IntervalTicker(n,e!=null?e:fJe.Constants.monitor.defaultInterval)}function gJe(n,e){var t,r,i,s=pJe.ParamsParsers,o=n.accept(e.target.read(),e.params);if((0,mJe.isEmpty)(o))return null;var a={target:e.target,initialValue:o.initialValue,params:o.params},c=n.binding.reader(a),u=(r=(t=s.optional.number(e.params.bufferSize).value)!==null&&t!==void 0?t:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(o.params))!==null&&r!==void 0?r:1,d=s.optional.number(e.params.interval).value,p=new aJe.MonitorBinding({reader:c,target:e.target,ticker:vJe(e.document,d),value:(0,uJe.initializeBuffer)(u)}),f=s.optional.boolean(e.params.disabled).value,v=s.optional.boolean(e.params.hidden).value,x=n.controller({document:e.document,params:o.params,value:p.value,viewProps:dJe.ViewProps.create({disabled:f,hidden:v})}),y=(i=s.optional.string(e.params.label).value)!==null&&i!==void 0?i:e.target.key;return new oJe.MonitorBindingController(e.document,{binding:p,blade:(0,sJe.createBlade)(),props:hJe.ValueMap.fromObject({label:y}),valueController:x})}W4.createMonitorBindingController=gJe;var $F=Ct&&Ct.__spreadArray||function(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(pA,"__esModule",{value:!0});pA.PluginPool=void 0;var _Je=Fb,yJe=iv,xJe=Ub,bJe=sv,wJe=jE,SJe=Bm,MJe=OE(),qS=Fl,CJe=j4,EJe=Gn,AJe=W4,PJe=function(){function n(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return n.prototype.getAll=function(){return $F($F($F([],this.pluginsMap_.blades,!0),this.pluginsMap_.inputs,!0),this.pluginsMap_.monitors,!0)},n.prototype.register=function(e){e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)},n.prototype.createInput=function(e,t,r){var i=t.read();if((0,EJe.isEmpty)(i))throw new qS.TpError({context:{key:t.key},type:"nomatchingcontroller"});var s=this.pluginsMap_.inputs.reduce(function(o,a){return o!=null?o:(0,CJe.createInputBindingController)(a,{document:e,target:t,params:r})},null);if(s)return s;throw new qS.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createMonitor=function(e,t,r){var i=this.pluginsMap_.monitors.reduce(function(s,o){return s!=null?s:(0,AJe.createMonitorBindingController)(o,{document:e,params:r,target:t})},null);if(i)return i;throw new qS.TpError({context:{key:t.key},type:"nomatchingcontroller"})},n.prototype.createBlade=function(e,t){var r=this.pluginsMap_.blades.reduce(function(i,s){return i!=null?i:(0,wJe.createBladeController)(s,{document:e,params:t})},null);if(!r)throw new qS.TpError({type:"nomatchingview",context:{params:t}});return r},n.prototype.createBladeApi=function(e){var t=this;if(e instanceof yJe.InputBindingController)return new _Je.InputBindingApi(e);if(e instanceof bJe.MonitorBindingController)return new xJe.MonitorBindingApi(e);if(e instanceof MJe.RackController)return new SJe.RackApi(e,this);var r=this.pluginsMap_.blades.reduce(function(i,s){return i!=null?i:s.api({controller:e,pool:t})},null);if(!r)throw qS.TpError.shouldNeverHappen();return r},n}();pA.PluginPool=PJe;Object.defineProperty(U4,"__esModule",{value:!0});U4.createDefaultPluginPool=void 0;var TJe=EE,RJe=IE,OJe=zE,LJe=UE,DJe=tA,IJe=nA,NJe=rA,kJe=iA,zJe=ed,BJe=ah,VJe=oA,FJe=aA,UJe=lA,jJe=cA,HJe=hA,WJe=dA,GJe=pA;function XJe(){var n=new GJe.PluginPool;return[BJe.Point2dInputPlugin,VJe.Point3dInputPlugin,FJe.Point4dInputPlugin,UJe.StringInputPlugin,zJe.NumberInputPlugin,kJe.StringColorInputPlugin,NJe.ObjectColorInputPlugin,IJe.NumberColorInputPlugin,DJe.BooleanInputPlugin,jJe.BooleanMonitorPlugin,WJe.StringMonitorPlugin,HJe.NumberMonitorPlugin,TJe.ButtonBladePlugin,RJe.FolderBladePlugin,OJe.SeparatorBladePlugin,LJe.TabBladePlugin].forEach(function(e){n.register(e)}),n}U4.createDefaultPluginPool=XJe;(function(n){var e=Ct&&Ct.__createBinding||(Object.create?function(i,s,o,a){a===void 0&&(a=o),Object.defineProperty(i,a,{enumerable:!0,get:function(){return s[o]}})}:function(i,s,o,a){a===void 0&&(a=o),i[a]=s[o]}),t=Ct&&Ct.__exportStar||function(i,s){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,i,o)};Object.defineProperty(n,"__esModule",{value:!0}),n.createBladeController=void 0,t(fd,n),t(lue,n),t(cue,n),t(Lo,n),t(wE,n),t(SE,n),t(ME,n),t(CE,n),t(EE,n),t(af,n),t(H0,n),t(AE,n),t(rv,n),t(cl,n),t(PE,n),t(TE,n),t(LE,n),t(IE,n),t(Fb,n),t(iv,n),t(j0,n),t(h4,n),t(zb,n),t(Ub,n),t(sv,n),t(NE,n),t(kE,n),t(zE,n),t(BE,n),t(VE,n),t(FE,n),t(Hb,n),t(UE,n);var r=jE;Object.defineProperty(n,"createBladeController",{enumerable:!0,get:function(){return r.createBladeController}}),t(HE,n),t(WE,n),t(mue,n),t(uh,n),t(gue,n),t(av,n),t(lv,n),t(Wb,n),t(_ue,n),t(W0,n),t(Gb,n),t(Xb,n),t(yue,n),t($h,n),t(bue,n),t(co,n),t(Eue,n),t(YE,n),t(Vm,n),t(Fm,n),t(Ps,n),t(go,n),t(Pue,n),t(es,n),t(lf,n),t(yl,n),t(ov,n),t(cf,n),t(KE,n),t(QE,n),t(ZE,n),t(JE,n),t($E,n),t(fr,n),t(GE,n),t(RE,n),t(ph,n),t(XE,n),t(zl,n),t(qE,n),t(Oue,n),t(_4,n),t(ma,n),t(_i,n),t(Ws,n),t(Lue,n),t(cv,n),t(Fl,n),t(Do,n),t(hi,n),t(eA,n),t(tA,n),t(G0,n),t(io,n),t(uf,n),t(Va,n),t(nA,n),t(rA,n),t(iA,n),t(X0,n),t(q0,n),t(ed,n),t(sA,n),t(ah,n),t(oA,n),t(aA,n),t(lA,n),t(uv,n),t(Gn,n),t(cA,n),t(Y0,n),t(Z0,n),t(uA,n),t(hA,n),t(dA,n),t(she,n),t(U4,n),t(pA,n)})(d9e);const R$e={...u9e,shadowDistance:Number},O$e={...h9e,shadowDistance:new ki(3e3),shadowResolution:new ki(1024)},qJe={...uE,onKeyPress:Function,onKeyUp:Function,onKeyDown:Function},YJe={...hE,onKeyPress:void 0,onKeyUp:void 0,onKeyDown:void 0},[ZJe,KJe]=fa(),[J$,JJe]=fa(),[Q$,QJe]=fa(),fc=new Set,$$=n=>(n=n.length===1?n.toLocaleLowerCase():n,n===" "&&(n="Space"),n);yn(()=>{if(gl()||qp()&&mn()===uo)return;const n=ha(()=>fc.size>0&&Q$()),e=r=>{const i=$$(r.key);fc.add(i),ZJe(i)},t=r=>{const i=$$(r.key);fc.delete(i),J$(i),!fc.size&&Q$()};return n.watch(C7(()=>{if(!fc.size)return;const r=[...fc];fc.clear();for(const i of r)J$(i)})),document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{n.cancel(),document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[gl,qp,mn]);class bR extends Lb{constructor(){super();We(this,"onKeyPress");We(this,"onKeyUp");We(this,"onKeyDown");this.watch(QJe(()=>{if(!!this.onKeyPress){if(!fc.size){this.onKeyPress("",fc);return}for(const t of fc)this.onKeyPress(t,fc)}})),this.watch(JJe(t=>{var r;return(r=this.onKeyUp)==null?void 0:r.call(this,t,fc)})),this.watch(KJe(t=>{var r;return(r=this.onKeyDown)==null?void 0:r.call(this,t,fc)}))}}We(bR,"componentName","keyboard"),We(bR,"defaults",YJe),We(bR,"schema",qJe);const $Je=new bR;dl.delete($Je);"getGamepads"in navigator&&ha(()=>{for(const n of navigator.getGamepads())if(!!n){for(let e=0;e<n.buttons.length;e++){const t=n.buttons[e],r=Math.round(t.value*100)+"%";t.pressed&&console.log(e,t.value,t.pressed,r)}for(let e=0;e<n.axes.length;e++){const t=Number(n.axes[e].toFixed(2));t!==0&&console.log(e,t)}}});const eQe=new Map,fA=(n,e)=>{for(const t of e)eQe.set(t,n);return e};fA("image",["jpg","jpeg","gif","png","svg","tiff","webp","hdr"]);fA("audio",["m4a","mp3","wav","wma","ogg","flax","flac","aac"]);fA("plainText",["ls","js","ts","jsx","tsx","py","txt","md","json","yaml","c","cpp","h","hpp","css","scss","sass","html"]);fA("model",["gltf","glb","fbx"]);fA("scene",["l3d"]);const wR=(n,e)=>{const t=e.x-n.x,r=e.y-n.y;return Math.sqrt(t*t+r*r)},tQe=(n,e)=>{const t=e.x-n.x,r=e.y-n.y;return rQe(Math.atan2(r,t))},nQe=(n,e,t)=>{const r={x:0,y:0};return t=gj(t),r.x=n.x-e*Math.cos(t),r.y=n.y-e*Math.sin(t),r},gj=n=>n*(Math.PI/180),rQe=n=>n*(180/Math.PI),iQe=n=>isNaN(n.buttons)?n.pressure!==0:n.buttons!==0,e6=new Map,eee=n=>{e6.has(n)&&clearTimeout(e6.get(n)),e6.set(n,setTimeout(n,100))},JO=(n,e,t)=>{const r=e.split(/[ ,]+/g);let i;for(let s=0;s<r.length;s+=1)i=r[s],n.addEventListener?n.addEventListener(i,t,!1):n.attachEvent&&n.attachEvent(i,t)},tee=(n,e,t)=>{const r=e.split(/[ ,]+/g);let i;for(let s=0;s<r.length;s+=1)i=r[s],n.removeEventListener?n.removeEventListener(i,t):n.detachEvent&&n.detachEvent(i,t)},ohe=n=>(n.preventDefault(),n.type.match(/^touch/)?n.changedTouches:n),nee=()=>{const n=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:n,y:e}},_j=(n,e)=>{e.top||e.right||e.bottom||e.left?(n.style.top=e.top,n.style.right=e.right,n.style.bottom=e.bottom,n.style.left=e.left):(n.style.left=e.x+"px",n.style.top=e.y+"px")},q7=(n,e,t)=>{const r=ahe(n);for(let i in r)if(r.hasOwnProperty(i))if(typeof e=="string")r[i]=e+" "+t;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+t+", ";r[i]=s.slice(0,-2)}return r},sQe=(n,e)=>{const t=ahe(n);for(let r in t)t.hasOwnProperty(r)&&(t[r]=e);return t},ahe=n=>{const e={};return e[n]="",["webkit","Moz","o"].forEach(function(r){e[r+n.charAt(0).toUpperCase()+n.slice(1)]=""}),e},t6=(n,e)=>{for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},oQe=(n,e)=>{const t={};for(let r in n)n.hasOwnProperty(r)&&e.hasOwnProperty(r)?t[r]=e[r]:n.hasOwnProperty(r)&&(t[r]=n[r]);return t},yj=(n,e)=>{if(n.length)for(let t=0,r=n.length;t<r;t+=1)e(n[t]);else e(n)},aQe=(n,e,t)=>({x:Math.min(Math.max(n.x,e.x-t),e.x+t),y:Math.min(Math.max(n.y,e.y-t),e.y+t)});var lQe="ontouchstart"in window,cQe=!!window.PointerEvent,uQe=!!window.MSPointerEvent,YS={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Ay,LC={};cQe?Ay=YS.pointer:uQe?Ay=YS.MSPointer:lQe?(Ay=YS.touch,LC=YS.mouse):Ay=YS.mouse;function hf(){}hf.prototype.on=function(n,e){var t=this,r=n.split(/[ ,]+/g),i;t._handlers_=t._handlers_||{};for(var s=0;s<r.length;s+=1)i=r[s],t._handlers_[i]=t._handlers_[i]||[],t._handlers_[i].push(e);return t};hf.prototype.off=function(n,e){var t=this;return t._handlers_=t._handlers_||{},n===void 0?t._handlers_={}:e===void 0?t._handlers_[n]=null:t._handlers_[n]&&t._handlers_[n].indexOf(e)>=0&&t._handlers_[n].splice(t._handlers_[n].indexOf(e),1),t};hf.prototype.trigger=function(n,e){var t=this,r=n.split(/[ ,]+/g),i;t._handlers_=t._handlers_||{};for(var s=0;s<r.length;s+=1)i=r[s],t._handlers_[i]&&t._handlers_[i].length&&t._handlers_[i].forEach(function(o){o.call(t,{type:i,target:t},e)})};hf.prototype.config=function(n){var e=this;e.options=e.defaults||{},n&&(e.options=oQe(e.options,n))};hf.prototype.bindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},t._domHandlers_[e]=function(){typeof t["on"+e]=="function"?t["on"+e].apply(t,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},JO(n,Ay[e],t._domHandlers_[e]),LC[e]&&JO(n,LC[e],t._domHandlers_[e]),t};hf.prototype.unbindEvt=function(n,e){var t=this;return t._domHandlers_=t._domHandlers_||{},tee(n,Ay[e],t._domHandlers_[e]),LC[e]&&tee(n,LC[e],t._domHandlers_[e]),delete t._domHandlers_[e],this};function _o(n,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=n,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=_o.id,_o.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}_o.prototype=new hf;_o.constructor=_o;_o.id=0;_o.prototype.buildEl=function(n){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};_o.prototype.stylize=function(){if(this.options.dataOnly)return this;var n=this.options.fadeTime+"ms",e=sQe("borderRadius","50%"),t=q7("transition","opacity",n),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},t6(r.el,t),this.options.shape==="circle"&&t6(r.back,e),t6(r.front,e),this.applyStyles(r),this};_o.prototype.applyStyles=function(n){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var t in n[e])this.ui[e].style[t]=n[e][t];return this};_o.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};_o.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};_o.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};_o.prototype.show=function(n){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof n=="function"&&n.call(this)},e.options.fadeTime)),e};_o.prototype.hide=function(n){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var t=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=t,typeof n=="function"&&n.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const t=e.options.restJoystick,r={};r.x=t===!0||t.x!==!1?0:e.instance.frontPosition.x,r.y=t===!0||t.y!==!1?0:e.instance.frontPosition.y,e.setPosition(n,r)}return e};_o.prototype.setPosition=function(n,e){var t=this;t.frontPosition={x:e.x,y:e.y};var r=t.options.fadeTime+"ms",i={};i.front=q7("transition",["top","left"],r);var s={front:{}};s.front={left:t.frontPosition.x+"px",top:t.frontPosition.y+"px"},t.applyStyles(i),t.applyStyles(s),t.restTimeout=setTimeout(function(){typeof n=="function"&&n.call(t),t.restCallback()},t.options.fadeTime)};_o.prototype.restCallback=function(){var n=this,e={};e.front=q7("transition","none",""),n.applyStyles(e),n.trigger("rested",n.instance)};_o.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};_o.prototype.computeDirection=function(n){var e=n.angle.radian,t=Math.PI/4,r=Math.PI/2,i,s,o;if(e>t&&e<t*3&&!n.lockX?i="up":e>-t&&e<=t&&!n.lockY?i="left":e>-t*3&&e<=-t&&!n.lockX?i="down":n.lockY||(i="right"),n.lockY||(e>-r&&e<r?s="left":s="right"),n.lockX||(e>0?o="up":o="down"),n.force>this.options.threshold){var a={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(a[c]=this.direction[c]);var u={};this.direction={x:s,y:o,angle:i},n.direction=this.direction;for(c in a)a[c]===this.direction[c]&&(u[c]=!0);if(u.x&&u.y&&u.angle)return n;(!u.x||!u.y)&&this.trigger("plain",n),u.x||this.trigger("plain:"+s,n),u.y||this.trigger("plain:"+o,n),u.angle||this.trigger("dir dir:"+i,n)}else this.resetDirection();return n};function Cs(n,e){var t=this;t.nipples=[],t.idles=[],t.actives=[],t.ids=[],t.pressureIntervals={},t.manager=n,t.id=Cs.id,Cs.id+=1,t.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},t.config(e),(t.options.mode==="static"||t.options.mode==="semi")&&(t.options.multitouch=!1),t.options.multitouch||(t.options.maxNumberOfNipples=1);const r=getComputedStyle(t.options.zone.parentElement);return r&&r.display==="flex"&&(t.parentIsFlex=!0),t.updateBox(),t.prepareNipples(),t.bindings(),t.begin(),t.nipples}Cs.prototype=new hf;Cs.constructor=Cs;Cs.id=0;Cs.prototype.prepareNipples=function(){var n=this,e=n.nipples;e.on=n.on.bind(n),e.off=n.off.bind(n),e.options=n.options,e.destroy=n.destroy.bind(n),e.ids=n.ids,e.id=n.id,e.processOnMove=n.processOnMove.bind(n),e.processOnEnd=n.processOnEnd.bind(n),e.get=function(t){if(t===void 0)return e[0];for(var r=0,i=e.length;r<i;r+=1)if(e[r].identifier===t)return e[r];return!1}};Cs.prototype.bindings=function(){var n=this;n.bindEvt(n.options.zone,"start"),n.options.zone.style.touchAction="none",n.options.zone.style.msTouchAction="none"};Cs.prototype.begin=function(){var n=this,e=n.options;if(e.mode==="static"){var t=n.createNipple(e.position,n.manager.getIdentifier());t.add(),n.idles.push(t)}};Cs.prototype.createNipple=function(n,e){var t=this,r=t.manager.scroll,i={},s=t.options,o={x:t.parentIsFlex?r.x:r.x+t.box.left,y:t.parentIsFlex?r.y:r.y+t.box.top};if(n.x&&n.y)i={x:n.x-o.x,y:n.y-o.y};else if(n.top||n.right||n.bottom||n.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=n.top,a.style.right=n.right,a.style.bottom=n.bottom,a.style.left=n.left,a.style.position="absolute",s.zone.appendChild(a);var c=a.getBoundingClientRect();s.zone.removeChild(a),i=n,n={x:c.left+r.x,y:c.top+r.y}}var u=new _o(t,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:n,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(_j(u.ui.el,i),_j(u.ui.front,u.frontPosition)),t.nipples.push(u),t.trigger("added "+u.identifier+":added",u),t.manager.trigger("added "+u.identifier+":added",u),t.bindNipple(u),u};Cs.prototype.updateBox=function(){var n=this;n.box=n.options.zone.getBoundingClientRect()};Cs.prototype.bindNipple=function(n){var e=this,t,r=function(i,s){t=i.type+" "+s.id+":"+i.type,e.trigger(t,s)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",r),n.on("dir:up dir:right dir:down dir:left",r),n.on("plain:up plain:right plain:down plain:left",r)};Cs.prototype.pressureFn=function(n,e,t){var r=this,i=0;clearInterval(r.pressureIntervals[t]),r.pressureIntervals[t]=setInterval(function(){var s=n.force||n.pressure||n.webkitForce||0;s!==i&&(e.trigger("pressure",s),r.trigger("pressure "+e.identifier+":pressure",s),i=s)}.bind(r),100)};Cs.prototype.onstart=function(n){var e=this,t=e.options,r=n;n=ohe(n),e.updateBox();var i=function(s){e.actives.length<t.maxNumberOfNipples?e.processOnStart(s):r.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(r.touches).findIndex(function(c){return c.identifier===o})<0){var a=[n[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<t.maxNumberOfNipples&&e.processOnStart(s))};return yj(n,i),e.manager.bindDocument(),!1};Cs.prototype.processOnStart=function(n){var e=this,t=e.options,r,i=e.manager.getIdentifier(n),s=n.force||n.pressure||n.webkitForce||0,o={x:n.pageX,y:n.pageY},a=e.getOrCreate(i,o);a.identifier!==i&&e.manager.removeIdentifier(a.identifier),a.identifier=i;var c=function(d){d.trigger("start",d),e.trigger("start "+d.id+":start",d),d.show(),s>0&&e.pressureFn(n,d,d.identifier),e.processOnMove(n)};if((r=e.idles.indexOf(a))>=0&&e.idles.splice(r,1),e.actives.push(a),e.ids.push(a.identifier),t.mode!=="semi")c(a);else{var u=wR(o,a.position);if(u<=t.catchDistance)c(a);else{a.destroy(),e.processOnStart(n);return}}return a};Cs.prototype.getOrCreate=function(n,e){var t=this,r=t.options,i;return/(semi|static)/.test(r.mode)?(i=t.idles[0],i?(t.idles.splice(0,1),i):r.mode==="semi"?t.createNipple(e,n):(console.warn("Coudln't find the needed nipple."),!1)):(i=t.createNipple(e,n),i)};Cs.prototype.processOnMove=function(n){var e=this,t=e.options,r=e.manager.getIdentifier(n),i=e.nipples.get(r),s=e.manager.scroll;if(!iQe(n)){this.processOnEnd(n);return}if(!i){console.error("Found zombie joystick with ID "+r),e.manager.removeIdentifier(r);return}if(t.dynamicPage){var o=i.el.getBoundingClientRect();i.position={x:s.x+o.left,y:s.y+o.top}}i.identifier=r;var a=i.options.size/2,c={x:n.pageX,y:n.pageY};t.lockX&&(c.y=i.position.y),t.lockY&&(c.x=i.position.x);var u=wR(c,i.position),d=tQe(c,i.position),p=gj(d),f=u/a,v={distance:u,position:c},x,y;if(i.options.shape==="circle"?(x=Math.min(u,a),y=nQe(i.position,x,d)):(y=aQe(c,i.position,a),x=wR(y,i.position)),t.follow){if(u>a){let A=c.x-y.x,P=c.y-y.y;i.position.x+=A,i.position.y+=P,i.el.style.top=i.position.y-(e.box.top+s.y)+"px",i.el.style.left=i.position.x-(e.box.left+s.x)+"px",u=wR(c,i.position)}}else c=y,u=x;var _=c.x-i.position.x,S=c.y-i.position.y;i.frontPosition={x:_,y:S},t.dataOnly||_j(i.ui.front,i.frontPosition);var C={identifier:i.identifier,position:c,force:f,pressure:n.force||n.pressure||n.webkitForce||0,distance:u,angle:{radian:p,degree:d},vector:{x:_/a,y:-S/a},raw:v,instance:i,lockX:t.lockX,lockY:t.lockY};C=i.computeDirection(C),C.angle={radian:gj(180-d),degree:180-d},i.trigger("move",C),e.trigger("move "+i.id+":move",C)};Cs.prototype.processOnEnd=function(n){var e=this,t=e.options,r=e.manager.getIdentifier(n),i=e.nipples.get(r),s=e.manager.removeIdentifier(i.identifier);!i||(t.dataOnly||i.hide(function(){t.mode==="dynamic"&&(i.trigger("removed",i),e.trigger("removed "+i.id+":removed",i),e.manager.trigger("removed "+i.id+":removed",i),i.destroy())}),clearInterval(e.pressureIntervals[i.identifier]),i.resetDirection(),i.trigger("end",i),e.trigger("end "+i.id+":end",i),e.ids.indexOf(i.identifier)>=0&&e.ids.splice(e.ids.indexOf(i.identifier),1),e.actives.indexOf(i)>=0&&e.actives.splice(e.actives.indexOf(i),1),/(semi|static)/.test(t.mode)?e.idles.push(i):e.nipples.indexOf(i)>=0&&e.nipples.splice(e.nipples.indexOf(i),1),e.manager.unbindDocument(),/(semi|static)/.test(t.mode)&&(e.manager.ids[s.id]=s.identifier))};Cs.prototype.onDestroyed=function(n,e){var t=this;t.nipples.indexOf(e)>=0&&t.nipples.splice(t.nipples.indexOf(e),1),t.actives.indexOf(e)>=0&&t.actives.splice(t.actives.indexOf(e),1),t.idles.indexOf(e)>=0&&t.idles.splice(t.idles.indexOf(e),1),t.ids.indexOf(e.identifier)>=0&&t.ids.splice(t.ids.indexOf(e.identifier),1),t.manager.removeIdentifier(e.identifier),t.manager.unbindDocument()};Cs.prototype.destroy=function(){var n=this;n.unbindEvt(n.options.zone,"start"),n.nipples.forEach(function(t){t.destroy()});for(var e in n.pressureIntervals)n.pressureIntervals.hasOwnProperty(e)&&clearInterval(n.pressureIntervals[e]);n.trigger("destroyed",n.nipples),n.manager.unbindDocument(),n.off()};function zo(n){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=nee(),e.config(n),e.prepareCollections();var t=function(){var i;e.collections.forEach(function(s){s.forEach(function(o){i=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+i.left,y:e.scroll.y+i.top}})})};JO(window,"resize",function(){eee(t)});var r=function(){e.scroll=nee()};return JO(window,"scroll",function(){eee(r)}),e.collections}zo.prototype=new hf;zo.constructor=zo;zo.prototype.prepareCollections=function(){var n=this;n.collections.create=n.create.bind(n),n.collections.on=n.on.bind(n),n.collections.off=n.off.bind(n),n.collections.destroy=n.destroy.bind(n),n.collections.get=function(e){var t;return n.collections.every(function(r){return t=r.get(e),!t}),t}};zo.prototype.create=function(n){return this.createCollection(n)};zo.prototype.createCollection=function(n){var e=this,t=new Cs(e,n);return e.bindCollection(t),e.collections.push(t),t};zo.prototype.bindCollection=function(n){var e=this,t,r=function(i,s){t=i.type+" "+s.id+":"+i.type,e.trigger(t,s)};n.on("destroyed",e.onDestroyed.bind(e)),n.on("shown hidden rested dir plain",r),n.on("dir:up dir:right dir:down dir:left",r),n.on("plain:up plain:right plain:down plain:left",r)};zo.prototype.bindDocument=function(){var n=this;n.binded||(n.bindEvt(document,"move").bindEvt(document,"end"),n.binded=!0)};zo.prototype.unbindDocument=function(n){var e=this;(!Object.keys(e.ids).length||n===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};zo.prototype.getIdentifier=function(n){var e;return n?(e=n.identifier===void 0?n.pointerId:n.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};zo.prototype.removeIdentifier=function(n){var e={};for(var t in this.ids)if(this.ids[t]===n){e.id=t,e.identifier=this.ids[t],delete this.ids[t];break}return e};zo.prototype.onmove=function(n){var e=this;return e.onAny("move",n),!1};zo.prototype.onend=function(n){var e=this;return e.onAny("end",n),!1};zo.prototype.oncancel=function(n){var e=this;return e.onAny("end",n),!1};zo.prototype.onAny=function(n,e){var t=this,r,i="processOn"+n.charAt(0).toUpperCase()+n.slice(1);e=ohe(e);var s=function(a,c,u){u.ids.indexOf(c)>=0&&(u[i](a),a._found_=!0)},o=function(a){r=t.getIdentifier(a),yj(t.collections,s.bind(null,a,r)),a._found_||t.removeIdentifier(r)};return yj(e,o),!1};zo.prototype.destroy=function(){var n=this;n.unbindDocument(!0),n.ids={},n.index=0,n.collections.forEach(function(e){e.destroy()}),n.off()};zo.prototype.onDestroyed=function(n,e){var t=this;if(t.collections.indexOf(e)<0)return!1;t.collections.splice(t.collections.indexOf(e),1)};new zo;const Y7=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})();Y7?Promise.resolve().then(function(){return pQe}):Promise.resolve().then(function(){return yQe});Y7?Promise.resolve().then(function(){return mQe}):Promise.resolve().then(function(){return bQe});Y7?Promise.resolve().then(function(){return gQe}):Promise.resolve().then(function(){return SQe});const hQe=async n=>{const e=await n.getFile();return e.handle=n,e};var dQe=async(n=[{}])=>{Array.isArray(n)||(n=[n]);const e=[];n.forEach((i,s)=>{e[s]={description:i.description||"Files",accept:{}},i.mimeTypes?i.mimeTypes.map(o=>{e[s].accept[o]=i.extensions||[]}):e[s].accept["*/*"]=i.extensions||[]});const t=await window.showOpenFilePicker({id:n[0].id,startIn:n[0].startIn,types:e,multiple:n[0].multiple||!1,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1}),r=await Promise.all(t.map(hQe));return n[0].multiple?r:r[0]},pQe={__proto__:null,default:dQe};function SR(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var r=t.done;return Promise.resolve(t.value).then(function(i){return{value:i,done:r}})}return SR=function(t){this.s=t,this.n=t.next},SR.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return r===void 0?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return r===void 0?Promise.reject(t):e(r.apply(this.s,arguments))}},new SR(n)}const lhe=async(n,e,t=n.name,r)=>{const i=[],s=[];var o,a=!1,c=!1;try{for(var u,d=function(p){var f,v,x,y=2;for(typeof Symbol<"u"&&(v=Symbol.asyncIterator,x=Symbol.iterator);y--;){if(v&&(f=p[v])!=null)return f.call(p);if(x&&(f=p[x])!=null)return new SR(f.call(p));v="@@asyncIterator",x="@@iterator"}throw new TypeError("Object is not async iterable")}(n.values());a=!(u=await d.next()).done;a=!1){const p=u.value,f=`${t}/${p.name}`;p.kind==="file"?s.push(p.getFile().then(v=>(v.directoryHandle=n,v.handle=p,Object.defineProperty(v,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>f})))):p.kind!=="directory"||!e||r&&r(p)||i.push(lhe(p,e,f,r))}}catch(p){c=!0,o=p}finally{try{a&&d.return!=null&&await d.return()}finally{if(c)throw o}}return[...(await Promise.all(i)).flat(),...await Promise.all(s)]};var fQe=async(n={})=>{n.recursive=n.recursive||!1,n.mode=n.mode||"read";const e=await window.showDirectoryPicker({id:n.id,startIn:n.startIn,mode:n.mode});return lhe(e,n.recursive,void 0,n.skipDirectory)},mQe={__proto__:null,default:fQe},vQe=async(n,e=[{}],t=null,r=!1,i=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const s=[];let o=null;if(n instanceof Blob&&n.type?o=n.type:n.headers&&n.headers.get("content-type")&&(o=n.headers.get("content-type")),e.forEach((u,d)=>{s[d]={description:u.description||"Files",accept:{}},u.mimeTypes?(d===0&&o&&u.mimeTypes.push(o),u.mimeTypes.map(p=>{s[d].accept[p]=u.extensions||[]})):o?s[d].accept[o]=u.extensions||[]:s[d].accept["*/*"]=u.extensions||[]}),t)try{await t.getFile()}catch(u){if(t=null,r)throw u}const a=t||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:s,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!t&&i&&i(a);const c=await a.createWritable();return"stream"in n?(await n.stream().pipeTo(c),a):"body"in n?(await n.body.pipeTo(c),a):(await c.write(await n),await c.close(),a)},gQe={__proto__:null,default:vQe},_Qe=async(n=[{}])=>(Array.isArray(n)||(n=[n]),new Promise((e,t)=>{const r=document.createElement("input");r.type="file";const i=[...n.map(c=>c.mimeTypes||[]),...n.map(c=>c.extensions||[])].join();r.multiple=n[0].multiple||!1,r.accept=i||"",r.style.display="none",document.body.append(r);const s=c=>{typeof o=="function"&&o(),e(c)},o=n[0].legacySetup&&n[0].legacySetup(s,()=>o(t),r),a=()=>{window.removeEventListener("focus",a),r.remove()};r.addEventListener("click",()=>{window.addEventListener("focus",a)}),r.addEventListener("change",()=>{window.removeEventListener("focus",a),r.remove(),s(r.multiple?Array.from(r.files):r.files[0])}),r.click()})),yQe={__proto__:null,default:_Qe},xQe=async(n=[{}])=>(Array.isArray(n)||(n=[n]),n[0].recursive=n[0].recursive||!1,new Promise((e,t)=>{const r=document.createElement("input");r.type="file",r.webkitdirectory=!0;const i=o=>{typeof s=="function"&&s(),e(o)},s=n[0].legacySetup&&n[0].legacySetup(i,()=>s(t),r);r.addEventListener("change",()=>{let o=Array.from(r.files);n[0].recursive?n[0].recursive&&n[0].skipDirectory&&(o=o.filter(a=>a.webkitRelativePath.split("/").every(c=>!n[0].skipDirectory({name:c,kind:"directory"})))):o=o.filter(a=>a.webkitRelativePath.split("/").length===2),i(o)}),r.click()})),bQe={__proto__:null,default:xQe},wQe=async(n,e={})=>{Array.isArray(e)&&(e=e[0]);const t=document.createElement("a");let r=n;"body"in n&&(r=await async function(o,a){const c=o.getReader(),u=new ReadableStream({start:f=>async function v(){return c.read().then(({done:x,value:y})=>{if(!x)return f.enqueue(y),v();f.close()})}()}),d=new Response(u),p=await d.blob();return c.releaseLock(),new Blob([p],{type:a})}(n.body,n.headers.get("content-type"))),t.download=e.fileName||"Untitled",t.href=URL.createObjectURL(await r);const i=()=>{typeof s=="function"&&s()},s=e.legacySetup&&e.legacySetup(i,()=>s(),t);return t.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(t.href),3e4),i()}),t.click(),null},SQe={__proto__:null,default:wQe};Pt(!1);Pt("https://unpkg.com/lingo3d-wasm@1.0.1/assets/");const MQe=n=>{const e=new JU.exports.Client("ws://localhost:2567"),t=iL({});return Wp(async r=>{const i=n.value;if(!i)return;const s=await e.joinOrCreate("my_room");s.state.players.onAdd=(a,c)=>{if(console.log("player joined",c),s.sessionId===c){console.log("I am",c);return}const d=BLe();t[c]=d,a.onChange=()=>{Object.assign(d,a)}},s.state.players.onRemove=(a,c)=>{console.log("player left!",c),delete t[c]};const o=rR(()=>{const{x:a,y:c,z:u,animation:d}=i;s.send("updatePlayer",{x:a,y:c,z:u,animation:d})});r(()=>{o.cancel()})}),t},CQe=Um({__name:"App",setup(n){const e=qx(),t=MQe(e);return q3.onKeyPress=(r,i)=>{const s=e.value;!s||(i.has("w")&&(s.strideForward=-5),i.has("s")&&(s.strideForward=5),i.has("a")&&(s.strideRight=5),i.has("d")&&(s.strideRight=-5))},q3.onKeyDown=r=>{const i=e.value;!i||r==="Space"&&i.jump(8)},q3.onKeyUp=(r,i)=>{const s=e.value;!s||(!i.has("w")&&!i.has("s")&&(s.strideForward=0),!i.has("a")&&!i.has("d")&&(s.strideRight=0))},(r,i)=>{const s=Ide("Lingo3d");return mM(),f6(Mh(wDe),null,{default:KS(()=>[sa(s,{version:"1.34.4"}),sa(Mh(NZ),{x:-703.67,y:-44.16,z:243.91,"scale-x":150,"scale-y":150,"scale-z":150,width:121.25,depth:84.17,src:"map.glb",physics:"map"},null,8,["x","y","z","width","depth"]),(mM(!0),Xee(Al,null,zde(Mh(t),(o,a)=>(mM(),f6(Mh(kZ),{key:a,proxy:o,preset:"rifle"},null,8,["proxy"]))),128)),sa(Mh(sIe),{x:-3975.58,y:-533.97,z:-1750.08,active:"","mouse-control-model":"orbit","mouse-control":"","inner-x":20,"inner-z":150},{default:KS(()=>[sa(Mh(kZ),{animations:{idle:"https://unpkg.com/lingo3d-dummy@1.0.4/assets/rifle-idle.fbx",running:"https://unpkg.com/lingo3d-dummy@1.0.4/assets/rifle-running.fbx",runningBackwards:"https://unpkg.com/lingo3d-dummy@1.0.4/assets/rifle-running-backwards.fbx",jumping:"https://unpkg.com/lingo3d-dummy@1.0.4/assets/rifle-falling.fbx",death:"https://unpkg.com/lingo3d-dummy@1.0.4/assets/death.fbx"},x:-3975.58,y:-533.97,z:-1750.08,preset:"rifle",ref_key:"dummyRef",ref:e,"stride-move":"",physics:"character"},{default:KS(()=>[sa(Mh(oIe),{name:"mixamorigRightHand",x:-2761.45,"scale-y":1,"rotation-x":-53.44,"rotation-y":-17.1,"rotation-z":-30.07,"normal-scale":{x:1,y:1}},{default:KS(()=>[sa(Mh(NZ),{x:-2622.16,y:-341.02,z:-13.31,"scale-x":31.85,"scale-y":31.85,"scale-z":31.85,"rotation-x":-158.16,"rotation-y":-84.15,"rotation-z":106.08,width:26.63,depth:277.87,src:"gun.glb"},null,8,["x","y","z","scale-x","scale-y","scale-z","rotation-x","rotation-y","rotation-z","width","depth"])]),_:1},8,["x","rotation-x","rotation-y","rotation-z"])]),_:1},8,["animations","x","y","z"])]),_:1},8,["x","y","z"]),sa(Mh(Coe),{"default-light":"studio",exposure:2,pbr:""})]),_:1})}}});Bpe(CQe).mount("#app");export{$be as $,Oi as A,LX as B,Gxe as C,Kr as D,Ch as E,Gp as F,Iy as G,ye as H,Nh as I,Jp as J,$_e as K,UQe as L,jQe as M,Jx as N,zn as O,BR as P,Qt as Q,iu as R,hh as S,Bl as T,Hxe as U,P0 as V,$p as W,Ut as X,Ol as Y,$we as Z,$j as _,Io as a,DW as a$,Ibe as a0,Yxe as a1,Sr as a2,Po as a3,WQe as a4,gxe as a5,hl as a6,yL as a7,A0 as a8,Hn as a9,kR as aA,ZB as aB,UC as aC,QM as aD,ib as aE,ad as aF,VC as aG,oo as aH,qye as aI,Gye as aJ,Zye as aK,QQe as aL,Am as aM,NQe as aN,zC as aO,zQe as aP,X_e as aQ,Vs as aR,kC as aS,K_e as aT,od as aU,FC as aV,LQe as aW,DQe as aX,OR as aY,RQe as aZ,us as a_,s9 as aa,o9 as ab,l9 as ac,BC as ad,$x as ae,v9 as af,GQe as ag,T0 as ah,kQe as ai,Kte as aj,jye as ak,ix as al,mc as am,da as an,Wte as ao,Xt as ap,XM as aq,Ite as ar,Lr as as,OQe as at,kte as au,Kye as av,Ste as aw,ca as ax,Ir as ay,O6 as az,mne as b,Nt as b$,xfe as b0,IW as b1,x6 as b2,RR as b3,IR as b4,TQe as b5,wL as b6,Dy as b7,BQe as b8,g3 as b9,th as bA,mte as bB,nP as bC,Op as bD,AQe as bE,At as bF,Rb as bG,gle as bH,ua as bI,ut as bJ,Te as bK,Wy as bL,r$e as bM,nR as bN,h8 as bO,As as bP,sr as bQ,i$e as bR,ev as bS,Rle as bT,wVe as bU,Hh as bV,jh as bW,Uae as bX,vc as bY,Us as bZ,ds as b_,P6 as ba,VQe as bb,nr as bc,q_e as bd,Lte as be,IQe as bf,Yj as bg,Ei as bh,Rte as bi,s0 as bj,Wj as bk,m0 as bl,ss as bm,Nr as bn,$te as bo,ks as bp,G_e as bq,Bfe as br,E0 as bs,aa as bt,Lt as bu,KQe as bv,dq as bw,zne as bx,Nte as by,nh as bz,Bh as c,bC as c$,CT as c0,Ip as c1,IFe as c2,Mc as c3,Qi as c4,Eb as c5,Vr as c6,iE as c7,aE as c8,qD as c9,O$e as cA,R$e as cB,n$e as cC,d9e as cD,j8e as cE,L6e as cF,ia as cG,Up as cH,b7 as cI,AUe as cJ,Cc as cK,Fg as cL,NFe as cM,kh as cN,jD as cO,nv as cP,Sc as cQ,Ex as cR,e$e as cS,DO as cT,Nle as cU,Pt as cV,Mb as cW,Cb as cX,yn as cY,pce as cZ,B8e as c_,F0 as ca,ul as cb,$H as cc,SVe as cd,e7 as ce,n7 as cf,sE as cg,Uh as ch,l9e as ci,c9e as cj,t$e as ck,en as cl,gE as cm,tu as cn,Ule as co,kp as cp,W8e as cq,F8e as cr,mn as cs,uo as ct,di as cu,D8e as cv,$D as cw,yc as cx,Sn as cy,ha as cz,eb as d,gl as d0,PO as d1,LJ as d2,h6e as d3,Ah as d4,Gy as d5,a$e as d6,l$e as d7,oa as d8,o$e as d9,mE as da,Lb as db,EVe as dc,Eae as dd,kle as de,NH as df,sUe as dg,f6e as dh,Ms as di,Oo as dj,d$e as dk,cu as e,cb as f,tx as g,wr as h,zg as i,PQe as j,Pi as k,zh as l,sd as m,yt as n,Uj as o,bc as p,Zx as q,ete as r,ene as s,Kx as t,_n as u,Qne as v,Na as w,ot as x,Ri as y,y9 as z};
