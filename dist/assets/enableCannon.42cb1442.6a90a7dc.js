import{Q as y,f as m,$ as d}from"./index.66975801.js";import{x as l}from"./PhysicsUpdate.0a7e4cd0.02fb49e3.js";const p=[1,2,4,8,16,32],f=[0,1,2,3,4,5];async function B(o){var a,n;if(o.done)return;y.attach(this.outerObject3d);const{slipperyMaterial:h,defaultMaterial:c,world:r,Body:u,Vec3:s}=await m();if(o.done)return;const t=this.cannonBody=new u({mass:(a=this._mass)!=null?a:1,material:this._slippery?h:c,collisionFilterGroup:p[(n=this._physicsGroup)!=null?n:0],collisionFilterMask:f.filter(i=>{var e;return!((e=this._ignorePhysicsGroups)!=null&&e.includes(i))}).map(i=>p[i]).reduce((i,e)=>i+e,0)});await this.physicsShape(),!o.done&&(this._physics==="2d"&&(t.angularFactor=new s(0,0,1),t.linearFactor=new s(1,1,0)),this._noTumble&&(t.angularFactor=new s(0,0,0)),t.position.copy(this.outerObject3d.position),t.quaternion.copy(this.outerObject3d.quaternion),this.rotationUpdate=new l,this.positionUpdate=new l,r.addBody(t),d.add(this),o.then(()=>{r.removeBody(t),d.delete(this),this.cannonBody=void 0,this.rotationUpdate=void 0,this.positionUpdate=void 0}))}export{B as default};
