import{X as v,a0 as E,a1 as T,a2 as n,a3 as L,w as k,a4 as l}from"./index.66975801.js";function C(){this.done||(this.createEffect(()=>{if(v()!==this.camera||!this.mouseControlState.get())return;if(E()===this.camera){const t=s=>this.gyrate(s.movementX,s.movementY);return document.addEventListener("mousemove",t),()=>{document.removeEventListener("mousemove",t)}}let o=!1,e,i,r;const a=()=>{o=!0,[i,r]=[void 0,void 0]},g=()=>o=!1,u=t=>{i===void 0&&(i=t.clientX),r===void 0&&(r=t.clientY);const[s,d]=[t.clientX-i,t.clientY-r];[i,r]=[t.clientX,t.clientY],o&&this.gyrate(s/window.innerWidth*3e3,d/window.innerHeight*3e3)};if(T){const t=c=>{e===void 0&&(e=c.changedTouches[c.changedTouches.length-1].identifier,a())};n.addEventListener("touchstart",t);const s=c=>{e!==void 0&&c.changedTouches[c.changedTouches.length-1].identifier===e&&(e=void 0,g())};n.addEventListener("touchend",s);const d=c=>{if(e===void 0)return;let h;for(let m=0;m<c.changedTouches.length;++m){const f=c.changedTouches[m];if(f.identifier===e){h=f;break}}h&&u(h)};return n.addEventListener("touchmove",d),()=>{n.removeEventListener("touchstart",t),n.removeEventListener("touchend",s),n.removeEventListener("touchmove",d),e=void 0,o=!1}}const p=L.on("down",a),w=L.on("up",g);return n.addEventListener("mousemove",u),()=>{p.cancel(),w.cancel(),n.removeEventListener("mousemove",u),e=void 0,o=!1}},[this.mouseControlState.get,v,E]),this.createEffect(()=>{const o=v();if(this.mouseControlState.get()!==!0||o!==this.camera||k())return;const e=()=>{var r,a;return(a=(r=n).requestPointerLock)==null?void 0:a.call(r)},i=()=>{document.pointerLockElement===n?l(o):l(void 0)};return n.addEventListener("click",e),document.addEventListener("pointerlockchange",i),()=>{n.removeEventListener("click",e),document.removeEventListener("pointerlockchange",i),document.exitPointerLock(),l(void 0)}},[this.mouseControlState.get,v,k]))}export{C as default};
