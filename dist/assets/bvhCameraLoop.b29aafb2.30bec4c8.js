import{u as b,y as l,bv as m,bw as g,bx as k,G as a,M as p,k as B,U as M}from"./index.66975801.js";import{s as f}from"./useBVHMap.37f7c48f.6f03e93c.js";b(()=>{const r=f();if(!r.length){const t=l(m);return()=>{t.cancel()}}const u=l(()=>{m();for(const t of g){t.updateMatrixWorld();const d=k(t),{start:o,end:i}=p;i.copy(o.copy(t.position)),a.makeEmpty(),a.expandByPoint(o),a.min.addScalar(-.5),a.max.addScalar(.5);const y=B,S=M;let s=0,n=0;for(const x of r)x.shapecast({intersectsBounds:c=>c.intersectsBox(a),intersectsTriangle:c=>{s=c.closestPointToSegment(p,y,S),s<.5&&(n=.5-s,o.addScaledVector(d,n),i.addScaledVector(d,n))}});const e=o.sub(t.position),h=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(h),t.position.add(e)}});return()=>{u.cancel()}},[f]);
